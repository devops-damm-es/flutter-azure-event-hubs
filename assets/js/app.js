!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=113)}([function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(13),i=n(1);const o=Object(r.a)("event-hubs");function s(e){Object(i.c)(e,["stack"])&&e.stack&&o.verbose(e.stack)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(179),i=n(180);function o(e){return null!=e}function s(e,t){if(!o(e)||"object"!=typeof e)return!1;for(const n of t)if(!a(e,n))return!1;return!0}function a(e,t){return"object"==typeof e&&t in e}function c(e){return function(e){const t=e;return t&&"function"==typeof t.getToken&&(void 0===t.signRequest||t.getToken.length>0)}(e)||Object(r.a)(e)||Object(i.a)(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28);t.types=r.types,t.message=r.message,t.filter=r.filter,t.uuid_to_string=r.uuid_to_string,t.generate_uuid=r.generate_uuid,t.string_to_uuid=r.string_to_uuid,t.ReceiverEvents=r.ReceiverEvents,t.SenderEvents=r.SenderEvents,t.ConnectionEvents=r.ConnectionEvents,t.SessionEvents=r.SessionEvents,t.Typed=r.Typed;var i=n(87);t.EventContext=i.EventContext;var o=n(90);t.Container=o.Container;var s=n(62);t.Connection=s.Connection;var a=n(63);t.Session=a.Session;var c=n(88);t.Receiver=c.Receiver;var u=n(66);t.Sender=u.Sender,t.SenderSendOptions=u.SenderSendOptions;var l=n(89);t.AwaitableSender=l.AwaitableSender;var h=n(48);t.AmqpResponseStatusCode=h.AmqpResponseStatusCode,t.isAmqpError=h.isAmqpError,t.delay=h.delay,t.messageHeader=h.messageHeader,t.messageProperties=h.messageProperties,t.parseConnectionString=h.parseConnectionString;var d=n(49);t.InsufficientCreditError=d.InsufficientCreditError,t.OperationTimeoutError=d.OperationTimeoutError,t.SendOperationFailedError=d.SendOperationFailedError},function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(13);const i=Object(r.a)("identity");function o(e){return`SUCCESS. Scopes: ${Array.isArray(e)?e.join(", "):e}.`}function s(e,t){let n="ERROR.";return(null==e?void 0:e.length)&&(n+=` Scopes: ${Array.isArray(e)?e.join(", "):e}.`),`${n} Error message: ${"string"==typeof t?t:t.message}.`}function a(e,t,n=i){const r=t?`${t.fullTitle} ${e}`:e;return{title:e,fullTitle:r,info:function(e){n.info(r+" =>",e)}}}function c(e,t=i){const n=a(e,void 0,t);return Object.assign(Object.assign({},n),{getToken:a("=> getToken()",n,t)})}}).call(this,n(9))},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(13),i=n(16);const o=Object(r.a)("core-amqp");function s(e){Object(i.b)(e,["stack"])&&o.verbose(e.stack)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r={associatedLinkName:"associated-link-name",partitionKey:"x-opt-partition-key",sequenceNumber:"x-opt-sequence-number",enqueueSequenceNumber:"x-opt-enqueue-sequence-number",enqueuedTime:"x-opt-enqueued-time",scheduledEnqueueTime:"x-opt-scheduled-enqueue-time",offset:"x-opt-offset",lockedUntil:"x-opt-locked-until",partitionIdName:"x-opt-partition-id",publisher:"x-opt-publisher-name",viaPartitionKey:"x-opt-via-partition-key",deadLetterSource:"x-opt-deadletter-source",messageState:"x-opt-message-state",enqueuedTimeAnnotation:"amqp.annotation.x-opt-enqueued-time",offsetAnnotation:"amqp.annotation.x-opt-offset",sequenceNumberAnnotation:"amqp.annotation.x-opt-sequence-number",guidSize:16,message:"message",error:"error",statusCode:"status-code",statusDescription:"status-description",errorCondition:"error-condition",management:"$management",partition:"partition",partitionId:"partitionId",readOperation:"READ",TLS:"tls",establishConnection:"establishConnection",defaultConsumerGroup:"$default",eventHub:"eventhub",cbsEndpoint:"$cbs",cbsReplyTo:"cbs",operationPutToken:"put-token",aadEventHubsAudience:"https://eventhubs.azure.net/",aadEventHubsScope:"https://eventhubs.azure.net//.default",aadServiceBusAudience:"https://servicebus.azure.net/",aadServiceBusScope:"https://servicebus.azure.net//.default",maxUserAgentLength:512,vendorString:"com.microsoft",attachEpoch:"com.microsoft:epoch",receiverIdentifierName:"com.microsoft:receiver-name",enableReceiverRuntimeMetricName:"com.microsoft:enable-receiver-runtime-metric",timespan:"com.microsoft:timespan",uri:"com.microsoft:uri",dateTimeOffset:"com.microsoft:datetime-offset",sessionFilterName:"com.microsoft:session-filter",receiverError:"receiver_error",senderError:"sender_error",sessionError:"session_error",connectionError:"connection_error",defaultOperationTimeoutInMs:6e4,defaultConnectionIdleTimeoutInMs:6e4,managementRequestKey:"managementRequest",negotiateCbsKey:"negotiateCbs",negotiateClaim:"negotiateClaim",ensureContainerAndBlob:"ensureContainerAndBlob",defaultPrefetchCount:1e3,reconnectLimit:100,maxMessageIdLength:128,maxPartitionKeyLength:128,maxSessionIdLength:128,pathDelimiter:"/",ruleNameMaximumLength:50,maximumSqlFilterStatementLength:1024,maximumSqlRuleActionStatementLength:1024,maxDeadLetterReasonLength:4096,maxDurationValue:922337203685477,minDurationValue:-922337203685477,maxAbsoluteExpiryTime:new Date("9999-12-31T07:59:59.000Z").getTime(),aadTokenValidityMarginInMs:5e3,connectionReconnectDelay:300,defaultMaxRetries:3,defaultMaxRetriesForConnection:150,defaultDelayBetweenOperationRetriesInMs:3e4,defaultMaxDelayForExponentialRetryInMs:9e4,receiverSettleMode:"receiver-settle-mode",dispositionStatus:"disposition-status",fromSequenceNumber:"from-sequence-number",messageCount:"message-count",lockTokens:"lock-tokens",messageIdMapKey:"message-id",sequenceNumberMapKey:"sequence-number",lockTokenMapKey:"lock-token",sessionIdMapKey:"session-id",sequenceNumbers:"sequence-numbers",deadLetterReason:"deadletter-reason",deadLetterDescription:"deadletter-description",propertiesToModify:"properties-to-modify",deadLetterName:"com.microsoft:dead-letter",trackingId:"com.microsoft:tracking-id",serverTimeout:"com.microsoft:server-timeout",operations:{putToken:"put-token",read:"READ",cancelScheduledMessage:"com.microsoft:cancel-scheduled-message",scheduleMessage:"com.microsoft:schedule-message",renewLock:"com.microsoft:renew-lock",peekMessage:"com.microsoft:peek-message",receiveBySequenceNumber:"com.microsoft:receive-by-sequence-number",updateDisposition:"com.microsoft:update-disposition",renewSessionLock:"com.microsoft:renew-session-lock",setSessionState:"com.microsoft:set-session-state",getSessionState:"com.microsoft:get-session-state",enumerateSessions:"com.microsoft:get-message-sessions",addRule:"com.microsoft:add-rule",removeRule:"com.microsoft:remove-rule",enumerateRules:"com.microsoft:enumerate-rules"},descriptorCodes:{ruleDescriptionList:1335734829060,sqlFilterList:83483426822,correlationFilterList:83483426825,sqlRuleActionList:1335734829062,trueFilterList:83483426823,falseFilterList:83483426824}},i="The operation was aborted."},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));const r={name:"@azure/event-hubs",version:"5.8.0"},i={capability:"com.microsoft:idempotent-producer",epoch:"com.microsoft:producer-epoch",producerId:"com.microsoft:producer-id",producerSequenceNumber:"com.microsoft:producer-sequence-number"},o=Symbol.for("@azure/event-hubs.pendingPublishSequenceNumber")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r="$",i="_"},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(115),i=n(116),o=n(80);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=d(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n),i=(e=a(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):d(e,t);if("Buffer"===t.type&&o(t.data))return d(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(l(t),e=a(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|p(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function f(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return D(e).length;default:if(r)return B(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return O(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=n;o<a;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){for(var h=!0,d=0;d<c;d++)if(u(e,o+d)!==u(t,d)){h=!1;break}if(h)return o}return-1}function _(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function b(e,t,n,r){return F(B(t,e.length-n),e,n,r)}function w(e,t,n,r){return F(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return w(e,t,n,r)}function S(e,t,n,r){return F(D(t),e,n,r)}function k(e,t,n,r){return F(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function O(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,c,u=e[i],l=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=n)switch(h){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),u=this.slice(r,i),l=e.slice(t,n),h=0;h<a;++h)if(u[h]!==l[h]){o=u[h],s=l[h];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return E(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function A(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=U(e[o]);return i}function x(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function R(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function N(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function j(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function L(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(e,t,n,r,o){return o||L(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function q(e,t,n,r,o){return o||L(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):j(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);P(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);P(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):j(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return M(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return M(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return q(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return q(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=c.isBuffer(e)?e:B(new c(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var z=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function B(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function D(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(25))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],l=!1,h=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&p())}function p(){if(!l){var e=a(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||l||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return i})),n.d(t,"__assign",(function(){return o})),n.d(t,"__rest",(function(){return s})),n.d(t,"__decorate",(function(){return a})),n.d(t,"__param",(function(){return c})),n.d(t,"__metadata",(function(){return u})),n.d(t,"__awaiter",(function(){return l})),n.d(t,"__generator",(function(){return h})),n.d(t,"__createBinding",(function(){return d})),n.d(t,"__exportStar",(function(){return p})),n.d(t,"__values",(function(){return f})),n.d(t,"__read",(function(){return m})),n.d(t,"__spread",(function(){return y})),n.d(t,"__spreadArrays",(function(){return g})),n.d(t,"__spreadArray",(function(){return v})),n.d(t,"__await",(function(){return _})),n.d(t,"__asyncGenerator",(function(){return b})),n.d(t,"__asyncDelegator",(function(){return w})),n.d(t,"__asyncValues",(function(){return E})),n.d(t,"__makeTemplateObject",(function(){return S})),n.d(t,"__importStar",(function(){return O})),n.d(t,"__importDefault",(function(){return T})),n.d(t,"__classPrivateFieldGet",(function(){return C})),n.d(t,"__classPrivateFieldSet",(function(){return I})),n.d(t,"__classPrivateFieldIn",(function(){return A}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function a(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function c(e,t){return function(n,r){t(n,r,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function h(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var d=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function p(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||d(t,e,n)}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function v(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function b(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof _?Promise.resolve(n.value.v).then(c,u):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function w(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:_(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var k=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&d(t,e,n);return k(t,e),t}function T(e){return e&&e.__esModule?e:{default:e}}function C(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function I(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}function A(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return f}));var r,i=n(0),o=n(1),s=n(2),a=n(12);function c(e){if(e&&e.wasConnectionCloseCalled){const t=new Error("The underlying AMQP connection is closed.");throw i.b.warning(`[${e.connectionId}] ${t.name}: ${t.message}`),Object(i.a)(t),t}}function u(e,t,n,r){if(!Object(o.b)(r)){const r=new TypeError(`${t} called without required argument "${n}"`);throw i.b.warning(`[${e}] ${r.name}: ${r.message}`),Object(i.a)(r),r}}!function(e){e["com.microsoft:out-of-order-sequence"]="SequenceOutOfOrderError",e["com.microsoft:producer-epoch-stolen"]="ProducerDisconnectedError"}(r||(r={}));const l=new Set(["ProducerDisconnectedError","SequenceOutOfOrderError"]);function h(e){const t=Object(a.e)(e);if(!Object(a.d)(t)||!Object(s.isAmqpError)(e)||t.code)return t;const n=e.condition;return n?(t.code=r[n],t.code&&(t.retryable=!l.has(t.code)),t):t}const d="These events have already been successfully published. When idempotent publishing is enabled, events that were acknowledged by the Event Hubs service may not be published again.",p="1 or more of these events have already been successfully published. When idempotent publishing is enabled, events that were acknowledged by the Event Hubs service may not be published again.";function f({enableIdempotentRetries:e,partitionId:t,partitionKey:n}){if(e&&(Object(o.b)(n)||!Object(o.b)(t)))throw new Error('The "partitionId" must be supplied and "partitionKey" must not be provided when the EventHubProducerClient has "enableIdempotentRetries" set to true.');if(Object(o.b)(t)&&Object(o.b)(n))throw new Error(`The partitionId (${t}) and partitionKey (${n}) cannot both be specified.`)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return m}));var r,i,o,s=n(2),a=n(16),c=n(17);!function(e){e[e["com.microsoft:timeout"]=408]="com.microsoft:timeout",e[e["amqp:not-found"]=404]="amqp:not-found",e[e["amqp:not-implemented"]=501]="amqp:not-implemented",e[e["com.microsoft:entity-already-exists"]=409]="com.microsoft:entity-already-exists",e[e["com.microsoft:message-lock-lost"]=410]="com.microsoft:message-lock-lost",e[e["com.microsoft:session-lock-lost"]=410]="com.microsoft:session-lock-lost",e[e["com.microsoft:no-matching-subscription"]=500]="com.microsoft:no-matching-subscription",e[e["amqp:link:message-size-exceeded"]=403]="amqp:link:message-size-exceeded",e[e["com.microsoft:server-busy"]=503]="com.microsoft:server-busy",e[e["com.microsoft:argument-error"]=400]="com.microsoft:argument-error",e[e["com.microsoft:argument-out-of-range"]=400]="com.microsoft:argument-out-of-range",e[e["com.microsoft:store-lock-lost"]=410]="com.microsoft:store-lock-lost",e[e["com.microsoft:session-cannot-be-locked"]=410]="com.microsoft:session-cannot-be-locked",e[e["com.microsoft:partition-not-owned"]=410]="com.microsoft:partition-not-owned",e[e["com.microsoft:entity-disabled"]=400]="com.microsoft:entity-disabled",e[e["com.microsoft:publisher-revoked"]=401]="com.microsoft:publisher-revoked",e[e["amqp:link:stolen"]=410]="amqp:link:stolen",e[e["amqp:not-allowed"]=400]="amqp:not-allowed",e[e["amqp:unauthorized-access"]=401]="amqp:unauthorized-access",e[e["amqp:resource-limit-exceeded"]=403]="amqp:resource-limit-exceeded"}(r||(r={})),function(e){e["com.microsoft:address-already-in-use"]="AddressAlreadyInUseError",e["com.microsoft:store-lock-lost"]="StoreLockLostError",e["com.microsoft:no-matching-subscription"]="NoMatchingSubscriptionError",e["com.microsoft:partition-not-owned"]="PartitionNotOwnedError",e["com.microsoft:publisher-revoked"]="PublisherRevokedError",e["com.microsoft:entity-already-exists"]="MessagingEntityAlreadyExistsError",e["com.microsoft:entity-disabled"]="MessagingEntityDisabledError",e["com.microsoft:message-lock-lost"]="MessageLockLostError",e["com.microsoft:session-lock-lost"]="SessionLockLostError",e["com.microsoft:session-cannot-be-locked"]="SessionCannotBeLockedError",e["amqp:internal-error"]="InternalServerError",e["amqp:not-found"]="ServiceCommunicationError",e["com.microsoft:message-not-found"]="MessageNotFoundError",e["com.microsoft:relay-not-found"]="RelayNotFoundError",e["amqp:not-implemented"]="NotImplementedError",e["amqp:not-allowed"]="InvalidOperationError",e["amqp:resource-limit-exceeded"]="QuotaExceededError",e["amqp:unauthorized-access"]="UnauthorizedError",e["com.microsoft:auth-failed"]="UnauthorizedError",e["com.microsoft:timeout"]="ServiceUnavailableError",e["com.microsoft:message-wait-timeout"]="MessageWaitTimeout",e["com.microsoft:argument-out-of-range"]="ArgumentOutOfRangeError",e["amqp:precondition-failed"]="PreconditionFailedError",e["com.microsoft:precondition-failed"]="PreconditionFailedError",e["amqp:decode-error"]="DecodeError",e["amqp:invalid-field"]="InvalidFieldError",e["amqp:resource-locked"]="ResourceLockedError",e["amqp:resource-deleted"]="ResourceDeletedError",e["amqp:illegal-state"]="IllegalStateError",e["amqp:frame-size-too-small"]="FrameSizeTooSmallError",e["amqp:link:detach-forced"]="DetachForcedError",e["amqp:link:transfer-limit-exceeded"]="TransferLimitExceededError",e["amqp:link:message-size-exceeded"]="MessageTooLargeError",e["amqp:link:redirect"]="LinkRedirectError",e["amqp:link:stolen"]="ReceiverDisconnectedError",e["amqp:session:window-violation"]="SessionWindowViolationError",e["amqp:session:errant-link"]="ErrantLinkError",e["amqp:session:handle-in-use"]="HandleInUseError",e["amqp:session:unattached-handle"]="UnattachedHandleError",e["amqp:connection:forced"]="ConnectionForcedError",e["amqp:connection:framing-error"]="FramingError",e["amqp:connection:redirect"]="ConnectionRedirectError",e["com.microsoft:server-busy"]="ServerBusyError",e["com.microsoft:argument-error"]="ArgumentError",e["com.microsoft:operation-cancelled"]="OperationCancelledError",e["client.sender:not-enough-link-credit"]="SenderBusyError",e["system:error"]="SystemError"}(i||(i={})),function(e){e.AddressAlreadyInUseError="com.microsoft:address-already-in-use",e.StoreLockLostError="com.microsoft:store-lock-lost",e.NoMatchingSubscriptionError="com.microsoft:no-matching-subscription",e.PartitionNotOwnedError="com.microsoft:partition-not-owned",e.PublisherRevokedError="com.microsoft:publisher-revoked",e.MessagingEntityAlreadyExistsError="com.microsoft:entity-already-exists",e.MessagingEntityDisabledError="com.microsoft:entity-disabled",e.MessageLockLostError="com.microsoft:message-lock-lost",e.SessionLockLostError="com.microsoft:session-lock-lost",e.SessionCannotBeLockedError="com.microsoft:session-cannot-be-locked",e.InternalServerError="amqp:internal-error",e.ServiceCommunicationError="amqp:not-found",e.MessageNotFoundError="com.microsoft:message-not-found",e.RelayNotFoundError="com.microsoft:relay-not-found",e.NotImplementedError="amqp:not-implemented",e.InvalidOperationError="amqp:not-allowed",e.QuotaExceededError="amqp:resource-limit-exceeded",e.UnauthorizedError="amqp:unauthorized-access",e.ServiceUnavailableError="com.microsoft:timeout",e.MessageWaitTimeout="com.microsoft:message-wait-timeout",e.ArgumentOutOfRangeError="com.microsoft:argument-out-of-range",e.PreconditionFailedError="amqp:precondition-failed",e.DecodeError="amqp:decode-error",e.InvalidFieldError="amqp:invalid-field",e.ResourceLockedError="amqp:resource-locked",e.ResourceDeletedError="amqp:resource-deleted",e.IllegalStateError="amqp:illegal-state",e.FrameSizeTooSmallError="amqp:frame-size-too-small",e.DetachForcedError="amqp:link:detach-forced",e.TransferLimitExceededError="amqp:link:transfer-limit-exceeded",e.MessageTooLargeError="amqp:link:message-size-exceeded",e.LinkRedirectError="amqp:link:redirect",e.ReceiverDisconnectedError="amqp:link:stolen",e.SessionWindowViolationError="amqp:session:window-violation",e.ErrantLinkError="amqp:session:errant-link",e.HandleInUseError="amqp:session:handle-in-use",e.UnattachedHandleError="amqp:session:unattached-handle",e.ConnectionForcedError="amqp:connection:forced",e.FramingError="amqp:connection:framing-error",e.ConnectionRedirectError="amqp:connection:redirect",e.ServerBusyError="com.microsoft:server-busy",e.ArgumentError="com.microsoft:argument-error",e.OperationCancelledError="com.microsoft:operation-cancelled",e.SenderBusyError="client.sender:not-enough-link-credit",e.SystemError="system:error"}(o||(o={}));const u=["address","code","errno","info","port","stack","syscall"];function l(e){return"MessagingError"===e.name}class h extends Error{constructor(e,t){if(super(e),this.name="MessagingError",this.retryable=!0,t)for(const e of u)null!=t[e]&&(this[e]=t[e])}}const d=["InternalServerError","ServerBusyError","ServiceUnavailableError","OperationCancelledError","UnauthorizedError","OperationTimeoutError","SenderBusyError","MessagingError","DetachForcedError","ConnectionForcedError","TransferLimitExceededError","InsufficientCreditError"];var p;!function(e){e.ENOTFOUND="amqp:not-found",e.EBUSY="com.microsoft:server-busy",e.ECONNREFUSED="amqp:connection:forced",e.ETIMEDOUT="com.microsoft:timeout",e.ECONNRESET="com.microsoft:timeout",e.ENETDOWN="com.microsoft:timeout",e.EHOSTDOWN="com.microsoft:timeout",e.ENETRESET="com.microsoft:timeout",e.ENETUNREACH="com.microsoft:timeout",e.ENONET="com.microsoft:timeout"}(p||(p={}));const f=["OperationTimeoutError","InsufficientCreditError","SendOperationFailedError"];function m(e){if(!Object(a.a)(e))return new Error("Unknown error encountered.");if("object"!=typeof e)return new Error(e);if(e instanceof TypeError||e instanceof RangeError)return e;if(t=e,Object(s.isAmqpError)(t)){const t=e.condition,n=e.description,r=new h(n);return e.stack&&(r.stack=e.stack),r.info=e.info,t&&(r.code=i[t]),n&&(n.includes("status-code: 404")||null!==n.match(/The messaging entity .* could not be found.*/i))&&(r.code="MessagingEntityNotFoundError"),r.code&&-1===d.indexOf(r.code)&&(r.retryable=!1),r}var t;if("MessagingError"===e.name)return e;if(function(e){return!!Object(a.b)(e,["code","syscall","errno"])&&(!(!Object(c.e)(e.code)||!Object(c.e)(e.syscall))&&!(!Object(c.e)(e.errno)&&!Object(c.d)(e.errno)))}(e)){const t=e.code,n=e.message,r=new h(n,e);let o="SystemError";if(t){const e=p[t];o=i[e]}return-1===d.indexOf(o)&&(r.retryable=!1),r}if(function(e){let t=!1;return!c.c&&self&&"error"===e.type&&e.target instanceof self.WebSocket&&(t=!0),t}(e)){const e=new h("Websocket connection failed.");return e.code=i[o.ServiceCommunicationError],e.retryable=!1,e}if(-1!==f.indexOf(e.name)){const t=new h(e.message,e);return t.code=e.name,t.code&&-1===d.indexOf(t.code)&&(t.retryable=!1),t}return e}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r=n(43);const i=new Set,o=void 0!==e&&e.env&&e.env.AZURE_LOG_LEVEL||void 0;let s;const a=Object(r.a)("azure");a.log=(...e)=>{r.a.log(...e)};const c=["verbose","info","warning","error"];o&&(f(o)?function(e){if(e&&!f(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${c.join(",")}`);s=e;const t=[];for(const e of i)p(e)&&t.push(e.namespace);r.a.enable(t.join(","))}(o):console.error(`AZURE_LOG_LEVEL set to unknown log level '${o}'; logging is not enabled. Acceptable values: ${c.join(", ")}.`));const u={verbose:400,info:300,warning:200,error:100};function l(e){const t=a.extend(e);return h(a,t),{error:d(t,"error"),warning:d(t,"warning"),info:d(t,"info"),verbose:d(t,"verbose")}}function h(e,t){t.log=(...t)=>{e.log(...t)}}function d(e,t){const n=Object.assign(e.extend(t),{level:t});if(h(e,n),p(n)){const e=r.a.disable();r.a.enable(e+","+n.namespace)}return i.add(n),n}function p(e){return!!(s&&u[e.level]<=u[s])}function f(e){return c.includes(e)}}).call(this,n(9))},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(176),i=n(6);const o=Object(r.a)({namespace:"Microsoft.EventHub",packageName:i.c.name,packageVersion:i.c.version});function s(e,t){const n={spanAttributes:{"message_bus.destination":e.entityPath,"peer.address":e.host}};return t&&(n.spanKind=t),n}},,function(e,t,n){"use strict";function r(e){return null!=e}function i(e,t){if(!r(e)||"object"!=typeof e)return!1;for(const n of t)if(!o(e,n))return!1;return!0}function o(e,t){return"object"==typeof e&&t in e}function s(e){return i(e,["isSasTokenProvider"])&&!0===e.isSasTokenProvider}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}))},function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p}));var r,i=n(51),o=n(103),s=n(5),a=n(16);const c=void 0!==e&&Boolean(e.version)&&Boolean(null===(r=e.versions)||void 0===r?void 0:r.node);function u(e){const t={},n=e.trim().split(";");for(let e of n){if(e=e.trim(),""===e)continue;const n=e.indexOf("=");if(-1===n)throw new Error("Connection string malformed: each part of the connection string must have an `=` assignment.");const r=e.substring(0,n).trim();if(""===r)throw new Error("Connection string malformed: missing key for assignment");const i=e.substring(n+1).trim();t[r]=i}return t}const l=new o.a;function h(e,t,n,r){return new Promise((o,c)=>{let u=void 0,l=void 0;const h=()=>c(new i.b(n||s.b)),d=()=>{t&&l&&t.removeEventListener("abort",l)};if(l=()=>(Object(a.a)(u)&&clearTimeout(u),d(),h()),t&&t.aborted)return h();u=setTimeout(()=>{d(),o(r)},e),t&&t.addEventListener("abort",l)})}function d(e){return"string"==typeof e}function p(e){return"number"==typeof e}}).call(this,n(9))},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));class r extends Error{}const i="AuthenticationError";class o extends Error{constructor(e,t){let n={error:"unknown",errorDescription:"An unknown error occurred and no additional details are available."};if(function(e){return e&&"string"==typeof e.error&&"string"==typeof e.error_description}(t))n=c(t);else if("string"==typeof t)try{n=c(JSON.parse(t))}catch(r){n=400===e?{error:"authority_not_found",errorDescription:"The specified authority URL was not found."}:{error:"unknown_error",errorDescription:"An unknown error has occurred. Response body:\n\n"+t}}else n={error:"unknown_error",errorDescription:"An unknown error occurred and no additional details are available."};super(`${n.error}(status code ${e}).\nMore details:\n${n.errorDescription}`),this.statusCode=e,this.errorResponse=n,this.name=i}}const s="AggregateAuthenticationError";class a extends Error{constructor(e,t){super(`${t}\n\n${e.join("\n")}`),this.errors=e,this.name=s}}function c(e){return{error:e.error,errorDescription:e.error_description,correlationId:e.correlation_id,errorCodes:e.error_codes,timestamp:e.timestamp,traceId:e.trace_id}}},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,s=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),c=r[n];n<o;c=r[++n])m(c)||!b(c)?s+=" "+c:s+=" "+a(c);return s},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,s={};function a(e,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(n)?r.showHidden=n:n&&t._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),l(r,e,r.depth)}function c(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function u(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&S(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return g(i)||(i=l(e,i,r)),i}var o=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(y(t))return e.stylize(""+t,"number");if(f(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(o)return o;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),E(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(S(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(_(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(E(n))return h(n)}var u,b="",k=!1,O=["{","}"];(p(n)&&(k=!0,O=["[","]"]),S(n))&&(b=" [Function"+(n.name?": "+n.name:"")+"]");return _(n)&&(b=" "+RegExp.prototype.toString.call(n)),w(n)&&(b=" "+Date.prototype.toUTCString.call(n)),E(n)&&(b=" "+h(n)),0!==s.length||k&&0!=n.length?r<0?_(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),u=k?function(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)I(t,String(s))?o.push(d(e,t,n,r,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(e,t,n,r,i,!0))})),o}(e,n,r,a,s):s.map((function(t){return d(e,n,r,a,t,k)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(u,b,O)):O[0]+b+O[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i,o){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),I(r,i)||(s="["+i+"]"),a||(e.seen.indexOf(c.value)<0?(a=m(n)?l(e,c.value,null):l(e,c.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),v(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function p(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function y(e){return"number"==typeof e}function g(e){return"string"==typeof e}function v(e){return void 0===e}function _(e){return b(e)&&"[object RegExp]"===k(e)}function b(e){return"object"==typeof e&&null!==e}function w(e){return b(e)&&"[object Date]"===k(e)}function E(e){return b(e)&&("[object Error]"===k(e)||e instanceof Error)}function S(e){return"function"==typeof e}function k(e){return Object.prototype.toString.call(e)}function O(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(v(o)&&(o=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=e.pid;s[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else s[n]=function(){};return s[n]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=f,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=_,t.isObject=b,t.isDate=w,t.isError=E,t.isFunction=S,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(117);var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(){var e=new Date,t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),T[e.getMonth()],t].join(" ")}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",C(),t.format.apply(t,arguments))},t.inherits=n(118),t._extend=function(e,t){if(!t||!b(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function x(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(A&&e[A]){var t;if("function"!=typeof(t=e[A]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),A&&Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=A,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return i.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(s,null,t)}),(function(t){e.nextTick(x,t,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(9))},,function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&g(e,"error",t,n)}(e,i,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,n,r){var i,o,s,a;if(u(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=l(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=d.bind(r);return i.listener=n,r.wrapFn=i,i}function f(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):y(i,i.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function g(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)o(c,this,t);else{var u=c.length,l=y(c,u);for(n=0;n<u;++n)o(l[n],this,t)}return!0},a.prototype.addListener=function(e,t){return h(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return h(this,e,t,!0)},a.prototype.once=function(e,t){return u(t),this.on(e,p(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,i,o,s;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));class r{spanContext(){return{spanId:"",traceId:"",traceFlags:0}}end(e){}setAttribute(e,t){return this}setAttributes(e){return this}addEvent(e,t){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}recordException(e,t){}}class i{startSpan(e,t){return new r}getCurrentSpan(){return new r}withSpan(e,t){return t()}bind(e,t){return e}}const o=Symbol.for("@azure/core-tracing.tracerCache4");let s,a;function c(){const e=self;e[o]||(e[o]={tracer:void 0}),s=e[o]}function u(){return s||c(),s}function l(){const e=u();return e.tracer?e.tracer:(a||(a=new i),a)}var h=n(44);const d=(p={packagePrefix:"Azure.Identity",namespace:"Microsoft.AAD"},function(e,t){const n=l(),r=(null==t?void 0:t.tracingOptions)||{},i=Object.assign({kind:h.a.INTERNAL},r.spanOptions),o=p.packagePrefix?`${p.packagePrefix}.${e}`:e,s=n.startSpan(o,i,r.tracingContext);p.namespace&&s.setAttribute("az.namespace",p.namespace);let a=r.spanOptions||{};s.isRecording()&&p.namespace&&(a=Object.assign(Object.assign({},r.spanOptions),{attributes:Object.assign(Object.assign({},i.attributes),{"az.namespace":p.namespace})}));const c=Object.assign(Object.assign({},r),{spanOptions:a,tracingContext:Object(h.d)(r.tracingContext||h.c.active(),s)});return{span:s,updatedOptions:Object.assign(Object.assign({},t),{tracingOptions:c})}});var p},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(5),i=n(1);function o(e){return!Object(i.b)(e)||"number"!=typeof e.timeoutInMs||!isFinite(e.timeoutInMs)||e.timeoutInMs<r.a.defaultOperationTimeoutInMs?r.a.defaultOperationTimeoutInMs:e.timeoutInMs}},function(e,t,n){"use strict";function r(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function i(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return g}));var o=n(7),s=n(42);class a{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,n){const r=(e,r)=>{throw new Error(`"${n}" with value "${t}" should satisfy the constraint "${e}": ${r}.`)};if(e.constraints&&null!=t){const{ExclusiveMaximum:n,ExclusiveMinimum:i,InclusiveMaximum:o,InclusiveMinimum:s,MaxItems:a,MaxLength:c,MinItems:u,MinLength:l,MultipleOf:h,Pattern:d,UniqueItems:p}=e.constraints;if(void 0!==n&&t>=n&&r("ExclusiveMaximum",n),void 0!==i&&t<=i&&r("ExclusiveMinimum",i),void 0!==o&&t>o&&r("InclusiveMaximum",o),void 0!==s&&t<s&&r("InclusiveMinimum",s),void 0!==a&&t.length>a&&r("MaxItems",a),void 0!==c&&t.length>c&&r("MaxLength",c),void 0!==u&&t.length<u&&r("MinItems",u),void 0!==l&&t.length<l&&r("MinLength",l),void 0!==h&&t%h!=0&&r("MultipleOf",h),d){const e="string"==typeof d?new RegExp(d):d;"string"==typeof t&&null!==t.match(e)||r("Pattern",d)}p&&t.some((e,t,n)=>n.indexOf(e)!==t)&&r("UniqueItems",p)}}serialize(e,t,n,i={xml:{}}){var a,c,p;const y={xml:{rootName:null!==(a=i.xml.rootName)&&void 0!==a?a:"",includeRoot:null!==(c=i.xml.includeRoot)&&void 0!==c&&c,xmlCharKey:null!==(p=i.xml.xmlCharKey)&&void 0!==p?p:o.b}};let g={};const v=e.type.name;n||(n=e.serializedName),null!==v.match(/^Sequence$/i)&&(g=[]),e.isConstant&&(t=e.defaultValue);const{required:_,nullable:b}=e;if(_&&b&&void 0===t)throw new Error(n+" cannot be undefined.");if(_&&!b&&null==t)throw new Error(n+" cannot be null or undefined.");if(!_&&!1===b&&null===t)throw new Error(n+" cannot be null.");if(null==t)g=t;else if(this.validateConstraints(e,t,n),null!==v.match(/^any$/i))g=t;else if(null!==v.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i))g=function(e,t,n){if(null!=n)if(null!==e.match(/^Number$/i)){if("number"!=typeof n)throw new Error(`${t} with value ${n} must be of type number.`)}else if(null!==e.match(/^String$/i)){if("string"!=typeof n.valueOf())throw new Error(`${t} with value "${n}" must be of type string.`)}else if(null!==e.match(/^Uuid$/i)){if("string"!=typeof n.valueOf()||!Object(s.c)(n))throw new Error(`${t} with value "${n}" must be of type string and a valid uuid.`)}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof n)throw new Error(`${t} with value ${n} must be of type boolean.`)}else if(null!==e.match(/^Stream$/i)){if(!("string"===typeof n||"function"==typeof n.pipe||n instanceof ArrayBuffer||ArrayBuffer.isView(n)||("function"==typeof Blob||"object"==typeof Blob)&&n instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or NodeJS.ReadableStream.")}return n}(v,n,t);else if(null!==v.match(/^Enum$/i)){g=function(e,t,n){if(!t)throw new Error(`Please provide a set of allowedValues to validate ${e} as an Enum Type.`);if(!t.some(e=>"string"==typeof e.valueOf()?e.toLowerCase()===n.toLowerCase():e===n))throw new Error(`${n} is not a valid value for ${e}. The valid values are: ${JSON.stringify(t)}.`);return n}(n,e.type.allowedValues,t)}else null!==v.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?g=function(e,t,n){if(null!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=function(e){if(!e)return;"string"==typeof e.valueOf()&&(e=new Date(e));return Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!Object(s.b)(t))throw new Error(`${n} must be a string in ISO 8601 format. Instead was "${t}".`);return t}(v,t,n):null!==v.match(/^ByteArray$/i)?g=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=r(t)}return t}(n,t):null!==v.match(/^Base64Url$/i)?g=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=function(e){if(!e)return;if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){let n=e.length;for(;n-1>=0&&e[n-1]===t;)--n;return e.substr(0,n)}(r(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}(t)}return t}(n,t):null!==v.match(/^Sequence$/i)?g=function(e,t,n,r,i,s){var a;if(!Array.isArray(n))throw new Error(r+" must be of type Array.");let c=t.type.element;if(!c||"object"!=typeof c)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}.`);"Composite"===c.type.name&&c.type.className&&(c=null!==(a=e.modelMappers[c.type.className])&&void 0!==a?a:c);const u=[];for(let t=0;t<n.length;t++){const a=e.serialize(c,n[t],r,s);if(i&&c.xmlNamespace){const e=c.xmlNamespacePrefix?"xmlns:"+c.xmlNamespacePrefix:"xmlns";"Composite"===c.type.name?(u[t]=Object.assign({},a),u[t][o.a]={[e]:c.xmlNamespace}):(u[t]={},u[t][s.xml.xmlCharKey]=a,u[t][o.a]={[e]:c.xmlNamespace})}else u[t]=a}return u}(this,e,t,n,Boolean(this.isXML),y):null!==v.match(/^Dictionary$/i)?g=function(e,t,n,r,i,s){if("object"!=typeof n)throw new Error(r+" must be of type object.");const a=t.type.value;if(!a||"object"!=typeof a)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}.`);const c={};for(const t of Object.keys(n)){const o=e.serialize(a,n[t],r,s);c[t]=d(a,o,i,s)}if(i&&t.xmlNamespace){const e=t.xmlNamespacePrefix?"xmlns:"+t.xmlNamespacePrefix:"xmlns",n=c;return n[o.a]={[e]:t.xmlNamespace},n}return c}(this,e,t,n,Boolean(this.isXML),y):null!==v.match(/^Composite$/i)&&(g=function(e,t,n,r,i,s){m(e,t)&&(t=f(e,t,n,"clientName"));if(null!=n){const a={},c=h(e,t,r);for(const l of Object.keys(c)){const h=c[l];if(h.readOnly)continue;let p,f=a;if(e.isXML)p=h.xmlIsWrapped?h.xmlName:h.xmlElementName||h.xmlName;else{const e=u(h.serializedName);p=e.pop();for(const t of e){const e=f[t];null==e&&(void 0!==n[l]&&null!==n[l]||void 0!==h.defaultValue)&&(f[t]={}),f=f[t]}}if(null!=f){if(i&&t.xmlNamespace){const e=t.xmlNamespacePrefix?"xmlns:"+t.xmlNamespacePrefix:"xmlns";f[o.a]=Object.assign(Object.assign({},f[o.a]),{[e]:t.xmlNamespace})}const a=""!==h.serializedName?r+"."+h.serializedName:r;let c=n[l];const u=m(e,t);u&&u.clientName===l&&null==c&&(c=t.serializedName);const y=e.serialize(h,c,a,s);if(void 0!==y&&null!=p){const e=d(h,y,i,s);i&&h.xmlIsAttribute?(f[o.a]=f[o.a]||{},f[o.a][p]=y):i&&h.xmlIsWrapped?f[p]={[h.xmlElementName]:e}:f[p]=e}}}const p=function(e,t,n){const r=t.type.additionalProperties;if(!r&&t.type.className){const r=l(e,t,n);return null==r?void 0:r.type.additionalProperties}return r}(e,t,r);if(p){const t=Object.keys(c);for(const i in n){t.every(e=>e!==i)&&(a[i]=e.serialize(p,n[i],r+'["'+i+'"]',s))}}return a}return n}(this,e,t,n,Boolean(this.isXML),y));return g}deserialize(e,t,n,r={xml:{}}){var s,a,c;const l={xml:{rootName:null!==(s=r.xml.rootName)&&void 0!==s?s:"",includeRoot:null!==(a=r.xml.includeRoot)&&void 0!==a&&a,xmlCharKey:null!==(c=r.xml.xmlCharKey)&&void 0!==c?c:o.b}};if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;let d;const y=e.type.name;if(n||(n=e.serializedName),null!==y.match(/^Composite$/i))d=function(e,t,n,r,i){var s;m(e,t)&&(t=f(e,t,n,"serializedName"));const a=h(e,t,r);let c={};const l=[];for(const h of Object.keys(a)){const d=a[h],p=u(a[h].serializedName);l.push(p[0]);const{serializedName:f,xmlName:m,xmlElementName:y}=d;let g=r;""!==f&&void 0!==f&&(g=r+"."+f);const v=d.headerCollectionPrefix;if(v){const t={};for(const r of Object.keys(n))r.startsWith(v)&&(t[r.substring(v.length)]=e.deserialize(d.type.value,n[r],g,i)),l.push(r);c[h]=t}else if(e.isXML)if(d.xmlIsAttribute&&n[o.a])c[h]=e.deserialize(d,n[o.a][m],g,i);else{const t=y||m||f;if(d.xmlIsWrapped){const t=n[m],r=null!==(s=null==t?void 0:t[y])&&void 0!==s?s:[];c[h]=e.deserialize(d,r,g,i)}else{const r=n[t];c[h]=e.deserialize(d,r,g,i)}}else{let r,o=n;for(const e of p){if(!o)break;o=o[e]}r=o;const s=t.type.polymorphicDiscriminator;let u;if(s&&h===s.clientName&&null==r&&(r=t.serializedName),Array.isArray(n[h])&&""===a[h].serializedName){r=n[h];const t=e.deserialize(d,r,g,i);for(const[e,n]of Object.entries(c))Object.prototype.hasOwnProperty.call(t,e)||(t[e]=n);c=t}else void 0===r&&void 0===d.defaultValue||(u=e.deserialize(d,r,g,i),c[h]=u)}}const d=t.type.additionalProperties;if(d){const t=e=>{for(const t in a){if(u(a[t].serializedName)[0]===e)return!1}return!0};for(const o in n)t(o)&&(c[o]=e.deserialize(d,n[o],r+'["'+o+'"]',i))}else if(n)for(const e of Object.keys(n))void 0!==c[e]||l.includes(e)||p(e,i)||(c[e]=n[e]);return c}(this,e,t,n,l);else{if(this.isXML){const e=l.xml.xmlCharKey;void 0!==t[o.a]&&void 0!==t[e]&&(t=t[e])}null!==y.match(/^Number$/i)?(d=parseFloat(t),isNaN(d)&&(d=t)):null!==y.match(/^Boolean$/i)?d="true"===t||"false"!==t&&t:null!==y.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?d=t:null!==y.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?d=new Date(t):null!==y.match(/^UnixTime$/i)?d=function(e){if(!e)return;return new Date(1e3*e)}(t):null!==y.match(/^ByteArray$/i)?d=i(t):null!==y.match(/^Base64Url$/i)?d=function(e){if(!e)return;if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return i(e=e.replace(/-/g,"+").replace(/_/g,"/"))}(t):null!==y.match(/^Sequence$/i)?d=function(e,t,n,r,i){var o;let s=t.type.element;if(!s||"object"!=typeof s)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+r);if(n){Array.isArray(n)||(n=[n]),"Composite"===s.type.name&&s.type.className&&(s=null!==(o=e.modelMappers[s.type.className])&&void 0!==o?o:s);const t=[];for(let o=0;o<n.length;o++)t[o]=e.deserialize(s,n[o],`${r}[${o}]`,i);return t}return n}(this,e,t,n,l):null!==y.match(/^Dictionary$/i)&&(d=function(e,t,n,r,i){const o=t.type.value;if(!o||"object"!=typeof o)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+r);if(n){const t={};for(const s of Object.keys(n))t[s]=e.deserialize(o,n[s],r,i);return t}return n}(this,e,t,n,l))}return e.isConstant&&(d=e.defaultValue),d}}function c(e={},t=!1){return new a(e,t)}function u(e){const t=[];let n="";if(e){const r=e.split(".");for(const e of r)"\\"===e.charAt(e.length-1)?n+=e.substr(0,e.length-1)+".":(n+=e,t.push(n),n="")}return t}function l(e,t,n){const r=t.type.className;if(!r)throw new Error(`Class name for model "${n}" is not provided in the mapper "${JSON.stringify(t,void 0,2)}".`);return e.modelMappers[r]}function h(e,t,n){let r=t.type.modelProperties;if(!r){const i=l(e,t,n);if(!i)throw new Error(`mapper() cannot be null or undefined for model "${t.type.className}".`);if(r=null==i?void 0:i.type.modelProperties,!r)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(i)}" of type "${t.type.className}" for object "${n}".`)}return r}function d(e,t,n,r){if(!n||!e.xmlNamespace)return t;const i={[e.xmlNamespacePrefix?"xmlns:"+e.xmlNamespacePrefix:"xmlns"]:e.xmlNamespace};if(["Composite"].includes(e.type.name)){if(t[o.a])return t;{const e=Object.assign({},t);return e[o.a]=i,e}}const s={};return s[r.xml.xmlCharKey]=t,s[o.a]=i,s}function p(e,t){return[o.a,t.xml.xmlCharKey].includes(e)}function f(e,t,n,r){const i=m(e,t);if(i){let o=i[r];if(o){"serializedName"===r&&(o=o.replace(/\\/gi,""));const i=n[o];if(null!=i){const n=t.type.uberParent||t.type.className,r=i===n?i:n+"."+i,o=e.modelMappers.discriminators[r];o&&(t=o)}}}return t}function m(e,t){return t.type.polymorphicDiscriminator||y(e,t.type.uberParent)||y(e,t.type.className)}function y(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}const g={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));const r="04b07795-8ddb-461a-bbee-02f9e1bf7b46",i="common";var o;!function(e){e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureGovernment="https://login.microsoftonline.us",e.AzurePublicCloud="https://login.microsoftonline.com"}(o||(o={}));const s=o.AzurePublicCloud},,function(e,t,n){"use strict";(function(t){var r=n(114),i=n(34),o=n(82),s=n(33),a=n(126),c=n(85),u=n(86),l=n(21).EventEmitter,h=function(e){this.options=e?Object.create(e):{},this.options.id||(this.options.id=s.generate_uuid()),this.id=this.options.id,this.sasl_server_mechanisms=o.server_mechanisms()};(h.prototype=Object.create(l.prototype)).constructor=h,h.prototype.dispatch=function(e){return i.events("[%s] Container got event: "+e,this.id),l.prototype.emit.apply(this,arguments),!!this.listeners(e).length},h.prototype.connect=function(e){return new r(e,this).connect()},h.prototype.create_connection=function(e){return new r(e,this)},h.prototype.listen=function(e){var n,i=this;if(void 0===e.transport||"tcp"===e.transport)(n=c.createServer()).on("connection",(function(t){new r(e,i).accept(t)}));else{if("tls"!==e.transport&&"ssl"!==e.transport)throw Error("Unrecognised transport: "+e.transport);(n=u.createServer(e)).on("secureConnection",(function(t){new r(e,i).accept(t)}))}return t.version.match(/v0\.10\.\d+/)?n.listen(e.port,e.host):n.listen(e),n},h.prototype.create_container=function(e){return new h(e)},h.prototype.get_option=function(e,t){return void 0!==this.options[e]?this.options[e]:t},h.prototype.generate_uuid=s.generate_uuid,h.prototype.string_to_uuid=s.string_to_uuid,h.prototype.uuid_to_string=s.uuid_to_string;var d=n(127);h.prototype.websocket_accept=function(e,t){new r(t,this).accept(d.wrap(e))},h.prototype.websocket_connect=d.connect,h.prototype.filter=n(128),h.prototype.types=n(32),h.prototype.message=n(61),h.prototype.sasl=o,h.prototype.ReceiverEvents=a.ReceiverEvents,h.prototype.SenderEvents=a.SenderEvents,h.prototype.SessionEvents=a.SessionEvents,h.prototype.ConnectionEvents=a.ConnectionEvents,e.exports=new h}).call(this,n(9))},function(e,t,n){"use strict";var r=n(54),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=h;var o=Object.create(n(50));o.inherits=n(37);var s=n(94),a=n(73);o.inherits(h,s);for(var c=i(a.prototype),u=0;u<c.length;u++){var l=c[u];h.prototype[l]||(h.prototype[l]=a.prototype[l])}function h(e){if(!(this instanceof h))return new h(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||r.nextTick(p,this)}function p(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},function(e,t,n){"use strict";function r(e){return e.toLowerCase()}n.d(t,"a",(function(){return o}));class i{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(r(e),{name:e,value:String(t)})}get(e){var t;return null===(t=this._headersMap.get(r(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(r(e))}delete(e){this._headersMap.delete(r(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const e of this._headersMap.values())t[e.name]=e.value;else for(const[e,n]of this._headersMap)t[e]=n.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function o(e){return new i(e)}},function(e,t,n){"use strict";var r=n(19);function i(e){Error.call(this),this.message=e,this.name="ProtocolError"}function o(e){i.call(this,e),this.message=e,this.name="TypeError"}function s(e,t,n){Error.call(this,e),this.message=e,this.name="ConnectionError",this.condition=t,this.description=e,Object.defineProperty(this,"connection",{value:n})}r.inherits(i,Error),r.inherits(o,i),r.inherits(s,Error),s.prototype.toJSON=function(){return{type:this.name,code:this.condition,message:this.description}},e.exports={ProtocolError:i,TypeError:o,ConnectionError:s}},function(e,t,n){"use strict";(function(t){var r=n(31),i=n(33);function o(e,t,n,r){this.type=e,this.value=t,n&&(this.array_constructor={typecode:n},r&&(this.array_constructor.descriptor=r))}function s(e,t,n,r){this.name=e,this.typecode=t;var i=t>>>4;switch(i){case 4:this.width=0,this.category=1;break;case 5:this.width=1,this.category=1;break;case 6:this.width=2,this.category=1;break;case 7:this.width=4,this.category=1;break;case 8:this.width=8,this.category=1;break;case 9:this.width=16,this.category=1;break;case 10:this.width=1,this.category=2;break;case 11:this.width=4,this.category=2;break;case 12:this.width=1,this.category=3;break;case 13:this.width=4,this.category=3;break;case 14:this.width=1,this.category=4;break;case 15:this.width=4,this.category=4}n&&(n.read&&(this.read=n.read),n.write&&(this.write=n.write),n.encoding&&(this.encoding=n.encoding));var s=this;this.create=4===i?function(){return new o(s,r)}:14===i||15===i?function(e,t,n){return new o(s,e,t,n)}:function(e){return new o(s,e)}}function a(e){return Number(e).toString(16)}o.prototype.toString=function(){return this.value?this.value.toString():null},o.prototype.toLocaleString=function(){return this.value?this.value.toLocaleString():null},o.prototype.valueOf=function(){return this.value},o.prototype.toJSON=function(){return this.value&&this.value.toJSON?this.value.toJSON():this.value},o.prototype.toRheaTyped=function(){return this},s.prototype.toString=function(){return this.name+"#"+a(this.typecode)};var c={by_code:{}};function u(e,t,n,r){var i=new s(e,t,n,r);i.create.typecode=i.typecode,c.by_code[i.typecode]=i,c[e]=i.create}Object.defineProperty(c,"MAX_UINT",{value:4294967295,writable:!1,configurable:!1}),Object.defineProperty(c,"MAX_USHORT",{value:65535,writable:!1,configurable:!1});function l(e,t,n){if("number"==typeof t||t instanceof Number){var r=Math.abs(t),i=Math.floor(r/4294967296),o=r%4294967296;if(e.writeInt32BE(i,n),e.writeUInt32BE(o,n+4),t<0)for(var s=1,a=0;a<8;a++){var c=n+(7-a),u=(255^e[c])+s;e[c]=255&u,s=u>>8}}else t.copy(e,n)}function h(e,t){var n=e.readInt32BE(t),r=e.readUInt32BE(t+4);return n<2097153&&n>-2097153?4294967296*n+r:e.slice(t,t+8)}function d(e,t){for(var n=0;n<t.length;n++)if(e.type.typecode===t[n].typecode)return!0;return!1}function p(e,t,n){for(var r=0;r<t&&r<e.length;r++)if(e[r]!==(n?255:0))return!1;return!0}function f(e){for(var t={},n=0;n+1<e.length;)t[e[n++]]=e[n++];return t}u("Null",64,void 0,null),u("Boolean",86,{read:function(e,t){return e.readUInt8(t)},write:function(e,t,n){e.writeUInt8(t,n)}}),u("True",65,void 0,!0),u("False",66,void 0,!1),u("Ubyte",80,{read:function(e,t){return e.readUInt8(t)},write:function(e,t,n){e.writeUInt8(t,n)}}),u("Ushort",96,{read:function(e,t){return e.readUInt16BE(t)},write:function(e,t,n){e.writeUInt16BE(t,n)}}),u("Uint",112,{read:function(e,t){return e.readUInt32BE(t)},write:function(e,t,n){e.writeUInt32BE(t,n)}}),u("SmallUint",82,{read:function(e,t){return e.readUInt8(t)},write:function(e,t,n){e.writeUInt8(t,n)}}),u("Uint0",67,void 0,0),u("Ulong",128,{write:function(e,t,n){if("number"==typeof t||t instanceof Number){var r=Math.floor(t/4294967296),i=t%4294967296;e.writeUInt32BE(r,n),e.writeUInt32BE(i,n+4)}else t.copy(e,n)},read:function(e,t){var n=e.readUInt32BE(t),r=e.readUInt32BE(t+4);return n<2097153?4294967296*n+r:e.slice(t,t+8)}}),u("SmallUlong",83,{read:function(e,t){return e.readUInt8(t)},write:function(e,t,n){e.writeUInt8(t,n)}}),u("Ulong0",68,void 0,0),u("Byte",81,{read:function(e,t){return e.readInt8(t)},write:function(e,t,n){e.writeInt8(t,n)}}),u("Short",97,{read:function(e,t){return e.readInt16BE(t)},write:function(e,t,n){e.writeInt16BE(t,n)}}),u("Int",113,{read:function(e,t){return e.readInt32BE(t)},write:function(e,t,n){e.writeInt32BE(t,n)}}),u("SmallInt",84,{read:function(e,t){return e.readInt8(t)},write:function(e,t,n){e.writeInt8(t,n)}}),u("Long",129,{write:l,read:h}),u("SmallLong",85,{read:function(e,t){return e.readInt8(t)},write:function(e,t,n){e.writeInt8(t,n)}}),u("Float",114,{read:function(e,t){return e.readFloatBE(t)},write:function(e,t,n){e.writeFloatBE(t,n)}}),u("Double",130,{read:function(e,t){return e.readDoubleBE(t)},write:function(e,t,n){e.writeDoubleBE(t,n)}}),u("Decimal32",116),u("Decimal64",132),u("Decimal128",148),u("CharUTF32",115,{read:function(e,t){return e.readUInt32BE(t)},write:function(e,t,n){e.writeUInt32BE(t,n)}}),u("Timestamp",131,{write:function(e,t,n){return"object"==typeof t&&null!==t&&"function"==typeof t.getTime&&(t=t.getTime()),l(e,t,n)},read:function(e,t){const n=h(e,t);return new Date(n)}}),u("Uuid",152),u("Vbin8",160),u("Vbin32",176),u("Str8",161,{encoding:"utf8"}),u("Str32",177,{encoding:"utf8"}),u("Sym8",163,{encoding:"ascii"}),u("Sym32",179,{encoding:"ascii"}),u("List0",69,void 0,[]),u("List8",192),u("List32",208),u("Map8",193),u("Map32",209),u("Array8",224),u("Array32",240),c.is_ulong=function(e){return d(e,[c.Ulong,c.Ulong0,c.SmallUlong])},c.is_string=function(e){return d(e,[c.Str8,c.Str32])},c.is_symbol=function(e){return d(e,[c.Sym8,c.Sym32])},c.is_list=function(e){return d(e,[c.List0,c.List8,c.List32])},c.is_map=function(e){return d(e,[c.Map8,c.Map32])},c.wrap_boolean=function(e){return e?c.True():c.False()},c.wrap_ulong=function(e){return t.isBuffer(e)?p(e,8,!1)?c.Ulong0():p(e,7,!1)?c.SmallUlong(e[7]):c.Ulong(e):0===e?c.Ulong0():e>255?c.Ulong(e):c.SmallUlong(e)},c.wrap_uint=function(e){return 0===e?c.Uint0():e>255?c.Uint(e):c.SmallUint(e)},c.wrap_ushort=function(e){return c.Ushort(e)},c.wrap_ubyte=function(e){return c.Ubyte(e)},c.wrap_long=function(e){if(t.isBuffer(e)){var n=0!=(128&e[0]);return p(e,7,n)&&(128&e[7])==(n?128:0)?c.SmallLong(n?-(1+(255^e[7])):e[7]):c.Long(e)}return e>127||e<-128?c.Long(e):c.SmallLong(e)},c.wrap_int=function(e){return e>127||e<-128?c.Int(e):c.SmallInt(e)},c.wrap_short=function(e){return c.Short(e)},c.wrap_byte=function(e){return c.Byte(e)},c.wrap_float=function(e){return c.Float(e)},c.wrap_double=function(e){return c.Double(e)},c.wrap_timestamp=function(e){return c.Timestamp(e)},c.wrap_char=function(e){return c.CharUTF32(e)},c.wrap_uuid=function(e){return c.Uuid(e)},c.wrap_binary=function(e){return e.length>255?c.Vbin32(e):c.Vbin8(e)},c.wrap_string=function(e){return t.byteLength(e)>255?c.Str32(e):c.Str8(e)},c.wrap_symbol=function(e){return t.byteLength(e)>255?c.Sym32(e):c.Sym8(e)},c.wrap_list=function(e){if(0===e.length)return c.List0();var t=e.map(c.wrap);return c.List32(t)},c.wrap_set_as_list=function(e){if(0===e.size)return c.List0();var t=Array.from(e,c.wrap);return c.List32(t)},c.wrap_map=function(e,t){var n=[];for(var r in e)n.push(t?t(r):c.wrap(r)),n.push(c.wrap(e[r]));return c.Map32(n)},c.wrap_map_as_map=function(e){var t=[];for(var[n,r]of e)t.push(c.wrap(n)),t.push(c.wrap(r));return c.Map32(t)},c.wrap_symbolic_map=function(e){return c.wrap_map(e,c.wrap_symbol)},c.wrap_array=function(e,t,n){if(t)return c.Array32(e,t,n);throw console.trace("An array must specify a type for its elements"),new r.TypeError("An array must specify a type for its elements")},c.wrap=function(e){var n=typeof e;return"object"===n&&null!==e&&"function"==typeof e.toRheaTyped?e.toRheaTyped():"string"===n?c.wrap_string(e):"boolean"===n?e?c.True():c.False():"number"===n||e instanceof Number?isNaN(e)?c.Null():Math.floor(e)-e!=0?c.Double(e):e>0?e<4294967296?c.wrap_uint(e):c.wrap_ulong(e):e>-2147483647?c.wrap_int(e):c.wrap_long(e):e instanceof Date?c.wrap_timestamp(e.getTime()):e instanceof t||e instanceof Uint8Array?c.wrap_binary(e):"undefined"===n||null===e?c.Null():Array.isArray(e)?c.wrap_list(e):e instanceof Map?c.wrap_map_as_map(e):e instanceof Set?c.wrap_set_as_list(e):c.wrap_map(e)},c.wrap_described=function(e,t){var n=c.wrap(e);return t&&("string"==typeof t?n=c.described(c.wrap_symbol(t),n):("number"==typeof t||t instanceof Number)&&(n=c.described(c.wrap_ulong(t),n))),n},c.wrap_message_id=function(e){var n=typeof e;if("string"===n)return c.wrap_string(e);if("number"===n||e instanceof Number)return c.wrap_ulong(e);if(t.isBuffer(e))return c.wrap_uuid(e);throw new r.TypeError("invalid message id:"+e)};var m,y,g={};function v(e){var t=c.by_code[e];if(!t)throw new r.TypeError("Unrecognised typecode: "+a(e));return t}function _(e,t){if(null!=t){if(Array.isArray(t)){if(!e.multiple)throw new r.TypeError("Field "+e.name+" does not support multiple values, got "+JSON.stringify(t));var n=function(e){if("symbol"===e)return{typecode:c.Sym8.typecode};throw new r.TypeError("TODO: Array of type "+e+" not yet supported")}(e.type);return c.wrap_array(t,n.typecode,n.descriptor)}if("*"===e.type)return t;var i=c["wrap_"+e.type];if(i)return i(t);throw new r.TypeError("No wrapper for field "+e.name+" of type "+e.type)}if(e.mandatory)throw new r.TypeError("Field "+e.name+" is mandatory");return c.Null()}function b(e,t){return{get:"*"===t.type?function(){return this.value[e]}:function(){return c.unwrap(this.value[e])},set:function(n){this.value[e]=_(t,n)},enumerable:!0,configurable:!1}}c.unwrap_map_simple=function(e){return f(e.value.map((function(e){return c.unwrap(e,!0)})))},c.unwrap=function(e,t){if(e instanceof o){if(e.descriptor){var n=g[e.descriptor.value];if(n)return new n(e.value);if(t)return e}var r=c.unwrap(e.value,!0);return c.is_map(e)?f(r):r}return Array.isArray(e)?e.map((function(e){return c.unwrap(e,!0)})):e},c.described_nc=function(e,t){return e.length?(t.descriptor=e.shift(),c.described(e,t)):(t.descriptor=e,t)},c.described=c.described_nc,c.Reader=function(e){this.buffer=e,this.position=0},c.Reader.prototype.read_typecode=function(){return this.read_uint(1)},c.Reader.prototype.read_uint=function(e){var t=this.position;if(this.position+=e,1===e)return this.buffer.readUInt8(t);if(2===e)return this.buffer.readUInt16BE(t);if(4===e)return this.buffer.readUInt32BE(t);throw new r.TypeError("Unexpected width for uint "+e)},c.Reader.prototype.read_fixed_width=function(e){var t=this.position;return this.position+=e.width,e.read?e.read(this.buffer,t):this.buffer.slice(t,this.position)},c.Reader.prototype.read_variable_width=function(e){var t=this.read_uint(e.width),n=this.read_bytes(t);return e.encoding?n.toString(e.encoding):n},c.Reader.prototype.read=function(){var e=this.read_constructor(),t=this.read_value(v(e.typecode));return e.descriptor?c.described_nc(e.descriptor,t):t},c.Reader.prototype.read_constructor=function(e){var t=this.read_typecode();return 0===t?(void 0===e&&(e=[]),e.push(this.read()),this.read_constructor(e)):void 0===e?{typecode:t}:1===e.length?{typecode:t,descriptor:e[0]}:{typecode:t,descriptor:e[0],descriptors:e}},c.Reader.prototype.read_value=function(e){if(0===e.width)return e.create();if(1===e.category)return e.create(this.read_fixed_width(e));if(2===e.category)return e.create(this.read_variable_width(e));if(3===e.category)return this.read_compound(e);if(4===e.category)return this.read_array(e);throw new r.TypeError("Invalid category for type: "+e)},c.Reader.prototype.read_array_items=function(e,t){for(var n=[];n.length<e;)n.push(this.read_value(t));return n},c.Reader.prototype.read_n=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.read();return t},c.Reader.prototype.read_size_count=function(e){return{size:this.read_uint(e),count:this.read_uint(e)}},c.Reader.prototype.read_compound=function(e){var t=this.read_size_count(e.width);return e.create(this.read_n(t.count))},c.Reader.prototype.read_array=function(e){var t=this.read_size_count(e.width),n=this.read_constructor();return e.create(this.read_array_items(t.count,v(n.typecode)),n.typecode,n.descriptor)},c.Reader.prototype.toString=function(){var e="buffer@"+this.position;this.position&&(e+=": ");for(var t=this.position;t<this.buffer.length;t++)t>0&&(e+=","),e+="0x"+Number(this.buffer[t]).toString(16);return e},c.Reader.prototype.reset=function(){this.position=0},c.Reader.prototype.skip=function(e){this.position+=e},c.Reader.prototype.read_bytes=function(e){var t=this.position;return this.position+=e,this.buffer.slice(t,this.position)},c.Reader.prototype.remaining=function(){return this.buffer.length-this.position},c.Writer=function(e){this.buffer=e||i.allocate_buffer(1024),this.position=0},c.Writer.prototype.toBuffer=function(){return this.buffer.slice(0,this.position)},c.Writer.prototype.ensure=function(e){if(this.buffer.length<e){var t=i.allocate_buffer((n=2*this.buffer.length)>(r=e)?n:r);this.buffer.copy(t),this.buffer=t}var n,r},c.Writer.prototype.write_typecode=function(e){this.write_uint(e,1)},c.Writer.prototype.write_uint=function(e,t){var n=this.position;if(this.ensure(this.position+t),this.position+=t,1===t)return this.buffer.writeUInt8(e,n);if(2===t)return this.buffer.writeUInt16BE(e,n);if(4===t)return this.buffer.writeUInt32BE(e,n);throw new r.TypeError("Unexpected width for uint "+t)},c.Writer.prototype.write_fixed_width=function(e,t){var n=this.position;if(this.ensure(this.position+e.width),this.position+=e.width,e.write)e.write(this.buffer,t,n);else{if(!t.copy)throw new r.TypeError("Cannot handle write for "+e);t.copy(this.buffer,n)}},c.Writer.prototype.write_variable_width=function(e,n){var r=e.encoding?t.from(n,e.encoding):t.from(n);this.write_uint(r.length,e.width),this.write_bytes(r)},c.Writer.prototype.write_bytes=function(e){var t=this.position;this.ensure(this.position+e.length),this.position+=e.length,e.copy(this.buffer,t)},c.Writer.prototype.write_constructor=function(e,t){t&&(this.write_typecode(0),this.write(t)),this.write_typecode(e)},c.Writer.prototype.write=function(e){if(void 0===e.type){if(!e.described)throw new r.TypeError("Cannot write "+JSON.stringify(e));this.write(e.described())}else this.write_constructor(e.type.typecode,e.descriptor),this.write_value(e.type,e.value,e.array_constructor)},c.Writer.prototype.write_value=function(e,t,n){if(0!==e.width)if(1===e.category)this.write_fixed_width(e,t);else if(2===e.category)this.write_variable_width(e,t);else if(3===e.category)this.write_compound(e,t);else{if(4!==e.category)throw new r.TypeError("Invalid category "+e.category+" for type: "+e);this.write_array(e,t,n)}},c.Writer.prototype.backfill_size=function(e,t){var n=this.position-t;this.position=t,this.write_uint(n-e,e),this.position+=n-e},c.Writer.prototype.write_compound=function(e,t){var n=this.position;this.position+=e.width,this.write_uint(t.length,e.width);for(var r=0;r<t.length;r++)void 0===t[r]||null===t[r]?this.write(c.Null()):this.write(t[r]);this.backfill_size(e.width,n)},c.Writer.prototype.write_array=function(e,t,n){var r=this.position;this.position+=e.width,this.write_uint(t.length,e.width),this.write_constructor(n.typecode,n.descriptor);for(var i=v(n.typecode),o=0;o<t.length;o++)this.write_value(i,t[o]);this.backfill_size(e.width,r)},c.Writer.prototype.toString=function(){var e="buffer@"+this.position;this.position&&(e+=": ");for(var t=0;t<this.position;t++)t>0&&(e+=","),e+=("00"+Number(this.buffer[t]).toString(16)).slice(-2);return e},c.Writer.prototype.skip=function(e){this.ensure(this.position+e),this.position+=e},c.Writer.prototype.clear=function(){this.buffer.fill(0),this.position=0},c.Writer.prototype.remaining=function(){return this.buffer.length-this.position},c.define_composite=function(e){var t=function(e){this.value=e||[]};t.descriptor={numeric:e.code,symbolic:"amqp:"+e.name+":list"},t.prototype.dispatch=function(t,n){t["on_"+e.name](n)};for(var n=0;n<e.fields.length;n++){var r=e.fields[n];Object.defineProperty(t.prototype,r.name,b(n,r))}return t.toString=function(){return e.name+"#"+Number(e.code).toString(16)},t.prototype.toJSON=function(){var e={};for(var t in this)"value"!==t&&this[t]&&(e[t]=this[t]);return e},t.create=function(e){var n=new t;for(var r in e)n[r]=e[r];return n},t.prototype.described=function(){return c.described_nc(c.wrap_ulong(t.descriptor.numeric),c.wrap_list(this.value))},t},m={name:"error",code:29,fields:[{name:"condition",type:"symbol",mandatory:!0},{name:"description",type:"string"},{name:"info",type:"map"}]},y=c.define_composite(m),c["wrap_"+m.name]=function(e){return y.create(e).described()},g[Number(y.descriptor.numeric).toString(10)]=y,g[y.descriptor.symbolic]=y,e.exports=c}).call(this,n(8).Buffer)},function(e,t,n){"use strict";(function(t){var r=n(31),i={allocate_buffer:function(e){return t.alloc?t.alloc(e):new t(e)},generate_uuid:function(){return i.uuid_to_string(i.uuid4())},uuid4:function(){for(var e=i.allocate_buffer(16),t=0;t<e.length;t++)e[t]=255*Math.random()|0;return e[7]&=15,e[7]|=64,e[8]&=63,e[8]|=128,e},uuid_to_string:function(e){if(16===e.length)return[e.slice(0,4),e.slice(4,6),e.slice(6,8),e.slice(8,10),e.slice(10,16)].map((function(e){return e.toString("hex")})).join("-");throw new r.TypeError("Not a UUID, expecting 16 byte buffer")}},o=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/;i.string_to_uuid=function(e){var n=o.exec(e.toLowerCase());if(n)return t.from(n.slice(1).join(""),"hex");throw new r.TypeError("Not a valid UUID string: "+e)},i.clone=function(e){for(var t=Object.create(e.prototype||{}),n=Object.getOwnPropertyNames(e),r=0;r<n.length;r++){var i=n[r];t[i]=e[i]}return t},i.and=function(e,t){return void 0===t?e:function(n){return e(n)&&t(n)}},i.is_sender=function(e){return e.is_sender()},i.is_receiver=function(e){return e.is_receiver()},i.sender_filter=function(e){return i.and(i.is_sender,e)},i.receiver_filter=function(e){return i.and(i.is_receiver,e)},i.is_defined=function(e){return null!=e},e.exports=i}).call(this,n(8).Buffer)},function(e,t,n){"use strict";var r=n(81);r.formatters&&(r.formatters.h=function(e){return e.toString("hex")}),e.exports={config:r("rhea:config"),frames:r("rhea:frames"),raw:r("rhea:raw"),reconnect:r("rhea:reconnect"),events:r("rhea:events"),message:r("rhea:message"),flow:r("rhea:flow"),io:r("rhea:io")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(81);t.container=r("rhea-promise:container"),t.connection=r("rhea-promise:connection"),t.session=r("rhea-promise:session"),t.sender=r("rhea-promise:sender"),t.receiver=r("rhea-promise:receiver"),t.error=r("rhea-promise:error"),t.eventHandler=r("rhea-promise:eventhandler"),t.contextTranslator=r("rhea-promise:translate")},function(e,t,n){"use strict";(function(t){var r=n(144),i=n(19),o=new d(4096),s=/^[A-Za-z_][A-Za-z0-9_]*$/,a=i.format;function c(e){return"function"==typeof t.alloc?t.alloc(e):new t(e)}function u(e,n){return"function"==typeof t.from?t.from(e,n):new t(e,n)}function l(e){return e.charAt(0).toUpperCase()+e.slice(1)}function h(e){return s.test(e)}function d(e){this._len=0|e,this._pos=0,this._slab=c(this._len)}function p(e){var t=Math.pow(2,31),n=Math.floor(e||Math.random()*(t-1));this._max=t,this._nextInt=function(){return n=(1103515245*n+12345)%t}}function f(){this._index=0,this._items=[]}function m(e,t){if(this.buf=e,this.pos=0|t,this.pos<0)throw new Error("negative offset")}function y(e,t){for(;t--;)e[t]=~e[t]}d.prototype.alloc=function(e){if(e<0)throw new Error("negative length");var t=this._len;return e>t?c(e):(this._pos+e>t&&(this._slab=c(t),this._pos=0),this._slab.slice(this._pos,this._pos+=e))},p.prototype.nextBoolean=function(){return!!(this._nextInt()%2)},p.prototype.nextInt=function(e,t){return void 0===t&&(t=e,e=0),t=void 0===t?this._max:t,e+Math.floor(this.nextFloat()*(t-e))},p.prototype.nextFloat=function(e,t){return void 0===t&&(t=e,e=0),e+((t=void 0===t?1:t)-e)*this._nextInt()/this._max},p.prototype.nextString=function(e,t){e|=0;var n="";(t=t||"aA").indexOf("a")>-1&&(n+="abcdefghijklmnopqrstuvwxyz"),t.indexOf("A")>-1&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),t.indexOf("#")>-1&&(n+="0123456789"),t.indexOf("!")>-1&&(n+="~`!@#$%^&*()_+-={}[]:\";'<>?,./|\\");for(var r=[],i=0;i<e;i++)r.push(this.choice(n));return r.join("")},p.prototype.nextBuffer=function(e){var t,n=[];for(t=0;t<e;t++)n.push(this.nextInt(256));return u(n)},p.prototype.choice=function(e){var t=e.length;if(!t)throw new Error("choosing from empty array");return e[this.nextInt(t)]},f.prototype.push=function(e){var t,n=this._items,r=0|n.length;for(n.push(e);r>0&&n[r].index<n[t=r-1>>1].index;)e=n[r],n[r]=n[t],n[t]=e,r=t},f.prototype.pop=function(){var e=this._items,t=e.length-1|0,n=e[0];if(!n||n.index>this._index)return null;if(this._index++,!t)return e.pop(),n;e[0]=e.pop();for(var r,i,o,s,a,c,u,l=t>>1,h=0;h<l&&(s=e[h],i=h+1<<1,c=e[r=1+(h<<1)],!(u=e[i])||c.index<=u.index?(a=c,o=r):(a=u,o=i),!(a.index>=s.index));)e[o]=s,e[h]=a,h=o;return n},m.prototype.isValid=function(){return this.pos<=this.buf.length},m.prototype._invalidate=function(){this.pos=this.buf.length+1},m.prototype.readBoolean=function(){return!!this.buf[this.pos++]},m.prototype.skipBoolean=function(){this.pos++},m.prototype.writeBoolean=function(e){this.buf[this.pos++]=!!e},m.prototype.readInt=m.prototype.readLong=function(){var e,t,n,r,i=0,o=0,s=this.buf;do{t=128&(e=s[this.pos++]),i|=(127&e)<<o,o+=7}while(t&&o<28);if(t){n=i,r=268435456;do{n+=(127&(e=s[this.pos++]))*r,r*=128}while(128&e);return(n%2?-(n+1):n)/2}return i>>1^-(1&i)},m.prototype.skipInt=m.prototype.skipLong=function(){for(var e=this.buf;128&e[this.pos++];);},m.prototype.writeInt=m.prototype.writeLong=function(e){var t,n,r=this.buf;if(e>=-1073741824&&e<1073741824){n=e>=0?e<<1:~e<<1|1;do{r[this.pos]=127&n,n>>=7}while(n&&(r[this.pos++]|=128))}else{t=e>=0?2*e:2*-e-1;do{r[this.pos]=127&t,t/=128}while(t>=1&&(r[this.pos++]|=128))}this.pos++},m.prototype.readFloat=function(){var e=this.buf,t=this.pos;return this.pos+=4,this.pos>e.length?0:this.buf.readFloatLE(t)},m.prototype.skipFloat=function(){this.pos+=4},m.prototype.writeFloat=function(e){var t=this.buf,n=this.pos;if(this.pos+=4,!(this.pos>t.length))return this.buf.writeFloatLE(e,n)},m.prototype.readDouble=function(){var e=this.buf,t=this.pos;return this.pos+=8,this.pos>e.length?0:this.buf.readDoubleLE(t)},m.prototype.skipDouble=function(){this.pos+=8},m.prototype.writeDouble=function(e){var t=this.buf,n=this.pos;if(this.pos+=8,!(this.pos>t.length))return this.buf.writeDoubleLE(e,n)},m.prototype.readFixed=function(e){var t=this.pos;if(this.pos+=e,!(this.pos>this.buf.length)){var n=o.alloc(e);return this.buf.copy(n,0,t,t+e),n}},m.prototype.skipFixed=function(e){this.pos+=e},m.prototype.writeFixed=function(e,t){t=t||e.length;var n=this.pos;this.pos+=t,this.pos>this.buf.length||e.copy(this.buf,n,0,t)},m.prototype.readBytes=function(){var e=this.readLong();if(!(e<0))return this.readFixed(e);this._invalidate()},m.prototype.skipBytes=function(){var e=this.readLong();e<0?this._invalidate():this.pos+=e},m.prototype.writeBytes=function(e){var t=e.length;this.writeLong(t),this.writeFixed(e,t)},"function"==typeof t.prototype.utf8Slice?m.prototype.readString=function(){var e=this.readLong();if(e<0)return this._invalidate(),"";var t=this.pos,n=this.buf;return this.pos+=e,this.pos>n.length?void 0:this.buf.utf8Slice(t,t+e)}:m.prototype.readString=function(){var e=this.readLong();if(e<0)return this._invalidate(),"";var t=this.pos,n=this.buf;return this.pos+=e,this.pos>n.length?void 0:this.buf.slice(t,t+e).toString()},m.prototype.skipString=function(){var e=this.readLong();e<0?this._invalidate():this.pos+=e},m.prototype.writeString=function(e){var n=t.byteLength(e),r=this.buf;this.writeLong(n);var i,o,s,a,c=this.pos;if(this.pos+=n,!(this.pos>r.length))if(n>64&&"function"==typeof t.prototype.utf8Write)r.utf8Write(e,c,n);else for(i=0,o=n;i<o;i++)(s=e.charCodeAt(i))<128?r[c++]=s:s<2048?(r[c++]=s>>6|192,r[c++]=63&s|128):55296==(64512&s)&&56320==(64512&(a=e.charCodeAt(i+1)))?(s=65536+((1023&s)<<10)+(1023&a),i++,r[c++]=s>>18|240,r[c++]=s>>12&63|128,r[c++]=s>>6&63|128,r[c++]=63&s|128):(r[c++]=s>>12|224,r[c++]=s>>6&63|128,r[c++]=63&s|128)},"function"==typeof t.prototype.latin1Write?m.prototype.writeBinary=function(e,t){var n=this.pos;this.pos+=t,this.pos>this.buf.length||this.buf.latin1Write(e,n,t)}:"function"==typeof t.prototype.binaryWrite?m.prototype.writeBinary=function(e,t){var n=this.pos;this.pos+=t,this.pos>this.buf.length||this.buf.binaryWrite(e,n,t)}:m.prototype.writeBinary=function(e,t){var n=this.pos;this.pos+=t,this.pos>this.buf.length||this.buf.write(e,n,t,"binary")},m.prototype.matchBoolean=function(e){return this.buf[this.pos++]-e.buf[e.pos++]},m.prototype.matchInt=m.prototype.matchLong=function(e){var t=this.readLong(),n=e.readLong();return t===n?0:t<n?-1:1},m.prototype.matchFloat=function(e){var t=this.readFloat(),n=e.readFloat();return t===n?0:t<n?-1:1},m.prototype.matchDouble=function(e){var t=this.readDouble(),n=e.readDouble();return t===n?0:t<n?-1:1},m.prototype.matchFixed=function(e,t){return this.readFixed(t).compare(e.readFixed(t))},m.prototype.matchBytes=m.prototype.matchString=function(e){var t=this.readLong(),n=this.pos;this.pos+=t;var r=e.readLong(),i=e.pos;e.pos+=r;var o=this.buf.slice(n,this.pos),s=e.buf.slice(i,e.pos);return o.compare(s)},m.prototype.unpackLongBytes=function(){var e,t,n=c(8),r=0,i=0,o=6,s=this.buf;for(t=1&(e=s[this.pos++]),n.fill(0),r|=(127&e)>>1;128&e;)r|=(127&(e=s[this.pos++]))<<o,(o+=7)>=8&&(o-=8,n[i++]=r,r>>=8);return n[i]=r,t&&y(n,8),n},m.prototype.packLongBytes=function(e){var t,n=(128&e[7])>>7,r=this.buf,i=1,o=0,s=3;n?(y(e,8),t=1):t=0;for(var a=[e.readUIntLE(0,3),e.readUIntLE(3,3),e.readUIntLE(6,2)];s&&!a[--s];);for(;o<s;)for(t|=a[o++]<<i,i+=24;i>7;)r[this.pos++]=127&t|128,t>>=7,i-=7;t|=a[s]<<i;do{r[this.pos]=127&t,t>>=7}while(t&&(r[this.pos++]|=128));this.pos++,n&&y(e,8)},e.exports={abstractFunction:function(){throw new Error("abstract")},addDeprecatedGetters:function(e,t){var n,r,o,s,a=e.prototype;for(n=0,r=t.length;n<r;n++)a[s="get"+l(o=t[n])]=i.deprecate(c(o),"use `."+o+"` instead of `."+s+"()`");function c(e){return function(){var t=this[e];return"function"==typeof t?t.apply(this,arguments):t}}},bufferFrom:u,capitalize:l,copyOwnProperties:function(e,t,n){var r,i,o,s=Object.getOwnPropertyNames(e);for(r=0,i=s.length;r<i;r++)if(o=s[r],!t.hasOwnProperty(o)||n){var a=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,a)}return t},getHash:function(e,t){t=t||"md5";var n=r.createHash(t);return n.end(e),n.read()},compare:function(e,t){return e===t?0:e<t?-1:1},getOption:function(e,t,n){var r=e[t];return void 0===r?n:r},impliedNamespace:function(e){var t=/^(.*)\.[^.]+$/.exec(e);return t?t[1]:void 0},isValidName:h,jsonEnd:function(e,t){t|=0;var n=e.charAt(t++);if(/[\d-]/.test(n)){for(;/[eE\d.+-]/.test(e.charAt(t));)t++;return t}if(/true|null/.test(e.slice(t-1,t+3)))return t+3;if(/false/.test(e.slice(t-1,t+4)))return t+4;var r=0,i=!1;do{switch(n){case"{":case"[":i||r++;break;case"}":case"]":if(!i&&!--r)return t;break;case'"':if(i=!i,!r&&!i)return t;break;case"\\":t++}}while(n=e.charAt(t++));return-1},newBuffer:c,objectValues:function(e){return Object.keys(e).map((function(t){return e[t]}))},qualify:function(e,t){return~e.indexOf(".")?e=e.replace(/^\./,""):t&&(e=t+"."+e),e.split(".").forEach((function(t){if(!h(t))throw new Error(a("invalid name: %j",e))})),e},toMap:function(e,t){var n,r,i={};for(n=0;n<e.length;n++)i[t(r=e[n])]=r;return i},singleIndexOf:function(e,t){var n,r,i=-1;if(!e)return-1;for(n=0,r=e.length;n<r;n++)if(e[n]===t){if(i>=0)return-2;i=n}return i},hasDuplicates:function(e,t){var n,r,i,o=Object.create(null);for(n=0,r=e.length;n<r;n++){if(i=e[n],t&&(i=t(i)),o[i])return!0;o[i]=!0}return!1},unqualify:function(e){var t=e.split(".");return t[t.length-1]},BufferPool:d,Lcg:p,OrderedQueue:f,Tap:m}}).call(this,n(8).Buffer)},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t,n){"use strict";var r=n(130),i=n(140),o=n(69);e.exports={formats:o,parse:i,stringify:r}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(51);function i(e,t,n){return new Promise((i,o)=>{let s=void 0,a=void 0;const c=()=>o(new r.b((null==n?void 0:n.abortErrorMsg)?null==n?void 0:n.abortErrorMsg:"The operation was aborted.")),u=()=>{(null==n?void 0:n.abortSignal)&&a&&n.abortSignal.removeEventListener("abort",a)};if(a=()=>(s&&clearTimeout(s),u(),c()),(null==n?void 0:n.abortSignal)&&n.abortSignal.aborted)return c();s=setTimeout(()=>{u(),i(t)},e),(null==n?void 0:n.abortSignal)&&n.abortSignal.addEventListener("abort",a)})}function o(e,t){const n=e.headers.get(t);if(!n)return;const r=Number(n);return Number.isNaN(r)?void 0:r}},function(e,t,n){"use strict";function r(e){return"adfs"===e?"oauth2/token":"oauth2/v2.0/token"}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,i=n(17),o=n(16);!function(e){e.CbsTokenTypeJwt="jwt",e.CbsTokenTypeSas="servicebus.windows.net:sastoken"}(r||(r={}));var s=n(5),a=n(23),c=n(0),u=n(58);class l{constructor(e,t){this.isConnecting=!1,t||(t={}),this._context=e,this.address=t.address||"",this.audience=t.audience||"",this.name=`${t.name}-${Object(u.a)()}`,this.partitionId=t.partitionId}async _negotiateClaim({abortSignal:e,setTokenRenewal:t,timeoutInMs:n}){c.b.verbose("[%s] Acquiring cbs lock: '%s' for creating the cbs session while creating the %s: '%s' with address: '%s'.",this._context.connectionId,this._context.cbsSession.cbsLock,this._type,this.name,this.address);const a=Date.now();let u,l;if(this._context.cbsSession.isOpen()||await i.a.acquire(this._context.cbsSession.cbsLock,()=>this._context.cbsSession.init({abortSignal:e,timeoutInMs:n-(Date.now()-a)}),{abortSignal:e,timeoutInMs:n}),Object(o.c)(this._context.tokenCredential))u=this._context.tokenCredential.getToken(this.audience),l=r.CbsTokenTypeSas,this._tokenTimeoutInMs=27e5;else{const e=await this._context.tokenCredential.getToken(s.a.aadEventHubsScope);if(!e)throw new Error('Failed to get token from the provided "TokenCredential" object');u=e,l=r.CbsTokenTypeJwt,this._tokenTimeoutInMs=u.expiresOnTimestamp-Date.now()-12e4}c.b.verbose("[%s] %s: calling negotiateClaim for audience '%s'.",this._context.connectionId,this._type,this.audience),c.b.verbose("[%s] Acquiring cbs lock: '%s' for cbs auth for %s: '%s' with address '%s'.",this._context.connectionId,this._context.negotiateClaimLock,this._type,this.name,this.address),await i.a.acquire(this._context.negotiateClaimLock,()=>this._context.cbsSession.negotiateClaim(this.audience,u.token,l,{abortSignal:e,timeoutInMs:n-(Date.now()-a)}),{abortSignal:e,timeoutInMs:n-(Date.now()-a)}),c.b.verbose("[%s] Negotiated claim for %s '%s' with with address: %s",this._context.connectionId,this._type,this.name,this.address),t&&await this._ensureTokenRenewal()}_ensureTokenRenewal(){this._tokenTimeoutInMs&&(this._tokenRenewalTimer&&clearTimeout(this._tokenRenewalTimer),this._tokenRenewalTimer=setTimeout(async()=>{try{await this._negotiateClaim({setTokenRenewal:!0,abortSignal:void 0,timeoutInMs:Object(a.a)(void 0)})}catch(e){c.b.verbose("[%s] %s '%s' with address %s, an error occurred while renewing the token: %O",this._context.connectionId,this._type,this.name,this.address,e)}},this._tokenTimeoutInMs),c.b.verbose("[%s] %s '%s' with address %s, has next token renewal in %d milliseconds @(%s).",this._context.connectionId,this._type,this.name,this.address,this._tokenTimeoutInMs,new Date(Date.now()+this._tokenTimeoutInMs).toString()))}async _closeLink(e){if(clearTimeout(this._tokenRenewalTimer),e)try{await e.close(),c.b.verbose("[%s] %s '%s' with address '%s' closed.",this._context.connectionId,this._type,this.name,this.address)}catch(e){c.b.verbose("[%s] An error occurred while closing the %s '%s' with address '%s': %O",this._context.connectionId,this._type,this.name,this.address,e)}}get _type(){let e="LinkEntity";return this.constructor&&this.constructor.name&&(e=this.constructor.name),e}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return a}));const r=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function i(e){return r.test(e)}const o=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function s(e){return o.test(e)}function a(e,t){var n,r;const i=e.parsedHeaders;if("HEAD"===e.request.method)return Object.assign(Object.assign({},i),{body:e.parsedBody});const o=t&&t.bodyMapper,s=Boolean(null==o?void 0:o.nullable),a=null==o?void 0:o.type.name;if("Stream"===a)return Object.assign(Object.assign({},i),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody});const c="Composite"===a&&o.type.modelProperties||{},u=Object.keys(c).some(e=>""===c[e].serializedName);if("Sequence"===a||u){const t=null!==(n=e.parsedBody)&&void 0!==n?n:[];for(const n of Object.keys(c))c[n].serializedName&&(t[n]=null===(r=e.parsedBody)||void 0===r?void 0:r[n]);if(i)for(const e of Object.keys(i))t[e]=i[e];return!s||e.parsedBody||i||0!==Object.getOwnPropertyNames(c).length?t:null}return function(e){const t=Object.assign(Object.assign({},e.headers),e.body);return e.hasNullableType&&0===Object.getOwnPropertyNames(t).length?e.shouldWrapBody?{body:null}:null:e.shouldWrapBody?Object.assign(Object.assign({},e.headers),{body:e.body}):t}({body:e.parsedBody,headers:i,hasNullableType:s,shouldWrapBody:(l=e.parsedBody,h=a,"Composite"!==h&&"Dictionary"!==h&&("string"==typeof l||"number"==typeof l||"boolean"==typeof l||null!==(null==h?void 0:h.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i))||null==l))});var l,h}},function(e,t,n){"use strict";(function(e){var r=n(102);const i=void 0!==e&&e.env&&e.env.DEBUG||void 0;let o,s=[],a=[];const c=[];i&&l(i);const u=Object.assign(e=>d(e),{enable:l,enabled:h,disable:function(){const e=o||"";return l(""),e},log:r.a});function l(e){o=e,s=[],a=[];const t=/\*/g,n=e.split(",").map(e=>e.trim().replace(t,".*?"));for(const e of n)e.startsWith("-")?a.push(new RegExp(`^${e.substr(1)}$`)):s.push(new RegExp(`^${e}$`));for(const e of c)e.enabled=h(e.namespace)}function h(e){if(e.endsWith("*"))return!0;for(const t of a)if(t.test(e))return!1;for(const t of s)if(t.test(e))return!0;return!1}function d(e){const t=Object.assign((function(...n){if(!t.enabled)return;n.length>0&&(n[0]=`${e} ${n[0]}`);t.log(...n)}),{enabled:h(e),destroy:p,log:u.log,namespace:e,extend:f});return c.push(t),t}function p(){const e=c.indexOf(this);return e>=0&&(c.splice(e,1),!0)}function f(e){const t=d(`${this.namespace}:${e}`);return t.log=this.log,t}t.a=u}).call(this,n(9))},function(e,t,n){"use strict";n.d(t,"a",(function(){return ie})),n.d(t,"d",(function(){return ue})),n.d(t,"c",(function(){return le})),n.d(t,"b",(function(){return he}));var r=n(91),i=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var o=function(e){var t=new Set([e]),n=new Set,r=e.match(i);if(!r)return function(){return!1};var o=+r[1],s=+r[2],a=+r[3];if(null!=r[4])return function(t){return t===e};function c(e){return n.add(e),!1}function u(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;var r=e.match(i);if(!r)return c(e);var l=+r[1],h=+r[2],d=+r[3];return null!=r[4]||o!==l?c(e):0===o?s===h&&a<=d?u(e):c(e):s<=h?u(e):c(e)}}("1.1.0"),s="1.1.0".split(".")[0],a=Symbol.for("opentelemetry.js.api."+s),c=r.a;function u(e,t,n,r){var i;void 0===r&&(r=!1);var o=c[a]=null!==(i=c[a])&&void 0!==i?i:{version:"1.1.0"};if(!r&&o[e]){var s=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(s.stack||s.message),!1}if("1.1.0"!==o.version){s=new Error("@opentelemetry/api: All API registration versions must match");return n.error(s.stack||s.message),!1}return o[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v1.1.0."),!0}function l(e){var t,n,r=null===(t=c[a])||void 0===t?void 0:t.version;if(r&&o(r))return null===(n=c[a])||void 0===n?void 0:n[e]}function h(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v1.1.0.");var n=c[a];n&&delete n[e]}var d,p=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return f("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return f("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return f("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return f("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return f("verbose",this._namespace,e)},e}();function f(e,t,n){var r=l("diag");if(r)return n.unshift(t),r[e].apply(r,n)}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(d||(d={}));var m=function(){function e(){function e(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=l("diag");if(r)return r[e].apply(r,t)}}var t=this;t.setLogger=function(e,n){var r,i;if(void 0===n&&(n=d.INFO),e===t){var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(r=o.stack)&&void 0!==r?r:o.message),!1}var s=l("diag"),a=function(e,t){function n(n,r){var i=t[n];return"function"==typeof i&&e>=r?i.bind(t):function(){}}return e<d.NONE?e=d.NONE:e>d.ALL&&(e=d.ALL),t=t||{},{error:n("error",d.ERROR),warn:n("warn",d.WARN),info:n("info",d.INFO),debug:n("debug",d.DEBUG),verbose:n("verbose",d.VERBOSE)}}(n,e);if(s){var c=null!==(i=(new Error).stack)&&void 0!==i?i:"<failed to generate stacktrace>";s.warn("Current logger will be overwritten from "+c),a.warn("Current logger will overwrite one already registered from "+c)}return u("diag",a,t,!0)},t.disable=function(){h("diag",t)},t.createComponentLogger=function(e){return new p(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),y=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){return[e[0],e[1]]}))},e.prototype.setEntry=function(t,n){var r=new e(this._entries);return r._entries.set(t,n),r},e.prototype.removeEntry=function(t){var n=new e(this._entries);return n._entries.delete(t),n},e.prototype.removeEntries=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=new e(this._entries),i=0,o=t;i<o.length;i++){var s=o[i];r._entries.delete(s)}return r},e.prototype.clear=function(){return new e},e}();Symbol("BaggageEntryMetadata"),m.instance();function g(e){return void 0===e&&(e={}),new y(new Map(Object.entries(e)))}var v={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},_={set:function(e,t,n){null!=e&&(e[t]=n)}};function b(e){return Symbol.for(e)}var w,E=new function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(e){return n._currentContext.get(e)},n.setValue=function(t,r){var i=new e(n._currentContext);return i._currentContext.set(t,r),i},n.deleteValue=function(t){var r=new e(n._currentContext);return r._currentContext.delete(t),r}},S=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},k=function(){function e(){}return e.prototype.active=function(){return E},e.prototype.with=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t.call.apply(t,S([n],r))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),O=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},T=new k,C=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return u("context",e,m.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return(r=this._getContextManager()).with.apply(r,O([e,t,n],i))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return l("context")||T},e.prototype.disable=function(){this._getContextManager().disable(),h("context",m.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(w||(w={}));var I={traceId:"00000000000000000000000000000000",spanId:"0000000000000000",traceFlags:w.NONE},A=function(){function e(e){void 0===e&&(e=I),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),x=b("OpenTelemetry Context Key SPAN");function R(e){return e.getValue(x)||void 0}function P(e,t){return e.setValue(x,t)}function N(e){return e.deleteValue(x)}function j(e,t){return P(e,new A(t))}function L(e){var t;return null===(t=R(e))||void 0===t?void 0:t.spanContext()}var M=/^([0-9a-f]{32})$/i,q=/^[0-9a-f]{16}$/i;function z(e){return n=e.traceId,M.test(n)&&"00000000000000000000000000000000"!==n&&(t=e.spanId,q.test(t)&&"0000000000000000"!==t);var t,n}function U(e){return new A(e)}var B=C.getInstance(),D=function(){function e(){}return e.prototype.startSpan=function(e,t,n){if(Boolean(null==t?void 0:t.root))return new A;var r,i=n&&L(n);return"object"==typeof(r=i)&&"string"==typeof r.spanId&&"string"==typeof r.traceId&&"number"==typeof r.traceFlags&&z(i)?new A(i):new A},e.prototype.startActiveSpan=function(e,t,n,r){var i,o,s;if(!(arguments.length<2)){2===arguments.length?s=t:3===arguments.length?(i=t,s=n):(i=t,o=n,s=r);var a=null!=o?o:B.active(),c=this.startSpan(e,i,a),u=P(a,c);return B.with(u,s,void 0,c)}},e}();var F,H,$,K=new D,W=function(){function e(e,t,n,r){this._provider=e,this.name=t,this.version=n,this.options=r}return e.prototype.startSpan=function(e,t,n){return this._getTracer().startSpan(e,t,n)},e.prototype.startActiveSpan=function(e,t,n,r){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):K},e}(),V=new(function(){function e(){}return e.prototype.getTracer=function(e,t,n){return new D},e}()),G=function(){function e(){}return e.prototype.getTracer=function(e,t,n){var r;return null!==(r=this.getDelegateTracer(e,t,n))&&void 0!==r?r:new W(this,e,t,n)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:V},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t,n)},e}();!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(F||(F={})),function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(H||(H={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}($||($={}));var Y=new RegExp("^(?:[a-z][_0-9a-z-*/]{0,255}|[a-z0-9][_0-9a-z-*/]{0,240}@[a-z][_0-9a-z-*/]{0,13})$"),J=/^[ -~]{0,255}[!-~]$/,Z=/,|=/;!function(){function e(e){this._internalState=new Map,e&&this._parse(e)}e.prototype.set=function(e,t){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,n){return t.push(n+"="+e.get(n)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var n=t.trim(),r=n.indexOf("=");if(-1!==r){var i=n.slice(0,r),o=n.slice(r+1,t.length);(function(e){return Y.test(e)})(i)&&function(e){return J.test(e)&&!Z.test(e)}(o)&&e.set(i,o)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t}}();var Q=function(){function e(){this._proxyTracerProvider=new G,this.wrapSpanContext=U,this.isSpanContextValid=z,this.deleteSpan=N,this.getSpan=R,this.getSpanContext=L,this.setSpan=P,this.setSpanContext=j}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=u("trace",this._proxyTracerProvider,m.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return l("trace")||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){h("trace",m.instance()),this._proxyTracerProvider=new G},e}(),X=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),ee=b("OpenTelemetry Baggage Key");function te(e){return e.getValue(ee)||void 0}function ne(e,t){return e.setValue(ee,t)}function re(e){return e.deleteValue(ee)}var ie,oe=new X,se=function(){function e(){this.createBaggage=g,this.getBaggage=te,this.setBaggage=ne,this.deleteBaggage=re}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return u("propagation",e,m.instance())},e.prototype.inject=function(e,t,n){return void 0===n&&(n=_),this._getGlobalPropagator().inject(e,t,n)},e.prototype.extract=function(e,t,n){return void 0===n&&(n=v),this._getGlobalPropagator().extract(e,t,n)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){h("propagation",m.instance())},e.prototype._getGlobalPropagator=function(){return l("propagation")||oe},e}(),ae=C.getInstance(),ce=Q.getInstance();se.getInstance(),m.instance();function ue(e,t){return ce.setSpan(e,t)}!function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(ie||(ie={}));const le=ae;var he;!function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(he||(he={}))},,,function(e,t,n){"use strict";var r=n(32),i=n(31),o={},s={};function a(e,t){var n=r.define_composite(t);o[t.name]=n.create,s[Number(n.descriptor.numeric).toString(10)]=n,s[n.descriptor.symbolic]=n}o.read_header=function(e){var t=4,n={};if("AMQP"!==e.toString("ascii",0,t))throw new i.ProtocolError("Invalid protocol header for AMQP: "+e.toString("hex",0,t));if(n.protocol_id=e.readUInt8(t++),n.major=e.readUInt8(t++),n.minor=e.readUInt8(t++),n.revision=e.readUInt8(t++),0===n.protocol_id&&0===n.major&&9===n.minor&&1===n.revision)throw new i.ProtocolError("Unsupported AMQP version: 0-9-1");if(1===n.protocol_id&&1===n.major&&0===n.minor&&10===n.revision)throw new i.ProtocolError("Unsupported AMQP version: 0-10");if(1!==n.major||0!==n.minor)throw new i.ProtocolError("Unsupported AMQP version: "+JSON.stringify(n));return n},o.write_header=function(e,t){var n=4;return e.write("AMQP",0,n,"ascii"),e.writeUInt8(t.protocol_id,n++),e.writeUInt8(t.major,n++),e.writeUInt8(t.minor,n++),e.writeUInt8(t.revision,n++),8},o.TYPE_AMQP=0,o.TYPE_SASL=1,o.read_frame=function(e){var t=new r.Reader(e),n={};if(n.size=t.read_uint(4),t.remaining()<n.size-4)return null;var a=t.read_uint(1);if(a<2)throw new i.ProtocolError("Invalid data offset, must be at least 2 was "+a);if(n.type=t.read_uint(1),n.type===o.TYPE_AMQP)n.channel=t.read_uint(2);else{if(n.type!==o.TYPE_SASL)throw new i.ProtocolError("Unknown frame type "+n.type);t.skip(2),n.channel=0}if(a>1&&t.skip(4*a-8),t.remaining()){n.performative=t.read();var c=s[n.performative.descriptor.value];c&&(n.performative=new c(n.performative.value)),t.remaining()&&(n.payload=t.read_bytes(t.remaining()))}return n},o.write_frame=function(e){var t=new r.Writer;if(t.skip(4),t.write_uint(2,1),t.write_uint(e.type,1),e.type===o.TYPE_AMQP)t.write_uint(e.channel,2);else{if(e.type!==o.TYPE_SASL)throw new i.ProtocolError("Unknown frame type "+e.type);t.write_uint(0,2)}e.performative&&(t.write(e.performative),e.payload&&t.write_bytes(e.payload));var n=t.toBuffer();return n.writeUInt32BE(n.length,0),n},o.amqp_frame=function(e,t,n){return{channel:e||0,type:o.TYPE_AMQP,performative:t,payload:n}},o.sasl_frame=function(e){return{channel:0,type:o.TYPE_SASL,performative:e}};a(o.TYPE_AMQP,{name:"open",code:16,fields:[{name:"container_id",type:"string",mandatory:!0},{name:"hostname",type:"string"},{name:"max_frame_size",type:"uint",default_value:4294967295},{name:"channel_max",type:"ushort",default_value:65535},{name:"idle_time_out",type:"uint"},{name:"outgoing_locales",type:"symbol",multiple:!0},{name:"incoming_locales",type:"symbol",multiple:!0},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]}),a(o.TYPE_AMQP,{name:"begin",code:17,fields:[{name:"remote_channel",type:"ushort"},{name:"next_outgoing_id",type:"uint",mandatory:!0},{name:"incoming_window",type:"uint",mandatory:!0},{name:"outgoing_window",type:"uint",mandatory:!0},{name:"handle_max",type:"uint",default_value:"4294967295"},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]}),a(o.TYPE_AMQP,{name:"attach",code:18,fields:[{name:"name",type:"string",mandatory:!0},{name:"handle",type:"uint",mandatory:!0},{name:"role",type:"boolean",mandatory:!0},{name:"snd_settle_mode",type:"ubyte",default_value:2},{name:"rcv_settle_mode",type:"ubyte",default_value:0},{name:"source",type:"*"},{name:"target",type:"*"},{name:"unsettled",type:"map"},{name:"incomplete_unsettled",type:"boolean",default_value:!1},{name:"initial_delivery_count",type:"uint"},{name:"max_message_size",type:"ulong"},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]}),a(o.TYPE_AMQP,{name:"flow",code:19,fields:[{name:"next_incoming_id",type:"uint"},{name:"incoming_window",type:"uint",mandatory:!0},{name:"next_outgoing_id",type:"uint",mandatory:!0},{name:"outgoing_window",type:"uint",mandatory:!0},{name:"handle",type:"uint"},{name:"delivery_count",type:"uint"},{name:"link_credit",type:"uint"},{name:"available",type:"uint"},{name:"drain",type:"boolean",default_value:!1},{name:"echo",type:"boolean",default_value:!1},{name:"properties",type:"symbolic_map"}]}),a(o.TYPE_AMQP,{name:"transfer",code:20,fields:[{name:"handle",type:"uint",mandatory:!0},{name:"delivery_id",type:"uint"},{name:"delivery_tag",type:"binary"},{name:"message_format",type:"uint"},{name:"settled",type:"boolean"},{name:"more",type:"boolean",default_value:!1},{name:"rcv_settle_mode",type:"ubyte"},{name:"state",type:"delivery_state"},{name:"resume",type:"boolean",default_value:!1},{name:"aborted",type:"boolean",default_value:!1},{name:"batchable",type:"boolean",default_value:!1}]}),a(o.TYPE_AMQP,{name:"disposition",code:21,fields:[{name:"role",type:"boolean",mandatory:!0},{name:"first",type:"uint",mandatory:!0},{name:"last",type:"uint"},{name:"settled",type:"boolean",default_value:!1},{name:"state",type:"*"},{name:"batchable",type:"boolean",default_value:!1}]}),a(o.TYPE_AMQP,{name:"detach",code:22,fields:[{name:"handle",type:"uint",mandatory:!0},{name:"closed",type:"boolean",default_value:!1},{name:"error",type:"error"}]}),a(o.TYPE_AMQP,{name:"end",code:23,fields:[{name:"error",type:"error"}]}),a(o.TYPE_AMQP,{name:"close",code:24,fields:[{name:"error",type:"error"}]});a(o.TYPE_SASL,{name:"sasl_mechanisms",code:64,fields:[{name:"sasl_server_mechanisms",type:"symbol",multiple:!0,mandatory:!0}]}),a(o.TYPE_SASL,{name:"sasl_init",code:65,fields:[{name:"mechanism",type:"symbol",mandatory:!0},{name:"initial_response",type:"binary"},{name:"hostname",type:"string"}]}),a(o.TYPE_SASL,{name:"sasl_challenge",code:66,fields:[{name:"challenge",type:"binary",mandatory:!0}]}),a(o.TYPE_SASL,{name:"sasl_response",code:67,fields:[{name:"response",type:"binary",mandatory:!0}]}),a(o.TYPE_SASL,{name:"sasl_outcome",code:68,fields:[{name:"code",type:"ubyte",mandatory:!0},{name:"additional_data",type:"binary"}]}),e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(35),i=n(87);!function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.OK=200]="OK",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.Ambiguous=300]="Ambiguous",e[e.MultipleChoices=300]="MultipleChoices",e[e.Moved=301]="Moved",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.Redirect=302]="Redirect",e[e.RedirectMethod=303]="RedirectMethod",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.RedirectKeepVerb=307]="RedirectKeepVerb",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.RequestUriTooLong=414]="RequestUriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported"}(t.AmqpResponseStatusCode||(t.AmqpResponseStatusCode={})),t.messageProperties=["message_id","reply_to","to","correlation_id","content_type","absolute_expiry_time","group_id","group_sequence","reply_to_group_id","content_encoding","creation_time","subject","user_id"],t.messageHeader=["first_acquirer","delivery_count","ttl","durable","priority"],t.isAmqpError=function(e){if(!e||"object"!=typeof e)throw new Error("err is a required parameter and must be of type 'object'.");let t=!1;return(e.condition&&"string"==typeof e.condition&&e.description&&"string"==typeof e.description||e.value&&Array.isArray(e.value)||e.constructor&&"c"===e.constructor.name)&&(t=!0),t},t.delay=function(e,t){return new Promise(n=>setTimeout(()=>n(t),e))},t.parseConnectionString=function(e,t){t||(t={});const n=t.entitySeperator||";",r=t.keyValueSeparator||"=";return e.split(n).reduce((e,t)=>{const n=t.indexOf(r);return Object.assign({},e,{[t.substring(0,n)]:t.substring(n+1)})},{})},t.emitEvent=function(e){const t=()=>{const t=e.emitter&&(e.emitter.id||e.emitter.name);r[e.emitterType]("[%s] %s '%s' got event: '%s'. Re-emitting the translated context.",e.connectionId,e.emitterType,t,e.eventName),e.emitter.emit(e.eventName,i.EventContext.translate(e.rheaContext,e.emitter,e.eventName))};-1!==e.eventName.indexOf("error")&&e.emitter.actionInitiated>0?(r[e.emitterType]("[%s] %s got event: '%s'. Will re-emit in the next tick, since this happened before the promise for create/close was resolved.",e.connectionId,e.emitterType,e.eventName),setTimeout(t)):t()},t.abortErrorName="AbortError",t.createAbortError=function(){const e=new Error("The operation was aborted.");return e.name=t.abortErrorName,e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e),this.name="OperationTimeoutError"}}t.OperationTimeoutError=r;class i extends Error{constructor(e){super(e),this.name="InsufficientCreditError"}}t.InsufficientCreditError=i;class o extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.innerError=n,this.name="SendOperationFailedError",this.code=t,this.innerError=n}}t.SendOperationFailedError=o},function(e,t,n){function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(8).Buffer.isBuffer},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));const r=new WeakMap,i=new WeakMap;class o{constructor(){this.onabort=null,r.set(this,[]),i.set(this,!1)}get aborted(){if(!i.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return i.get(this)}static get none(){return new o}addEventListener(e,t){if(!r.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");r.get(this).push(t)}removeEventListener(e,t){if(!r.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");const n=r.get(this),i=n.indexOf(t);i>-1&&n.splice(i,1)}dispatchEvent(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")}}function s(e){if(e.aborted)return;e.onabort&&e.onabort.call(e);const t=r.get(e);t&&t.slice().forEach(t=>{t.call(e,{type:"abort"})}),i.set(e,!0)}class a extends Error{constructor(e){super(e),this.name="AbortError"}}class c{constructor(e){if(this._signal=new o,e){Array.isArray(e)||(e=arguments);for(const t of e)t.aborted?this.abort():t.addEventListener("abort",()=>{this.abort()})}}get signal(){return this._signal}abort(){s(this._signal)}static timeout(e){const t=new o,n=setTimeout(s,e,t);return"function"==typeof n.unref&&n.unref(),t}}},,function(e,t,n){e.exports=i;var r=n(21).EventEmitter;function i(){r.call(this)}n(37)(i,r),i.Readable=n(71),i.Writable=n(154),i.Duplex=n(155),i.Transform=n(156),i.PassThrough=n(157),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",c));var s=!1;function a(){s||(s=!0,e.end())}function c(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(l(),0===r.listenerCount(this,"error"))throw e}function l(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",a),n.removeListener("close",c),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",l),n.removeListener("close",l),e.removeListener("close",l)}return n.on("error",u),e.on("error",u),n.on("end",l),n.on("close",l),e.on("close",l),e.emit("pipe",n),e}},function(e,t,n){"use strict";(function(t){void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,r)}));case 4:return t.nextTick((function(){e.call(null,n,r,i)}));default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return t.nextTick((function(){e.apply(null,o)}))}}}:e.exports=t}).call(this,n(9))},function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(e[r]=n[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){var t,n,r,i,o,s;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(s=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)o=e[t],s.set(o,i),i+=o.length;return s}},s={arraySet:function(e,t,n,r,i){for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,s))},t.setTyped(r)},function(e,t,n){"use strict";function r(e,t){if(!function(e){return null!=e}(e)||"object"!=typeof e)return!1;for(const n of t)if(!i(e,n))return!1;return!0}function i(e,t){return"object"==typeof e&&t in e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var r=n(10),i=n(38),o=n.n(i),s=n(44),a=n(175),c=n(77),u=n(30),l=n(18),h=n(40),d=n(26),p=n(22),f=n(3),m=n(106);function y(e){if(!e)return{};try{return JSON.parse(e)}catch(e){return{}}}class g extends a.a{constructor(t){var n;const r=(null===(n=null==t?void 0:t.userAgentOptions)||void 0===n?void 0:n.userAgentPrefix)?t.userAgentOptions.userAgentPrefix+" azsdk-js-identity/1.5.2":"azsdk-js-identity/1.5.2",i=function(t){let n=null==t?void 0:t.authorityHost;return m.a&&(n=null!=n?n:e.env.AZURE_AUTHORITY_HOST),null!=n?n:d.b}(t);if(!i.startsWith("https:"))throw new Error("The authorityHost address must use the 'https' protocol.");super(Object.assign(Object.assign({requestContentType:"application/json; charset=utf-8"},t),{userAgentOptions:{userAgentPrefix:r},baseUri:i})),this.authorityHost=i}sendTokenRequest(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){f.d.info(`IdentityClient: sending token request to [${e.url}]`);const r=yield this.sendRequest(e);if(t=t||(e=>Date.now()+1e3*e.expires_in),!r.bodyAsText||200!==r.status&&201!==r.status){const e=new l.c(r.status,r.bodyAsText);throw f.d.warning(`IdentityClient: authentication error. HTTP status: ${r.status}, ${e.errorResponse.errorDescription}`),e}{const i=y(r.bodyAsText),o={accessToken:{token:null!==(n=i.token)&&void 0!==n?n:i.access_token,expiresOnTimestamp:t(i)},refreshToken:i.refresh_token};return f.d.info(`IdentityClient: [${e.url}] token acquired, expires on ${o.accessToken.expiresOnTimestamp}`),o}}))}refreshAccessToken(e,t,n,i,a,d,m){var y,g;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(void 0===i)return null;f.d.info(`IdentityClient: refreshing access token with client ID: ${t}, scopes: ${n} started`);const{span:r,updatedOptions:v}=Object(p.a)("IdentityClient-refreshAccessToken",m),_={grant_type:"refresh_token",client_id:t,refresh_token:i,scope:n};void 0!==a&&(_.client_secret=a);try{const n=Object(h.a)(e),i=Object(c.a)({url:`${this.authorityHost}/${e}/${n}`,method:"POST",body:o.a.stringify(_),abortSignal:m&&m.abortSignal,headers:Object(u.a)({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),tracingOptions:{spanOptions:null===(y=null==v?void 0:v.tracingOptions)||void 0===y?void 0:y.spanOptions,tracingContext:null===(g=null==v?void 0:v.tracingOptions)||void 0===g?void 0:g.tracingContext}}),s=yield this.sendTokenRequest(i,d);return f.d.info("IdentityClient: refreshed token for client ID: "+t),s}catch(e){if(e.name===l.d&&"interaction_required"===e.errorResponse.error)return f.d.info("IdentityClient: interaction required for client ID: "+t),r.setStatus({code:s.b.ERROR,message:e.message}),null;throw f.d.warning(`IdentityClient: failed refreshing token for client ID: ${t}: ${e}`),r.setStatus({code:s.b.ERROR,message:e.message}),e}finally{r.end()}}))}sendGetRequestAsync(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object(c.a)({url:e,method:"GET",body:null==t?void 0:t.body,headers:Object(u.a)(null==t?void 0:t.headers)}),r=yield this.sendRequest(n);return{body:y(r.bodyAsText),headers:r.headers.toJSON(),status:r.status}}))}sendPostRequestAsync(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object(c.a)({url:e,method:"POST",body:null==t?void 0:t.body,headers:Object(u.a)(null==t?void 0:t.headers)}),r=yield this.sendRequest(n);return{body:y(r.bodyAsText),headers:r.headers.toJSON(),status:r.status}}))}}}).call(this,n(9))},function(e,t,n){"use strict";var r,i=new Uint8Array(16);function o(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}var s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var a=function(e){return"string"==typeof e&&s.test(e)},c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!a(n))throw TypeError("Stringified UUID is invalid");return n};t.a=function(e,t,n){var r=(e=e||{}).random||(e.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return l(r)}},,function(e,t,n){"use strict";var r=function(){this.init()};r.prototype.init=function(){this.local_open=!1,this.remote_open=!1,this.open_requests=0,this.close_requests=0,this.initialised=!1,this.marker=void 0},r.prototype.mark=function(e){return this.marker=e||Date.now(),this.marker},r.prototype.open=function(){return this.marker=void 0,this.initialised=!0,!this.local_open&&(this.local_open=!0,this.open_requests++,!0)},r.prototype.close=function(){return this.marker=void 0,!!this.local_open&&(this.local_open=!1,this.close_requests++,!0)},r.prototype.disconnected=function(){var e=this.initialised;this.was_open=this.local_open,this.init(),this.initialised=e},r.prototype.reconnect=function(){this.was_open&&(this.open(),this.was_open=void 0)},r.prototype.remote_opened=function(){return!this.remote_open&&(this.remote_open=!0,!0)},r.prototype.remote_closed=function(){return!!this.remote_open&&(this.remote_open=!1,!0)},r.prototype.is_open=function(){return this.local_open&&this.remote_open},r.prototype.is_closed=function(){return this.initialised&&!(this.local_open||this.was_open)&&!this.remote_open},r.prototype.has_settled=function(){return 0===this.open_requests&&0===this.close_requests},r.prototype.need_open=function(){return this.open_requests>0&&(this.open_requests--,!0)},r.prototype.need_close=function(){return this.close_requests>0&&(this.close_requests--,!0)},e.exports=r},function(e,t,n){"use strict";var r=n(34),i=n(32),o={},s={},a=[],c={};function u(e,t,n){t.descriptor=e,s[e.symbolic]=t,s[Number(e.numeric).toString(10)]=t,n&&a.push(n)}function l(e){var t=i.define_composite(e);c[e.name]=t.create,o[Number(t.descriptor.numeric).toString(10)]=t,o[t.descriptor.symbolic]=t;u(t.descriptor,(function(n,r){for(var i=new t(r.value),o=0;o<e.fields.length;o++){var s=e.fields[o],a=i[s.name];null!=a&&(n[s.name]=a)}}),(function(e,n){e.push(t.create(n).described())}))}function h(e,t){var n=t?i.wrap_symbolic_map:i.wrap_map,r={numeric:e.code};r.symbolic="amqp:"+e.name.replace(/_/g,"-")+":map";u(r,(function(t,n){t[e.name]=i.unwrap_map_simple(n)}),(function(t,o){o[e.name]&&t.push(i.described_nc(i.wrap_ulong(r.numeric),n(o[e.name])))}))}function d(e,t,n){this.typecode=e,this.content=t,this.multiple=n}function p(e,t,n){void 0===e.body?e.body=new d(n,i.unwrap(t)):e.body.constructor===d&&e.body.typecode===n&&(e.body.multiple?e.body.content.push(i.unwrap(t)):(e.body.multiple=!0,e.body.content=[e.body.content,i.unwrap(t)]))}function f(e){e&&function e(t,n){for(var r in t){var i=t[r];"object"==typeof i?e(i,n[r]):n[r]=i}}(e,this)}d.prototype.described=function(e){return i.described(i.wrap_ulong(this.typecode),i.wrap(e||this.content))},d.prototype.collect_sections=function(e){if(this.multiple)for(var t=0;t<this.content.length;t++)e.push(this.described(this.content[t]));else e.push(this.described())},l({name:"header",code:112,fields:[{name:"durable",type:"boolean",default_value:!1},{name:"priority",type:"ubyte",default_value:4},{name:"ttl",type:"uint"},{name:"first_acquirer",type:"boolean",default_value:!1},{name:"delivery_count",type:"uint",default_value:0}]}),h({name:"delivery_annotations",code:113},!0),h({name:"message_annotations",code:114},!0),l({name:"properties",code:115,fields:[{name:"message_id",type:"message_id"},{name:"user_id",type:"binary"},{name:"to",type:"string"},{name:"subject",type:"string"},{name:"reply_to",type:"string"},{name:"correlation_id",type:"message_id"},{name:"content_type",type:"symbol"},{name:"content_encoding",type:"symbol"},{name:"absolute_expiry_time",type:"timestamp"},{name:"creation_time",type:"timestamp"},{name:"group_id",type:"string"},{name:"group_sequence",type:"uint"},{name:"reply_to_group_id",type:"string"}]}),h({name:"application_properties",code:116}),u({numeric:117,symbolic:"amqp:data:binary"},(function(e,t){p(e,t,117)})),u({numeric:118,symbolic:"amqp:amqp-sequence:list"},(function(e,t){p(e,t,118)})),u({numeric:119,symbolic:"amqp:value:*"},(function(e,t){e.body=i.unwrap(t)})),h({name:"footer",code:120}),a.push((function(e,t){t.body&&t.body.collect_sections?t.body.collect_sections(e):e.push(i.described(i.wrap_ulong(119),i.wrap(t.body)))})),c.data_section=function(e){return new d(117,e)},c.sequence_section=function(e){return new d(118,e)},c.data_sections=function(e){return new d(117,e,!0)},c.sequence_sections=function(e){return new d(118,e,!0)},f.prototype.toJSON=function(){var e={};for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e},f.prototype.toString=function(){return JSON.stringify(this.toJSON())},c.encode=function(e){var t=[];a.forEach((function(n){n(t,e)}));for(var n=new i.Writer,o=0;o<t.length;o++)r.message("Encoding section %d of %d: %o",o+1,t.length,t[o]),n.write(t[o]);var s=n.toBuffer();return r.message("encoded %d bytes",s.length),s},c.decode=function(e){for(var t=new f,n=new i.Reader(e);n.remaining();){var o=n.read();if(r.message("decoding section: %o of type: %o",o,o.descriptor),o.descriptor){var a=s[o.descriptor.value];a?a(t,o):console.warn("WARNING: did not recognise message section with descriptor "+o.descriptor)}else console.warn("WARNING: expected described message section got "+JSON.stringify(o))}return t};var m={};function y(e){var t=i.define_composite(e);t.composite_type=e.name,c[e.name]=t.create,m[Number(t.descriptor.numeric).toString(10)]=t,m[t.descriptor.symbolic]=t,c["is_"+e.name]=function(t){if(t&&t.descriptor){var n=m[t.descriptor.value];if(n)return n.descriptor.numeric===e.code}return!1}}c.unwrap_outcome=function(e){if(e&&e.descriptor){var t=m[e.descriptor.value];if(t)return new t(e.value)}return console.error("unrecognised outcome: "+JSON.stringify(e)),e},c.are_outcomes_equivalent=function(e,t){return void 0===e&&void 0===t||void 0!==e&&void 0!==t&&(e.descriptor.value===t.descriptor.value&&36===e.descriptor.value)},y({name:"received",code:35,fields:[{name:"section_number",type:"uint",mandatory:!0},{name:"section_offset",type:"ulong",mandatory:!0}]}),y({name:"accepted",code:36,fields:[]}),y({name:"rejected",code:37,fields:[{name:"error",type:"error"}]}),y({name:"released",code:38,fields:[]}),y({name:"modified",code:39,fields:[{name:"delivery_failed",type:"boolean"},{name:"undeliverable_here",type:"boolean"},{name:"message_annotations",type:"map"}]}),e.exports=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(10),i=n(35),o=n(63),s=n(90),a=n(129),c=n(48),u=n(28),l=n(65),h=n(49);class d extends l.Entity{constructor(e){if(super(),e||(e={}),null==e.operationTimeoutInSeconds&&(e.operationTimeoutInSeconds=a.defaultOperationTimeoutInSeconds),(t=e)&&"object"==typeof t.container&&"object"==typeof t.rheaConnection)this._connection=e.rheaConnection,this.container=e.container;else{const t=e;if(t.webSocketOptions){const e=u.websocket_connect(t.webSocketOptions.webSocket);t.connection_details=e(t.webSocketOptions.url,t.webSocketOptions.protocol,t.webSocketOptions.options)}this._connection=u.create_connection(t),this.container=s.Container.copyFromContainerInstance(this._connection.container)}var t;this.options=this._connection.options,this.options.operationTimeoutInSeconds=e.operationTimeoutInSeconds,this._initializeEventListeners()}get id(){return this._connection.options.id}get properties(){return this._connection.properties}get maxFrameSize(){return this._connection.max_frame_size}get idleTimeout(){return this._connection.idle_time_out}get channelMax(){return this._connection.channel_max}get error(){return this._connection.error}removeSession(e){return e.remove()}open(e){return new Promise((t,n)=>{if(this.isOpen())return t(this);{let r,o,s;const a=e&&e.abortSignal;let l;const h=()=>{clearTimeout(l),this.actionInitiated--,this._connection.removeListener(u.ConnectionEvents.connectionOpen,r),this._connection.removeListener(u.ConnectionEvents.connectionClose,o),this._connection.removeListener(u.ConnectionEvents.disconnected,o),a&&a.removeEventListener("abort",s)};r=e=>(h(),i.connection("[%s] Resolving the promise with amqp connection.",this.id),t(this)),o=e=>{h();const t=e.error||e.connection.error||Error("Failed to connect");return i.error("[%s] Error occurred while establishing amqp connection: %O",this.id,t),n(t)},s=()=>{h(),this._connection.close();const e=c.createAbortError();return i.error("[%s] [%s]",this.id,e.message),n(e)};const d=()=>{h();const e=`Unable to open the amqp connection "${this.id}" due to operation timeout.`;return i.error("[%s] %s",this.id,e),n(new Error(e))};this._connection.once(u.ConnectionEvents.connectionOpen,r),this._connection.once(u.ConnectionEvents.connectionClose,o),this._connection.once(u.ConnectionEvents.disconnected,o),l=setTimeout(d,1e3*this.options.operationTimeoutInSeconds),i.connection("[%s] Trying to create a new amqp connection.",this.id),this._connection.connect(),this.actionInitiated++,a&&(a.aborted?s():a.addEventListener("abort",s))}})}close(e){return new Promise((t,n)=>{if(i.error("[%s] The connection is open ? -> %s",this.id,this.isOpen()),!this.isOpen())return t();{let r,o,s,a;const l=e&&e.abortSignal;let h;const d=()=>{clearTimeout(h),this.actionInitiated--,this._connection.removeListener(u.ConnectionEvents.connectionError,o),this._connection.removeListener(u.ConnectionEvents.connectionClose,r),this._connection.removeListener(u.ConnectionEvents.disconnected,s),l&&l.removeEventListener("abort",a)};r=e=>(d(),i.connection("[%s] Resolving the promise as the connection has been successfully closed.",this.id),t()),o=e=>(d(),i.error("[%s] Error occurred while closing amqp connection: %O.",this.id,e.connection.error),n(e.connection.error)),s=e=>{d();const t=e.connection&&e.connection.error?e.connection.error:e.error;i.error("[%s] Connection got disconnected while closing itself: %O.",this.id,t)},a=()=>{d();const e=c.createAbortError();return i.error("[%s] [%s]",this.id,e.message),n(e)};const p=()=>{d();const e=`Unable to close the amqp connection "${this.id}" due to operation timeout.`;return i.error("[%s] %s",this.id,e),n(new Error(e))};this._connection.once(u.ConnectionEvents.connectionClose,r),this._connection.once(u.ConnectionEvents.connectionError,o),this._connection.once(u.ConnectionEvents.disconnected,s),h=setTimeout(p,1e3*this.options.operationTimeoutInSeconds),this._connection.close(),this.actionInitiated++,l&&(l.aborted?a():l.addEventListener("abort",a))}})}isOpen(){let e=!1;return this._connection&&this._connection.is_open&&this._connection.is_open()&&(e=!0),e}removeAllSessions(){this._connection&&this._connection.remove_all_sessions()}isRemoteOpen(){return this._connection.is_remote_open()}getError(){return this._connection.get_error()}getPeerCertificate(){return this._connection.get_peer_certificate()}getTlsSocket(){return this._connection.get_tls_socket()}wasCloseInitiated(){return this._connection.is_closed()}createSession(e){return new Promise((t,n)=>{const r=e&&e.abortSignal;let s;if(r){const e=()=>{const e=c.createAbortError();return i.error("[%s] [%s]",this.id,e.message),n(e)};if(s=()=>(y(),a.is_open()?a.close():a.is_closed()||a.once(u.SessionEvents.sessionOpen,()=>{a.close()}),e()),r.aborted)return e();r.addEventListener("abort",s)}const a=this._connection.create_session(),l=new o.Session(this,a);let d,p,f,m;l.actionInitiated++;const y=()=>{clearTimeout(m),l.actionInitiated--,a.removeListener(u.SessionEvents.sessionOpen,d),a.removeListener(u.SessionEvents.sessionClose,p),a.connection.removeListener(u.ConnectionEvents.disconnected,f),r&&r.removeEventListener("abort",s)};d=e=>(y(),i.session("[%s] Resolving the promise with amqp session '%s'.",this.id,l.id),t(l)),p=e=>(y(),i.error("[%s] Error occurred while establishing a session over amqp connection: %O.",this.id,e.session.error),n(e.session.error)),f=e=>{y();const t=e.connection&&e.connection.error?e.connection.error:e.error;return i.error("[%s] Connection got disconnected while creating amqp session '%s': %O.",this.id,l.id,t),n(t)};a.once(u.SessionEvents.sessionOpen,d),a.once(u.SessionEvents.sessionClose,p),a.connection.once(u.ConnectionEvents.disconnected,f),i.session("[%s] Calling amqp session.begin().",this.id),m=setTimeout(()=>{y();const e="Unable to create the amqp session due to operation timeout.";return i.error("[%s] %s",this.id,e),n(new h.OperationTimeoutError(e))},1e3*this.options.operationTimeoutInSeconds),a.begin()})}createSender(e){return r.__awaiter(this,void 0,void 0,(function*(){if(e&&e.session&&e.session.createSender)return e.session.createSender(e);return(yield this.createSession({abortSignal:e&&e.abortSignal})).createSender(e)}))}createAwaitableSender(e){return r.__awaiter(this,void 0,void 0,(function*(){if(e&&e.session&&e.session.createAwaitableSender)return e.session.createAwaitableSender(e);return(yield this.createSession({abortSignal:e&&e.abortSignal})).createAwaitableSender(e)}))}createReceiver(e){return r.__awaiter(this,void 0,void 0,(function*(){if(e&&e.session&&e.session.createReceiver)return e.session.createReceiver(e);return(yield this.createSession({abortSignal:e&&e.abortSignal})).createReceiver(e)}))}createRequestResponseLink(e,t,n={}){return r.__awaiter(this,void 0,void 0,(function*(){if(!e)throw new Error("Please provide sender options.");if(!t)throw new Error("Please provide receiver options.");const{session:r,abortSignal:o}=n,s=r||(yield this.createSession({abortSignal:o})),[a,c]=yield Promise.all([s.createSender(Object.assign({},e,{abortSignal:o})),s.createReceiver(Object.assign({},t,{abortSignal:o}))]);return i.connection("[%s] Successfully created the sender '%s' and receiver '%s' on the same amqp session '%s'.",this.id,a.name,c.name,s.id),{session:s,sender:a,receiver:c}}))}_initializeEventListeners(){for(const e of Object.keys(u.ConnectionEvents))this._connection.on(u.ConnectionEvents[e],t=>{const n={rheaContext:t,emitter:this,eventName:u.ConnectionEvents[e],emitterType:"connection",connectionId:this.id};u.ConnectionEvents[e]===u.ConnectionEvents.protocolError&&i.connection("[%s] ProtocolError is: %O.",this.id,t),c.emitEvent(n)});this._connection.on(u.SenderEvents.senderError,e=>{const t={rheaContext:e,emitter:this,eventName:u.SenderEvents.senderError,emitterType:"connection",connectionId:this.id};c.emitEvent(t)}),this._connection.on(u.SenderEvents.senderClose,e=>{const t={rheaContext:e,emitter:this,eventName:u.SenderEvents.senderClose,emitterType:"connection",connectionId:this.id};c.emitEvent(t)}),this._connection.on(u.ReceiverEvents.receiverError,e=>{const t={rheaContext:e,emitter:this,eventName:u.ReceiverEvents.receiverError,emitterType:"connection",connectionId:this.id};c.emitEvent(t)}),this._connection.on(u.ReceiverEvents.receiverClose,e=>{const t={rheaContext:e,emitter:this,eventName:u.ReceiverEvents.receiverClose,emitterType:"connection",connectionId:this.id};c.emitEvent(t)}),this._connection.on(u.SessionEvents.sessionError,e=>{const t={rheaContext:e,emitter:this,eventName:u.SessionEvents.sessionError,emitterType:"connection",connectionId:this.id};c.emitEvent(t)}),this._connection.on(u.SessionEvents.sessionClose,e=>{const t={rheaContext:e,emitter:this,eventName:u.SessionEvents.sessionClose,emitterType:"connection",connectionId:this.id};c.emitEvent(t)}),"function"==typeof this._connection.eventNames&&i.eventHandler("[%s] rhea-promise 'connection' object is listening for events: %o emitted by rhea's 'connection' object.",this.id,this._connection.eventNames())}}t.Connection=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(10),i=n(35),o=n(88),s=n(66),a=n(28),c=n(48),u=n(65),l=n(49),h=n(89);var d;!function(e){e.sender="sender",e.AwaitableSender="AwaitableSender"}(d||(d={}));class p extends u.Entity{constructor(e,t){super(),this._connection=e,this._session=t,this._initializeEventListeners()}get connection(){return this._connection}get incoming(){return this._session.incoming}get outgoing(){return this._session.outgoing}get error(){return this._session.error}get id(){let e="";const t=this._session;return t.local&&(e+=`local-${t.local.channel}_`),t.remote&&(e+=`remote-${t.remote.channel}_`),e&&(e+=""+this._connection.id),e}isOpen(){let e=!1;return this._connection.isOpen()&&this._session.is_open()&&(e=!0),e}isClosed(){return this._session.is_closed()}isItselfClosed(){return this._session.is_itself_closed()}remove(){this._session&&(this.removeAllListeners(),this._session.removeAllListeners(),this._session.remove())}begin(){this._session&&this._session.begin()}close(e){return r.__awaiter(this,void 0,void 0,(function*(){const t=new Promise((t,n)=>{if(i.error("[%s] The amqp session '%s' is open ? -> %s",this.connection.id,this.id,this.isOpen()),!this.isOpen())return t();{let r,o,s,u;const h=e&&e.abortSignal;let d;const p=()=>{clearTimeout(d),this.actionInitiated--,this._session.removeListener(a.SessionEvents.sessionError,r),this._session.removeListener(a.SessionEvents.sessionClose,o),this._session.connection.removeListener(a.ConnectionEvents.disconnected,s),h&&h.removeEventListener("abort",u)};o=e=>(p(),i.session("[%s] Resolving the promise as the amqp session '%s' has been closed.",this.connection.id,this.id),t()),r=e=>{p(),i.error("[%s] Error occurred while closing amqp session '%s'.",this.connection.id,this.id,e.session.error),n(e.session.error)},s=e=>{p();const t=e.connection&&e.connection.error?e.connection.error:e.error;i.error("[%s] Connection got disconnected while closing amqp session '%s': %O.",this.connection.id,this.id,t)},u=()=>{p();const e=c.createAbortError();return i.error("[%s] [%s]",this.connection.id,e.message),n(e)};const f=()=>{p();const e=`Unable to close the amqp session ${this.id} due to operation timeout.`;i.error("[%s] %s",this.connection.id,e),n(new l.OperationTimeoutError(e))};this._session.once(a.SessionEvents.sessionClose,o),this._session.once(a.SessionEvents.sessionError,r),this._session.connection.once(a.ConnectionEvents.disconnected,s),i.session("[%s] Calling session.close() for amqp session '%s'.",this.connection.id,this.id),d=setTimeout(f,1e3*this.connection.options.operationTimeoutInSeconds),this._session.close(),this.actionInitiated++,h&&(h.aborted?u():h.addEventListener("abort",u))}});try{yield t}finally{this.removeAllListeners()}}))}createReceiver(e){return new Promise((t,n)=>{if(e&&(e.onMessage&&!e.onError||e.onError&&!e.onMessage)&&0!==e.credit_window)return n(new Error("Either provide both 'onMessage' and 'onError' handlers, or please set the credit_window to 0, if you want to provide only the 'onError' handler. This ensures no messages are lost between the receiver getting created  and the 'onMessage' handler being added."));const r=e&&e.abortSignal;let s;if(r){const e=()=>{const e=c.createAbortError();return i.error("[%s] [%s]",this.connection.id,e.message),n(e)};if(s=()=>(y(),u.is_open()?u.close():u.is_closed()||u.once(a.ReceiverEvents.receiverOpen,()=>{u.close()}),e()),r.aborted)return e();r.addEventListener("abort",s)}e&&e.onSessionError&&(this.on(a.SessionEvents.sessionError,e.onSessionError),i.session("[%s] Added event handler for event '%s' on rhea-promise 'session: %s', while creating the 'receiver'.",this.connection.id,a.SessionEvents.sessionError,this.id)),e&&e.onSessionClose&&(this.on(a.SessionEvents.sessionClose,e.onSessionClose),i.session("[%s] Added event handler for event '%s' on rhea-promise 'session: %s',  while creating the 'receiver'.",this.connection.id,a.SessionEvents.sessionClose,this.id));const u=this._session.attach_receiver(e),h=new o.Receiver(this,u,e);let d,p,f,m;h.actionInitiated++,e&&e.onMessage&&(h.on(a.ReceiverEvents.message,e.onMessage),i.receiver("[%s] Added event handler for event '%s' on rhea-promise 'receiver'.",this.connection.id,a.ReceiverEvents.message)),e&&e.onError&&(h.on(a.ReceiverEvents.receiverError,e.onError),i.receiver("[%s] Added event handler for event '%s' on rhea-promise 'receiver'.",this.connection.id,a.ReceiverEvents.receiverError)),e&&e.onClose&&(h.on(a.ReceiverEvents.receiverClose,e.onClose),i.receiver("[%s] Added event handler for event '%s' on rhea-promise 'receiver'.",this.connection.id,a.ReceiverEvents.receiverClose)),e&&e.onSettled&&(h.on(a.ReceiverEvents.settled,e.onSettled),i.receiver("[%s] Added event handler for event '%s' on rhea-promise 'receiver'.",this.connection.id,a.ReceiverEvents.settled));const y=()=>{clearTimeout(m),h.actionInitiated--,u.removeListener(a.ReceiverEvents.receiverOpen,d),u.removeListener(a.ReceiverEvents.receiverClose,p),u.session.connection.removeListener(a.ConnectionEvents.disconnected,f),r&&r.removeEventListener("abort",s)};d=e=>(y(),i.receiver("[%s] Resolving the promise with amqp receiver '%s' on amqp session '%s'.",this.connection.id,h.name,this.id),t(h)),p=e=>(y(),i.error("[%s] Error occurred while creating the amqp receiver '%s' on amqp session '%s' over amqp connection: %O.",this.connection.id,h.name,this.id,e.receiver.error),n(e.receiver.error)),f=e=>{y();const t=e.connection&&e.connection.error?e.connection.error:e.error;return i.error("[%s] Connection got disconnected while creating amqp receiver '%s' on amqp session '%s': %O.",this.connection.id,h.name,this.id,t),n(t)};u.once(a.ReceiverEvents.receiverOpen,d),u.once(a.ReceiverEvents.receiverClose,p),u.session.connection.on(a.ConnectionEvents.disconnected,f),m=setTimeout(()=>{y();const e=`Unable to create the amqp receiver '${h.name}' on amqp session '${this.id}' due to operation timeout.`;return i.error("[%s] %s",this.connection.id,e),n(new l.OperationTimeoutError(e))},1e3*this.connection.options.operationTimeoutInSeconds)})}createSender(e){return this._createSender(d.sender,e)}createAwaitableSender(e){return this._createSender(d.AwaitableSender,e)}_createSender(e,t){return new Promise((n,r)=>{const o=t&&t.abortSignal;let u;if(o){const e=()=>{const e=c.createAbortError();return i.error("[%s] [%s]",this.connection.id,e.message),r(e)};if(u=()=>(_(),p.is_open()?p.close():p.is_closed()||p.once(a.SenderEvents.senderOpen,()=>{p.close()}),e()),o.aborted)return e();o.addEventListener("abort",u)}t&&t.onSessionError&&(this.on(a.SessionEvents.sessionError,t.onSessionError),i.session("[%s] Added event handler for event '%s' on rhea-promise 'session: %s', while creating the sender.",this.connection.id,a.SessionEvents.sessionError,this.id)),t&&t.onSessionClose&&(this.on(a.SessionEvents.sessionClose,t.onSessionClose),i.session("[%s] Added event handler for event '%s' on rhea-promise 'session: %s', while creating the sender.",this.connection.id,a.SessionEvents.sessionClose,this.id));const p=this._session.attach_sender(t);let f,m,y,g,v;f=e===d.sender?new s.Sender(this,p,t):new h.AwaitableSender(this,p,t),f.actionInitiated++,t&&(t.onError&&f.on(a.SenderEvents.senderError,t.onError),t.onClose&&f.on(a.SenderEvents.senderClose,t.onClose),e===d.sender&&(t.onAccepted&&f.on(a.SenderEvents.accepted,t.onAccepted),t.onRejected&&f.on(a.SenderEvents.rejected,t.onRejected),t.onReleased&&f.on(a.SenderEvents.released,t.onReleased),t.onModified&&f.on(a.SenderEvents.modified,t.onModified)));const _=()=>{clearTimeout(v),f.actionInitiated--,p.removeListener(a.SenderEvents.senderOpen,m),p.removeListener(a.SenderEvents.senderClose,y),p.session.connection.removeListener(a.ConnectionEvents.disconnected,g),o&&o.removeEventListener("abort",u)};m=e=>(_(),i.sender("[%s] Resolving the promise with amqp sender '%s' on amqp session '%s'.",this.connection.id,f.name,this.id),n(f)),y=e=>(_(),i.error("[%s] Error occurred while creating the amqp sender '%s' on amqp session '%s' over amqp connection: %O.",this.connection.id,f.name,this.id,e.sender.error),r(e.sender.error)),g=e=>{_();const t=e.connection&&e.connection.error?e.connection.error:e.error;return i.error("[%s] Connection got disconnected while creating amqp sender '%s' on amqp session '%s': %O.",this.connection.id,f.name,this.id,t),r(t)};p.once(a.SenderEvents.sendable,m),p.once(a.SenderEvents.senderClose,y),p.session.connection.on(a.ConnectionEvents.disconnected,g),v=setTimeout(()=>{_();const e=`Unable to create the amqp sender '${f.name}' on amqp session '${this.id}' due to operation timeout.`;return i.error("[%s] %s",this.connection.id,e),r(new l.OperationTimeoutError(e))},1e3*this.connection.options.operationTimeoutInSeconds)})}_initializeEventListeners(){for(const e of Object.keys(a.SessionEvents))this._session.on(a.SessionEvents[e],t=>{const n={rheaContext:t,emitter:this,eventName:a.SessionEvents[e],emitterType:"session",connectionId:this.connection.id};c.emitEvent(n)});this._session.on(a.SenderEvents.senderError,e=>{const t={rheaContext:e,emitter:this,eventName:a.SenderEvents.senderError,emitterType:"session",connectionId:this.connection.id};c.emitEvent(t)}),this._session.on(a.SenderEvents.senderClose,e=>{const t={rheaContext:e,emitter:this,eventName:a.SenderEvents.senderClose,emitterType:"session",connectionId:this.connection.id};c.emitEvent(t)}),this._session.on(a.ReceiverEvents.receiverError,e=>{const t={rheaContext:e,emitter:this,eventName:a.ReceiverEvents.receiverError,emitterType:"session",connectionId:this.connection.id};c.emitEvent(t)}),this._session.on(a.ReceiverEvents.receiverClose,e=>{const t={rheaContext:e,emitter:this,eventName:a.ReceiverEvents.receiverClose,emitterType:"session",connectionId:this.connection.id};c.emitEvent(t)}),"function"==typeof this._session.eventNames&&i.eventHandler("[%s] rhea-promise 'session' object '%s' is listening for events: %o emitted by rhea's 'session' object.",this.connection.id,this.id,this._session.eventNames())}}t.Session=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(10),i=n(35),o=n(28),s=n(48),a=n(65),c=n(49);var u;!function(e){e.sender="sender",e.receiver="receiver"}(u=t.LinkType||(t.LinkType={}));class l extends a.Entity{constructor(e,t,n,r){super(),this.type=e,this._session=t,this._link=n,this.linkOptions=r,this._initializeEventListeners()}get name(){return this._link.name}get error(){return this._link.error}get properties(){return this._link.properties}get sendSettleMode(){return this._link.snd_settle_mode}get receiveSettleMode(){return this._link.rcv_settle_mode}get source(){return this._link.source}set source(e){this._link.set_source(e)}get target(){return this._link.target}set target(e){this._link.set_source(e)}get maxMessageSize(){return this._link.max_message_size}get offeredCapabilities(){return this._link.offered_capabilities}get desiredCapabilities(){return this._link.desired_capabilities}get address(){return this.source.address}get credit(){return this._link.credit}get session(){return this._session}get connection(){return this._session.connection}isOpen(){let e=!1;return this._session.isOpen()&&this._link.is_open()&&(e=!0),e}isRemoteOpen(){return this._link.is_remote_open()}hasCredit(){return this._link.has_credit()}isSender(){return this._link.is_sender()}isReceiver(){return this._link.is_receiver()}isClosed(){return this._link.is_closed()}isItselfClosed(){return this._link.is_itself_closed()}isSessionClosed(){return this._session.isClosed()}isSessionItselfClosed(){return this._session.isItselfClosed()}remove(){this._link&&(this.removeAllListeners(),this._link.removeAllListeners(),this._link.remove()),this._session&&this._session.remove()}close(e){return r.__awaiter(this,void 0,void 0,(function*(){e||(e={}),null==e.closeSession&&(e.closeSession=!0);const t=new Promise((e,t)=>{if(i.error("[%s] The %s '%s' on amqp session '%s' is open ? -> %s",this.connection.id,this.type,this.name,this.session.id,this.isOpen()),!this.isOpen())return e();{const n=this.type===u.sender?o.SenderEvents.senderError:o.ReceiverEvents.receiverError,r=this.type===u.sender?o.SenderEvents.senderClose:o.ReceiverEvents.receiverClose;let s,a,l,h;const d=()=>{clearTimeout(h),this.actionInitiated--,this._link.removeListener(n,s),this._link.removeListener(r,a),this._link.connection.removeListener(o.ConnectionEvents.disconnected,l)};a=t=>(d(),i[this.type]("[%s] Resolving the promise as the %s '%s' on amqp session '%s' has been closed.",this.connection.id,this.type,this.name,this.session.id),e()),s=e=>{d();let n=e.session.error;return this.type===u.sender&&e.sender&&e.sender.error?n=e.sender.error:this.type===u.receiver&&e.receiver&&e.receiver.error&&(n=e.receiver.error),i.error("[%s] Error occurred while closing %s '%s' on amqp session '%s': %O.",this.connection.id,this.type,this.name,this.session.id,n),t(n)},l=e=>{d();const t=e.connection&&e.connection.error?e.connection.error:e.error;i.error("[%s] Connection got disconnected while closing amqp %s '%s' on amqp session '%s': %O.",this.connection.id,this.type,this.name,this.session.id,t)};const p=()=>{d();const e=`Unable to close the ${this.type} '${this.name}' on amqp session '${this.session.id}' due to operation timeout.`;return i.error("[%s] %s",this.connection.id,e),t(new c.OperationTimeoutError(e))};this._link.once(r,a),this._link.once(n,s),this._link.connection.once(o.ConnectionEvents.disconnected,l),h=setTimeout(p,1e3*this.connection.options.operationTimeoutInSeconds),this._link.close(),this.actionInitiated++}});try{yield t}finally{this.removeAllListeners()}if(e.closeSession)return i[this.type]("[%s] %s '%s' has been closed, now closing it's amqp session '%s'.",this.connection.id,this.type,this.name,this.session.id),this._session.close()}))}_initializeEventListeners(){const e=this.type===u.sender?o.SenderEvents:o.ReceiverEvents;for(const t of Object.keys(e))this._link.on(e[t],n=>{const r={rheaContext:n,emitter:this,eventName:e[t],emitterType:this.type,connectionId:this.connection.id};s.emitEvent(r)});"function"==typeof this._link.eventNames&&i.eventHandler("[%s] rhea-promise '%s' object is listening for events: %o emitted by rhea's '%s' object.",this.connection.id,this.type,this._link.eventNames(),this.type),"function"==typeof this._link.listenerCount&&i.eventHandler("[%s] ListenerCount for event '%s_error' on rhea's '%s' object is: %d.",this.connection.id,this.type,this.type,this._link.listenerCount(this.type+"_error"))}}t.Link=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(21);class i extends r.EventEmitter{constructor(){super(),this.actionInitiated=0}}t.Entity=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(64);class i extends r.Link{constructor(e,t,n){super(r.LinkType.sender,e,t,n)}setDrained(e){this._link.set_drained(e)}sendable(){return this._link.sendable()}}t.BaseSender=i;t.SenderSendOptions=class{};t.Sender=class extends i{constructor(e,t,n){super(e,t,n)}send(e,t={}){return this._link.send(e,t.tag,t.format)}}},function(e,t,n){"use strict";var r=SyntaxError,i=Function,o=TypeError,s=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(e){}},a=Object.getOwnPropertyDescriptor;if(a)try{a({},"")}catch(e){a=null}var c=function(){throw new o},u=a?function(){try{return c}catch(e){try{return a(arguments,"callee").get}catch(e){return c}}}():c,l=n(132)(),h=Object.getPrototypeOf||function(e){return e.__proto__},d={},p="undefined"==typeof Uint8Array?void 0:h(Uint8Array),f={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":l?h([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":d,"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":d,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":d,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":l?h(h([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&l?h((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&l?h((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":l?h(""[Symbol.iterator]()):void 0,"%Symbol%":l?Symbol:void 0,"%SyntaxError%":r,"%ThrowTypeError%":u,"%TypedArray%":p,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},m={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},y=n(68),g=n(135),v=y.call(Function.call,Array.prototype.concat),_=y.call(Function.apply,Array.prototype.splice),b=y.call(Function.call,String.prototype.replace),w=y.call(Function.call,String.prototype.slice),E=y.call(Function.call,RegExp.prototype.exec),S=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,k=/\\(\\)?/g,O=function(e){var t=w(e,0,1),n=w(e,-1);if("%"===t&&"%"!==n)throw new r("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new r("invalid intrinsic syntax, expected opening `%`");var i=[];return b(e,S,(function(e,t,n,r){i[i.length]=n?b(r,k,"$1"):t||e})),i},T=function(e,t){var n,i=e;if(g(m,i)&&(i="%"+(n=m[i])[0]+"%"),g(f,i)){var a=f[i];if(a===d&&(a=function e(t){var n;if("%AsyncFunction%"===t)n=s("async function () {}");else if("%GeneratorFunction%"===t)n=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=s("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&(n=h(i.prototype))}return f[t]=n,n}(i)),void 0===a&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:a}}throw new r("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new o('"allowMissing" argument must be a boolean');if(null===E(/^%?[^%]*%?$/g,e))throw new r("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=O(e),i=n.length>0?n[0]:"",s=T("%"+i+"%",t),c=s.name,u=s.value,l=!1,h=s.alias;h&&(i=h[0],_(n,v([0,1],h)));for(var d=1,p=!0;d<n.length;d+=1){var m=n[d],y=w(m,0,1),b=w(m,-1);if(('"'===y||"'"===y||"`"===y||'"'===b||"'"===b||"`"===b)&&y!==b)throw new r("property names with quotes must have matching quotes");if("constructor"!==m&&p||(l=!0),g(f,c="%"+(i+="."+m)+"%"))u=f[c];else if(null!=u){if(!(m in u)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(a&&d+1>=n.length){var S=a(u,m);u=(p=!!S)&&"get"in S&&!("originalValue"in S.get)?S.get:u[m]}else p=g(u,m),u=u[m];p&&!l&&(f[c]=u)}}return u}},function(e,t,n){"use strict";var r=n(134);e.exports=Function.prototype.bind||r},function(e,t,n){"use strict";var r=String.prototype.replace,i=/%20/g,o="RFC1738",s="RFC3986";e.exports={default:s,formatters:{RFC1738:function(e){return r.call(e,i,"+")},RFC3986:function(e){return String(e)}},RFC1738:o,RFC3986:s}},function(e,t,n){"use strict";(function(t){var r=n(36),i=n(8),o=n(19),s=r.Tap,a=o.debuglog("avsc:types"),c=o.format,u={array:x,boolean:g,bytes:S,double:w,enum:C,error:R,fixed:I,float:b,int:v,long:_,map:A,null:y,record:R,string:E},l=new r.Lcg,h=new s(new i.SlowBuffer(1024)),d=null,p=[];function f(e,t){var n;if(d?(n=d,p.push([d,this]),d=null):n=this,this._hash=new M,this.name=void 0,this.aliases=void 0,this.doc=e&&e.doc?""+e.doc:void 0,e){var r=e.name,i=void 0===e.namespace?t&&t.namespace:e.namespace;if(void 0!==r){if(B(r=W(r,i)))throw new Error(c("cannot rename primitive type: %j",r));var o=t&&t.registry;if(o){if(void 0!==o[r])throw new Error(c("duplicate type name: %s",r));o[r]=n}}else if(t&&t.noAnonymousTypes)throw new Error(c("missing name property in schema: %j",e));this.name=r,this.aliases=e.aliases?e.aliases.map((function(e){return W(e,i)})):[]}}function m(e){f.call(this),this._branchConstructor=this._createBranchConstructor(),e||Object.freeze(this)}function y(){m.call(this)}function g(){m.call(this)}function v(){m.call(this)}function _(){m.call(this)}function b(){m.call(this)}function w(){m.call(this)}function E(){m.call(this)}function S(){m.call(this)}function k(e,t){if(f.call(this),!Array.isArray(e))throw new Error(c("non-array union schema: %j",e));if(!e.length)throw new Error("empty union");this.types=Object.freeze(e.map((function(e){return f.forSchema(e,t)}))),this._branchIndices={},this.types.forEach((function(e,t){if(f.isType(e,"union"))throw new Error("unions cannot be directly nested");var n=e.branchName;if(void 0!==this._branchIndices[n])throw new Error(c("duplicate union branch name: %j",n));this._branchIndices[n]=t}),this)}function O(e,t){k.call(this,e,t),this._dynamicBranches=null,this._bucketIndices={},this.types.forEach((function(e,t){if(f.isType(e,"abstract","logical"))this._dynamicBranches||(this._dynamicBranches=[]),this._dynamicBranches.push({index:t,type:e});else{var n=V(e);if(void 0!==this._bucketIndices[n])throw new Error(c("ambiguous unwrapped union: %j",this));this._bucketIndices[n]=t}}),this),Object.freeze(this)}function T(e,t){k.call(this,e,t),Object.freeze(this)}function C(e,t){if(f.call(this,e,t),!Array.isArray(e.symbols)||!e.symbols.length)throw new Error(c("invalid enum symbols: %j",e.symbols));if(this.symbols=Object.freeze(e.symbols.slice()),this._indices={},this.symbols.forEach((function(e,t){if(!r.isValidName(e))throw new Error(c("invalid %s symbol: %j",this,e));if(void 0!==this._indices[e])throw new Error(c("duplicate %s symbol: %j",this,e));this._indices[e]=t}),this),this.default=e.default,void 0!==this.default&&void 0===this._indices[this.default])throw new Error(c("invalid %s default: %j",this,this.default));this._branchConstructor=this._createBranchConstructor(),Object.freeze(this)}function I(e,t){if(f.call(this,e,t),e.size!==(0|e.size)||e.size<0)throw new Error(c("invalid %s size",this.branchName));this.size=0|e.size,this._branchConstructor=this._createBranchConstructor(),Object.freeze(this)}function A(e,t){if(f.call(this),!e.values)throw new Error(c("missing map values: %j",e));this.valuesType=f.forSchema(e.values,t),this._branchConstructor=this._createBranchConstructor(),Object.freeze(this)}function x(e,t){if(f.call(this),!e.items)throw new Error(c("missing array items: %j",e));this.itemsType=f.forSchema(e.items,t),this._branchConstructor=this._createBranchConstructor(),Object.freeze(this)}function R(e,t){var n=(t=t||{}).namespace;if(void 0!==e.namespace)t.namespace=e.namespace;else if(e.name){var i=r.impliedNamespace(e.name);void 0!==i&&(t.namespace=i)}if(f.call(this,e,t),!Array.isArray(e.fields))throw new Error(c("non-array record fields: %j",e.fields));if(r.hasDuplicates(e.fields,(function(e){return e.name})))throw new Error(c("duplicate field name: %j",e.fields));this._fieldsByName={},this.fields=Object.freeze(e.fields.map((function(e){var n=new j(e,t);return this._fieldsByName[n.name]=n,n}),this)),this._branchConstructor=this._createBranchConstructor(),this._isError="error"===e.type,this.recordConstructor=this._createConstructor(t.errorStackTraces,t.omitRecordMethods),this._read=this._createReader(),this._skip=this._createSkipper(),this._write=this._createWriter(),this._check=this._createChecker(),t.namespace=n,Object.freeze(this)}function P(e,t){this._logicalTypeName=e.logicalType,f.call(this),d=this;try{this._underlyingType=f.forSchema(e,t)}finally{d=null;var n=p.length;n&&p[n-1][0]===this&&p.pop()}f.isType(this.underlyingType,"union")?this._branchConstructor=this.underlyingType._branchConstructor:this._branchConstructor=this.underlyingType._createBranchConstructor()}function N(e){this._concreteTypeName="long",m.call(this,!0),this._noUnpack=!!e}function j(e,t){var n=e.name;if("string"!=typeof n||!r.isValidName(n))throw new Error(c("invalid field name: %s",n));this.name=n,this.type=f.forSchema(e.type,t),this.aliases=e.aliases||[],this.doc=void 0!==e.doc?""+e.doc:void 0,this._order=function(e){switch(e){case"ascending":return 1;case"descending":return-1;case"ignore":return 0;default:throw new Error(c("invalid order: %j",e))}}(void 0===e.order?"ascending":e.order);var i=e.default;if(void 0!==i){var o=this.type,s=o._copy(i,{coerce:2,wrap:2});B(o.typeName)&&"bytes"!==o.typeName?this.defaultValue=function(){return s}:this.defaultValue=function(){return o._copy(s)}}Object.freeze(this)}function L(e){this._readerType=e,this._read=null,this.itemsType=null,this.size=0,this.symbols=null,this.valuesType=null}function M(){this.str=void 0}function q(e,t,n,r){if(n){if(n._readerType!==e)throw new Error("invalid resolver");return n._read(t,r)}return e._read(t)}function z(e){var t={};e.name&&(t[e.name]=!0);var n,r,i=e.aliases;for(n=0,r=i.length;n<r;n++)t[i[n]]=!0;return Object.keys(t)}function U(e,t,n){if(!t.name)return!0;var i,o,s,a=n?t.name:r.unqualify(t.name),c=z(e);for(i=0,o=c.length;i<o;i++)if(s=c[i],n||(s=r.unqualify(s)),s===a)return!0;return!1}function B(e){var t=u[e];return t&&t.prototype instanceof m}function D(e){if("error"===e)e="record";else{var t=/^([^:]+):(.*)$/.exec(e);t&&(e="union"===t[1]?t[2]+"Union":t[1])}return r.capitalize(e)+"Type"}function F(e){var t=e.readLong();return t<0&&(t=-t,e.skipLong()),t}function H(e){return e>=-9007199254740990&&e<=9007199254740990}function $(e){return e&&"Buffer"===e.type&&Array.isArray(e.data)}function K(e,t){throw new Error(c("invalid %j: %j",t.schema(),e))}function W(e,t){var n=r.unqualify(e);return B(n)?n:r.qualify(e,t)}function V(e){var t=e.typeName;switch(t){case"double":case"float":case"int":case"long":return"number";case"bytes":case"fixed":return"buffer";case"enum":return"string";case"map":case"error":case"record":return"object";default:return t}}function G(e){if(null===e)return"null";var n=typeof e;if("object"===n){if(Array.isArray(e))return"array";if(t.isBuffer(e))return"buffer"}return n}f.forSchema=function(e,t){(t=t||{}).registry=t.registry||{};var n,r=function(e){switch(!0===e?e="always":!1===e?e="never":void 0===e?e="auto":"string"==typeof e&&(e=e.toLowerCase()),e){case"always":return T;case"never":return O;case"auto":return;default:throw new Error(c("invalid wrap unions option: %j",e))}}(t.wrapUnions);if(null===e)throw new Error('invalid type: null (did you mean "null"?)');if(f.isType(e))return e;if(t.typeHook&&(n=t.typeHook(e,t))){if(!f.isType(n))throw new Error(c("invalid typehook return value: %j",n));return n}if("string"==typeof e){if(e=W(e,t.namespace),n=t.registry[e])return n;if(B(e))return t.registry[e]=f.forSchema({type:e},t);throw new Error(c("undefined type name: %s",e))}if(e.logicalType&&t.logicalTypes&&!d){var i=t.logicalTypes[e.logicalType];if(i){var o=t.namespace,s={};Object.keys(t.registry).forEach((function(e){s[e]=t.registry[e]}));try{return a("instantiating logical type for %s",e.logicalType),new i(e,t)}catch(n){if(a("failed to instantiate logical type for %s",e.logicalType),t.assertLogicalTypes)throw n;d=null,t.namespace=o,t.registry=s}}}if(Array.isArray(e)){var l=d;d=null;var h=e.map((function(e){return f.forSchema(e,t)}));r||(r=function(e){var t,n,r,i,o={};for(t=0,n=e.length;t<n;t++)if(i=e[t],!f.isType(i,"logical")){if(r=V(i),o[r])return!0;o[r]=!0}return!1}(h)?T:O),d=l,n=new r(h,t)}else n=function(n){var r=u[n];if(void 0===r)throw new Error(c("unknown type: %j",n));return new r(e,t)}(e.type);return n},f.forValue=function(e,n){if((n=n||{}).emptyArrayType=n.emptyArrayType||f.forSchema({type:"array",items:"null"}),n.valueHook){var i=n.valueHook(e,n);if(void 0!==i){if(!f.isType(i))throw new Error(c("invalid value hook return value: %j",i));return i}}switch(typeof e){case"string":return f.forSchema("string",n);case"boolean":return f.forSchema("boolean",n);case"number":return(0|e)===e?f.forSchema("int",n):Math.abs(e)<9007199254740991?f.forSchema("float",n):f.forSchema("double",n);case"object":if(null===e)return f.forSchema("null",n);if(Array.isArray(e))return e.length?f.forSchema({type:"array",items:f.forTypes(e.map((function(e){return f.forValue(e,n)})),n)},n):n.emptyArrayType;if(t.isBuffer(e))return f.forSchema("bytes",n);var o=Object.keys(e);return o.some((function(e){return!r.isValidName(e)}))?f.forSchema({type:"map",values:f.forTypes(o.map((function(t){return f.forValue(e[t],n)})),n)},n):f.forSchema({type:"record",fields:o.map((function(t){return{name:t,type:f.forValue(e[t],n)}}))},n);default:throw new Error(c("cannot infer type from: %j",e))}},f.forTypes=function(e,t){if(!e.length)throw new Error("no types to combine");if(1===e.length)return e[0];t=t||{};var n=[],r=0,i=!0;if(e.forEach((function(e){switch(e.typeName){case"union:unwrapped":i=!1,n=n.concat(e.types);break;case"union:wrapped":r++,n=n.concat(e.types);break;case"null":n.push(e);break;default:i=!1,n.push(e)}})),r){if(!i)throw new Error("cannot combine wrapped union");var o={};n.forEach((function(e){var t=e.branchName,n=o[t];if(n){if(!e.equals(n))throw new Error("inconsistent branch type")}else o[t]=e}));var s,a=t.wrapUnions;t.wrapUnions=!0;try{s=f.forSchema(Object.keys(o).map((function(e){return o[e]})),t)}catch(e){throw t.wrapUnions=a,e}return t.wrapUnions=a,s}var c={};n.forEach((function(e){var t=V(e),n=c[t];n||(c[t]=n=[]),n.push(e)}));var u=Object.keys(c).map((function(e){var n=c[e];if(1===n.length)return n[0];switch(e){case"null":case"boolean":return n[0];case"number":return function(e){var t,n,r,i,o=["int","long","float","double"],s=-1,a=null;for(t=0,n=e.length;t<n;t++)r=e[t],(i=o.indexOf(r.typeName))>s&&(s=i,a=r);return a}(n);case"string":return function(e,t){var n,r,i,o,s={};for(n=0,r=e.length;n<r;n++){if("string"===(i=e[n]).typeName)return i;var a,c;for(o=i.symbols,a=0,c=o.length;a<c;a++)s[o[a]]=!0}return f.forSchema({type:"enum",symbols:Object.keys(s)},t)}(n,t);case"buffer":return function(e,t){var n,r,i,o=-1;for(n=0,r=e.length;n<r;n++){if("bytes"===(i=e[n]).typeName)return i;-1===o?o=i.size:i.size!==o&&(o=-2)}return o<0?f.forSchema("bytes",t):e[0]}(n,t);case"array":return(n=n.filter((function(e){return e!==t.emptyArrayType}))).length?f.forSchema({type:"array",items:f.forTypes(n.map((function(e){return e.itemsType})),t)},t):t.emptyArrayType;default:return function(e,t){var n,r,i,o,s,a=[],c={},u={},l=!0;for(n=0,r=e.length;n<r;n++){var h,d,p,m,y,g;if("map"===(i=e[n]).typeName)l=!1,a.push(i.valuesType);else for(o=i.fields,h=0,d=o.length;h<d;h++)p=o[h],y=p.name,g=p.type,a.push(g),l&&(c[y]||(c[y]=[]),c[y].push(g),void 0!==(m=p.defaultValue())&&(u[y]=m))}if(l){var v=Object.keys(c);for(n=0,r=v.length;n<r;n++)y=v[n],c[y].length<e.length&&void 0===u[y]&&(t&&t.strictDefaults?l=!1:(c[y].unshift(f.forSchema("null",t)),u[y]=null))}s=l?{type:"record",fields:v.map((function(e){var n=f.forTypes(c[e],t),r=u[e];if(void 0!==r&&~n.typeName.indexOf("union")){var i,o,s=n.types.slice();for(i=0,o=s.length;i<o&&!s[i].isValid(r);i++);if(i>0){var a=s[0];s[0]=s[i],s[i]=a,n=f.forSchema(s,t)}}return{name:e,type:n,default:u[e]}}))}:{type:"map",values:f.forTypes(a,t)};return f.forSchema(s,t)}(n,t)}}));return 1===u.length?u[0]:f.forSchema(u,t)},f.isType=function(){var e=arguments.length;if(!e)return!1;var t=arguments[0];if(!t||"function"!=typeof t._update||"function"!=typeof t.fingerprint)return!1;if(1===e)return!0;var n,r=t.typeName;for(n=1;n<e;n++)if(0===r.indexOf(arguments[n]))return!0;return!1},f.__reset=function(e){a("resetting type buffer to %d",e),h.buf=new i.SlowBuffer(e)},Object.defineProperty(f.prototype,"branchName",{enumerable:!0,get:function(){var e=f.isType(this,"logical")?this.underlyingType:this;return e.name?e.name:f.isType(e,"abstract")?e._concreteTypeName:f.isType(e,"union")?void 0:e.typeName}}),f.prototype.clone=function(e,t){return t?(t={coerce:0|!!t.coerceBuffers,fieldHook:t.fieldHook,qualifyNames:!!t.qualifyNames,skip:!!t.skipMissingFields,wrap:0|!!t.wrapUnions},this._copy(e,t)):this.fromBuffer(this.toBuffer(e))},f.prototype.compare=r.abstractFunction,f.prototype.compareBuffers=function(e,t){return this._match(new s(e),new s(t))},f.prototype.createResolver=function(e,t){if(!f.isType(e))throw new Error(c("not a type: %j",e));if(!f.isType(this,"union","logical")&&f.isType(e,"logical"))return this.createResolver(e.underlyingType,t);var n,r;if((t=t||{}).registry=t.registry||{},f.isType(this,"record","error")&&f.isType(e,"record","error")&&(r=this.name+":"+e.name,n=t.registry[r]))return n;if(n=new L(this),r&&(t.registry[r]=n),f.isType(e,"union")){var i=e.types.map((function(e){return this.createResolver(e,t)}),this);n._read=function(e){var t=e.readLong();if(void 0===i[t])throw new Error(c("invalid union index: %s",t));return i[t]._read(e)}}else this._update(n,e,t);if(!n._read)throw new Error(c("cannot read %s as %s",e,this));return Object.freeze(n)},f.prototype.decode=function(e,t,n){var r=new s(e,t),i=q(this,r,n);return r.isValid()?{value:i,offset:r.pos}:{value:void 0,offset:-1}},f.prototype.encode=function(e,t,n){var r=new s(t,n);return this._write(r,e),r.isValid()?r.pos:t.length-r.pos},f.prototype.equals=function(e,t){var n=f.isType(e)&&this.fingerprint().equals(e.fingerprint());return n&&t&&t.strict?JSON.stringify(this.schema({exportAttrs:!0}))===JSON.stringify(e.schema({exportAttrs:!0})):n},f.prototype.fingerprint=function(e){if(e)return r.getHash(JSON.stringify(this.schema()),e);if(!this._hash.str){var t=JSON.stringify(this.schema());this._hash.str=r.getHash(t).toString("binary")}return r.bufferFrom(this._hash.str,"binary")},f.prototype.fromBuffer=function(e,t,n){var r=new s(e),i=q(this,r,t,n);if(!r.isValid())throw new Error("truncated buffer");if(!n&&r.pos<e.length)throw new Error("trailing data");return i},f.prototype.fromString=function(e){return this._copy(JSON.parse(e),{coerce:2})},f.prototype.inspect=function(){var e=this.typeName,t=D(e);if(B(e))return c("<%s>",t);var n=this.schema({exportAttrs:!0,noDeref:!0});return"object"!=typeof n||f.isType(this,"logical")||(n.type=void 0),c("<%s %j>",t,n)},f.prototype.isValid=function(e,t){var n,r,i=0|(t&&t.noUndeclaredFields),o=t&&t.errorHook;return o&&(r=[],n=function(t,n){o.call(this,r.slice(),t,n,e)}),this._check(e,i,n,r)},f.prototype.random=r.abstractFunction,f.prototype.schema=function(e){return this._attrs({exportAttrs:!(!e||!e.exportAttrs),noDeref:!(!e||!e.noDeref)})},f.prototype.toBuffer=function(e){h.pos=0,this._write(h,e);var t=r.newBuffer(h.pos);return h.isValid()?h.buf.copy(t,0,0,h.pos):this._write(new s(t),e),t},f.prototype.toJSON=function(){return this.schema({exportAttrs:!0})},f.prototype.toString=function(e){return void 0===e?JSON.stringify(this.schema({noDeref:!0})):JSON.stringify(this._copy(e,{coerce:3}))},f.prototype.wrap=function(e){var t=this._branchConstructor;return null===t?null:new t(e)},f.prototype._attrs=function(e){e.derefed=e.derefed||{};var t=this.name;if(void 0!==t){if(e.noDeref||e.derefed[t])return t;e.derefed[t]=!0}var n={};void 0!==this.name&&(n.name=t),n.type=this.typeName;var r=this._deref(n,e);return void 0!==r&&(n=r),e.exportAttrs&&(this.aliases&&this.aliases.length&&(n.aliases=this.aliases),void 0!==this.doc&&(n.doc=this.doc)),n},f.prototype._createBranchConstructor=function(){var e=this.branchName;if("null"===e)return null;var t=~e.indexOf(".")?"this['"+e+"']":"this."+e,n=new Function("return function Branch$(val) { "+t+" = val; };")();return n.type=this,n.prototype.unwrap=new Function("return "+t+";"),n.prototype.unwrapped=n.prototype.unwrap,n},f.prototype._peek=function(e){var t=e.pos,n=this._read(e);return e.pos=t,n},f.prototype._check=r.abstractFunction,f.prototype._copy=r.abstractFunction,f.prototype._deref=r.abstractFunction,f.prototype._match=r.abstractFunction,f.prototype._read=r.abstractFunction,f.prototype._skip=r.abstractFunction,f.prototype._update=r.abstractFunction,f.prototype._write=r.abstractFunction,f.prototype.getAliases=function(){return this.aliases},f.prototype.getFingerprint=f.prototype.fingerprint,f.prototype.getName=function(e){return this.name||!e?this.name:this.branchName},f.prototype.getSchema=f.prototype.schema,f.prototype.getTypeName=function(){return this.typeName},o.inherits(m,f),m.prototype._update=function(e,t){t.typeName===this.typeName&&(e._read=this._read)},m.prototype._copy=function(e){return this._check(e,void 0,K),e},m.prototype._deref=function(){return this.typeName},m.prototype.compare=r.compare,o.inherits(y,m),y.prototype._check=function(e,t,n){var r=null===e;return!r&&n&&n(e,this),r},y.prototype._read=function(){return null},y.prototype._skip=function(){},y.prototype._write=function(e,t){null!==t&&K(t,this)},y.prototype._match=function(){return 0},y.prototype.compare=y.prototype._match,y.prototype.typeName="null",y.prototype.random=y.prototype._read,o.inherits(g,m),g.prototype._check=function(e,t,n){var r="boolean"==typeof e;return!r&&n&&n(e,this),r},g.prototype._read=function(e){return e.readBoolean()},g.prototype._skip=function(e){e.skipBoolean()},g.prototype._write=function(e,t){"boolean"!=typeof t&&K(t,this),e.writeBoolean(t)},g.prototype._match=function(e,t){return e.matchBoolean(t)},g.prototype.typeName="boolean",g.prototype.random=function(){return l.nextBoolean()},o.inherits(v,m),v.prototype._check=function(e,t,n){var r=e===(0|e);return!r&&n&&n(e,this),r},v.prototype._read=function(e){return e.readInt()},v.prototype._skip=function(e){e.skipInt()},v.prototype._write=function(e,t){t!==(0|t)&&K(t,this),e.writeInt(t)},v.prototype._match=function(e,t){return e.matchInt(t)},v.prototype.typeName="int",v.prototype.random=function(){return 0|l.nextInt(1e3)},o.inherits(_,m),_.prototype._check=function(e,t,n){var r="number"==typeof e&&e%1==0&&H(e);return!r&&n&&n(e,this),r},_.prototype._read=function(e){var t=e.readLong();if(!H(t))throw new Error("potential precision loss");return t},_.prototype._skip=function(e){e.skipLong()},_.prototype._write=function(e,t){("number"!=typeof t||t%1||!H(t))&&K(t,this),e.writeLong(t)},_.prototype._match=function(e,t){return e.matchLong(t)},_.prototype._update=function(e,t){switch(t.typeName){case"int":e._read=t._read;break;case"abstract:long":case"long":e._read=this._read}},_.prototype.typeName="long",_.prototype.random=function(){return l.nextInt()},_.__with=function(e,t){e=e||{};var n={toBuffer:"_toBuffer",fromBuffer:"_fromBuffer",fromJSON:"_fromJSON",toJSON:"_toJSON",isValid:"_isValid",compare:"compare"},r=new N(t);return Object.keys(n).forEach((function(t){if(void 0===e[t])throw new Error(c("missing method implementation: %s",t));r[n[t]]=e[t]})),Object.freeze(r)},o.inherits(b,m),b.prototype._check=function(e,t,n){var r="number"==typeof e;return!r&&n&&n(e,this),r},b.prototype._read=function(e){return e.readFloat()},b.prototype._skip=function(e){e.skipFloat()},b.prototype._write=function(e,t){"number"!=typeof t&&K(t,this),e.writeFloat(t)},b.prototype._match=function(e,t){return e.matchFloat(t)},b.prototype._update=function(e,t){switch(t.typeName){case"float":case"int":e._read=t._read;break;case"abstract:long":case"long":e._read=function(e){return e.readLong()}}},b.prototype.typeName="float",b.prototype.random=function(){return l.nextFloat(1e3)},o.inherits(w,m),w.prototype._check=function(e,t,n){var r="number"==typeof e;return!r&&n&&n(e,this),r},w.prototype._read=function(e){return e.readDouble()},w.prototype._skip=function(e){e.skipDouble()},w.prototype._write=function(e,t){"number"!=typeof t&&K(t,this),e.writeDouble(t)},w.prototype._match=function(e,t){return e.matchDouble(t)},w.prototype._update=function(e,t){switch(t.typeName){case"double":case"float":case"int":e._read=t._read;break;case"abstract:long":case"long":e._read=function(e){return e.readLong()}}},w.prototype.typeName="double",w.prototype.random=function(){return l.nextFloat()},o.inherits(E,m),E.prototype._check=function(e,t,n){var r="string"==typeof e;return!r&&n&&n(e,this),r},E.prototype._read=function(e){return e.readString()},E.prototype._skip=function(e){e.skipString()},E.prototype._write=function(e,t){"string"!=typeof t&&K(t,this),e.writeString(t)},E.prototype._match=function(e,t){return e.matchString(t)},E.prototype._update=function(e,t){switch(t.typeName){case"bytes":case"string":e._read=this._read}},E.prototype.typeName="string",E.prototype.random=function(){return l.nextString(l.nextInt(32))},o.inherits(S,m),S.prototype._check=function(e,n,r){var i=t.isBuffer(e);return!i&&r&&r(e,this),i},S.prototype._read=function(e){return e.readBytes()},S.prototype._skip=function(e){e.skipBytes()},S.prototype._write=function(e,n){t.isBuffer(n)||K(n,this),e.writeBytes(n)},S.prototype._match=function(e,t){return e.matchBytes(t)},S.prototype._update=E.prototype._update,S.prototype._copy=function(e,t){var n;switch(0|(t&&t.coerce)){case 3:return this._check(e,void 0,K),e.toString("binary");case 2:if("string"!=typeof e)throw new Error(c("cannot coerce to buffer: %j",e));return n=r.bufferFrom(e,"binary"),this._check(n,void 0,K),n;case 1:if(!$(e))throw new Error(c("cannot coerce to buffer: %j",e));return n=r.bufferFrom(e.data),this._check(n,void 0,K),n;default:return this._check(e,void 0,K),r.bufferFrom(e)}},S.prototype.compare=t.compare,S.prototype.typeName="bytes",S.prototype.random=function(){return l.nextBuffer(l.nextInt(32))},o.inherits(k,f),k.prototype._branchConstructor=function(){throw new Error("unions cannot be directly wrapped")},k.prototype._skip=function(e){this.types[e.readLong()]._skip(e)},k.prototype._match=function(e,t){var n=e.readLong(),r=t.readLong();return n===r?this.types[n]._match(e,t):n<r?-1:1},k.prototype._deref=function(e,t){return this.types.map((function(e){return e._attrs(t)}))},k.prototype.getTypes=function(){return this.types},o.inherits(O,k),O.prototype._getIndex=function(e){var t=this._bucketIndices[G(e)];return this._dynamicBranches&&(t=this._getBranchIndex(e,t)),t},O.prototype._getBranchIndex=function(e,t){var n,r,i,o=this._dynamicBranches;for(n=0,r=o.length;n<r;n++)if((i=o[n]).type._check(e)){if(void 0!==t)throw new Error("ambiguous conversion");t=i.index}return t},O.prototype._check=function(e,t,n,r){var i=this._getIndex(e),o=void 0!==i;return o?this.types[i]._check(e,t,n,r):(n&&n(e,this),o)},O.prototype._read=function(e){var t=e.readLong(),n=this.types[t];if(n)return n._read(e);throw new Error(c("invalid union index: %s",t))},O.prototype._write=function(e,t){var n=this._getIndex(t);void 0===n&&K(t,this),e.writeLong(n),null!==t&&this.types[n]._write(e,t)},O.prototype._update=function(e,t,n){var r,i,o;for(r=0,i=this.types.length;r<i;r++){try{o=this.types[r].createResolver(t,n)}catch(e){continue}return void(e._read=function(e){return o._read(e)})}},O.prototype._copy=function(e,t){var n,r=t&&0|t.coerce,i=t&&0|t.wrap;if(2===i)n=0;else{switch(r){case 1:n=$(e)&&void 0!==this._bucketIndices.buffer?this._bucketIndices.buffer:this._getIndex(e);break;case 2:if(null===e)n=this._bucketIndices.null;else if("object"==typeof e){var o=Object.keys(e);1===o.length&&(n=this._branchIndices[o[0]],e=e[o[0]])}break;default:n=this._getIndex(e)}void 0===n&&K(e,this)}var s=this.types[n];if(null===e||3===i)return s._copy(e,t);switch(r){case 3:var a={};return a[s.branchName]=s._copy(e,t),a;default:return s._copy(e,t)}},O.prototype.compare=function(e,t){var n=this._getIndex(e),i=this._getIndex(t);if(void 0===n)K(e,this);else{if(void 0!==i)return n===i?this.types[n].compare(e,t):r.compare(n,i);K(t,this)}},O.prototype.typeName="union:unwrapped",O.prototype.random=function(){var e=l.nextInt(this.types.length);return this.types[e].random()},o.inherits(T,k),T.prototype._check=function(e,t,n,r){var i=!1;if(null===e)i=void 0!==this._branchIndices.null;else if("object"==typeof e){var o=Object.keys(e);if(1===o.length){var s=o[0],a=this._branchIndices[s];if(void 0!==a)return n?(r.push(s),i=this.types[a]._check(e[s],t,n,r),r.pop(),i):this.types[a]._check(e[s],t)}}return!i&&n&&n(e,this),i},T.prototype._read=function(e){var t=this.types[e.readLong()];if(!t)throw new Error(c("invalid union index"));var n=t._branchConstructor;return null===n?null:new n(t._read(e))},T.prototype._write=function(e,t){var n,r,i;null===t?(void 0===(n=this._branchIndices.null)&&K(t,this),e.writeLong(n)):(1===(r=Object.keys(t)).length&&(i=r[0],n=this._branchIndices[i]),void 0===n&&K(t,this),e.writeLong(n),this.types[n]._write(e,t[i]))},T.prototype._update=function(e,t,n){var r,i,o,s;for(r=0,i=this.types.length;r<i;r++){try{o=this.types[r].createResolver(t,n)}catch(e){continue}return s=this.types[r]._branchConstructor,void(e._read=s?function(e){return new s(o._read(e))}:function(){return null})}},T.prototype._copy=function(e,t){var n,i,o,s=t&&0|t.wrap;if(2===s){var a=this.types[0];return null===e&&"null"===a.typeName?null:new a._branchConstructor(a._copy(e,t))}if(null===e&&void 0!==this._branchIndices.null)return null;if("object"==typeof e){var c=Object.keys(e);if(1===c.length){var u,l,h=c[0];if(void 0===(n=this._branchIndices[h])&&t.qualifyNames)for(u=0,i=this.types.length;u<i;u++)if((l=this.types[u]).name&&h===r.unqualify(l.name)){n=u;break}void 0!==n&&(o=this.types[n]._copy(e[h],t))}}if(1===s&&void 0===o)for(n=0,i=this.types.length;n<i&&void 0===o;)try{o=this.types[n]._copy(e,t)}catch(e){n++}if(void 0!==o)return 3===s?o:new this.types[n]._branchConstructor(o);K(e,this)},T.prototype.compare=function(e,t){var n=null===e?"null":Object.keys(e)[0],i=null===t?"null":Object.keys(t)[0],o=this._branchIndices[n];return n===i?"null"===n?0:this.types[o].compare(e[n],t[n]):r.compare(o,this._branchIndices[i])},T.prototype.typeName="union:wrapped",T.prototype.random=function(){var e=l.nextInt(this.types.length),t=this.types[e],n=t._branchConstructor;return n?new n(t.random()):null},o.inherits(C,f),C.prototype._check=function(e,t,n){var r=void 0!==this._indices[e];return!r&&n&&n(e,this),r},C.prototype._read=function(e){var t=e.readLong(),n=this.symbols[t];if(void 0===n)throw new Error(c("invalid %s enum index: %s",this.name,t));return n},C.prototype._skip=function(e){e.skipLong()},C.prototype._write=function(e,t){var n=this._indices[t];void 0===n&&K(t,this),e.writeLong(n)},C.prototype._match=function(e,t){return e.matchLong(t)},C.prototype.compare=function(e,t){return r.compare(this._indices[e],this._indices[t])},C.prototype._update=function(e,t,n){var r=this.symbols;"enum"===t.typeName&&U(this,t,!n.ignoreNamespaces)&&(t.symbols.every((function(e){return~r.indexOf(e)}))||void 0!==this.default)&&(e.symbols=t.symbols.map((function(e){return void 0===this._indices[e]?this.default:e}),this),e._read=t._read)},C.prototype._copy=function(e){return this._check(e,void 0,K),e},C.prototype._deref=function(e){e.symbols=this.symbols},C.prototype.getSymbols=function(){return this.symbols},C.prototype.typeName="enum",C.prototype.random=function(){return l.choice(this.symbols)},o.inherits(I,f),I.prototype._check=function(e,n,r){var i=t.isBuffer(e)&&e.length===this.size;return!i&&r&&r(e,this),i},I.prototype._read=function(e){return e.readFixed(this.size)},I.prototype._skip=function(e){e.skipFixed(this.size)},I.prototype._write=function(e,n){t.isBuffer(n)&&n.length===this.size||K(n,this),e.writeFixed(n,this.size)},I.prototype._match=function(e,t){return e.matchFixed(t,this.size)},I.prototype.compare=t.compare,I.prototype._update=function(e,t,n){"fixed"===t.typeName&&this.size===t.size&&U(this,t,!n.ignoreNamespaces)&&(e.size=this.size,e._read=this._read)},I.prototype._copy=S.prototype._copy,I.prototype._deref=function(e){e.size=this.size},I.prototype.getSize=function(){return this.size},I.prototype.typeName="fixed",I.prototype.random=function(){return l.nextBuffer(this.size)},o.inherits(A,f),A.prototype._check=function(e,t,n,r){if(!e||"object"!=typeof e||Array.isArray(e))return n&&n(e,this),!1;var i,o,s,a,c=Object.keys(e),u=!0;if(n){for(s=r.length,r.push(""),i=0,o=c.length;i<o;i++)a=r[s]=c[i],this.valuesType._check(e[a],t,n,r)||(u=!1);r.pop()}else for(i=0,o=c.length;i<o;i++)if(!this.valuesType._check(e[c[i]],t))return!1;return u},A.prototype._read=function(e){for(var t,n=this.valuesType,r={};t=F(e);)for(;t--;){r[e.readString()]=n._read(e)}return r},A.prototype._skip=function(e){for(var t,n,r=this.valuesType;n=e.readLong();)if(n<0)t=e.readLong(),e.pos+=t;else for(;n--;)e.skipString(),r._skip(e)},A.prototype._write=function(e,t){t&&"object"==typeof t&&!Array.isArray(t)||K(t,this);var n,r,i=this.valuesType,o=Object.keys(t),s=o.length;if(s)for(e.writeLong(s),n=0;n<s;n++)r=o[n],e.writeString(r),i._write(e,t[r]);e.writeLong(0)},A.prototype._match=function(){throw new Error("maps cannot be compared")},A.prototype._update=function(e,t,n){"map"===t.typeName&&(e.valuesType=this.valuesType.createResolver(t.valuesType,n),e._read=this._read)},A.prototype._copy=function(e,t){if(e&&"object"==typeof e&&!Array.isArray(e)){var n,r,i,o=this.valuesType,s=Object.keys(e),a={};for(n=0,r=s.length;n<r;n++)a[i=s[n]]=o._copy(e[i],t);return a}K(e,this)},A.prototype.compare=A.prototype._match,A.prototype.typeName="map",A.prototype.getValuesType=function(){return this.valuesType},A.prototype.random=function(){var e,t,n={};for(e=0,t=l.nextInt(10);e<t;e++)n[l.nextString(l.nextInt(20))]=this.valuesType.random();return n},A.prototype._deref=function(e,t){e.values=this.valuesType._attrs(t)},o.inherits(x,f),x.prototype._check=function(e,t,n,r){if(!Array.isArray(e))return n&&n(e,this),!1;var i,o,s,a=this.itemsType,c=!0;if(n){for(s=r.length,r.push(""),i=0,o=e.length;i<o;i++)r[s]=""+i,a._check(e[i],t,n,r)||(c=!1);r.pop()}else for(i=0,o=e.length;i<o;i++)if(!a._check(e[i],t))return!1;return c},x.prototype._read=function(e){for(var t,n,r=this.itemsType,i=0;n=e.readLong();)for(n<0&&(n=-n,e.skipLong()),t=t||new Array(n);n--;)t[i++]=r._read(e);return t||[]},x.prototype._skip=function(e){for(var t,n,r=this.itemsType;n=e.readLong();)if(n<0)t=e.readLong(),e.pos+=t;else for(;n--;)r._skip(e)},x.prototype._write=function(e,t){Array.isArray(t)||K(t,this);var n,r=this.itemsType,i=t.length;if(i)for(e.writeLong(i),n=0;n<i;n++)r._write(e,t[n]);e.writeLong(0)},x.prototype._match=function(e,t){for(var n,i=e.readLong(),o=t.readLong();i&&o;){if(n=this.itemsType._match(e,t))return n;--i||(i=F(e)),--o||(o=F(t))}return r.compare(i,o)},x.prototype._update=function(e,t,n){"array"===t.typeName&&(e.itemsType=this.itemsType.createResolver(t.itemsType,n),e._read=this._read)},x.prototype._copy=function(e,t){Array.isArray(e)||K(e,this);var n,r,i=new Array(e.length);for(n=0,r=e.length;n<r;n++)i[n]=this.itemsType._copy(e[n],t);return i},x.prototype._deref=function(e,t){e.items=this.itemsType._attrs(t)},x.prototype.compare=function(e,t){var n,i,o,s=e.length,a=t.length;for(n=0,i=Math.min(s,a);n<i;n++)if(o=this.itemsType.compare(e[n],t[n]))return o;return r.compare(s,a)},x.prototype.getItemsType=function(){return this.itemsType},x.prototype.typeName="array",x.prototype.random=function(){var e,t,n=[];for(e=0,t=l.nextInt(10);e<t;e++)n.push(this.itemsType.random());return n},o.inherits(R,f),R.prototype._getConstructorName=function(){return this.name?r.capitalize(r.unqualify(this.name)):this._isError?"Error$":"Record$"},R.prototype._createConstructor=function(e,t){var n,r,i,s,a,c,u,l=[],h=[],d=[],p="";for(n=0,r=this.fields.length;n<r;n++)c=void 0!==(a=(i=this.fields[n]).defaultValue)(),s=i.name,e&&this._isError&&"stack"===s&&f.isType(i.type,"string")&&!c&&(u=i),h.push("v"+n),p+="  ",c?(p+="if (v"+n+" === undefined) { ",p+="this."+s+" = d"+d.length+"(); ",p+="} else { this."+s+" = v"+n+"; }\n",l.push("d"+d.length),d.push(a)):p+="this."+s+" = v"+n+";\n";u&&(p+="  if (this.stack === undefined) { ","function"==typeof Error.captureStackTrace?p+="Error.captureStackTrace(this, this.constructor);":p+="this.stack = Error().stack;",p+=" }\n");var m="return function "+this._getConstructorName()+"(";m+=h.join()+") {\n"+p+"};";var y=new Function(l.join(),m).apply(void 0,d);if(t)return y;var g=this;return y.getType=function(){return g},y.type=g,this._isError&&(o.inherits(y,Error),y.prototype.name=this._getConstructorName()),y.prototype.clone=function(e){return g.clone(this,e)},y.prototype.compare=function(e){return g.compare(this,e)},y.prototype.isValid=function(e){return g.isValid(this,e)},y.prototype.toBuffer=function(){return g.toBuffer(this)},y.prototype.toString=function(){return g.toString(this)},y.prototype.wrap=function(){return g.wrap(this)},y.prototype.wrapped=y.prototype.wrap,y},R.prototype._createChecker=function(){var e=[],t=[],n="return function check"+this._getConstructorName()+"(v, f, h, p) {\n";if(n+="  if (\n",n+="    v === null ||\n",n+="    typeof v != 'object' ||\n",n+="    (f && !this._checkFields(v))\n",n+="  ) {\n",n+="    if (h) { h(v, this); }\n",n+="    return false;\n",n+="  }\n",this.fields.length){for(r=0,i=this.fields.length;r<i;r++)o=this.fields[r],e.push("t"+r),t.push(o.type),void 0!==o.defaultValue()&&(n+="  var v"+r+" = v."+o.name+";\n");var r,i,o;for(n+="  if (h) {\n",n+="    var b = 1;\n",n+="    var j = p.length;\n",n+="    p.push('');\n",r=0,i=this.fields.length;r<i;r++)n+="    p[j] = '"+(o=this.fields[r]).name+"';\n",n+="    b &= ",void 0===o.defaultValue()?n+="t"+r+"._check(v."+o.name+", f, h, p);\n":(n+="v"+r+" === undefined || ",n+="t"+r+"._check(v"+r+", f, h, p);\n");n+="    p.pop();\n",n+="    return !!b;\n",n+="  } else {\n    return (\n      ",n+=this.fields.map((function(e,t){return void 0===e.defaultValue()?"t"+t+"._check(v."+e.name+", f)":"(v"+t+" === undefined || t"+t+"._check(v"+t+", f))"})).join(" &&\n      "),n+="\n    );\n  }\n"}else n+="  return true;\n";return n+="};",new Function(e.join(),n).apply(void 0,t)},R.prototype._createReader=function(){var e,t,n=[],r=[this.recordConstructor];for(e=0,t=this.fields.length;e<t;e++)n.push("t"+e),r.push(this.fields[e].type);var i=this._getConstructorName(),o="return function read"+i+"(t) {\n";return o+="  return new "+i+"(\n    ",o+=n.map((function(e){return e+"._read(t)"})).join(",\n    "),o+="\n  );\n};",n.unshift(i),new Function(n.join(),o).apply(void 0,r)},R.prototype._createSkipper=function(){var e,t,n=[],r="return function skip"+this._getConstructorName()+"(t) {\n",i=[];for(e=0,t=this.fields.length;e<t;e++)n.push("t"+e),i.push(this.fields[e].type),r+="  t"+e+"._skip(t);\n";return r+="}",new Function(n.join(),r).apply(void 0,i)},R.prototype._createWriter=function(){var e,t,n,r,i=[],o="return function write"+this._getConstructorName()+"(t, v) {\n",s=[];for(e=0,t=this.fields.length;e<t;e++)n=this.fields[e],i.push("t"+e),s.push(n.type),o+="  ",void 0===n.defaultValue()?o+="t"+e+"._write(t, v."+n.name+");\n":(r=n.type.toBuffer(n.defaultValue()).toString("binary"),i.push("d"+e),s.push(r),o+="var v"+e+" = v."+n.name+";\n",o+="if (v"+e+" === undefined) {\n",o+="    t.writeBinary(d"+e+", "+r.length+");\n",o+="  } else {\n    t"+e+"._write(t, v"+e+");\n  }\n");return o+="}",new Function(i.join(),o).apply(void 0,s)},R.prototype._update=function(e,t,n){if(!U(this,t,!n.ignoreNamespaces))throw new Error(c("no alias found for %s",t.name));var i,o,s,a,u,l,h,d=this.fields,p=t.fields,f=r.toMap(p,(function(e){return e.name})),m=[],y={};for(i=0;i<d.length;i++){for(u=z(s=d[i]),l=[],o=0;o<u.length;o++)f[a=u[o]]&&l.push(a);if(l.length>1)throw new Error(c("ambiguous aliasing for %s.%s (%s)",t.name,s.name,l));if(l.length)a=l[0],h={resolver:s.type.createResolver(f[a].type,n),name:"_"+s.name},y[a]?y[a].push(h):y[a]=[h],m.push(h.name);else{if(void 0===s.defaultValue())throw new Error(c("no matching field for default-less %s.%s",t.name,s.name));m.push("undefined")}}var g=-1;for(i=p.length;i&&void 0===y[p[--i].name];)g=i;var v=this._getConstructorName(),_=[v],b=[this.recordConstructor],w="  return function read"+v+"(t, b) {\n";for(i=0;i<p.length;i++)if(i===g&&(w+="  if (!b) {\n"),void 0===y[a=(s=t.fields[i]).name])w+=~g&&i>=g?"    ":"  ",_.push("r"+i),b.push(s.type),w+="r"+i+"._skip(t);\n";else for(o=y[a].length;o--;)w+=~g&&i>=g?"    ":"  ",_.push("r"+i+"f"+o),h=y[a][o],b.push(h.resolver),w+="var "+h.name+" = ",w+="r"+i+"f"+o+"._"+(o?"peek":"read")+"(t);\n";~g&&(w+="  }\n"),w+="  return new "+v+"("+m.join()+");\n};",e._read=new Function(_.join(),w).apply(void 0,b)},R.prototype._match=function(e,t){var n,r,i,o,s,a=this.fields;for(n=0,r=a.length;n<r;n++)if(o=(i=a[n])._order,s=i.type,o){if(o*=s._match(e,t))return o}else s._skip(e),s._skip(t);return 0},R.prototype._checkFields=function(e){var t,n,r=Object.keys(e);for(t=0,n=r.length;t<n;t++)if(!this._fieldsByName[r[t]])return!1;return!0},R.prototype._copy=function(e,t){var n,r,i,o,s=t&&t.fieldHook,a=[void 0];for(n=0,r=this.fields.length;n<r;n++)void 0===(o=e[(i=this.fields[n]).name])&&i.hasOwnProperty("defaultValue")&&(o=i.defaultValue()),(t&&!t.skip||void 0!==o)&&(o=i.type._copy(o,t)),s&&(o=s(i,o,this)),a.push(o);var c=this.recordConstructor;return new(c.bind.apply(c,a))},R.prototype._deref=function(e,t){e.fields=this.fields.map((function(e){var n=e.type,r={name:e.name,type:n._attrs(t)};if(t.exportAttrs){var i=e.defaultValue();void 0!==i&&(r.default=n._copy(i,{coerce:3,wrap:3}));var o=e.order;"ascending"!==o&&(r.order=o);var s=e.aliases;s.length&&(r.aliases=s);var a=e.doc;void 0!==a&&(r.doc=a)}return r}))},R.prototype.compare=function(e,t){var n,r,i,o,s,a,c=this.fields;for(n=0,r=c.length;n<r;n++)if(o=(i=c[n]).name,s=i._order,a=i.type,s&&(s*=a.compare(e[o],t[o])))return s;return 0},R.prototype.random=function(){var e=this.fields.map((function(e){return e.type.random()}));e.unshift(void 0);var t=this.recordConstructor;return new(t.bind.apply(t,e))},R.prototype.field=function(e){return this._fieldsByName[e]},R.prototype.getField=R.prototype.field,R.prototype.getFields=function(){return this.fields},R.prototype.getRecordConstructor=function(){return this.recordConstructor},Object.defineProperty(R.prototype,"typeName",{enumerable:!0,get:function(){return this._isError?"error":"record"}}),o.inherits(P,f),Object.defineProperty(P.prototype,"typeName",{enumerable:!0,get:function(){return"logical:"+this._logicalTypeName}}),Object.defineProperty(P.prototype,"underlyingType",{enumerable:!0,get:function(){if(this._underlyingType)return this._underlyingType;var e,t,n;for(e=0,t=p.length;e<t;e++)if((n=p[e])[0]===this)return n[1]}}),P.prototype.getUnderlyingType=function(){return this.underlyingType},P.prototype._read=function(e){return this._fromValue(this.underlyingType._read(e))},P.prototype._write=function(e,t){this.underlyingType._write(e,this._toValue(t))},P.prototype._check=function(e,t,n,r){try{var i=this._toValue(e)}catch(e){}return void 0===i?(n&&n(e,this),!1):this.underlyingType._check(i,t,n,r)},P.prototype._copy=function(e,t){var n=this.underlyingType;switch(t&&t.coerce){case 3:return n._copy(this._toValue(e),t);case 2:return this._fromValue(n._copy(e,t));default:return this._fromValue(n._copy(this._toValue(e),t))}},P.prototype._update=function(e,t,n){var r=this._resolve(t,n);r&&(e._read=function(e){return r(t._read(e))})},P.prototype.compare=function(e,t){var n=this._toValue(e),r=this._toValue(t);return this.underlyingType.compare(n,r)},P.prototype.random=function(){return this._fromValue(this.underlyingType.random())},P.prototype._deref=function(e,t){var n=this.underlyingType,r=void 0!==n.name&&t.derefed[n.name];return e=n._attrs(t),!r&&t.exportAttrs&&("string"==typeof e&&(e={type:e}),e.logicalType=this._logicalTypeName,this._export(e)),e},P.prototype._skip=function(e){this.underlyingType._skip(e)},P.prototype._export=function(){},P.prototype._fromValue=r.abstractFunction,P.prototype._toValue=r.abstractFunction,P.prototype._resolve=r.abstractFunction,o.inherits(N,_),N.prototype.typeName="abstract:long",N.prototype._check=function(e,t,n){var r=this._isValid(e);return!r&&n&&n(e,this),r},N.prototype._read=function(e){var t,n;if(this._noUnpack?(n=e.pos,e.skipLong(),t=e.buf.slice(n,e.pos)):t=e.unpackLongBytes(e),e.isValid())return this._fromBuffer(t)},N.prototype._write=function(e,t){this._isValid(t)||K(t,this);var n=this._toBuffer(t);this._noUnpack?e.writeFixed(n):e.packLongBytes(n)},N.prototype._copy=function(e,t){switch(t&&t.coerce){case 3:return this._toJSON(e);case 2:return this._fromJSON(e);default:return this._fromJSON(this._toJSON(e))}},N.prototype._deref=function(){return"long"},N.prototype._update=function(e,t){var n=this;switch(t.typeName){case"int":e._read=function(e){return n._fromJSON(t._read(e))};break;case"abstract:long":case"long":e._read=function(e){return n._read(e)}}},N.prototype.random=function(){return this._fromJSON(_.prototype.random())},N.prototype._fromBuffer=r.abstractFunction,N.prototype._toBuffer=r.abstractFunction,N.prototype._fromJSON=r.abstractFunction,N.prototype._toJSON=r.abstractFunction,N.prototype._isValid=r.abstractFunction,N.prototype.compare=r.abstractFunction,j.prototype.defaultValue=function(){},Object.defineProperty(j.prototype,"order",{enumerable:!0,get:function(){return["descending","ignore","ascending"][this._order+1]}}),j.prototype.getAliases=function(){return this.aliases},j.prototype.getDefault=j.prototype.defaultValue,j.prototype.getName=function(){return this.name},j.prototype.getOrder=function(){return this.order},j.prototype.getType=function(){return this.type},L.prototype._peek=f.prototype._peek,L.prototype.inspect=function(){return"<Resolver>"},e.exports={Type:f,getTypeBucket:V,getValueBucket:G,isPrimitive:B,builtins:function(){var e,t,n,r={LogicalType:P,UnwrappedUnionType:O,WrappedUnionType:T},i=Object.keys(u);for(e=0,t=i.length;e<t;e++)r[D(n=i[e])]=u[n];return r}()}}).call(this,n(8).Buffer)},function(e,t,n){(t=e.exports=n(94)).Stream=t,t.Readable=t,t.Writable=n(73),t.Duplex=n(29),t.Transform=n(98),t.PassThrough=n(153)},function(e,t,n){var r=n(8),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=s),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";(function(t,r,i){var o=n(54);function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=v;var a,c=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?r:o.nextTick;v.WritableState=g;var u=Object.create(n(50));u.inherits=n(37);var l={deprecate:n(151)},h=n(95),d=n(72).Buffer,p=i.Uint8Array||function(){};var f,m=n(96);function y(){}function g(e,t){a=a||n(29),e=e||{};var r=t instanceof a;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,u=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(u||0===u)?u:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var h=!1===e.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(o.nextTick(i,r),o.nextTick(k,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),k(e,t))}(e,n,r,t,i);else{var s=E(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||w(e,n),r?c(b,e,n,s,i):b(e,n,s,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function v(e){if(a=a||n(29),!(f.call(v,this)||this instanceof a))return new v(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),h.call(this)}function _(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function b(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),k(e,t)}function w(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var a=0,c=!0;n;)i[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;i.allBuffers=c,_(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,h=n.callback;if(_(e,t,!1,t.objectMode?1:u.length,u,l,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function E(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function S(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),k(e,t)}))}function k(e,t){var n=E(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,o.nextTick(S,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}u.inherits(v,h),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:l.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(e){return!!f.call(this,e)||this===v&&(e&&e._writableState instanceof g)}})):f=function(e){return e instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(e,t,n){var r,i=this._writableState,s=!1,a=!i.objectMode&&(r=e,d.isBuffer(r)||r instanceof p);return a&&!d.isBuffer(e)&&(e=function(e){return d.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=y),i.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),o.nextTick(t,n)}(this,n):(a||function(e,t,n,r){var i=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),o.nextTick(r,s),i=!1),i}(this,i,e,n))&&(i.pendingcb++,s=function(e,t,n,r,i,o){if(!n){var s=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,n));return t}(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=t.objectMode?1:r.length;t.length+=a;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else _(e,t,!1,a,r,i,o);return c}(this,i,a,e,t,n)),s},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},v.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,k(e,t),n&&(t.finished?o.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),v.prototype.destroy=m.destroy,v.prototype._undestroy=m.undestroy,v.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(9),n(149).setImmediate,n(25))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(51),i=n(12),o=n(2),s=n(5),a=n(4),c=n(16);class u{constructor(e,t,n){this.session=e,this.sender=t,this.receiver=n,this._responsesMap=new Map,this.session=e,this.sender=t,this.receiver=n,this.receiver.on(o.ReceiverEvents.message,e=>{!function(e,t,n){const r=e.message;if(!r)return void a.b.verbose(`[${t}] "message" property on the EventContext is "undefined" which is unexpected, returning from the "onMessageReceived" handler without resolving or rejecting the promise upon encountering the message event.`);const o=r.correlation_id;if(!n.has(o))return void a.b.verbose(`[${t}] correlationId "${o}" property on the response does not match with any of the "request-id"s in the map, returning from the "onMessageReceived" handler without resolving or rejecting the promise upon encountering the message event.`);const c=n.get(o);c.cleanupBeforeResolveOrReject();const u=n.delete(o);a.b.verbose(`[${t}] Successfully deleted the response with id ${o} from the map. Delete result - `+u);const l=((e={})=>({statusCode:e[s.a.statusCode]||e.statusCode,statusDescription:e[s.a.statusDescription]||e.statusDescription,errorCondition:e[s.a.errorCondition]||e.errorCondition}))(r.application_properties);let h;l.statusCode||(h=new Error(`[${t}] No statusCode in the "application_properties" in the returned response with correlation-id: ${o}`));if(l.statusCode>199&&l.statusCode<300)return a.b.verbose(`[${t}] Resolving the response with correlation-id: ${o}`),c.resolve(r);if(!h){const e=l.errorCondition||i.a[l.statusCode]||"amqp:internal-error";h=Object(i.e)({condition:e,description:l.statusDescription}),a.b.warning(`${null==h?void 0:h.name}: ${null==h?void 0:h.message}`)}Object(a.a)(h),c.reject(h)}(e,this.connection.id,this._responsesMap)})}get connection(){return this.session.connection}isOpen(){return this.session.isOpen()&&this.sender.isOpen()&&this.receiver.isOpen()}sendRequest(e,t={}){const n=t.timeoutInMs||s.a.defaultOperationTimeoutInMs,u=t.abortSignal;return e.message_id||(e.message_id=Object(o.generate_uuid)()),new Promise((o,l)=>{let h=void 0;const d=()=>{this._responsesMap.delete(e.message_id);const n=this.receiver.address||"address",i=t.requestName,o=`[${this.connection.id}] The request "${i}" to "${n}" has been cancelled by the user.`;a.b.info(o);const c=new r.b(s.b);l(c)},p=()=>{Object(c.a)(h)&&clearTimeout(h),u.removeEventListener("abort",p),d()};if(u){if(u.aborted)return d();u.addEventListener("abort",p)}h=setTimeout(()=>{this._responsesMap.delete(e.message_id),u&&u.removeEventListener("abort",p);const t=this.receiver.address||"address",n={name:"OperationTimeoutError",message:`The request with message_id "${e.message_id}" to "${t}" endpoint timed out. Please try again later.`};return l(Object(i.e)(n))},n),this._responsesMap.set(e.message_id,{resolve:o,reject:l,cleanupBeforeResolveOrReject:()=>{u&&u.removeEventListener("abort",p),Object(c.a)(h)&&clearTimeout(h)}}),a.b.verbose("[%s] %s request sent: %O",this.connection.id,e.to||"$management",e),this.sender.send(e)})}async close(){await this.sender.close({closeSession:!1}),await this.receiver.close({closeSession:!1}),await this.session.close()}remove(){this.sender.remove(),this.receiver.remove(),this.session.remove()}static async create(e,t,n,r={}){const{abortSignal:i}=r,o=await e.createSession({abortSignal:i}),s=await o.createSender(Object.assign(Object.assign({},t),{abortSignal:i})),c=await o.createReceiver(Object.assign(Object.assign({},n),{abortSignal:i}));return a.b.verbose("[%s] Successfully created the sender and receiver links on the same session.",e.id),new u(o,s,c)}}},function(e,t){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){(function(t){const n="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,r="function"==typeof AbortController?AbortController:class{constructor(){this.signal=new s}abort(){this.signal.dispatchEvent("abort")}},i="function"==typeof AbortSignal,o="function"==typeof r.AbortSignal,s=i?AbortSignal:o?r.AbortController:class{constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(e){if("abort"===e){this.aborted=!0;const t={type:e,target:this};this.onabort(t),this._listeners.forEach(e=>e(t),this)}}onabort(){}addEventListener(e,t){"abort"===e&&this._listeners.push(t)}removeEventListener(e,t){"abort"===e&&(this._listeners=this._listeners.filter(e=>e!==t))}},a=new Set,c=(e,t)=>{const n="LRU_CACHE_OPTION_"+e;h(n)&&d(n,e+" option","options."+t,g)},u=(e,t)=>{const n="LRU_CACHE_METHOD_"+e;if(h(n)){const{prototype:r}=g,{get:i}=Object.getOwnPropertyDescriptor(r,e);d(n,e+" method",`cache.${t}()`,i)}},l=(...e)=>{"object"==typeof t&&t&&"function"==typeof t.emitWarning?t.emitWarning(...e):console.error(...e)},h=e=>!a.has(e),d=(e,t,n,r)=>{a.add(e);l(`The ${t} is deprecated. Please use ${n} instead.`,"DeprecationWarning",e,r)},p=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),f=e=>p(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?m:null:null;class m extends Array{constructor(e){super(e),this.fill(0)}}class y{constructor(e){if(0===e)return[];const t=f(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class g{constructor(e={}){const{max:t=0,ttl:n,ttlResolution:r=1,ttlAutopurge:i,updateAgeOnGet:o,updateAgeOnHas:s,allowStale:u,dispose:d,disposeAfter:m,noDisposeOnSet:v,noUpdateTTL:_,maxSize:b=0,maxEntrySize:w=0,sizeCalculation:E,fetchMethod:S,fetchContext:k,noDeleteOnFetchRejection:O,noDeleteOnStaleGet:T}=e,{length:C,maxAge:I,stale:A}=e instanceof g?{}:e;if(0!==t&&!p(t))throw new TypeError("max option must be a nonnegative integer");const x=t?f(t):Array;if(!x)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=b,this.maxEntrySize=w||this.maxSize,this.sizeCalculation=E||C,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=S||null,this.fetchMethod&&"function"!=typeof this.fetchMethod)throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=k,!this.fetchMethod&&void 0!==k)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new x(t),this.prev=new x(t),this.head=0,this.tail=0,this.free=new y(t),this.initialFill=1,this.size=0,"function"==typeof d&&(this.dispose=d),"function"==typeof m?(this.disposeAfter=m,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!v,this.noUpdateTTL=!!_,this.noDeleteOnFetchRejection=!!O,0!==this.maxEntrySize){if(0!==this.maxSize&&!p(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!p(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!u||!!A,this.noDeleteOnStaleGet=!!T,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!s,this.ttlResolution=p(r)||0===r?r:1,this.ttlAutopurge=!!i,this.ttl=n||I||0,this.ttl){if(!p(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(0===this.max&&0===this.ttl&&0===this.maxSize)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const e="LRU_CACHE_UNBOUNDED";if(h(e)){a.add(e);l("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,g)}}A&&c("stale","allowStale"),I&&c("maxAge","ttl"),C&&c("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new m(this.max),this.starts=new m(this.max),this.setItemTTL=(e,t,r=n.now())=>{if(this.starts[e]=0!==t?r:0,this.ttls[e]=t,0!==t&&this.ttlAutopurge){const n=setTimeout(()=>{this.isStale(e)&&this.delete(this.keyList[e])},t+1);n.unref&&n.unref()}},this.updateItemAge=e=>{this.starts[e]=0!==this.ttls[e]?n.now():0};let e=0;const t=()=>{const t=n.now();if(this.ttlResolution>0){e=t;const n=setTimeout(()=>e=0,this.ttlResolution);n.unref&&n.unref()}return t};this.getRemainingTTL=n=>{const r=this.keyMap.get(n);return void 0===r?0:0===this.ttls[r]||0===this.starts[r]?1/0:this.starts[r]+this.ttls[r]-(e||t())},this.isStale=n=>0!==this.ttls[n]&&0!==this.starts[n]&&(e||t())-this.starts[n]>this.ttls[n]}updateItemAge(e){}setItemTTL(e,t,n){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new m(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,n,r)=>{if(!p(n)){if(!r)throw new TypeError("invalid size value (must be positive integer)");if("function"!=typeof r)throw new TypeError("sizeCalculation must be a function");if(n=r(t,e),!p(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return n},this.addItemSize=(e,t)=>{this.sizes[e]=t;const n=this.maxSize-this.sizes[e];for(;this.calculatedSize>n;)this.evict(!0);this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,n,r){if(n||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.head);)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.tail);)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(const e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(const e of this.indexes())yield this.keyList[e]}*rkeys(){for(const e of this.rindexes())yield this.keyList[e]}*values(){for(const e of this.indexes())yield this.valList[e]}*rvalues(){for(const e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const n of this.indexes())if(e(this.valList[n],this.keyList[n],this))return this.get(this.keyList[n],t)}forEach(e,t=this){for(const n of this.indexes())e.call(t,this.valList[n],this.keyList[n],this)}rforEach(e,t=this){for(const n of this.rindexes())e.call(t,this.valList[n],this.keyList[n],this)}get prune(){return u("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){const e=[];for(const t of this.indexes({allowStale:!0})){const r=this.keyList[t],i=this.valList[t],o={value:this.isBackgroundFetch(i)?i.__staleWhileFetching:i};if(this.ttls){o.ttl=this.ttls[t];const e=n.now()-this.starts[t];o.start=Math.floor(Date.now()-e)}this.sizes&&(o.size=this.sizes[t]),e.unshift([r,o])}return e}load(e){this.clear();for(const[t,r]of e){if(r.start){const e=Date.now()-r.start;r.start=n.now()-e}this.set(t,r.value,r)}}dispose(e,t,n){}set(e,t,{ttl:n=this.ttl,start:r,noDisposeOnSet:i=this.noDisposeOnSet,size:o=0,sizeCalculation:s=this.sizeCalculation,noUpdateTTL:a=this.noUpdateTTL}={}){if(o=this.requireSize(e,t,o,s),this.maxEntrySize&&o>this.maxEntrySize)return this;let c=0===this.size?void 0:this.keyMap.get(e);if(void 0===c)c=this.newIndex(),this.keyList[c]=e,this.valList[c]=t,this.keyMap.set(e,c),this.next[this.tail]=c,this.prev[c]=this.tail,this.tail=c,this.size++,this.addItemSize(c,o),a=!1;else{const n=this.valList[c];t!==n&&(this.isBackgroundFetch(n)?n.__abortController.abort():i||(this.dispose(n,e,"set"),this.disposeAfter&&this.disposed.push([n,e,"set"])),this.removeItemSize(c),this.valList[c]=t,this.addItemSize(c,o)),this.moveToTail(c)}if(0===n||0!==this.ttl||this.ttls||this.initializeTTLTracking(),a||this.setItemTTL(c,n,r),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return 0===this.size?this.tail:this.size===this.max&&0!==this.max?this.evict(!1):0!==this.free.length?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(!0),e}}evict(e){const t=this.head,n=this.keyList[t],r=this.valList[t];return this.isBackgroundFetch(r)?r.__abortController.abort():(this.dispose(r,n,"evict"),this.disposeAfter&&this.disposed.push([r,n,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(n),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas}={}){const n=this.keyMap.get(e);return void 0!==n&&!this.isStale(n)&&(t&&this.updateItemAge(n),!0)}peek(e,{allowStale:t=this.allowStale}={}){const n=this.keyMap.get(e);if(void 0!==n&&(t||!this.isStale(n))){const e=this.valList[n];return this.isBackgroundFetch(e)?e.__staleWhileFetching:e}}backgroundFetch(e,t,n,i){const o=void 0===t?void 0:this.valList[t];if(this.isBackgroundFetch(o))return o;const s=new r,a={signal:s.signal,options:n,context:i},c=new Promise(t=>t(this.fetchMethod(e,o,a))).then(t=>(s.signal.aborted||this.set(e,t,a.options),t),r=>{if(this.valList[t]===c){!n.noDeleteOnFetchRejection||void 0===c.__staleWhileFetching?this.delete(e):this.valList[t]=c.__staleWhileFetching}if(c.__returned===c)throw r});return c.__abortController=s,c.__staleWhileFetching=o,c.__returned=null,void 0===t?(this.set(e,c,a.options),t=this.keyMap.get(e)):this.valList[t]=c,c}isBackgroundFetch(e){return e&&"object"==typeof e&&"function"==typeof e.then&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||null===e.__returned)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,ttl:i=this.ttl,noDisposeOnSet:o=this.noDisposeOnSet,size:s=0,sizeCalculation:a=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,fetchContext:l=this.fetchContext,forceRefresh:h=!1}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:n,noDeleteOnStaleGet:r});const d={allowStale:t,updateAgeOnGet:n,noDeleteOnStaleGet:r,ttl:i,noDisposeOnSet:o,size:s,sizeCalculation:a,noUpdateTTL:c,noDeleteOnFetchRejection:u};let p=this.keyMap.get(e);if(void 0===p){const t=this.backgroundFetch(e,p,d,l);return t.__returned=t}{const r=this.valList[p];if(this.isBackgroundFetch(r))return t&&void 0!==r.__staleWhileFetching?r.__staleWhileFetching:r.__returned=r;if(!h&&!this.isStale(p))return this.moveToTail(p),n&&this.updateItemAge(p),r;const i=this.backgroundFetch(e,p,d,l);return t&&void 0!==i.__staleWhileFetching?i.__staleWhileFetching:i.__returned=i}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet}={}){const i=this.keyMap.get(e);if(void 0!==i){const o=this.valList[i],s=this.isBackgroundFetch(o);if(this.isStale(i))return s?t?o.__staleWhileFetching:void 0:(r||this.delete(e),t?o:void 0);if(s)return;return this.moveToTail(i),n&&this.updateItemAge(i),o}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return u("del","delete"),this.delete}delete(e){let t=!1;if(0!==this.size){const n=this.keyMap.get(e);if(void 0!==n)if(t=!0,1===this.size)this.clear();else{this.removeItemSize(n);const t=this.valList[n];this.isBackgroundFetch(t)?t.__abortController.abort():(this.dispose(t,e,"delete"),this.disposeAfter&&this.disposed.push([t,e,"delete"])),this.keyMap.delete(e),this.keyList[n]=null,this.valList[n]=null,n===this.tail?this.tail=this.prev[n]:n===this.head?this.head=this.next[n]:(this.next[this.prev[n]]=this.next[n],this.prev[this.next[n]]=this.prev[n]),this.size--,this.free.push(n)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(const e of this.rindexes({allowStale:!0})){const t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort();else{const n=this.keyList[e];this.dispose(t,n,"delete"),this.disposeAfter&&this.disposed.push([t,n,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return u("reset","clear"),this.clear}get length(){return((e,t)=>{const n="LRU_CACHE_PROPERTY_"+e;if(h(n)){const{prototype:r}=g,{get:i}=Object.getOwnPropertyDescriptor(r,e);d(n,e+" property","cache."+t,i)}})("length","size"),this.size}static get AbortController(){return r}static get AbortSignal(){return s}}e.exports=g}).call(this,n(9))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(30),i=n(58);class o{constructor(e){var t,n,o,s,a,c,u;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:Object(r.a)(),this.method=null!==(n=e.method)&&void 0!==n?n:"GET",this.timeout=null!==(o=e.timeout)&&void 0!==o?o:0,this.formData=e.formData,this.disableKeepAlive=null!==(s=e.disableKeepAlive)&&void 0!==s&&s,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(a=e.withCredentials)&&void 0!==a&&a,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||Object(i.a)(),this.allowInsecureConnection=null!==(c=e.allowInsecureConnection)&&void 0!==c&&c,this.enableBrowserStreams=null!==(u=e.enableBrowserStreams)&&void 0!==u&&u}}function s(e){return new o(e)}},,,function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";(function(r){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(119)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(9))},function(e,t,n){"use strict";var r=n(31),i=n(47),o=n(83),s=n(33),a=0,c=1,u=2,l=3,h=4;var d=function(e){this.callback=e,this.outcome=void 0,this.username=void 0};d.prototype.start=function(e,t){var n=function(e){for(var t=[],n=0,r=0;r<e.length;)0===e[r]?(r>n?t.push(e.toString("utf8",n,r)):t.push(null),n=++r):++r;return r>n?t.push(e.toString("utf8",n,r)):t.push(null),t}(e);if(3!==n.length)return Promise.reject("Unexpected response in PLAIN, got "+n.length+" fields, expected 3");var r=this;return Promise.resolve(this.callback(n[1],n[2],t)).then((function(e){e?(r.outcome=!0,r.username=n[1]):r.outcome=!1}))};var p=function(e,t){this.username=e,this.password=t};p.prototype.start=function(e){var t=s.allocate_buffer(1+this.username.length+1+this.password.length);t.writeUInt8(0,0),t.write(this.username,1),t.writeUInt8(0,1+this.username.length),t.write(this.password,1+this.username.length+1),e(void 0,t)};var f=function(){this.outcome=void 0,this.username=void 0};f.prototype.start=function(e){this.outcome=!0,this.username=e?e.toString("utf8"):"anonymous"};var m=function(e){this.username=e||"anonymous"};m.prototype.start=function(e){var t=s.allocate_buffer(1+this.username.length);t.writeUInt8(0,0),t.write(this.username,1),e(void 0,t)};var y=function(){this.outcome=void 0,this.username=void 0};y.prototype.start=function(){this.outcome=!0};var g=function(){this.username=void 0};g.prototype.start=function(e){e(void 0,"")},g.prototype.step=function(e){e(void 0,"")};var v=function(e,t){this.username=e,this.token=t};v.prototype.start=function(e){var t=s.allocate_buffer(this.username.length+this.token.length+5+12+3),n=0;t.write("user=",n),n+=5,t.write(this.username,n),n+=this.username.length,t.writeUInt8(1,n),n+=1,t.write("auth=Bearer ",n),n+=12,t.write(this.token,n),n+=this.token.length,t.writeUInt8(1,n),n+=1,t.writeUInt8(1,n),n+=1,e(void 0,t)};var _=function(e,t){this.connection=e,this.transport=new o(e.amqp_transport.identifier,3,i.TYPE_SASL,this),this.next=e.amqp_transport,this.mechanisms=t,this.mechanism=void 0,this.outcome=void 0,this.username=void 0;var n=Object.getOwnPropertyNames(t);this.transport.encode(i.sasl_frame(i.sasl_mechanisms({sasl_server_mechanisms:n})))};_.prototype.do_step=function(e){if(void 0===this.mechanism.outcome)this.transport.encode(i.sasl_frame(i.sasl_challenge({challenge:e}))),this.connection.output();else{this.outcome=this.mechanism.outcome?a:c;var t=i.sasl_frame(i.sasl_outcome({code:this.outcome}));this.transport.encode(t),this.connection.output(),this.outcome===a&&(this.username=this.mechanism.username,this.transport.write_complete=!0,this.transport.read_complete=!0)}},_.prototype.on_sasl_init=function(e){var t=this.mechanisms[e.performative.mechanism];t?(this.mechanism=t(),Promise.resolve(this.mechanism.start(e.performative.initial_response,e.performative.hostname)).then(this.do_step.bind(this)).catch(this.do_fail.bind(this))):(this.outcome=c,this.transport.encode(i.sasl_frame(i.sasl_outcome({code:this.outcome}))))},_.prototype.on_sasl_response=function(e){Promise.resolve(this.mechanism.step(e.performative.response)).then(this.do_step.bind(this)).catch(this.do_fail.bind(this))},_.prototype.do_fail=function(e){var t=i.sasl_frame(i.sasl_outcome({code:u}));this.transport.encode(t),this.connection.output();try{this.connection.sasl_failed("Sasl callback promise failed with "+e,"amqp:internal-error")}catch(e){console.error("Uncaught error: ",e.message)}},_.prototype.has_writes_pending=function(){return this.transport.has_writes_pending()||this.next.has_writes_pending()},_.prototype.write=function(e){return this.transport.write_complete&&0===this.transport.pending.length?this.next.write(e):this.transport.write(e)},_.prototype.read=function(e){return this.transport.read_complete?this.next.read(e):this.transport.read(e)};var b=function(e,t,n){this.connection=e,this.transport=new o(e.amqp_transport.identifier,3,i.TYPE_SASL,this),this.next=e.amqp_transport,this.mechanisms=t,this.mechanism=void 0,this.mechanism_name=void 0,this.hostname=n,this.failed=!1};b.prototype.on_sasl_mechanisms=function(e){var t=[];Array.isArray(e.performative.sasl_server_mechanisms)?t=e.performative.sasl_server_mechanisms:e.performative.sasl_server_mechanisms&&(t=[e.performative.sasl_server_mechanisms]);for(var n=0;void 0===this.mechanism&&n<t.length;n++){var r=t[n],o=this.mechanisms[r];o&&(this.mechanism="function"==typeof o?o():o,this.mechanism_name=r)}if(this.mechanism){var s=this;this.mechanism.start((function(e,t){if(e)s.failed=!0,s.connection.sasl_failed("SASL mechanism init failed: "+e);else{var n={mechanism:s.mechanism_name,initial_response:t};s.hostname&&(n.hostname=s.hostname),s.transport.encode(i.sasl_frame(i.sasl_init(n))),s.connection.output()}}))}else this.failed=!0,this.connection.sasl_failed("No suitable mechanism; server supports "+e.performative.sasl_server_mechanisms)},b.prototype.on_sasl_challenge=function(e){var t=this;this.mechanism.step(e.performative.challenge,(function(e,n){e?(t.failed=!0,t.connection.sasl_failed("SASL mechanism challenge failed: "+e)):(t.transport.encode(i.sasl_frame(i.sasl_response({response:n}))),t.connection.output())}))},b.prototype.on_sasl_outcome=function(e){switch(e.performative.code){case a:this.transport.read_complete=!0,this.transport.write_complete=!0;break;case u:case l:case h:this.transport.write_complete=!0,this.connection.sasl_failed("Failed to authenticate: "+e.performative.code,"amqp:internal-error");break;default:this.transport.write_complete=!0,this.connection.sasl_failed("Failed to authenticate: "+e.performative.code)}},b.prototype.has_writes_pending=function(){return this.transport.has_writes_pending()||this.next.has_writes_pending()},b.prototype.write=function(e){return this.transport.write_complete?this.next.write(e):this.transport.write(e)},b.prototype.read=function(e){return this.transport.read_complete?this.next.read(e):this.transport.read(e)};var w=function(e,t){this.header_received=!1,this.transports={0:e.amqp_transport,3:new _(e,t)},this.selected=void 0};w.prototype.has_writes_pending=function(){return this.header_received&&this.selected.has_writes_pending()},w.prototype.write=function(e){return this.selected?this.selected.write(e):0},w.prototype.read=function(e){if(!this.header_received){if(e.length<8)return 0;if(this.header_received=i.read_header(e),this.selected=this.transports[this.header_received.protocol_id],void 0===this.selected)throw new r.ProtocolError("Invalid AMQP protocol id "+this.header_received.protocol_id)}return this.selected.read(e)};var E={enable_anonymous:function(){this.ANONYMOUS=function(){return new f}},enable_plain:function(e){this.PLAIN=function(){return new d(e)}}},S={enable_anonymous:function(e){this.ANONYMOUS=function(){return new m(e)}},enable_plain:function(e,t){this.PLAIN=function(){return new p(e,t)}},enable_external:function(){this.EXTERNAL=function(){return new g}},enable_xoauth2:function(e,t){if(e&&t)this.XOAUTH2=function(){return new v(e,t)};else{if(void 0===t)throw Error("token must be specified");if(void 0===e)throw Error("username must be specified")}}};e.exports={Client:b,Server:_,Selective:w,server_mechanisms:function(){return Object.create(E)},client_mechanisms:function(){return Object.create(S)},server_add_external:function(e){return e.EXTERNAL=function(){return new y},e}}},function(e,t,n){"use strict";var r=n(31),i=n(47),o=n(34),s=n(33),a=function(e,t,n,r){this.identifier=e,this.protocol_id=t,this.frame_type=n,this.handler=r,this.pending=[],this.header_sent=void 0,this.header_received=void 0,this.write_complete=!1,this.read_complete=!1};a.prototype.has_writes_pending=function(){return this.pending.length>0||!this.header_sent},a.prototype.encode=function(e){this.pending.push(e)},a.prototype.write=function(e){if(!this.header_sent){var t=s.allocate_buffer(8),n={protocol_id:this.protocol_id,major:1,minor:0,revision:0};o.frames("[%s] -> %o",this.identifier,n),i.write_header(t,n),e.write(t),this.header_sent=n}for(var r=0;r<this.pending.length;r++){var a=this.pending[r];t=i.write_frame(a);e.write(t),a.performative?o.frames("[%s]:%s -> %s %j",this.identifier,a.channel,a.performative.constructor,a.performative,a.payload||""):o.frames("[%s]:%s -> empty",this.identifier,a.channel),o.raw("[%s] SENT: %d %h",this.identifier,t.length,t)}this.pending=[]},a.prototype.read=function(e){var t=0;if(!this.header_received){if(e.length<8)return t;if(this.header_received=i.read_header(e),o.frames("[%s] <- %o",this.identifier,this.header_received),this.header_received.protocol_id!==this.protocol_id)throw 3===this.protocol_id&&0===this.header_received.protocol_id?new r.ProtocolError("Expecting SASL layer"):0===this.protocol_id&&3===this.header_received.protocol_id?new r.ProtocolError("SASL layer not enabled"):new r.ProtocolError("Invalid AMQP protocol id "+this.header_received.protocol_id+" expecting: "+this.protocol_id);t=8}for(;t<e.length-4&&!this.read_complete;){var n=e.readUInt32BE(t);if(o.io("[%s] got frame of size %d",this.identifier,n),e.length<t+n){o.io("[%s] incomplete frame; have only %d of %d",this.identifier,e.length-t,n);break}var s=e.slice(t,t+n);o.raw("[%s] RECV: %d %h",this.identifier,s.length,s);var a=i.read_frame(s);if(a.performative?o.frames("[%s]:%s <- %s %j",this.identifier,a.channel,a.performative.constructor,a.performative,a.payload||""):o.frames("[%s]:%s <- empty",this.identifier,a.channel),a.type!==this.frame_type)throw new r.ProtocolError("Invalid frame type: "+a.type);t+=n,a.performative&&a.performative.dispatch(this.handler,a)}return t},e.exports=a},function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s=o>=0?arguments[o]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,i="/"===s.charAt(0))}return(i?"/":"")+(t=n(r(t.split("/"),(function(e){return!!e})),!i).join("/"))||"."},t.normalize=function(e){var o=t.isAbsolute(e),s="/"===i(e,-1);return(e=n(r(e.split("/"),(function(e){return!!e})),!o).join("/"))||o||(e="."),e&&s&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),o=r(n.split("/")),s=Math.min(i.length,o.length),a=s,c=0;c<s;c++)if(i[c]!==o[c]){a=c;break}var u=[];for(c=a;c<i.length;c++)u.push("..");return(u=u.concat(o.slice(a))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){var n=function(e){"string"!=typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,o=0,s=e.length-1;s>=0;--s){var a=e.charCodeAt(s);if(47!==a)-1===r&&(i=!1,r=s+1),46===a?-1===t?t=s:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){n=s+1;break}}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===n+1?"":e.slice(t,r)};var i="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(9))},function(e,t){},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(62),i=n(63),o=n(64),s=n(35);!function(e){e.translate=function(e,t,n){const a=t instanceof r.Connection?t:t.connection;s.contextTranslator("[%s] Translating the context for event: '%s'.",a.id,n);const c=Object.assign({_context:e},e);return c.connection=a,c.container=a.container,t instanceof o.Link?(c.session=t.session,t.type===o.LinkType.receiver&&e.receiver?c.receiver=t:t.type===o.LinkType.sender&&e.sender&&(c.sender=t)):t instanceof i.Session&&(c.session=t),c}}(t.EventContext||(t.EventContext={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(64);class i extends r.Link{constructor(e,t,n){super(r.LinkType.receiver,e,t,n)}get drain(){return this._link.drain}set drain(e){this._link.drain=e}addCredit(e){this._link.add_credit(e)}drainCredit(){this._link.drain_credit()}setCreditWindow(e){this._link.set_credit_window(e)}}t.Receiver=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(28),i=n(35),o=n(66),s=n(28),a=n(49),c=n(48);class u extends o.BaseSender{constructor(e,t,n={}){super(e,t,n),this.deliveryDispositionMap=new Map;const o=e=>{const t=e.id;if(this.deliveryDispositionMap.has(e.id)){const n=this.deliveryDispositionMap.get(t);clearTimeout(n.timer);const r=this.deliveryDispositionMap.delete(t);return i.sender("[%s] Event: 'Accepted', Successfully deleted the delivery with id %d from the map of sender '%s' on amqp session '%s' and cleared the timer: %s.",this.connection.id,t,this.name,this.session.id,r),n.resolve(e)}},c=(e,t,n)=>{if(this.deliveryDispositionMap.has(t)){const r=this.deliveryDispositionMap.get(t);clearTimeout(r.timer);const o=this.deliveryDispositionMap.delete(t);i.sender("[%s] Event: '%s', Successfully deleted the delivery with id %d from the  map of sender '%s' on amqp session '%s' and cleared the timer: %s.",this.connection.id,e,t,this.name,this.session.id,o);const s=`Sender '${this.name}' on amqp session '${this.session.id}', received a '${e}' disposition. Hence we are rejecting the promise.`,c=new a.SendOperationFailedError(s,e,n);return i.error("[%s] %s",this.connection.id,s),r.reject(c)}},u=(e,t)=>{for(const n of this.deliveryDispositionMap.keys())c(e,n,t)};this.on(s.SenderEvents.accepted,e=>{o(e.delivery)}),this.on(s.SenderEvents.rejected,e=>{const t=e.delivery;c(s.SenderEvents.rejected,t.id,t.remote_state&&t.remote_state.error)}),this.on(s.SenderEvents.released,e=>{const t=e.delivery;c(s.SenderEvents.released,t.id,t.remote_state&&t.remote_state.error)}),this.on(s.SenderEvents.modified,e=>{const t=e.delivery;c(s.SenderEvents.modified,t.id,t.remote_state&&t.remote_state.error)}),n.onError||this.on(s.SenderEvents.senderError,e=>{u(s.SenderEvents.senderError,e.sender.error)}),n.onSessionError||this.session.on(r.SessionEvents.sessionError,e=>{u(r.SessionEvents.sessionError,e.session.error)})}send(e,t={}){return new Promise((n,r)=>{i.sender("[%s] Sender '%s' on amqp session '%s', credit: %d available: %d",this.connection.id,this.name,this.session.id,this.credit,this.session.outgoing.available());const o=t&&t.abortSignal,s=t.timeoutInSeconds||20;if(o&&o.aborted){const e=c.createAbortError();return i.error("[%s] %s",this.connection.id,e.message),r(e)}if(this.sendable()){const u=setTimeout(()=>{this.deliveryDispositionMap.delete(d.id);const e=`Sender '${this.name}' on amqp session '${this.session.id}', with address '${this.address}' was not able to send the message with delivery id ${d.id} right now, due to operation timeout.`;return i.error("[%s] %s",this.connection.id,e),r(new a.OperationTimeoutError(e))},1e3*s),l=()=>{if(this.deliveryDispositionMap.has(d.id)){const e=this.deliveryDispositionMap.get(d.id);clearTimeout(e.timer);const t=this.deliveryDispositionMap.delete(d.id);i.sender("[%s] Event: 'abort', Successfully deleted the delivery with id %d from the  map of sender '%s' on amqp session '%s' and cleared the timer: %s.",this.connection.id,d.id,this.name,this.session.id,t);const n=c.createAbortError();i.error("[%s] %s",this.connection.id,n.message),e.reject(n)}},h=()=>{o&&o.removeEventListener("abort",l)},d=this._link.send(e,t.tag,t.format);this.deliveryDispositionMap.set(d.id,{resolve:e=>{n(e),h()},reject:e=>{r(e),h()},timer:u}),o&&o.addEventListener("abort",l)}else{const e=`Sender "${this.name}" on amqp session "${this.session.id}", with address `+this.address+" cannot send the message right now as it does not have enough credit. Please try later.";i.error("[%s] %s",this.connection.id,e),r(new a.InsufficientCreditError(e))}})}}t.AwaitableSender=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(10),i=n(28),o=n(21),s=n(62);class a extends o.EventEmitter{constructor(e){e||(e={}),super(),e.createdInstance?(this._container=e.createdInstance,delete e.createdInstance):this._container=i.create_container(e),this.options=this._container.options}get id(){return this._container.id}get filter(){return this._container.filter}get types(){return this._container.types}get message(){return this._container.message}get sasl(){return this._container.sasl}get saslServerMechanisms(){return this._container.sasl_server_mechanisms}createConnection(e){const t=this._container.create_connection(e);return new s.Connection({rheaConnection:t,container:this})}connect(e){return r.__awaiter(this,void 0,void 0,(function*(){return this.createConnection(e).open()}))}listen(e){return this._container.listen(e)}generateUUid(){return this._container.generate_uuid()}stringToUuid(e){return this._container.string_to_uuid(e)}uuidToString(e){return this._container.uuid_to_string(e)}websocketAccept(e,t){return this._container.websocket_accept(e,t)}websocketConnect(e){return this._container.websocket_connect(e)}static create(e){return new a(e)}static copyFromContainerInstance(e){return new a({createdInstance:e})}}t.Container=a},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var r="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof e?e:{}}).call(this,n(25))},function(e,t,n){"use strict";var r=n(69),i=Object.prototype.hasOwnProperty,o=Array.isArray,s=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n};e.exports={arrayToObject:a,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],r=0;r<t.length;++r)for(var i=t[r],s=i.obj[i.prop],a=Object.keys(s),c=0;c<a.length;++c){var u=a[c],l=s[u];"object"==typeof l&&null!==l&&-1===n.indexOf(l)&&(t.push({obj:s,prop:u}),n.push(l))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(o(n)){for(var r=[],i=0;i<n.length;++i)void 0!==n[i]&&r.push(n[i]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\+/g," ");if("iso-8859-1"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,i,o){if(0===e.length)return e;var a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===n)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var c="",u=0;u<a.length;++u){var l=a.charCodeAt(u);45===l||46===l||95===l||126===l||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||o===r.RFC1738&&(40===l||41===l)?c+=a.charAt(u):l<128?c+=s[l]:l<2048?c+=s[192|l>>6]+s[128|63&l]:l<55296||l>=57344?c+=s[224|l>>12]+s[128|l>>6&63]+s[128|63&l]:(u+=1,l=65536+((1023&l)<<10|1023&a.charCodeAt(u)),c+=s[240|l>>18]+s[128|l>>12&63]+s[128|l>>6&63]+s[128|63&l])}return c},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(o(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if("object"!=typeof n){if(o(t))t.push(n);else{if(!t||"object"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!i.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(n);var s=t;return o(t)&&!o(n)&&(s=a(t,r)),o(t)&&o(n)?(n.forEach((function(n,o){if(i.call(t,o)){var s=t[o];s&&"object"==typeof s&&n&&"object"==typeof n?t[o]=e(s,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var s=n[o];return i.call(t,o)?t[o]=e(t[o],s,r):t[o]=s,t}),s)}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var r=n(107),i=n(76),o=n.n(i),s=n(109),a=n(108);const c={max:128,maxSize:Number.MAX_VALUE,sizeCalculation:(e,t)=>t.length};class u{constructor(e,t){var n;this.cacheBySchemaDefinition=new o.a(c),this.cacheById=new o.a(c),this.registry=e,this.schemaGroup=null==t?void 0:t.groupName,this.autoRegisterSchemas=null!==(n=null==t?void 0:t.autoRegisterSchemas)&&void 0!==n&&n,this.messageAdapter=null==t?void 0:t.messageAdapter}async serialize(e,t){const n=await this.getSchemaByDefinition(t),r=h(()=>n.serializer.toBuffer(e),"Avro serialization failed. See 'cause' for more details. Schema ID: "+n.id),i=new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT),o="avro/binary+"+n.id;return this.messageAdapter?this.messageAdapter.produce({contentType:o,data:i}):{data:i,contentType:o}}async deserialize(t,n={}){const{schema:r}=n,{data:i,contentType:o}=function(e,t){const n=null==t?void 0:t.consume;if(n)return n(e);if(Object(s.a)(e))return e;throw new Error("Expected either a message adapter to be provided to the serializer or the input message to have data and contentType fields")}(t,this.messageAdapter),a=e.from(i),c=function(e){const t=e.split("+");if(2!==t.length)throw new Error("Content type was not in the expected format of MIME type + schema ID");if("avro/binary"!==t[0])throw new Error(`Received content of type ${t[0]} but an avro serializer may only be used on content that is of 'avro/binary' type`);return t[1]}(o),u=await this.getSchemaById(c);if(r){const e=l(r),t=h(()=>e.createResolver(u),`Avro reader schema is incompatible with the writer schema (schema ID: (${c})):\n\n\treader schema: ${r}\n\nSee 'cause' for more details.`);return h(()=>e.fromBuffer(a,t,!0),`Avro deserialization with reader schema failed: \n\treader schema: ${r}\nSee 'cause' for more details. Writer schema ID: ${c}`)}return h(()=>u.fromBuffer(a),`Avro deserialization failed with schema ID (${c}). See 'cause' for more details.`)}async getSchemaById(e){const t=this.cacheById.get(e);if(t)return t;const n=await this.registry.getSchema(e);if(!n)throw new Error(`Schema with ID '${e}' not found.`);if(!n.properties.format.match(/^avro$/i))throw new Error(`Schema with ID '${n.properties.id}' has format '${n.properties.format}', not 'avro'.`);const r=l(n.definition);return this.cache(e,n.definition,r).serializer}async getSchemaByDefinition(e){const t=this.cacheBySchemaDefinition.get(e);if(t)return t;const n=l(e);if(!n.name)throw new Error("Schema must have a name.");if(!this.schemaGroup)throw new Error("Schema group must have been specified in the constructor options when the client was created in order to serialize.");const r={groupName:this.schemaGroup,name:n.name,format:"Avro",definition:e};let i;if(this.autoRegisterSchemas)i=(await this.registry.registerSchema(r)).id;else try{i=(await this.registry.getSchemaProperties(r)).id}catch(e){throw 404===e.statusCode?d(`Schema '${r.name}' not found in registry group '${r.groupName}', or not found to have matching definition.`,e):e}return this.cache(i,e,n)}cache(e,t,n){const r={id:e,serializer:n};return this.cacheBySchemaDefinition.set(t,r),this.cacheById.set(e,n),a.a.verbose(`Cache entry added or updated. Total number of entries: ${this.cacheBySchemaDefinition.size}; Total schema length ${this.cacheBySchemaDefinition.calculatedSize}`),r}}function l(e){return h(()=>r.Type.forSchema(JSON.parse(e),{omitRecordMethods:!0}),`Parsing Avro schema failed:\n\n\t${e}\n\nSee 'cause' for more details.`)}function h(e,t){let n;try{n=e()}catch(e){throw d(t,e)}return n}function d(e,t){return new Error(e,{cause:t})}}).call(this,n(8).Buffer)},function(e,t,n){"use strict";(function(t,r){var i=n(54);e.exports=_;var o,s=n(80);_.ReadableState=v;n(21).EventEmitter;var a=function(e,t){return e.listeners(t).length},c=n(95),u=n(72).Buffer,l=t.Uint8Array||function(){};var h=Object.create(n(50));h.inherits=n(37);var d=n(146),p=void 0;p=d&&d.debuglog?d.debuglog("stream"):function(){};var f,m=n(147),y=n(96);h.inherits(_,c);var g=["error","close","destroy","pause","resume"];function v(e,t){e=e||{};var r=t instanceof(o=o||n(29));this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,s=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(f||(f=n(97).StringDecoder),this.decoder=new f(e.encoding),this.encoding=e.encoding)}function _(e){if(o=o||n(29),!(this instanceof _))return new _(e);this._readableState=new v(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),c.call(this)}function b(e,t,n,r,i){var o,s=e._readableState;null===t?(s.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,S(e)}(e,s)):(i||(o=function(e,t){var n;r=t,u.isBuffer(r)||r instanceof l||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(s,t)),o?e.emit("error",o):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===u.prototype||(t=function(e){return u.from(e)}(t)),r?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):w(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(t=s.decoder.write(t),s.objectMode||0!==t.length?w(e,s,t,!1):O(e,s)):w(e,s,t,!1))):r||(s.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function w(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&S(e)),O(e,t)}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=y.destroy,_.prototype._undestroy=y.undestroy,_.prototype._destroy=function(e,t){this.push(null),t(e)},_.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=u.from(e,t),t=""),n=!0),b(this,e,t,!1,n)},_.prototype.unshift=function(e){return b(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){return f||(f=n(97).StringDecoder),this._readableState.decoder=new f(e),this._readableState.encoding=e,this};function E(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=8388608?e=8388608:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function S(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(p("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(k,e):k(e))}function k(e){p("emit readable"),e.emit("readable"),A(e)}function O(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(T,e,t))}function T(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(p("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function C(e){p("readable nexttick read 0"),e.read(0)}function I(e,t){t.reading||(p("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),A(e),t.flowing&&!t.reading&&e.read(0)}function A(e){var t=e._readableState;for(p("flow",t.flowing);t.flowing&&null!==e.read(););}function x(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),0===(e-=s)){s===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=u.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,s),0===(e-=s)){s===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function R(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(P,t,e))}function P(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function N(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}_.prototype.read=function(e){p("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return p("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?R(this):S(this),null;if(0===(e=E(e,t))&&t.ended)return 0===t.length&&R(this),null;var r,i=t.needReadable;return p("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&p("length less than watermark",i=!0),t.ended||t.reading?p("reading or ended",i=!1):i&&(p("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=E(n,t))),null===(r=e>0?x(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&R(this)),null!==r&&this.emit("data",r),r},_.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,t);var c=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:_;function u(t,r){p("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,p("cleanup"),e.removeListener("close",g),e.removeListener("finish",v),e.removeListener("drain",h),e.removeListener("error",y),e.removeListener("unpipe",u),n.removeListener("end",l),n.removeListener("end",_),n.removeListener("data",m),d=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||h())}function l(){p("onend"),e.end()}o.endEmitted?i.nextTick(c):n.once("end",c),e.on("unpipe",u);var h=function(e){return function(){var t=e._readableState;p("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,A(e))}}(n);e.on("drain",h);var d=!1;var f=!1;function m(t){p("ondata"),f=!1,!1!==e.write(t)||f||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==N(o.pipes,e))&&!d&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,f=!0),n.pause())}function y(t){p("onerror",t),_(),e.removeListener("error",y),0===a(e,"error")&&e.emit("error",t)}function g(){e.removeListener("finish",v),_()}function v(){p("onfinish"),e.removeListener("close",g),_()}function _(){p("unpipe"),n.unpipe(e)}return n.on("data",m),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?s(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",y),e.once("close",g),e.once("finish",v),e.emit("pipe",n),o.flowing||(p("pipe resume"),n.resume()),e},_.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var s=N(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},_.prototype.on=function(e,t){var n=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&S(this):i.nextTick(C,this))}return n},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var e=this._readableState;return e.flowing||(p("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(I,e,t))}(this,e)),this},_.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(p("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(p("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<g.length;o++)e.on(g[o],this.emit.bind(this,g[o]));return this._read=function(t){p("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=x}).call(this,n(25),n(9))},function(e,t,n){e.exports=n(21).EventEmitter},function(e,t,n){"use strict";var r=n(54);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(r.nextTick(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";var r=n(152).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=d,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=s(t[r]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=s(t[r]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";e.exports=s;var r=n(29),i=Object.create(n(50));function o(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function s(e){if(!(this instanceof s))return new s(e);r.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush((function(t,n){c(e,t,n)})):c(this,null,null)}function c(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=n(37),i.inherits(s,r),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},s.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},s.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,(function(e){t(e),n.emit("close")}))}},function(e,t,n){"use strict";(function(t){var r=n(163);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function i(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function o(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var s=n(19),a=Object.prototype.hasOwnProperty,c=Array.prototype.slice,u="foo"===function(){}.name;function l(e){return Object.prototype.toString.call(e)}function h(e){return!o(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var d=e.exports=v,p=/\s*function\s+([^\(\s]*)\s*/;function f(e){if(s.isFunction(e)){if(u)return e.name;var t=e.toString().match(p);return t&&t[1]}}function m(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function y(e){if(u||!s.isFunction(e))return s.inspect(e);var t=f(e);return"[Function"+(t?": "+t:"")+"]"}function g(e,t,n,r,i){throw new d.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function v(e,t){e||g(e,!0,t,"==",d.ok)}function _(e,t,n,r){if(e===t)return!0;if(o(e)&&o(t))return 0===i(e,t);if(s.isDate(e)&&s.isDate(t))return e.getTime()===t.getTime();if(s.isRegExp(e)&&s.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(h(e)&&h(t)&&l(e)===l(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===i(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(o(e)!==o(t))return!1;var a=(r=r||{actual:[],expected:[]}).actual.indexOf(e);return-1!==a&&a===r.expected.indexOf(t)||(r.actual.push(e),r.expected.push(t),function(e,t,n,r){if(null==e||null==t)return!1;if(s.isPrimitive(e)||s.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=b(e),o=b(t);if(i&&!o||!i&&o)return!1;if(i)return e=c.call(e),t=c.call(t),_(e,t,n);var a,u,l=S(e),h=S(t);if(l.length!==h.length)return!1;for(l.sort(),h.sort(),u=l.length-1;u>=0;u--)if(l[u]!==h[u])return!1;for(u=l.length-1;u>=0;u--)if(a=l[u],!_(e[a],t[a],n,r))return!1;return!0}(e,t,n,r))}return n?e===t:e==t}function b(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function w(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function E(e,t,n,r){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(e){var t;try{e()}catch(e){t=e}return t}(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&g(i,n,"Missing expected exception"+r);var o="string"==typeof r,a=!e&&i&&!n;if((!e&&s.isError(i)&&o&&w(i,n)||a)&&g(i,n,"Got unwanted exception"+r),e&&i&&n&&!w(i,n)||!e&&i)throw i}d.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return m(y(e.actual),128)+" "+e.operator+" "+m(y(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=f(t),o=r.indexOf("\n"+i);if(o>=0){var s=r.indexOf("\n",o+1);r=r.substring(s+1)}this.stack=r}}},s.inherits(d.AssertionError,Error),d.fail=g,d.ok=v,d.equal=function(e,t,n){e!=t&&g(e,t,n,"==",d.equal)},d.notEqual=function(e,t,n){e==t&&g(e,t,n,"!=",d.notEqual)},d.deepEqual=function(e,t,n){_(e,t,!1)||g(e,t,n,"deepEqual",d.deepEqual)},d.deepStrictEqual=function(e,t,n){_(e,t,!0)||g(e,t,n,"deepStrictEqual",d.deepStrictEqual)},d.notDeepEqual=function(e,t,n){_(e,t,!1)&&g(e,t,n,"notDeepEqual",d.notDeepEqual)},d.notDeepStrictEqual=function e(t,n,r){_(t,n,!0)&&g(t,n,r,"notDeepStrictEqual",e)},d.strictEqual=function(e,t,n){e!==t&&g(e,t,n,"===",d.strictEqual)},d.notStrictEqual=function(e,t,n){e===t&&g(e,t,n,"!==",d.notStrictEqual)},d.throws=function(e,t,n){E(!0,e,t,n)},d.doesNotThrow=function(e,t,n){E(!1,e,t,n)},d.ifError=function(e){if(e)throw e},d.strict=r((function e(t,n){t||g(t,!0,n,"==",e)}),d,{equal:d.strictEqual,deepEqual:d.deepStrictEqual,notEqual:d.notStrictEqual,notDeepEqual:d.notDeepStrictEqual}),d.strict.strict=d.strict;var S=Object.keys||function(e){var t=[];for(var n in e)a.call(e,n)&&t.push(n);return t}}).call(this,n(25))},function(e,t,n){"use strict";e.exports=function(e,t,n,r){for(var i=65535&e|0,o=e>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{o=o+(i=i+t[r++]|0)|0}while(--s);i%=65521,o%=65521}return i|o<<16|0}},function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t,n,i){var o=r,s=i+n;e^=-1;for(var a=i;a<s;a++)e=e>>>8^o[255&(e^t[a])];return-1^e}},function(e,t,n){"use strict";function r(...e){if(e.length>0){const t=String(e[0]);t.includes(":error")?console.error(...e):t.includes(":warning")?console.warn(...e):t.includes(":info")?console.info(...e):(t.includes(":verbose"),console.debug(...e))}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(51),i=n(2),o=n(5),s=n(4);class a{constructor(){this._keyMap=new Map,this._executionRunningSet=new Set}acquire(e,t,n){var a;const{abortSignal:c,timeoutInMs:u}=n;if(null==c?void 0:c.aborted)return Promise.reject(new r.b(o.b));const l=null!==(a=this._keyMap.get(e))&&void 0!==a?a:[];this._keyMap.set(e,l);const{promise:h,rejecter:d,resolver:p}=function(){let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolver:e,rejecter:t}}(),f={reject:d,resolve:p,task:t};if("number"==typeof u){const t=setTimeout(()=>{this._removeTaskDetails(e,f),d(new i.OperationTimeoutError("The task timed out waiting to acquire a lock for "+e))},u);f.tid=t}if(c){const t=()=>{this._removeTaskDetails(e,f),d(new r.b(o.b))};c.addEventListener("abort",t),f.abortSignal=c,f.abortListener=t}return l.push(f),s.b.verbose(`Called acquire() for lock "${e}". Lock "${e}" has ${l.length} pending tasks.`),this._execute(e),h}async _execute(e){if(this._executionRunningSet.has(e))return;const t=this._keyMap.get(e);if(t&&t.length){for(this._executionRunningSet.add(e);t.length;){const n=t.shift();if(n){try{s.b.verbose(`Acquired lock for "${e}", invoking task.`),c(n);const t=await n.task();n.resolve(t)}catch(e){n.reject(e)}s.b.verbose(`Task completed for lock "${e}". Lock "${e}" has ${t.length} pending tasks.`)}}this._executionRunningSet.delete(e)}}_removeTaskDetails(e,t){const n=this._keyMap.get(e);if(!n||!n.length)return;const r=n.indexOf(t);if(-1!==r){const[e]=n.splice(r,1);c(e)}}}function c(e){e.tid&&clearTimeout(e.tid),e.abortSignal&&e.abortListener&&e.abortSignal.removeEventListener("abort",e.abortListener)}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y}));var r=n(5),i=n(16),o=n(12),s=n(74),a=n(17),c=n(110),u=n(2),l=n(0),h=n(11),d=n(41),p=n(14),f=n(23),m=n(58);class y extends d.a{constructor(e,t){super(e,{address:t&&t.address?t.address:r.a.management,audience:t&&t.audience?t.audience:e.config.getManagementAudience()}),this.managementLock=`${r.a.managementRequestKey}-${Object(m.a)()}`,this.replyTo=Object(m.a)(),this._context=e,this.entityPath=e.config.entityPath}async getSecurityToken(){if(Object(i.c)(this._context.tokenCredential)){const e=this.audience.split("/");e[e.length-1]===this.address&&e.pop();const t=e.join("/");return this._context.tokenCredential.getToken(t)}return this._context.tokenCredential.getToken(r.a.aadEventHubsScope)}async getEventHubProperties(t={}){return Object(h.c)(this._context),p.b.withSpan("ManagementClient.getEventHubProperties",t,async t=>{try{const n=await this.getSecurityToken(),i={body:e.from(JSON.stringify([])),message_id:Object(m.a)(),reply_to:this.replyTo,application_properties:{operation:r.a.readOperation,name:this.entityPath,type:`${r.a.vendorString}:${r.a.eventHub}`,security_token:null==n?void 0:n.token}},o=await this._makeManagementRequest(i,Object.assign(Object.assign({},t),{requestName:"getHubRuntimeInformation"})),s={name:o.name,createdOn:new Date(o.created_at),partitionIds:o.partition_ids};return l.b.verbose("[%s] The hub runtime info is: %O",this._context.connectionId,s),s}catch(e){throw l.b.warning(`An error occurred while getting the hub runtime information: ${null==e?void 0:e.name}: ${null==e?void 0:e.message}`),Object(l.a)(e),e}},Object(p.a)(this._context.config))}async getPartitionProperties(t,n={}){return Object(h.c)(this._context),Object(h.d)(this._context.connectionId,"getPartitionProperties","partitionId",t),t=String(t),p.b.withSpan("ManagementClient.getPartitionProperties",n,async n=>{try{const i=await this.getSecurityToken(),o={body:e.from(JSON.stringify([])),message_id:Object(m.a)(),reply_to:this.replyTo,application_properties:{operation:r.a.readOperation,name:this.entityPath,type:`${r.a.vendorString}:${r.a.partition}`,partition:""+t,security_token:null==i?void 0:i.token}},s=await this._makeManagementRequest(o,Object.assign(Object.assign({},n),{requestName:"getPartitionInformation"})),a={beginningSequenceNumber:s.begin_sequence_number,eventHubName:s.name,lastEnqueuedOffset:s.last_enqueued_offset,lastEnqueuedOnUtc:new Date(s.last_enqueued_time_utc),lastEnqueuedSequenceNumber:s.last_enqueued_sequence_number,partitionId:s.partition,isEmpty:s.is_partition_empty};return l.b.verbose("[%s] The partition info is: %O.",this._context.connectionId,a),a}catch(e){throw l.b.warning(`An error occurred while getting the partition information: ${null==e?void 0:e.name}: ${null==e?void 0:e.message}`),Object(l.a)(e),e}},Object(p.a)(this._context.config))}async close(){try{if(clearTimeout(this._tokenRenewalTimer),this._isMgmtRequestResponseLinkOpen()){const e=this._mgmtReqResLink;this._mgmtReqResLink=void 0,await e.close(),l.b.info("Successfully closed the management session.")}}catch(e){const t=`An error occurred while closing the management session: ${null==e?void 0:e.name}: ${null==e?void 0:e.message}`;throw l.b.warning(t),Object(l.a)(e),new Error(t)}}async _init({abortSignal:e,timeoutInMs:t}){try{if(!this._isMgmtRequestResponseLinkOpen()){await this._context.readyToOpenLink(),await this._negotiateClaim({setTokenRenewal:!1,abortSignal:e,timeoutInMs:t});const n={source:{address:this.address},name:this.replyTo,target:{address:this.replyTo},onSessionError:e=>{const t=e.connection.options.id,n=Object(o.e)(e.session.error);l.b.verbose("[%s] An error occurred on the session for request/response links for $management: %O",t,n)}},r={target:{address:this.address}};l.b.verbose("[%s] Creating sender/receiver links on a session for $management endpoint with srOpts: %o, receiverOpts: %O.",this._context.connectionId,r,n),this._mgmtReqResLink=await s.a.create(this._context.connection,r,n,{abortSignal:e}),this._mgmtReqResLink.sender.on(u.SenderEvents.senderError,e=>{const t=e.connection.options.id,n=Object(o.e)(e.sender.error);l.b.verbose("[%s] An error occurred on the $management sender link.. %O",t,n)}),this._mgmtReqResLink.receiver.on(u.ReceiverEvents.receiverError,e=>{const t=e.connection.options.id,n=Object(o.e)(e.receiver.error);l.b.verbose("[%s] An error occurred on the $management receiver link.. %O",t,n)}),l.b.verbose("[%s] Created sender '%s' and receiver '%s' links for $management endpoint.",this._context.connectionId,this._mgmtReqResLink.sender.name,this._mgmtReqResLink.receiver.name),await this._ensureTokenRenewal()}}catch(e){const t=Object(o.e)(e);throw l.b.warning(`[${this._context.connectionId}] An error occured while establishing the $management links: ${null==t?void 0:t.name}: ${null==t?void 0:t.message}`),Object(l.a)(t),t}}async _makeManagementRequest(e,t={}){const n=t.retryOptions||{};try{const r=t&&t.abortSignal,i=async()=>{const n=Object(f.a)(t.retryOptions);let i=0;if(!this._isMgmtRequestResponseLinkOpen()){l.b.verbose("[%s] Acquiring lock to get the management req res link.",this._context.connectionId);const e=Date.now();try{await a.a.acquire(this.managementLock,()=>{const t=Date.now(),i=n-(t-e);return this._init({abortSignal:r,timeoutInMs:i})},{abortSignal:r,timeoutInMs:n})}catch(e){const t=Object(o.e)(e);throw l.b.warning("[%s] An error occurred while creating the management link %s: %s",this._context.connectionId,this.name,`${null==t?void 0:t.name}: ${null==t?void 0:t.message}`),Object(l.a)(t),t}i=Date.now()-e}const s=n-i,c={abortSignal:t.abortSignal,requestName:t.requestName,timeoutInMs:s};return e.message_id||(e.message_id=Object(u.generate_uuid)()),this._mgmtReqResLink.sendRequest(e,c)},s=Object.defineProperties({operation:i,operationType:c.b.management,abortSignal:r,retryOptions:n},{connectionId:{enumerable:!0,get:()=>this._context.connectionId}});return(await Object(c.c)(s)).body}catch(e){const t=Object(o.e)(e);throw l.b.warning("[%s] An error occurred during send on management request-response link with address '%s': %s",this._context.connectionId,this.address,`${null==t?void 0:t.name}: ${null==t?void 0:t.message}`),Object(l.a)(t),t}}_isMgmtRequestResponseLinkOpen(){return this._mgmtReqResLink&&this._mgmtReqResLink.isOpen()}}}).call(this,n(8).Buffer)},function(e,t,n){"use strict";(function(e){function r(t,n){const r=function(t){const n=function(e,t=0,n=0){let r,o,s;r=o=s=3735928559+e.length+t,s+=n;let a=0,c=e.length;for(;c>12;)r+=i(e,a),o+=i(e,a+4),s+=i(e,a+8),r-=s,r^=s<<4|s>>>28,s+=o,o-=r,o^=r<<6|r>>>26,r+=s,s-=o,s^=o<<8|o>>>24,o+=r,r-=s,r^=s<<16|s>>>16,s+=o,o-=r,o^=r<<19|r>>>13,r+=s,s-=o,s^=o<<4|o>>>28,o+=r,a+=12,c-=12;let u=c;switch(u){case 12:r+=i(e,a),o+=i(e,a+4),s+=i(e,a+8);break;case 11:s+=e[a+10]<<16,u=10;case 10:s+=e[a+9]<<8,u=9;case 9:s+=e[a+8],u=8;case 8:o+=i(e,a+4),r+=i(e,a);break;case 7:o+=e[a+6]<<16,u=6;case 6:o+=e[a+5]<<8,u=5;case 5:o+=e[a+4],u=4;case 4:r+=i(e,a);break;case 3:r+=e[a+2]<<16,u=2;case 2:r+=e[a+1]<<8,u=1;case 1:r+=e[a];break;case 0:return{b:o>>>0,c:s>>>0}}return s^=o,s-=o<<14|o>>>18,r^=s,r-=s<<11|s>>>21,o^=r,o-=r<<25|r>>>7,s^=o,s-=o<<16|o>>>16,r^=s,r-=s<<4|s>>>28,o^=r,o-=r<<14|r>>>18,s^=o,s-=o<<24|o>>>8,{b:o>>>0,c:s>>>0}}(e.from(t,"utf8"));return r=n.c^n.b,new Int16Array([r])[0];var r}(t);return Math.abs(r%n)}function i(e,t){return e.readUInt32LE(t)}n.d(t,"a",(function(){return r}))}).call(this,n(8).Buffer)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));const r=void 0!==e&&!!e.version&&!!e.versions&&!!e.versions.node}).call(this,n(9))},function(e,t,n){"use strict";var r=n(142),i=n(160),o=n(36),s=n(53),a=n(19);function c(e,t){s.Readable.call(this),t=t||{},this._batchSize=t.batchSize||65536,this._blob=e,this._pos=0}function u(){s.Transform.call(this,{readableObjectMode:!0}),this._bufs=[]}a.inherits(c,s.Readable),c.prototype._read=function(){var e=this._pos;if(e>=this._blob.size)this.push(null);else{this._pos+=this._batchSize;var t=this._blob.slice(e,this._pos,this._blob.type),n=new FileReader,r=this;n.addEventListener("loadend",(function e(t){n.removeEventListener("loadend",e,!1),t.error?r.emit("error",t.error):r.push(o.bufferFrom(n.result))}),!1),n.readAsArrayBuffer(t)}},a.inherits(u,s.Transform),u.prototype._transform=function(e,t,n){this._bufs.push(e),n()},u.prototype._flush=function(e){this.push(new Blob(this._bufs,{type:"application/octet-binary"})),e()},e.exports={createBlobDecoder:function(e,t){return new c(e).pipe(new i.streams.BlockDecoder(t))},createBlobEncoder:function(e,t){var n=new i.streams.BlockEncoder(e,t),r=new u;return n.pipe(r),new s.Duplex({objectMode:!0,read:function(){var e=r.read();e?n(e):r.once("readable",n);var t=this;function n(e){t.push(e||r.read()),t.push(null)}},write:function(e,t,r){return n.write(e,t,r)}}).on("finish",(function(){n.end()}))},streams:i.streams},o.copyOwnProperties(r,e.exports)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(13);const i=Object(r.a)("schema-registry-avro")},function(e,t,n){"use strict";function r(e){const t=e;return void 0!==t.data&&void 0!==t.contentType}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return h}));var r=n(12),i=n(5);var o,s,a=n(17),c=n(4);function u(e){let t=!1;return e&&"number"==typeof e.id&&"boolean"==typeof e.settled&&"boolean"==typeof e.remote_settled&&"number"==typeof e.format&&(t=!0),t}function l(e,t,n,r){if(r===o.Exponential){const r=(.8*t+Math.floor(Math.random()*(1.2*t-.8*t)))*(Math.pow(2,e)-1);return Math.min(r,n)}return t}async function h(e){let t,n;!function(e){if(!e.operation)throw new TypeError("Missing 'operation' in retry configuration");if(!e.connectionId)throw new TypeError("Missing 'connectionId' in retry configuration");if(!e.operationType)throw new TypeError("Missing 'operationType' in retry configuration")}(e),e.retryOptions||(e.retryOptions={}),(null==e.retryOptions.maxRetries||e.retryOptions.maxRetries<0)&&(e.retryOptions.maxRetries=i.a.defaultMaxRetries),(null==e.retryOptions.retryDelayInMs||e.retryOptions.retryDelayInMs<0)&&(e.retryOptions.retryDelayInMs=i.a.defaultDelayBetweenOperationRetriesInMs),(null==e.retryOptions.maxRetryDelayInMs||e.retryOptions.maxRetryDelayInMs<0)&&(e.retryOptions.maxRetryDelayInMs=i.a.defaultMaxDelayForExponentialRetryInMs),null==e.retryOptions.mode&&(e.retryOptions.mode=o.Fixed);let s=!1;const h=e.retryOptions.maxRetries+1;for(let i=1;i<=h;i++){c.b.verbose("[%s] Attempt number for '%s': %d.",e.connectionId,e.operationType,i);try{n=await e.operation(),s=!0,c.b.verbose("[%s] Success for '%s', after attempt number: %d.",e.connectionId,e.operationType,i),n&&!u(n)&&c.b.verbose("[%s] Success result for '%s': %O",e.connectionId,e.operationType,n);break}catch(n){let o=n;if(o.translated||(o=Object(r.e)(o)),!o.retryable&&"ServiceCommunicationError"===o.name&&e.connectionHost){await(e.connectionHost,Promise.resolve(self.navigator.onLine))||(o.name="ConnectionLostError",o.retryable=!0)}if(t=o,c.b.verbose("[%s] Error occurred for '%s' in attempt number %d: %O",e.connectionId,e.operationType,i,o),t&&t.retryable&&h>i){const t=l(i,e.retryOptions.retryDelayInMs,e.retryOptions.maxRetryDelayInMs,e.retryOptions.mode);c.b.verbose("[%s] Sleeping for %d milliseconds for '%s'.",e.connectionId,t,e.operationType),await Object(a.b)(t,e.abortSignal,"The retry operation has been cancelled by the user.");continue}break}}if(s)return n;throw t}!function(e){e[e.Exponential=0]="Exponential",e[e.Fixed=1]="Fixed"}(o||(o={})),function(e){e.cbsAuth="cbsAuth",e.connection="connection",e.management="management",e.receiverLink="receiverLink",e.senderLink="senderLink",e.sendMessage="sendMessage",e.receiveMessage="receiveMessage",e.session="session",e.messageSettlement="settlement"}(s||(s={}))},,,function(e,t,n){const{EventHubProducerClient:r,EventHubConsumerClient:i}=n(173),{ClientSecretCredential:o}=n(172),{SchemaRegistryClient:s}=n(174),{AvroSerializer:a}=n(141);flutterAzureEventHubs={},flutterAzureEventHubs.eventHubProducerClient=r,flutterAzureEventHubs.eventHubConsumerClient=i,flutterAzureEventHubs.clientSecretCredential=o,flutterAzureEventHubs.schemaRegistryClient=s,flutterAzureEventHubs.avroSerializer=a,flutterAzureEventHubs.instances={},flutterAzureEventHubs.instances.eventHubProducerClientList=[],flutterAzureEventHubs.instances.eventHubConsumerClientList=[],flutterAzureEventHubs.instances.subscriptionList=[],flutterAzureEventHubs.instances.clientSecretCredentialList=[],flutterAzureEventHubs.instances.schemaRegistryClientList=[],flutterAzureEventHubs.instances.avroSerializerList=[],flutterAzureEventHubs.api={},flutterAzureEventHubs.setEventHubProducerClient=function(e,t){flutterAzureEventHubs.instances.eventHubProducerClientList.push({key:e,value:t})},flutterAzureEventHubs.getEventHubProducerClientByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.eventHubProducerClientList.length;t++)if(flutterAzureEventHubs.instances.eventHubProducerClientList[t].key===e)return flutterAzureEventHubs.instances.eventHubProducerClientList[t].value},flutterAzureEventHubs.removeEventHubProducerClientByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.eventHubProducerClientList.length;t++)if(flutterAzureEventHubs.instances.eventHubProducerClientList[t].key===e){flutterAzureEventHubs.instances.eventHubProducerClientList.splice(t,1),t--;break}},flutterAzureEventHubs.setEventHubConsumerClient=function(e,t){flutterAzureEventHubs.instances.eventHubConsumerClientList.push({key:e,value:t})},flutterAzureEventHubs.getEventHubConsumerClientByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.eventHubConsumerClientList.length;t++)if(flutterAzureEventHubs.instances.eventHubConsumerClientList[t].key===e)return flutterAzureEventHubs.instances.eventHubConsumerClientList[t].value},flutterAzureEventHubs.removeEventHubConsumerClientByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.eventHubConsumerClientList.length;t++)if(flutterAzureEventHubs.instances.eventHubConsumerClientList[t].key===e){flutterAzureEventHubs.instances.eventHubConsumerClientList.splice(t,1),t--;break}},flutterAzureEventHubs.setSubscription=function(e,t){flutterAzureEventHubs.instances.subscriptionList.push({key:e,value:t})},flutterAzureEventHubs.getSubscriptionByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.subscriptionList.length;t++)if(flutterAzureEventHubs.instances.subscriptionList[t].key===e)return flutterAzureEventHubs.instances.subscriptionList[t].value},flutterAzureEventHubs.removeSubscriptionByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.subscriptionList.length;t++)if(flutterAzureEventHubs.instances.subscriptionList[t].key===e){flutterAzureEventHubs.instances.subscriptionList.splice(t,1),t--;break}},flutterAzureEventHubs.setClientSecretCredential=function(e,t){flutterAzureEventHubs.instances.clientSecretCredentialList.push({key:e,value:t})},flutterAzureEventHubs.getClientSecretCredentialByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.clientSecretCredentialList.length;t++)if(flutterAzureEventHubs.instances.clientSecretCredentialList[t].key===e)return flutterAzureEventHubs.instances.clientSecretCredentialList[t].value},flutterAzureEventHubs.removeClientSecretCredentialByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.clientSecretCredentialList.length;t++)if(flutterAzureEventHubs.instances.clientSecretCredentialList[t].key===e){flutterAzureEventHubs.instances.clientSecretCredentialList.splice(t,1),t--;break}},flutterAzureEventHubs.setSchemaRegistryClient=function(e,t){flutterAzureEventHubs.instances.schemaRegistryClientList.push({key:e,value:t})},flutterAzureEventHubs.getSchemaRegistryClientByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.schemaRegistryClientList.length;t++)if(flutterAzureEventHubs.instances.schemaRegistryClientList[t].key===e)return flutterAzureEventHubs.instances.schemaRegistryClientList[t].value},flutterAzureEventHubs.removeSchemaRegistryClientByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.schemaRegistryClientList.length;t++)if(flutterAzureEventHubs.instances.schemaRegistryClientList[t].key===e){flutterAzureEventHubs.instances.schemaRegistryClientList.splice(t,1),t--;break}},flutterAzureEventHubs.setAvroSerializer=function(e,t){flutterAzureEventHubs.instances.avroSerializerList.push({key:e,value:t})},flutterAzureEventHubs.getAvroSerializerByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.avroSerializerList.length;t++)if(flutterAzureEventHubs.instances.avroSerializerList[t].key===e)return flutterAzureEventHubs.instances.avroSerializerList[t].value},flutterAzureEventHubs.removeAvroSerializerByKey=function(e){for(var t=0;t<flutterAzureEventHubs.instances.avroSerializerList.length;t++)if(flutterAzureEventHubs.instances.avroSerializerList[t].key===e){flutterAzureEventHubs.instances.avroSerializerList.splice(t,1),t--;break}},flutterAzureEventHubs.api.createEventHubProducerClient=function(e,t,n,r,i){try{var o=new flutterAzureEventHubs.eventHubProducerClient(t,n);flutterAzureEventHubs.setEventHubProducerClient(e,o),proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!0,result:""}))}catch(e){proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:e.toString()}))}},flutterAzureEventHubs.api.sendEventDataBatch=function(e,t,n,r,i){var o=flutterAzureEventHubs.getEventHubProducerClientByKey(e);if(null!=o){for(var s in t)null!=t[s].contentType&&t[s].contentType.toString().startsWith("avro/binary")&&(t[s].body=Uint8Array.from(t[s].body));o.sendBatch(t,n).then((function(){proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!0,result:""}))})).catch((function(e){proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:e.toString()}))}))}else proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:"ERROR: EventHubProducerClient not found."}))},flutterAzureEventHubs.api.closeEventHubProducerClient=function(e,t,n){var r=flutterAzureEventHubs.getEventHubProducerClientByKey(e);null!=r?r.close().then((function(){flutterAzureEventHubs.removeEventHubProducerClientByKey(e),proxyInterop.postMessage(JSON.stringify({id:n,javascriptTransactionId:t,success:!0,result:""}))})).catch((function(e){proxyInterop.postMessage(JSON.stringify({id:n,javascriptTransactionId:t,success:!1,result:e.toString()}))})):proxyInterop.postMessage(JSON.stringify({id:n,javascriptTransactionId:t,success:!1,result:"ERROR: EventHubProducerClient not found."}))},flutterAzureEventHubs.api.createEventHubConsumerClient=function(e,t,n,r,i,o){try{var s=new flutterAzureEventHubs.eventHubConsumerClient(t,n,r);flutterAzureEventHubs.setEventHubConsumerClient(e,s),proxyInterop.postMessage(JSON.stringify({id:o,javascriptTransactionId:i,success:!0,result:""}))}catch(e){proxyInterop.postMessage(JSON.stringify({id:o,javascriptTransactionId:i,success:!1,result:e.toString()}))}},flutterAzureEventHubs.api.subscribe=function(e,t,n,r,i){var o=flutterAzureEventHubs.getEventHubConsumerClientByKey(e);if(null!=o)try{var s=o.subscribe({processEvents:function(e,n){var r={receivedEventDataList:[]};for(var o in e){var s=e[o].body;null!=e[o].contentType&&e[o].contentType.toString().startsWith("avro/binary")&&(s=Array.apply([],e[o].body)),r.receivedEventDataList.push({body:s,contentType:e[o].contentType,enqueuedTimeUtc:e[o].enqueuedTimeUtc,partitionKey:e[o].partitionKey,offset:e[o].offset,sequenceNumber:e[o].sequenceNumber})}r.partitionContext={fullyQualifiedNamespace:n._context.fullyQualifiedNamespace,eventHubName:n._context.eventHubName,consumerGroup:n._context.consumerGroup,partitionId:n._context.partitionId},proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:t,success:!0,result:JSON.stringify(r)}))},processError:function(e){proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:t,success:!1,result:e.toString()}))}},n);flutterAzureEventHubs.setSubscription(t,s),proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!0,result:""}))}catch(e){proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:e.toString()}))}else proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:"ERROR: EventHubConsumerClient not found."}))},flutterAzureEventHubs.api.closeSubscription=function(e,t,n){var r=flutterAzureEventHubs.getSubscriptionByKey(e);null!=r?r.close().then((function(){flutterAzureEventHubs.removeSubscriptionByKey(e),proxyInterop.postMessage(JSON.stringify({id:n,javascriptTransactionId:t,success:!0,result:""}))})).catch((function(e){proxyInterop.postMessage(JSON.stringify({id:n,javascriptTransactionId:t,success:!1,result:e.toString()}))})):proxyInterop.postMessage(JSON.stringify({id:n,javascriptTransactionId:t,success:!1,result:"ERROR: Subscription not found."}))},flutterAzureEventHubs.api.closeEventHubConsumerClient=function(e,t,n,r){var i=flutterAzureEventHubs.getEventHubConsumerClientByKey(e);null!=i?i.close().then((function(){for(var i in t)flutterAzureEventHubs.removeSubscriptionByKey(t[i]);flutterAzureEventHubs.removeEventHubConsumerClientByKey(e),proxyInterop.postMessage(JSON.stringify({id:r,javascriptTransactionId:n,success:!0,result:""}))})).catch((function(e){proxyInterop.postMessage(JSON.stringify({id:r,javascriptTransactionId:n,success:!1,result:e.toString()}))})):proxyInterop.postMessage(JSON.stringify({id:r,javascriptTransactionId:n,success:!1,result:"ERROR: EventHubConsumerClient not found."}))},flutterAzureEventHubs.api.createClientSecretCredential=function(e,t,n,r,i,o,s){try{var a=new flutterAzureEventHubs.clientSecretCredential(t,n,r,i);flutterAzureEventHubs.setClientSecretCredential(e,a),proxyInterop.postMessage(JSON.stringify({id:s,javascriptTransactionId:o,success:!0,result:""}))}catch(e){proxyInterop.postMessage(JSON.stringify({id:s,javascriptTransactionId:o,success:!1,result:e.toString()}))}},flutterAzureEventHubs.api.createSchemaRegistryClient=function(e,t,n,r,i,o){var s=flutterAzureEventHubs.getClientSecretCredentialByKey(n);if(null!=s)try{var a=new flutterAzureEventHubs.schemaRegistryClient(t,s,r);flutterAzureEventHubs.setSchemaRegistryClient(e,a),proxyInterop.postMessage(JSON.stringify({id:o,javascriptTransactionId:i,success:!0,result:""}))}catch(e){proxyInterop.postMessage(JSON.stringify({id:o,javascriptTransactionId:i,success:!1,result:e.toString()}))}else proxyInterop.postMessage(JSON.stringify({id:o,javascriptTransactionId:i,success:!1,result:"ERROR: ClientSecretCredential not found."}))},flutterAzureEventHubs.api.getSchemaProperties=function(e,t,n,r){var i=flutterAzureEventHubs.getSchemaRegistryClientByKey(e);null!=i?i.getSchemaProperties(t).then((function(e){proxyInterop.postMessage(JSON.stringify({id:r,javascriptTransactionId:n,success:!0,result:JSON.stringify({id:e.id,format:e.format,groupName:e.groupName,name:e.name})}))})).catch((function(e){proxyInterop.postMessage(JSON.stringify({id:r,javascriptTransactionId:n,success:!1,result:e.toString()}))})):proxyInterop.postMessage(JSON.stringify({id:r,javascriptTransactionId:n,success:!1,result:"ERROR: SchemaRegistryClient not found."}))},flutterAzureEventHubs.api.createAvroSerializer=function(e,t,n,r,i){var o=flutterAzureEventHubs.getSchemaRegistryClientByKey(t);if(null!=o)try{var s=new flutterAzureEventHubs.avroSerializer(o,n);flutterAzureEventHubs.setAvroSerializer(e,s),proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!0,result:""}))}catch(e){proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:e.toString()}))}else proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:"ERROR: SchemaRegistryClient not found."}))},flutterAzureEventHubs.api.serialize=function(e,t,n,r,i){var o=flutterAzureEventHubs.getAvroSerializerByKey(e);null!=o?o.serialize(t,n).then((function(e){proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!0,result:JSON.stringify({data:Array.apply([],e.data),contentType:e.contentType})}))})).catch((function(e){proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:e.toString()}))})):proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:"ERROR: AvroSerializer not found."}))},flutterAzureEventHubs.api.deserialize=function(e,t,n,r,i){var o=flutterAzureEventHubs.getAvroSerializerByKey(e);null!=o?o.deserialize(t,n).then((function(e){proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!0,result:JSON.stringify(e)}))})).catch((function(e){proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:e.toString()}))})):proxyInterop.postMessage(JSON.stringify({id:i,javascriptTransactionId:r,success:!1,result:"ERROR: AvroSerializer not found."}))}},function(e,t,n){"use strict";(function(t,r){var i=n(31),o=n(47),s=n(34),a=n(82),c=n(33),u=n(60),l=n(121),h=n(83),d=n(124),p=n(125),f=n(84),m=n(85),y=n(86),g=n(21).EventEmitter;function v(){var e=function(){var e;e=t.env.MESSAGING_CONNECT_FILE?[t.env.MESSAGING_CONNECT_FILE]:[t.cwd(),f.join(p.homedir(),".config/messaging"),"/etc/messaging"].map((function(e){return f.join(e,"/connect.json")}));for(var n=0;n<e.length;n++)if(d.existsSync(e[n])){var r=JSON.parse(d.readFileSync(e[n],"utf8"));return s.config("using config from %s: %j",e[n],r),r}return{}}(),n={};return"amqps"===e.scheme&&(n.transport="tls"),e.host&&(n.host=e.host),"amqp"===e.port?n.port=5672:"amqps"===e.port?n.port=5671:n.port=e.port,e.sasl&&!1===e.sasl.enabled||(e.user?n.username=e.user:n.username="anonymous",e.password&&(n.password=e.password),e.sasl_mechanisms&&(n.sasl_mechanisms=e.sasl_mechanisms)),e.tls&&(e.tls.key&&(n.key=d.readFileSync(e.tls.key)),e.tls.cert&&(n.cert=d.readFileSync(e.tls.cert)),e.tls.ca&&(n.ca=[d.readFileSync(e.tls.ca)]),!1!==e.verify&&!1!==e.tls.verify||(n.rejectUnauthorized=!1)),"tls"===n.transport&&(n.servername=n.host),n}function _(e){return e.get_id_string?e.get_id_string():e.localAddress+":"+e.localPort+" -> "+e.remoteAddress+":"+e.remotePort}function b(e,t){if(e){var n,r=e;return function(i){return n!==i&&(r=e,n=i),r--?t(i):-1}}return t}function w(e){if(void 0===e.transport||"tcp"===e.transport)return m.connect;if("tls"===e.transport||"ssl"===e.transport)return y.connect;throw Error("Unrecognised transport: "+e.transport)}var E=["container_id","hostname","max_frame_size","channel_max","idle_time_out","outgoing_locales","incoming_locales","offered_capabilities","desired_capabilities","properties"];function S(e,t){if("boolean"==typeof e)if(e){var n=t.get_option("initial_reconnect_delay",100),r=t.get_option("max_reconnect_delay",6e4);t.options.reconnect=b(t.get_option("reconnect_limit"),function(e,t){var n,r=e;return function(i){n!==i&&(r=e,n=i);var o=r,s=2*r;return r=t>s?s:t,o}}(n,r))}else t.options.reconnect=!1;else if("number"==typeof e){var i=t.options.reconnect;t.options.reconnect=b(t.get_option("reconnect_limit"),(function(){return i}))}}var k=1,O=function(e,t){if(this.options={},e){for(var n in e)this.options[n]=e[n];"tls"!==e.transport&&"ssl"!==e.transport||void 0!==e.servername||void 0===e.host||(this.options.servername=e.host)}else this.options=v();if(this.container=t,this.options.id||(this.options.id="connection-"+k++),this.options.container_id||(this.options.container_id=t?t.id:c.generate_uuid()),!this.options.connection_details){var r=this;this.options.connection_details=function(){return function(e){var t={};return t.connect=e.connect?e.connect:w(e),t.host=e.host?e.host:"localhost",t.port=e.port?e.port:5672,t.options=e,t}(r.options)}}var i,s,a,l;S(this.get_option("reconnect",!0),this),this.registered=!1,this.state=new u,this.local_channel_map={},this.remote_channel_map={},this.local={},this.remote={},this.local.open=o.open((i=this.options,s={},E.forEach((function(e){void 0!==i[e]&&(s[e]=i[e])})),s)),this.local.close=o.close({}),this.session_policy=(a=this,l=null,{get_session:function(){return l||((l=a.create_session()).observers.on("session_close",(function(){l=null})),l.begin()),l}}),this.amqp_transport=new h(this.options.id,0,o.TYPE_AMQP,this),this.sasl_transport=void 0,this.transport=this.amqp_transport,this.conn_established_counter=0,this.heartbeat_out=void 0,this.heartbeat_in=void 0,this.abort_idle=void 0,this.socket_ready=!1,this.scheduled_reconnect=void 0,this.default_sender=void 0,this.closed_with_non_fatal_error=!1;r=this;E.forEach((function(e){var t;Object.defineProperty(r,e,{get:(t=e,function(){return this.remote.open?this.remote.open[t]:void 0})})})),Object.defineProperty(this,"error",{get:function(){return this.remote.close?this.remote.close.error:void 0}})};function T(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&delete e[t]}function C(e){O.prototype["on_"+e]=function(t){var n=this.remote_channel_map[t.channel];if(!n)throw new i.ProtocolError(e+" received on invalid channel "+t.channel);n["on_"+e](t)}}(O.prototype=Object.create(g.prototype)).constructor=O,O.prototype.dispatch=function(e){return s.events("[%s] Connection got event: %s",this.options.id,e),this.listeners(e).length?(g.prototype.emit.apply(this,arguments),!0):!!this.container&&this.container.dispatch.apply(this.container,arguments)},O.prototype._disconnect=function(){for(var e in this.state.disconnected(),this.local_channel_map)this.local_channel_map[e]._disconnect();this.socket_ready=!1},O.prototype._reconnect=function(){this.abort_idle&&(clearTimeout(this.abort_idle),this.abort_idle=void 0,this.local.close.error=void 0,this.state=new u,this.state.open()),this.state.reconnect(),this._reset_remote_state()},O.prototype._reset_remote_state=function(){this.amqp_transport=new h(this.options.id,0,o.TYPE_AMQP,this),this.sasl_transport=void 0,this.transport=this.amqp_transport,this.remote={},this.remote_channel_map={};var e=this.local_channel_map;for(var t in e)e[t]._reconnect()},O.prototype.connect=function(){return this.is_server=!1,this.abort_idle&&(clearTimeout(this.abort_idle),this.abort_idle=void 0),this._reset_remote_state(),this._connect(this.options.connection_details(this.conn_established_counter)),this.open(),this},O.prototype.reconnect=function(){return this.scheduled_reconnect=void 0,s.reconnect("[%s] reconnecting...",this.options.id),this._reconnect(),this._connect(this.options.connection_details(this.conn_established_counter)),t.nextTick(this._process.bind(this)),this},O.prototype.set_reconnect=function(e){S(e,this)},O.prototype._connect=function(e){return e.connect?this.init(e.connect(e.port,e.host,e.options,this.connected.bind(this))):this.init(w(e)(e.port,e.host,e.options,this.connected.bind(this))),this},O.prototype.accept=function(e){return this.is_server=!0,s.io("[%s] client accepted: %s",this.id,_(e)),this.socket_ready=!0,this.init(e)},O.prototype.abort_socket=function(e){e===this.socket&&(this.abort_idle=void 0,s.io("[%s] aborting socket",this.options.id),this.socket.end(),this.socket.removeAllListeners&&(this.socket.removeAllListeners("data"),this.socket.removeAllListeners("error"),this.socket.removeAllListeners("end")),"function"==typeof this.socket.destroy&&this.socket.destroy(),this._disconnected())},O.prototype.init=function(e){if(this.socket=e,this.get_option("tcp_no_delay",!1)&&this.socket.setNoDelay&&this.socket.setNoDelay(!0),this.socket.on("data",this.input.bind(this)),this.socket.on("error",this.on_error.bind(this)),this.socket.on("end",this.eof.bind(this)),this.is_server){var t;if(this.container&&Object.getOwnPropertyNames(this.container.sasl_server_mechanisms).length&&(t=this.container.sasl_server_mechanisms),this.socket.encrypted&&this.socket.authorized&&this.get_option("enable_sasl_external",!1)&&(t=a.server_add_external(t?c.clone(t):{})),t)void 0===t.ANONYMOUS||this.get_option("require_sasl",!1)?this.sasl_transport=new a.Server(this,t):this.sasl_transport=new a.Selective(this,t);else if(!this.get_option("disable_sasl",!1)){var n=a.server_mechanisms();n.enable_anonymous(),this.sasl_transport=new a.Selective(this,n)}}else{var r=this.get_option("sasl_mechanisms");if(!r){var i=this.get_option("username"),o=this.get_option("password"),s=this.get_option("token");i&&(r=a.client_mechanisms(),o?r.enable_plain(i,o):s?r.enable_xoauth2(i,s):r.enable_anonymous(i))}this.socket.encrypted&&this.options.cert&&this.get_option("enable_sasl_external",!1)&&(r||(r=a.client_mechanisms()),r.enable_external()),r&&(this.sasl_transport=new a.Client(this,r,this.options.sasl_init_hostname||this.options.servername||this.options.host))}return this.transport=this.sasl_transport?this.sasl_transport:this.amqp_transport,this},O.prototype.attach_sender=function(e){return this.session_policy.get_session().attach_sender(e)},O.prototype.open_sender=O.prototype.attach_sender,O.prototype.attach_receiver=function(e){return this.get_option("tcp_no_delay",!0)&&this.socket.setNoDelay&&this.socket.setNoDelay(!0),this.session_policy.get_session().attach_receiver(e)},O.prototype.open_receiver=O.prototype.attach_receiver,O.prototype.get_option=function(e,t){return void 0!==this.options[e]?this.options[e]:this.container?this.container.get_option(e,t):t},O.prototype.send=function(e){return void 0===this.default_sender&&(this.default_sender=this.open_sender({target:{}})),this.default_sender.send(e)},O.prototype.connected=function(){this.socket_ready=!0,this.conn_established_counter++,s.io("[%s] connected %s",this.options.id,_(this.socket)),this.output()},O.prototype.sasl_failed=function(e,t){this.transport_error=new i.ConnectionError(e,t||"amqp:unauthorized-access",this),this._handle_error(),this.socket.end()},O.prototype._is_fatal=function(e){return!this.get_option("all_errors_non_fatal",!1)&&this.get_option("non_fatal_errors",["amqp:connection:forced"]).indexOf(e)<0},O.prototype._handle_error=function(){var e=this.get_error();if(e){var t=this.dispatch("connection_error",this._context({error:e}));return t=this.dispatch("connection_close",this._context({error:e}))||t,this._is_fatal(e.condition)?t||this.dispatch("error",new i.ConnectionError(e.description,e.condition,this)):this.state.local_open&&(this.closed_with_non_fatal_error=!0),!0}return!1},O.prototype.get_error=function(){return this.transport_error?this.transport_error:this.remote.close&&this.remote.close.error?new i.ConnectionError(this.remote.close.error.description,this.remote.close.error.condition,this):void 0},O.prototype._get_peer_details=function(){var e="";return this.remote.open&&this.remote.open.container&&(e+=this.remote.open.container+" "),this.remote.open&&this.remote.open.properties&&(e+=JSON.stringify(this.remote.open.properties)),e},O.prototype.output=function(){try{this.socket&&this.socket_ready&&(this.heartbeat_out&&clearTimeout(this.heartbeat_out),this.transport.write(this.socket),(this.is_closed()&&this.state.has_settled()||this.abort_idle||this.transport_error)&&!this.transport.has_writes_pending()?this.socket.end():this.is_open()&&this.remote.open.idle_time_out&&(this.heartbeat_out=setTimeout(this._write_frame.bind(this),this.remote.open.idle_time_out/2)),this.local.open.idle_time_out&&void 0===this.heartbeat_in&&(this.heartbeat_in=setTimeout(this.idle.bind(this),this.local.open.idle_time_out)))}catch(e){this.saved_error=e,"ProtocolError"===e.name?(console.error("["+this.options.id+"] error on write: "+e+" "+this._get_peer_details()+" "+e.name),this.dispatch("protocol_error",e)||console.error("["+this.options.id+"] error on write: "+e+" "+this._get_peer_details())):this.dispatch("error",e),this.socket.end()}},O.prototype.input=function(e){var t;try{this.heartbeat_in&&clearTimeout(this.heartbeat_in),s.io("[%s] read %d bytes",this.options.id,e.length),this.previous_input?(t=r.concat([this.previous_input,e],this.previous_input.length+e.length),this.previous_input=null):t=e;var n=this.transport.read(t,this);n<t.length&&(this.previous_input=t.slice(n)),this.local.open.idle_time_out&&(this.heartbeat_in=setTimeout(this.idle.bind(this),this.local.open.idle_time_out)),this.transport.has_writes_pending()?this.output():this.is_closed()&&this.state.has_settled()?this.socket.end():this.is_open()&&this.remote.open.idle_time_out&&!this.heartbeat_out&&(this.heartbeat_out=setTimeout(this._write_frame.bind(this),this.remote.open.idle_time_out/2))}catch(e){this.saved_error=e,"ProtocolError"===e.name?this.dispatch("protocol_error",e)||console.error("["+this.options.id+"] error on read: "+e+" "+this._get_peer_details()+" (buffer:"+function(e){for(var t,n=[],r=0;r<e.length;r++)n.push((t=e[r])<16?"0x0"+Number(t).toString(16):"0x"+Number(t).toString(16));return n.join(",")}(t)+")"):this.dispatch("error",e),this.socket.end()}},O.prototype.idle=function(){this.is_closed()||(this.closed_with_non_fatal_error=!0,this.local.close.error={condition:"amqp:resource-limit-exceeded",description:"max idle time exceeded"},this.close(),this.abort_idle=setTimeout(this.abort_socket.bind(this,this.socket),1e3))},O.prototype.on_error=function(e){this._disconnected(e)},O.prototype.eof=function(e){var t=e||this.saved_error;this.saved_error=void 0,this._disconnected(t)},O.prototype._disconnected=function(e){this.heartbeat_out&&(clearTimeout(this.heartbeat_out),this.heartbeat_out=void 0),this.heartbeat_in&&(clearTimeout(this.heartbeat_in),this.heartbeat_in=void 0),this.abort_idle&&(clearTimeout(this.abort_idle),this.abort_idle=void 0);var t=this.closed_with_non_fatal_error;if(this.closed_with_non_fatal_error&&(this.closed_with_non_fatal_error=!1,this.options.reconnect&&this.open()),(!this.is_closed()||t)&&void 0===this.scheduled_reconnect){this._disconnect();var n={};if(e&&(n.error=e),!this.is_server&&!this.transport_error&&this.options.reconnect){var r=this.options.reconnect(this.conn_established_counter);r>=0?(s.reconnect("[%s] Scheduled reconnect in "+r+"ms",this.options.id),this.scheduled_reconnect=setTimeout(this.reconnect.bind(this),r),n.reconnecting=!0):n.reconnecting=!1}this.dispatch("disconnected",this._context(n))||console.warn("["+this.options.id+"] disconnected %s",n.error||"")}},O.prototype.open=function(){this.state.open()&&this._register()},O.prototype.close=function(e){e&&(this.local.close.error=e),this.state.close()&&this._register()},O.prototype.is_open=function(){return this.state.is_open()},O.prototype.is_remote_open=function(){return this.state.remote_open},O.prototype.is_closed=function(){return this.state.is_closed()},O.prototype.create_session=function(){for(var e=0;this.local_channel_map[e];)e++;var t=new l(this,e);return this.local_channel_map[e]=t,t},O.prototype.find_sender=function(e){return this.find_link(c.sender_filter(e))},O.prototype.find_receiver=function(e){return this.find_link(c.receiver_filter(e))},O.prototype.find_link=function(e){for(var t in this.local_channel_map){var n=this.local_channel_map[t].find_link(e);if(n)return n}},O.prototype.each_receiver=function(e,t){this.each_link(e,c.receiver_filter(t))},O.prototype.each_sender=function(e,t){this.each_link(e,c.sender_filter(t))},O.prototype.each_link=function(e,t){for(var n in this.local_channel_map){this.local_channel_map[n].each_link(e,t)}},O.prototype.on_open=function(e){if(!this.state.remote_opened())throw new i.ProtocolError("Open already received");this.remote.open=e.performative,this.open(),this.dispatch("connection_open",this._context())},O.prototype.on_close=function(e){if(!this.state.remote_closed())throw new i.ProtocolError("Close already received");this.remote.close=e.performative,this.remote.close.error?this._handle_error():this.dispatch("connection_close",this._context()),this.heartbeat_out&&clearTimeout(this.heartbeat_out);var n=this;t.nextTick((function(){n.close()}))},O.prototype._register=function(){this.registered||(this.registered=!0,t.nextTick(this._process.bind(this)))},O.prototype._process=function(){this.registered=!1;do{this.state.need_open()&&this._write_open();var e=this.local_channel_map;for(var t in e)e[t]._process();this.state.need_close()&&this._write_close()}while(!this.state.has_settled())},O.prototype._write_frame=function(e,t,n){this.amqp_transport.encode(o.amqp_frame(e,t,n)),this.output()},O.prototype._write_open=function(){this._write_frame(0,this.local.open)},O.prototype._write_close=function(){this._write_frame(0,this.local.close),this.local.close.error=void 0},O.prototype.on_begin=function(e){var t;if(null===e.performative.remote_channel||void 0===e.performative.remote_channel)(t=this.create_session()).local.begin.remote_channel=e.channel;else if(!(t=this.local_channel_map[e.performative.remote_channel]))throw new i.ProtocolError("Invalid value for remote channel "+e.performative.remote_channel);t.on_begin(e),this.remote_channel_map[e.channel]=t},O.prototype.get_peer_certificate=function(){return this.socket&&this.socket.getPeerCertificate?this.socket.getPeerCertificate():void 0},O.prototype.get_tls_socket=function(){return!this.socket||"tls"!==this.options.transport&&"ssl"!==this.options.transport?void 0:this.socket},O.prototype._context=function(e){var t=e||{};return t.connection=this,this.container&&(t.container=this.container),t},O.prototype.remove_session=function(e){this.remote_channel_map[e.remote.channel]===e&&delete this.remote_channel_map[e.remote.channel],this.local_channel_map[e.local.channel]===e&&delete this.local_channel_map[e.local.channel]},O.prototype.remove_all_sessions=function(){T(this.remote_channel_map),T(this.local_channel_map)},C("end"),C("attach"),C("detach"),C("transfer"),C("disposition"),C("flow"),e.exports=O}).call(this,n(9),n(8).Buffer)},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),s=r[0],a=r[1],c=new o(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),l=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===a&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===a&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(l(e,s,s+16383>a?a:s+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?i-1:0,d=n?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=u}return(p?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*c-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&a,p+=f,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+p]=255&s,p+=f,s/=256,u-=8);e[n+p-f]|=128*m}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){var n;function s(){if(s.enabled){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var o=s,a=Number(new Date),c=a-(n||a);o.diff=c,o.prev=n,o.curr=a,n=a,t[0]=r.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return e;u++;var i=r.formatters[n];if("function"==typeof i){var s=t[u];e=i.call(o,s),t.splice(u,1),u--}return e})),r.formatArgs.call(o,t);var l=o.log||r.log;l.apply(o,t)}}return s.namespace=e,s.enabled=r.enabled(e),s.useColors=r.useColors(),s.color=t(e),s.destroy=i,s.extend=o,"function"==typeof r.init&&r.init(s),r.instances.push(s),s}function i(){var e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function o(e,t){return r(this.namespace+(void 0===t?":":t)+e)}return r.debug=r,r.default=r,r.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},r.disable=function(){r.enable("")},r.enable=function(e){var t;r.save(e),r.names=[],r.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(t=0;t<i;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){var o=r.instances[t];o.enabled=r.enabled(o.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n(120),Object.keys(e).forEach((function(t){r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},function(e,t){var n=1e3,r=6e4,i=60*r,o=24*i;function s(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=o)return s(e,t,o,"day");if(t>=i)return s(e,t,i,"hour");if(t>=r)return s(e,t,r,"minute");if(t>=n)return s(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=i)return Math.round(e/i)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){"use strict";(function(t,r){var i=n(47),o=n(122),s=n(34),a=n(61),c=n(32),u=n(33),l=n(60),h=n(21).EventEmitter;function d(e,t,n){Error.call(this),Error.captureStackTrace(this,this.constructor),this.message=e,this.condition=t,this.description=e,Object.defineProperty(this,"session",{value:n})}n(19).inherits(d,Error);var p=function(e){this.capacity=e,this.size=0,this.head=0,this.tail=0,this.entries=[]};function f(e){var t,n,r,o,s;for(o=0;o<e.length;o++)s=e[o],void 0===t&&(t=s,n=s,r=s.id),t!==n&&!a.are_outcomes_equivalent(n.state,s.state)||n.settled!==s.settled||r!==s.id?(t.link.session.output(i.disposition({role:t.link.is_receiver(),first:t.id,last:n.id,state:t.state,settled:t.settled})),t=s,n=s,r=s.id):(n.id!==s.id&&(n=s),r++);void 0!==t&&void 0!==n&&t.link.session.output(i.disposition({role:t.link.is_receiver(),first:t.id,last:n.id,state:t.state,settled:t.settled}))}p.prototype.available=function(){return this.capacity-this.size},p.prototype.push=function(e){if(!(this.size<this.capacity))throw Error("circular buffer overflow: head="+this.head+" tail="+this.tail+" size="+this.size+" capacity="+this.capacity);this.entries[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.size++},p.prototype.pop_if=function(e){for(var t=0;this.size&&e(this.entries[this.head]);)this.entries[this.head]=void 0,this.head=(this.head+1)%this.capacity,this.size--,t++;return t},p.prototype.by_id=function(e){if(this.size>0){var t=e-this.entries[this.head].id;if(t<this.size)return this.entries[(this.head+t)%this.capacity]}},p.prototype.get_head=function(){return this.size>0?this.entries[this.head]:void 0},p.prototype.get_tail=function(){return this.size>0?this.entries[(this.head+this.size-1)%this.capacity]:void 0};var m=function(e){this.deliveries=new p(2048),this.updated=[],this.pending_dispositions=[],this.next_delivery_id=0,this.next_pending_delivery=0,this.next_transfer_id=0,this.window=c.MAX_UINT,this.remote_next_transfer_id=void 0,this.remote_window=void 0,this.connection=e};m.prototype.available=function(){return this.deliveries.available()},m.prototype.compute_max_payload=function(e){return this.connection.max_frame_size?this.connection.max_frame_size-(50+e.length):void 0},m.prototype.send=function(e,t,n,r){var i=[],o=this.compute_max_payload(t);if(o&&n.length>o)for(var s=0;s<n.length;){var a=Math.min(s+o,n.length);i.push(n.slice(s,a)),s=a}else i.push(n);var c={id:this.next_delivery_id++,tag:t,link:e,data:i,format:r||0,sent:!1,settled:!1,state:void 0,remote_settled:!1,remote_state:void 0},u=this;return c.update=function(e,t){u.update(c,e,t)},this.deliveries.push(c),c},m.prototype.on_begin=function(e){this.remote_window=e.incoming_window},m.prototype.on_flow=function(e){this.remote_next_transfer_id=e.next_incoming_id,this.remote_window=e.incoming_window},m.prototype.on_disposition=function(e){for(var t=e.last?e.last:e.first,n=e.first;n<=t;n++){var r=this.deliveries.by_id(n);if(r&&!r.remote_settled){var i=!1;e.settled&&(r.remote_settled=e.settled,i=!0),e.state&&e.state!==r.remote_state&&(r.remote_state=a.unwrap_outcome(e.state),i=!0),i&&this.updated.push(r)}}},m.prototype.update=function(e,t,n){e&&(e.settled=t,void 0!==n&&(e.state=n),e.remote_settled||this.pending_dispositions.push(e),e.link.connection._register())},m.prototype.transfer_window=function(){return this.remote_window?this.remote_window-(this.next_transfer_id-this.remote_next_transfer_id):0},m.prototype.process=function(){for(var e;this.next_pending_delivery<this.next_delivery_id;){if(!(e=this.deliveries.by_id(this.next_pending_delivery))){console.error("ERROR: Next pending delivery not found: "+this.next_pending_delivery);break}if(!e.link.has_credit()){s.flow("[%s] Link has no credit",this.connection.options.id);break}if(!(this.transfer_window()>=e.data.length)){s.flow("[%s] Incoming window of peer preventing sending further transfers: remote_window=%d, remote_next_transfer_id=%d, next_transfer_id=%d",this.connection.options.id,this.remote_window,this.remote_next_transfer_id,this.next_transfer_id);break}this.window-=e.data.length;for(var t=0;t<e.data.length;t++){this.next_transfer_id++;var n=t+1<e.data.length,r=i.transfer({handle:e.link.local.handle,message_format:e.format,delivery_id:e.id,delivery_tag:e.tag,settled:e.settled,more:n});e.link.session.output(r,e.data[t]),e.settled&&(e.remote_settled=!0)}e.link.credit--,e.link.delivery_count++,this.next_pending_delivery++}for(t=0;t<this.updated.length;t++)(e=this.updated[t]).remote_state&&e.remote_state.constructor.composite_type&&e.link.dispatch(e.remote_state.constructor.composite_type,e.link._context({delivery:e})),e.remote_settled&&e.link.dispatch("settled",e.link._context({delivery:e}));this.updated=[],this.pending_dispositions.length&&(f(this.pending_dispositions),this.pending_dispositions=[]),this.deliveries.pop_if((function(e){return e.settled&&e.remote_settled}))};var y=function(){this.deliveries=new p(2048),this.updated=[],this.next_transfer_id=0,this.next_delivery_id=void 0,Object.defineProperty(this,"window",{get:function(){return this.deliveries.available()}}),this.remote_next_transfer_id=void 0,this.remote_window=void 0,this.max_transfer_id=this.next_transfer_id+this.window};y.prototype.update=function(e,t,n){e&&(e.settled=t,void 0!==n&&(e.state=n),e.remote_settled||this.updated.push(e),e.link.connection._register())},y.prototype.on_transfer=function(e,n){if(this.next_transfer_id++,!n.is_remote_open())throw Error("transfer after detach");var r,i;if(void 0===this.next_delivery_id&&(this.next_delivery_id=e.performative.delivery_id),n._incomplete){if(r=n._incomplete,u.is_defined(e.performative.delivery_id)&&r.id!==e.performative.delivery_id)throw Error("frame sequence error: delivery "+r.id+" not complete, got "+e.performative.delivery_id);i=e.payload?t.concat([r.data,e.payload],r.data.length+e.payload.length):r.data}else{if(this.next_delivery_id!==e.performative.delivery_id)throw Error("frame sequence error: expected "+this.next_delivery_id+", got "+e.performative.delivery_id);r={id:e.performative.delivery_id,tag:e.performative.delivery_tag,format:e.performative.message_format,link:n,settled:!1,state:void 0,remote_settled:void 0!==e.performative.settled&&e.performative.settled,remote_state:e.performative.state};var o=this;r.update=function(e,t){var i=e;void 0===i&&(i=1!==n.local.attach.rcv_settle_mode),o.update(r,i,t)},r.accept=function(){this.update(void 0,a.accepted().described())},r.release=function(e){e?this.update(void 0,a.modified(e).described()):this.update(void 0,a.released().described())},r.reject=function(e){this.update(void 0,a.rejected({error:e}).described())},r.modified=function(e){this.update(void 0,a.modified(e).described())},this.deliveries.push(r),this.next_delivery_id++,i=e.payload}if(r.incomplete=e.performative.more,r.incomplete)n._incomplete=r,r.data=i;else{n._incomplete=void 0,n.credit>0?n.credit--:console.error("Received transfer when credit was %d",n.credit),n.delivery_count++;var s=0===r.format?{message:a.decode(i),delivery:r}:{message:i,delivery:r,format:r.format};n.dispatch("message",n._context(s))}},y.prototype.process=function(e){this.updated.length>0&&(f(this.updated),this.updated=[]),this.deliveries.pop_if((function(e){return e.settled})),this.max_transfer_id-this.next_transfer_id<this.window/2&&e._write_flow()},y.prototype.on_begin=function(e){this.remote_window=e.outgoing_window,this.remote_next_transfer_id=e.next_outgoing_id},y.prototype.on_flow=function(e){this.remote_next_transfer_id=e.next_outgoing_id,this.remote_window=e.outgoing_window},y.prototype.on_disposition=function(e){for(var t=e.last?e.last:e.first,n=e.first;n<=t;n++){var r=this.deliveries.by_id(n);r&&!r.remote_settled&&(e.state&&e.state!==r.remote_state&&(r.remote_state=a.unwrap_outcome(e.state)),e.settled&&(r.remote_settled=e.settled,r.link.dispatch("settled",r.link._context({delivery:r}))))}};var g=function(e,t){this.connection=e,this.outgoing=new m(e),this.incoming=new y,this.state=new l,this.local={channel:t,handles:{}},this.local.begin=i.begin({next_outgoing_id:this.outgoing.next_transfer_id,incoming_window:this.incoming.window,outgoing_window:this.outgoing.window}),this.local.end=i.end(),this.remote={handles:{}},this.links={},this.options={},Object.defineProperty(this,"error",{get:function(){return this.remote.end?this.remote.end.error:void 0}}),this.observers=new h};function v(e,t,n,r){var i=Object.create(r||{});"string"==typeof t?i[n]=t:t&&function e(t,n){for(var r in n)"properties"===r&&t.properties?e(t.properties,n.properties):t[r]=n[r]}(i,t),i.name||(i.name=u.generate_uuid());var o=e(i.name,i);for(var s in{source:0,target:0})i[s]&&("string"==typeof i[s]&&(i[s]={address:i[s]}),o["set_"+s](i[s]));return o.is_sender()&&void 0===i.source&&(i.source=o.set_source({})),o.is_receiver()&&void 0===i.target&&(i.target=o.set_target({})),o.attach(),o}function _(e){e.dispatch("sendable",e._context())}function b(e){return e.is_open()&&e.sendable()}(g.prototype=Object.create(h.prototype)).constructor=g,g.prototype._disconnect=function(){for(var e in this.state.disconnected(),this.links)this.links[e]._disconnect();this.state.was_open||this.remove()},g.prototype._reconnect=function(){for(var e in this.state.reconnect(),this.outgoing=new m(this.connection),this.incoming=new y,this.remote={handles:{}},this.links)this.links[e]._reconnect()},g.prototype.dispatch=function(e){return s.events("[%s] Session got event: %s",this.connection.options.id,e),h.prototype.emit.apply(this.observers,arguments),this.listeners(e).length?(h.prototype.emit.apply(this,arguments),!0):this.connection.dispatch.apply(this.connection,arguments)},g.prototype.output=function(e,t){this.connection._write_frame(this.local.channel,e,t)},g.prototype.create_sender=function(e,t){return t||(t=this.get_option("sender_options",{})),this.create_link(e,o.Sender,t)},g.prototype.create_receiver=function(e,t){return t||(t=this.get_option("receiver_options",{})),this.create_link(e,o.Receiver,t)},g.prototype.get_option=function(e,t){return void 0!==this.options[e]?this.options[e]:this.connection.get_option(e,t)},g.prototype.attach_sender=function(e){return v(this.create_sender.bind(this),e,"target",this.get_option("sender_options",{}))},g.prototype.open_sender=g.prototype.attach_sender,g.prototype.attach_receiver=function(e){return v(this.create_receiver.bind(this),e,"source",this.get_option("receiver_options",{}))},g.prototype.open_receiver=g.prototype.attach_receiver,g.prototype.find_sender=function(e){return this.find_link(u.sender_filter(e))},g.prototype.find_receiver=function(e){return this.find_link(u.receiver_filter(e))},g.prototype.find_link=function(e){for(var t in this.links){var n=this.links[t];if(e(n))return n}},g.prototype.each_receiver=function(e,t){this.each_link(e,u.receiver_filter(t))},g.prototype.each_sender=function(e,t){this.each_link(e,u.sender_filter(t))},g.prototype.each_link=function(e,t){for(var n in this.links){var r=this.links[n];(void 0===t||t(r))&&e(r)}},g.prototype.create_link=function(e,t,n){for(var r=0;this.local.handles[r];)r++;var i=new t(this,e,r,n);return this.links[e]=i,this.local.handles[r]=i,i},g.prototype.begin=function(){this.state.open()&&this.connection._register()},g.prototype.open=g.prototype.begin,g.prototype.end=function(e){e&&(this.local.end.error=e),this.state.close()&&this.connection._register()},g.prototype.close=g.prototype.end,g.prototype.is_open=function(){return this.connection.is_open()&&this.state.is_open()},g.prototype.is_remote_open=function(){return this.connection.is_remote_open()&&this.state.remote_open},g.prototype.is_itself_closed=function(){return this.state.is_closed()},g.prototype.is_closed=function(){return this.connection.is_closed()||this.is_itself_closed()},g.prototype._process=function(){do{this.state.need_open()&&this.output(this.local.begin);var e=0===this.outgoing.deliveries.available();for(var t in this.outgoing.process(),e&&this.outgoing.deliveries.available()&&this.each_sender(_,b),this.incoming.process(this),this.links)this.links[t]._process();this.state.need_close()&&this.output(this.local.end)}while(!this.state.has_settled())},g.prototype.send=function(e,t,n,r){var i=this.outgoing.send(e,t,n,r);return this.connection._register(),i},g.prototype._write_flow=function(e){var t={next_incoming_id:this.incoming.next_transfer_id,incoming_window:this.incoming.window,next_outgoing_id:this.outgoing.next_transfer_id,outgoing_window:this.outgoing.window};this.incoming.max_transfer_id=t.next_incoming_id+t.incoming_window,e&&(e._get_drain()&&(t.drain=!0),t.delivery_count=e.delivery_count,t.handle=e.local.handle,t.link_credit=e.credit),this.output(i.flow(t))},g.prototype.on_begin=function(e){if(!this.state.remote_opened())throw Error("Begin already received");this.remote.channel||(this.remote.channel=e.channel),this.remote.begin=e.performative,this.outgoing.on_begin(e.performative),this.incoming.on_begin(e.performative),this.open(),this.dispatch("session_open",this._context())},g.prototype.on_end=function(e){if(!this.state.remote_closed())throw Error("End already received");this.remote.end=e.performative;var t=this.remote.end.error;if(t){var n=this.dispatch("session_error",this._context());(n=this.dispatch("session_close",this._context())||n)||h.prototype.emit.call(this.connection.container,"error",new d(t.description,t.condition,this))}else this.dispatch("session_close",this._context());var i=this,o=this.state.mark();r.nextTick((function(){i.state.marker===o&&(i.close(),r.nextTick((function(){i.remove()})))}))},g.prototype.on_attach=function(e){var t=e.performative.name,n=this.links[t];n||(n=e.performative.role?this.create_sender(t):this.create_receiver(t)),this.remote.handles[e.performative.handle]=n,n.on_attach(e),n.remote.attach=e.performative},g.prototype.on_disposition=function(e){e.performative.role?(s.events("[%s] Received disposition for outgoing transfers",this.connection.options.id),this.outgoing.on_disposition(e.performative)):(s.events("[%s] Received disposition for incoming transfers",this.connection.options.id),this.incoming.on_disposition(e.performative)),this.connection._register()},g.prototype.on_flow=function(e){this.outgoing.on_flow(e.performative),this.incoming.on_flow(e.performative),u.is_defined(e.performative.handle)&&this._get_link(e).on_flow(e),this.connection._register()},g.prototype._context=function(e){var t=e||{};return t.session=this,this.connection._context(t)},g.prototype._get_link=function(e){var t=e.performative.handle,n=this.remote.handles[t];if(!n)throw Error("Invalid handle "+t);return n},g.prototype.on_detach=function(e){this._get_link(e).on_detach(e)},g.prototype.remove_link=function(e){delete this.remote.handles[e.remote.handle],delete this.local.handles[e.local.handle],delete this.links[e.name]},g.prototype.remove=function(){this.connection.remove_session(this)},g.prototype.on_transfer=function(e){this.incoming.on_transfer(e,this._get_link(e))},e.exports=g}).call(this,n(8).Buffer,n(9))},function(e,t,n){"use strict";(function(t,r){var i=n(47),o=n(34),s=n(61),a=n(123),c=n(60),u=function(e){this.window=e};function l(e){e.delivery.settled=!0}function h(e){e.delivery.update(void 0,s.accepted().described())}function d(e,t,n){Error.call(this),Error.captureStackTrace(this,this.constructor),this.message=e,this.condition=t,this.description=e,Object.defineProperty(this,"link",{value:n})}u.prototype.update=function(e){var t=this.window-e.receiver.credit;t>=this.window/4&&e.receiver.flow(t)},n(19).inherits(d,Error);var p=n(21).EventEmitter,f=Object.create(p.prototype);function m(e){switch(e){case"name":case"handle":case"role":case"initial_delivery_count":return!0;default:return!1}}f.dispatch=function(e){return o.events("[%s] Link got event: %s",this.connection.options.id,e),p.prototype.emit.apply(this.observers,arguments),this.listeners(e).length?(p.prototype.emit.apply(this,arguments),!0):this.session.dispatch.apply(this.session,arguments)},f.set_source=function(e){this.local.attach.source=a.source(e).described()},f.set_target=function(e){this.local.attach.target=a.target(e).described()},f.attach=function(){this.state.open()&&this.connection._register()},f.open=f.attach,f.detach=function(){this.local.detach.closed=!1,this.state.close()&&this.connection._register()},f.close=function(e){e&&(this.local.detach.error=e),this.local.detach.closed=!0,this.state.close()&&this.connection._register()},f.remove=function(){this.session.remove_link(this)},f.is_open=function(){return this.session.is_open()&&this.state.is_open()},f.is_remote_open=function(){return this.session.is_remote_open()&&this.state.remote_open},f.is_itself_closed=function(){return this.state.is_closed()},f.is_closed=function(){return this.session.is_closed()||this.is_itself_closed()},f._process=function(){do{this.state.need_open()&&this.session.output(this.local.attach),this.issue_flow&&this.state.local_open&&(this.session._write_flow(this),this.issue_flow=!1),this.state.need_close()&&this.session.output(this.local.detach)}while(!this.state.has_settled())},f.on_attach=function(e){if(!this.state.remote_opened())throw Error("Attach already received");this.remote.handle||(this.remote.handle=e.handle),e.performative.source=a.unwrap(e.performative.source),e.performative.target=a.unwrap(e.performative.target),this.remote.attach=e.performative,this.open(),this.dispatch(this.is_receiver()?"receiver_open":"sender_open",this._context())},f.prefix_event=function(e){return(this.local.attach.role?"receiver_":"sender_")+e},f.on_detach=function(e){if(!this.state.remote_closed())throw Error("Detach already received");this._incomplete&&(this._incomplete.settled=!0),this.remote.detach=e.performative;var n=this.remote.detach.error;if(n){var r=this.dispatch(this.prefix_event("error"),this._context());(r=this.dispatch(this.prefix_event("close"),this._context())||r)||p.prototype.emit.call(this.connection.container,"error",new d(n.description,n.condition,this))}else this.dispatch(this.prefix_event("close"),this._context());var i=this,o=this.state.mark();t.nextTick((function(){i.state.marker===o&&(i.close(),t.nextTick((function(){i.remove()})))}))};var y=["snd_settle_mode","rcv_settle_mode","source","target","max_message_size","offered_capabilities","desired_capabilities","properties"];function g(e){return function(){return this.remote.attach?this.remote.attach[e]:void 0}}f.init=function(e,t,n,r,o){for(var s in this.session=e,this.connection=e.connection,this.name=t,this.options=void 0===r?{}:r,this.state=new c,this.issue_flow=!1,this.local={handle:n},this.local.attach=i.attach({handle:n,name:t,role:o}),this.local.attach)m(s)||void 0===this.options[s]||(this.local.attach[s]=this.options[s]);this.local.detach=i.detach({handle:n,closed:!0}),this.remote={handle:void 0},this.delivery_count=0,this.credit=0,this.observers=new p;var a=this;y.forEach((function(e){Object.defineProperty(a,e,{get:g(e)})})),Object.defineProperty(this,"error",{get:function(){return this.remote.detach?this.remote.detach.error:void 0}})},f._disconnect=function(){this.state.disconnected(),this.state.was_open||this.remove()},f._reconnect=function(){this.state.reconnect(),this.remote={handle:void 0},this.delivery_count=0,this.credit=0},f.has_credit=function(){return this.credit>0},f.is_receiver=function(){return this.local.attach.role},f.is_sender=function(){return!this.is_receiver()},f._context=function(e){var t=e||{};return this.is_receiver()?t.receiver=this:t.sender=this,this.session._context(t)},f.get_option=function(e,t){return void 0!==this.options[e]?this.options[e]:this.session.get_option(e,t)};var v=function(e,t,n,r){this.init(e,t,n,r,!1),this._draining=!1,this._drained=!1,this.local.attach.initial_delivery_count=0,this.tag=0,this.get_option("autosettle",!0)&&this.observers.on("settled",l);var i=this;this.get_option("treat_modified_as_released",!0)&&this.observers.on("modified",(function(e){i.dispatch("released",e)}))};(v.prototype=Object.create(f)).constructor=v,v.prototype._get_drain=function(){if(this._draining&&this._drained&&this.credit){for(;this.credit;)++this.delivery_count,--this.credit;return!0}return!1},v.prototype.set_drained=function(e){this._drained=e,this._draining&&this._drained&&(this.issue_flow=!0)},v.prototype.next_tag=function(){return r.from(new String(this.tag++))},v.prototype.sendable=function(){return Boolean(this.credit&&this.session.outgoing.available())},v.prototype.on_flow=function(e){var t=e.performative;this.credit=t.delivery_count+t.link_credit-this.delivery_count,this._draining=t.drain,this._drained=this.credit>0,this.is_open()&&(this.dispatch("sender_flow",this._context()),this._draining&&this.dispatch("sender_draining",this._context()),this.sendable()&&this.dispatch("sendable",this._context()))},v.prototype.on_transfer=function(){throw Error("got transfer on sending link")},v.prototype.send=function(e,t,n){var r=void 0===n?s.encode(e):e,i=this.session.send(this,t||this.next_tag(),r,n);return 1===this.local.attach.snd_settle_mode&&(i.settled=!0),i};var _=function(e,t,n,r){this.init(e,t,n,r,!0),this.drain=!1,this.set_credit_window(this.get_option("credit_window",1e3)),this.get_option("autoaccept",!0)&&this.observers.on("message",h),1===this.local.attach.rcv_settle_mode&&this.get_option("autosettle",!0)&&this.observers.on("settled",l)};(_.prototype=Object.create(f)).constructor=_,_.prototype.on_flow=function(e){this.dispatch("receiver_flow",this._context()),e.performative.drain&&(this.credit=e.performative.link_credit,this.delivery_count=e.performative.delivery_count,e.performative.link_credit>0?console.error("ERROR: received flow with drain set, but non zero credit"):this.dispatch("receiver_drained",this._context()))},_.prototype.flow=function(e){e>0&&(this.credit+=e,this.issue_flow=!0,this.connection._register())},_.prototype.drain_credit=function(){this.drain=!0,this.issue_flow=!0,this.connection._register()},_.prototype.add_credit=_.prototype.flow,_.prototype._get_drain=function(){return this.drain},_.prototype.set_credit_window=function(e){if(e>0){var t=new u(e),n=t.update.bind(t);this.observers.on("message",n),this.observers.on("receiver_open",n)}},e.exports={Sender:v,Receiver:_}}).call(this,n(9),n(8).Buffer)},function(e,t,n){"use strict";var r=n(32),i={},o={};function s(e){var t=r.define_composite(e);i[e.name]=t.create,o[Number(t.descriptor.numeric).toString(10)]=t,o[t.descriptor.symbolic]=t}i.unwrap=function(e){if(e&&e.descriptor){var t=o[e.descriptor.value];if(t)return new t(e.value);console.warn("Unknown terminus: "+e.descriptor)}return null},s({name:"source",code:40,fields:[{name:"address",type:"string"},{name:"durable",type:"uint",default_value:0},{name:"expiry_policy",type:"symbol",default_value:"session-end"},{name:"timeout",type:"uint",default_value:0},{name:"dynamic",type:"boolean",default_value:!1},{name:"dynamic_node_properties",type:"symbolic_map"},{name:"distribution_mode",type:"symbol"},{name:"filter",type:"symbolic_map"},{name:"default_outcome",type:"*"},{name:"outcomes",type:"symbol",multiple:!0},{name:"capabilities",type:"symbol",multiple:!0}]}),s({name:"target",code:41,fields:[{name:"address",type:"string"},{name:"durable",type:"uint",default_value:0},{name:"expiry_policy",type:"symbol",default_value:"session-end"},{name:"timeout",type:"uint",default_value:0},{name:"dynamic",type:"boolean",default_value:!1},{name:"dynamic_node_properties",type:"symbolic_map"},{name:"capabilities",type:"symbol",multiple:!0}]}),e.exports=i},function(e,t){},function(e,t){t.endianness=function(){return"LE"},t.hostname=function(){return"undefined"!=typeof location?location.hostname:""},t.loadavg=function(){return[]},t.uptime=function(){return 0},t.freemem=function(){return Number.MAX_VALUE},t.totalmem=function(){return Number.MAX_VALUE},t.cpus=function(){return[]},t.type=function(){return"Browser"},t.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},t.networkInterfaces=t.getNetworkInterfaces=function(){return{}},t.arch=function(){return"javascript"},t.platform=function(){return"browser"},t.tmpdir=t.tmpDir=function(){return"/tmp"},t.EOL="\n",t.homedir=function(){return"/"}},function(e,t,n){"use strict";var r,i,o,s;!function(e){e.message="message",e.receiverOpen="receiver_open",e.receiverDrained="receiver_drained",e.receiverFlow="receiver_flow",e.receiverError="receiver_error",e.receiverClose="receiver_close",e.settled="settled"}(r||(r={})),function(e){e.sendable="sendable",e.senderOpen="sender_open",e.senderDraining="sender_draining",e.senderFlow="sender_flow",e.senderError="sender_error",e.senderClose="sender_close",e.accepted="accepted",e.released="released",e.rejected="rejected",e.modified="modified",e.settled="settled"}(i||(i={})),function(e){e.sessionOpen="session_open",e.sessionError="session_error",e.sessionClose="session_close",e.settled="settled"}(o||(o={})),function(e){e.connectionOpen="connection_open",e.connectionClose="connection_close",e.connectionError="connection_error",e.protocolError="protocol_error",e.error="error",e.disconnected="disconnected",e.settled="settled"}(s||(s={})),e.exports={ReceiverEvents:r,SenderEvents:i,SessionEvents:o,ConnectionEvents:s}},function(e,t,n){"use strict";(function(t){function n(e){return e}function r(e){return e instanceof ArrayBuffer?t.from(new Uint8Array(e)):t.from(e)}function i(e){return new Uint8Array(e)}function o(e){var t=n,o=n;return e.binaryType&&(e.binaryType="arraybuffer",t=r,o=i),{end:function(){e.close()},write:function(t){try{e.send(o(t),{binary:!0})}catch(t){e.onerror(t)}},on:function(n,r){"data"===n?e.onmessage=function(e){r(t(e.data))}:"end"===n?e.onclose=r:"error"===n?e.onerror=r:console.error("ERROR: Attempt to set unrecognised handler on websocket wrapper: "+n)},get_id_string:function(){return e.url}}}e.exports={connect:function(e){return function(t,n,r){return function(){return{connect:function(i,s,a,c){var u=new e(t,n,r);return u.onopen=c,o(u)}}}}},wrap:o}}).call(this,n(8).Buffer)},function(e,t,n){"use strict";var r=n(32);e.exports={selector:function(e){return{"jms-selector":r.wrap_described(e,77567109365764)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultOperationTimeoutInSeconds=60},function(e,t,n){"use strict";var r=n(131),i=n(92),o=n(69),s=Object.prototype.hasOwnProperty,a={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},c=Array.isArray,u=String.prototype.split,l=Array.prototype.push,h=function(e,t){l.apply(e,c(t)?t:[t])},d=Date.prototype.toISOString,p=o.default,f={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,format:p,formatter:o.formatters[p],indices:!1,serializeDate:function(e){return d.call(e)},skipNulls:!1,strictNullHandling:!1},m={},y=function e(t,n,o,s,a,l,d,p,y,g,v,_,b,w,E,S){for(var k,O=t,T=S,C=0,I=!1;void 0!==(T=T.get(m))&&!I;){var A=T.get(t);if(C+=1,void 0!==A){if(A===C)throw new RangeError("Cyclic object value");I=!0}void 0===T.get(m)&&(C=0)}if("function"==typeof p?O=p(n,O):O instanceof Date?O=v(O):"comma"===o&&c(O)&&(O=i.maybeMap(O,(function(e){return e instanceof Date?v(e):e}))),null===O){if(a)return d&&!w?d(n,f.encoder,E,"key",_):n;O=""}if("string"==typeof(k=O)||"number"==typeof k||"boolean"==typeof k||"symbol"==typeof k||"bigint"==typeof k||i.isBuffer(O)){if(d){var x=w?n:d(n,f.encoder,E,"key",_);if("comma"===o&&w){for(var R=u.call(String(O),","),P="",N=0;N<R.length;++N)P+=(0===N?"":",")+b(d(R[N],f.encoder,E,"value",_));return[b(x)+(s&&c(O)&&1===R.length?"[]":"")+"="+P]}return[b(x)+"="+b(d(O,f.encoder,E,"value",_))]}return[b(n)+"="+b(String(O))]}var j,L=[];if(void 0===O)return L;if("comma"===o&&c(O))j=[{value:O.length>0?O.join(",")||null:void 0}];else if(c(p))j=p;else{var M=Object.keys(O);j=y?M.sort(y):M}for(var q=s&&c(O)&&1===O.length?n+"[]":n,z=0;z<j.length;++z){var U=j[z],B="object"==typeof U&&void 0!==U.value?U.value:O[U];if(!l||null!==B){var D=c(O)?"function"==typeof o?o(q,U):q:q+(g?"."+U:"["+U+"]");S.set(t,C);var F=r();F.set(m,S),h(L,e(B,D,o,s,a,l,d,p,y,g,v,_,b,w,E,F))}}return L};e.exports=function(e,t){var n,i=e,u=function(e){if(!e)return f;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||f.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=o.default;if(void 0!==e.format){if(!s.call(o.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var r=o.formatters[n],i=f.filter;return("function"==typeof e.filter||c(e.filter))&&(i=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:f.addQueryPrefix,allowDots:void 0===e.allowDots?f.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:f.charsetSentinel,delimiter:void 0===e.delimiter?f.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:f.encode,encoder:"function"==typeof e.encoder?e.encoder:f.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:f.encodeValuesOnly,filter:i,format:n,formatter:r,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:f.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:f.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:f.strictNullHandling}}(t);"function"==typeof u.filter?i=(0,u.filter)("",i):c(u.filter)&&(n=u.filter);var l,d=[];if("object"!=typeof i||null===i)return"";l=t&&t.arrayFormat in a?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var p=a[l];if(t&&"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var m="comma"===p&&t&&t.commaRoundTrip;n||(n=Object.keys(i)),u.sort&&n.sort(u.sort);for(var g=r(),v=0;v<n.length;++v){var _=n[v];u.skipNulls&&null===i[_]||h(d,y(i[_],_,p,m,u.strictNullHandling,u.skipNulls,u.encode?u.encoder:null,u.filter,u.sort,u.allowDots,u.serializeDate,u.format,u.formatter,u.encodeValuesOnly,u.charset,g))}var b=d.join(u.delimiter),w=!0===u.addQueryPrefix?"?":"";return u.charsetSentinel&&("iso-8859-1"===u.charset?w+="utf8=%26%2310003%3B&":w+="utf8=%E2%9C%93&"),b.length>0?w+b:""}},function(e,t,n){"use strict";var r=n(67),i=n(136),o=n(138),s=r("%TypeError%"),a=r("%WeakMap%",!0),c=r("%Map%",!0),u=i("WeakMap.prototype.get",!0),l=i("WeakMap.prototype.set",!0),h=i("WeakMap.prototype.has",!0),d=i("Map.prototype.get",!0),p=i("Map.prototype.set",!0),f=i("Map.prototype.has",!0),m=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n};e.exports=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new s("Side channel does not contain "+o(e))},get:function(r){if(a&&r&&("object"==typeof r||"function"==typeof r)){if(e)return u(e,r)}else if(c){if(t)return d(t,r)}else if(n)return function(e,t){var n=m(e,t);return n&&n.value}(n,r)},has:function(r){if(a&&r&&("object"==typeof r||"function"==typeof r)){if(e)return h(e,r)}else if(c){if(t)return f(t,r)}else if(n)return function(e,t){return!!m(e,t)}(n,r);return!1},set:function(r,i){a&&r&&("object"==typeof r||"function"==typeof r)?(e||(e=new a),l(e,r,i)):c?(t||(t=new c),p(t,r,i)):(n||(n={key:{},next:null}),function(e,t,n){var r=m(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,i))}};return r}},function(e,t,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,i=n(133);e.exports=function(){return"function"==typeof r&&("function"==typeof Symbol&&("symbol"==typeof r("foo")&&("symbol"==typeof Symbol("bar")&&i())))}},function(e,t,n){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},function(e,t,n){"use strict";var r="Function.prototype.bind called on incompatible ",i=Array.prototype.slice,o=Object.prototype.toString;e.exports=function(e){var t=this;if("function"!=typeof t||"[object Function]"!==o.call(t))throw new TypeError(r+t);for(var n,s=i.call(arguments,1),a=function(){if(this instanceof n){var r=t.apply(this,s.concat(i.call(arguments)));return Object(r)===r?r:this}return t.apply(e,s.concat(i.call(arguments)))},c=Math.max(0,t.length-s.length),u=[],l=0;l<c;l++)u.push("$"+l);if(n=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(a),t.prototype){var h=function(){};h.prototype=t.prototype,n.prototype=new h,h.prototype=null}return n}},function(e,t,n){"use strict";var r=n(68);e.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},function(e,t,n){"use strict";var r=n(67),i=n(137),o=i(r("String.prototype.indexOf"));e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&o(e,".prototype.")>-1?i(n):n}},function(e,t,n){"use strict";var r=n(68),i=n(67),o=i("%Function.prototype.apply%"),s=i("%Function.prototype.call%"),a=i("%Reflect.apply%",!0)||r.call(s,o),c=i("%Object.getOwnPropertyDescriptor%",!0),u=i("%Object.defineProperty%",!0),l=i("%Math.max%");if(u)try{u({},"a",{value:1})}catch(e){u=null}e.exports=function(e){var t=a(r,s,arguments);if(c&&u){var n=c(t,"length");n.configurable&&u(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}return t};var h=function(){return a(r,o,arguments)};u?u(e.exports,"apply",{value:h}):e.exports.apply=h},function(e,t,n){var r="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=r&&i&&"function"==typeof i.get?i.get:null,s=r&&Map.prototype.forEach,a="function"==typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,u=a&&c&&"function"==typeof c.get?c.get:null,l=a&&Set.prototype.forEach,h="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,d="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,p="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,f=Boolean.prototype.valueOf,m=Object.prototype.toString,y=Function.prototype.toString,g=String.prototype.match,v=String.prototype.slice,_=String.prototype.replace,b=String.prototype.toUpperCase,w=String.prototype.toLowerCase,E=RegExp.prototype.test,S=Array.prototype.concat,k=Array.prototype.join,O=Array.prototype.slice,T=Math.floor,C="function"==typeof BigInt?BigInt.prototype.valueOf:null,I=Object.getOwnPropertySymbols,A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,x="function"==typeof Symbol&&"object"==typeof Symbol.iterator,R="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===x||"symbol")?Symbol.toStringTag:null,P=Object.prototype.propertyIsEnumerable,N=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function j(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||E.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var r=e<0?-T(-e):T(e);if(r!==e){var i=String(r),o=v.call(t,i.length+1);return _.call(i,n,"$&_")+"."+_.call(_.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return _.call(t,n,"$&_")}var L=n(139),M=L.custom,q=F(M)?M:null;function z(e,t,n){var r="double"===(n.quoteStyle||t)?'"':"'";return r+e+r}function U(e){return _.call(String(e),/"/g,"&quot;")}function B(e){return!("[object Array]"!==K(e)||R&&"object"==typeof e&&R in e)}function D(e){return!("[object RegExp]"!==K(e)||R&&"object"==typeof e&&R in e)}function F(e){if(x)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!A)return!1;try{return A.call(e),!0}catch(e){}return!1}e.exports=function e(t,n,r,i){var a=n||{};if($(a,"quoteStyle")&&"single"!==a.quoteStyle&&"double"!==a.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if($(a,"maxStringLength")&&("number"==typeof a.maxStringLength?a.maxStringLength<0&&a.maxStringLength!==1/0:null!==a.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var c=!$(a,"customInspect")||a.customInspect;if("boolean"!=typeof c&&"symbol"!==c)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if($(a,"indent")&&null!==a.indent&&"\t"!==a.indent&&!(parseInt(a.indent,10)===a.indent&&a.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if($(a,"numericSeparator")&&"boolean"!=typeof a.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var m=a.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return function e(t,n){if(t.length>n.maxStringLength){var r=t.length-n.maxStringLength,i="... "+r+" more character"+(r>1?"s":"");return e(v.call(t,0,n.maxStringLength),n)+i}return z(_.call(_.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,V),"single",n)}(t,a);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var b=String(t);return m?j(t,b):b}if("bigint"==typeof t){var E=String(t)+"n";return m?j(t,E):E}var T=void 0===a.depth?5:a.depth;if(void 0===r&&(r=0),r>=T&&T>0&&"object"==typeof t)return B(t)?"[Array]":"[Object]";var I=function(e,t){var n;if("\t"===e.indent)n="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;n=k.call(Array(e.indent+1)," ")}return{base:n,prev:k.call(Array(t+1),n)}}(a,r);if(void 0===i)i=[];else if(W(i,t)>=0)return"[Circular]";function M(t,n,o){if(n&&(i=O.call(i)).push(n),o){var s={depth:a.depth};return $(a,"quoteStyle")&&(s.quoteStyle=a.quoteStyle),e(t,s,r+1,i)}return e(t,a,r+1,i)}if("function"==typeof t&&!D(t)){var H=function(e){if(e.name)return e.name;var t=g.call(y.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),X=Q(t,M);return"[Function"+(H?": "+H:" (anonymous)")+"]"+(X.length>0?" { "+k.call(X,", ")+" }":"")}if(F(t)){var ee=x?_.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):A.call(t);return"object"!=typeof t||x?ee:G(ee)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var te="<"+w.call(String(t.nodeName)),ne=t.attributes||[],re=0;re<ne.length;re++)te+=" "+ne[re].name+"="+z(U(ne[re].value),"double",a);return te+=">",t.childNodes&&t.childNodes.length&&(te+="..."),te+="</"+w.call(String(t.nodeName))+">"}if(B(t)){if(0===t.length)return"[]";var ie=Q(t,M);return I&&!function(e){for(var t=0;t<e.length;t++)if(W(e[t],"\n")>=0)return!1;return!0}(ie)?"["+Z(ie,I)+"]":"[ "+k.call(ie,", ")+" ]"}if(function(e){return!("[object Error]"!==K(e)||R&&"object"==typeof e&&R in e)}(t)){var oe=Q(t,M);return"cause"in Error.prototype||!("cause"in t)||P.call(t,"cause")?0===oe.length?"["+String(t)+"]":"{ ["+String(t)+"] "+k.call(oe,", ")+" }":"{ ["+String(t)+"] "+k.call(S.call("[cause]: "+M(t.cause),oe),", ")+" }"}if("object"==typeof t&&c){if(q&&"function"==typeof t[q]&&L)return L(t,{depth:T-r});if("symbol"!==c&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!o||!e||"object"!=typeof e)return!1;try{o.call(e);try{u.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var se=[];return s.call(t,(function(e,n){se.push(M(n,t,!0)+" => "+M(e,t))})),J("Map",o.call(t),se,I)}if(function(e){if(!u||!e||"object"!=typeof e)return!1;try{u.call(e);try{o.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var ae=[];return l.call(t,(function(e){ae.push(M(e,t))})),J("Set",u.call(t),ae,I)}if(function(e){if(!h||!e||"object"!=typeof e)return!1;try{h.call(e,h);try{d.call(e,d)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Y("WeakMap");if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{d.call(e,d);try{h.call(e,h)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Y("WeakSet");if(function(e){if(!p||!e||"object"!=typeof e)return!1;try{return p.call(e),!0}catch(e){}return!1}(t))return Y("WeakRef");if(function(e){return!("[object Number]"!==K(e)||R&&"object"==typeof e&&R in e)}(t))return G(M(Number(t)));if(function(e){if(!e||"object"!=typeof e||!C)return!1;try{return C.call(e),!0}catch(e){}return!1}(t))return G(M(C.call(t)));if(function(e){return!("[object Boolean]"!==K(e)||R&&"object"==typeof e&&R in e)}(t))return G(f.call(t));if(function(e){return!("[object String]"!==K(e)||R&&"object"==typeof e&&R in e)}(t))return G(M(String(t)));if(!function(e){return!("[object Date]"!==K(e)||R&&"object"==typeof e&&R in e)}(t)&&!D(t)){var ce=Q(t,M),ue=N?N(t)===Object.prototype:t instanceof Object||t.constructor===Object,le=t instanceof Object?"":"null prototype",he=!ue&&R&&Object(t)===t&&R in t?v.call(K(t),8,-1):le?"Object":"",de=(ue||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(he||le?"["+k.call(S.call([],he||[],le||[]),": ")+"] ":"");return 0===ce.length?de+"{}":I?de+"{"+Z(ce,I)+"}":de+"{ "+k.call(ce,", ")+" }"}return String(t)};var H=Object.prototype.hasOwnProperty||function(e){return e in this};function $(e,t){return H.call(e,t)}function K(e){return m.call(e)}function W(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function V(e){var t=e.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return n?"\\"+n:"\\x"+(t<16?"0":"")+b.call(t.toString(16))}function G(e){return"Object("+e+")"}function Y(e){return e+" { ? }"}function J(e,t,n,r){return e+" ("+t+") {"+(r?Z(n,r):k.call(n,", "))+"}"}function Z(e,t){if(0===e.length)return"";var n="\n"+t.prev+t.base;return n+k.call(e,","+n)+"\n"+t.prev}function Q(e,t){var n=B(e),r=[];if(n){r.length=e.length;for(var i=0;i<e.length;i++)r[i]=$(e,i)?t(e[i],e):""}var o,s="function"==typeof I?I(e):[];if(x){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var c in e)$(e,c)&&(n&&String(Number(c))===c&&c<e.length||x&&o["$"+c]instanceof Symbol||(E.call(/[^\w$]/,c)?r.push(t(c,e)+": "+t(e[c],e)):r.push(c+": "+t(e[c],e))));if("function"==typeof I)for(var u=0;u<s.length;u++)P.call(e,s[u])&&r.push("["+t(s[u])+"]: "+t(e[s[u]],e));return r}},function(e,t){},function(e,t,n){"use strict";var r=n(92),i=Object.prototype.hasOwnProperty,o=Array.isArray,s={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:r.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},a=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},c=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},u=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/g,a=n.depth>0&&/(\[[^[\]]*])/.exec(o),u=a?o.slice(0,a.index):o,l=[];if(u){if(!n.plainObjects&&i.call(Object.prototype,u)&&!n.allowPrototypes)return;l.push(u)}for(var h=0;n.depth>0&&null!==(a=s.exec(o))&&h<n.depth;){if(h+=1,!n.plainObjects&&i.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;l.push(a[1])}return a&&l.push("["+o.slice(a.index)+"]"),function(e,t,n,r){for(var i=r?t:c(t,n),o=e.length-1;o>=0;--o){var s,a=e[o];if("[]"===a&&n.parseArrays)s=[].concat(i);else{s=n.plainObjects?Object.create(null):{};var u="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,l=parseInt(u,10);n.parseArrays||""!==u?!isNaN(l)&&a!==u&&String(l)===u&&l>=0&&n.parseArrays&&l<=n.arrayLimit?(s=[])[l]=i:"__proto__"!==u&&(s[u]=i):s={0:i}}i=s}return i}(l,t,n,r)}};e.exports=function(e,t){var n=function(e){if(!e)return s;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?s.charset:e.charset;return{allowDots:void 0===e.allowDots?s.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:s.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:s.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:s.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:s.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:s.comma,decoder:"function"==typeof e.decoder?e.decoder:s.decoder,delimiter:"string"==typeof e.delimiter||r.isRegExp(e.delimiter)?e.delimiter:s.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:s.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:s.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:s.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:s.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:s.strictNullHandling}}(t);if(""===e||null==e)return n.plainObjects?Object.create(null):{};for(var l="string"==typeof e?function(e,t){var n,u={},l=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,h=t.parameterLimit===1/0?void 0:t.parameterLimit,d=l.split(t.delimiter,h),p=-1,f=t.charset;if(t.charsetSentinel)for(n=0;n<d.length;++n)0===d[n].indexOf("utf8=")&&("utf8=%E2%9C%93"===d[n]?f="utf-8":"utf8=%26%2310003%3B"===d[n]&&(f="iso-8859-1"),p=n,n=d.length);for(n=0;n<d.length;++n)if(n!==p){var m,y,g=d[n],v=g.indexOf("]="),_=-1===v?g.indexOf("="):v+1;-1===_?(m=t.decoder(g,s.decoder,f,"key"),y=t.strictNullHandling?null:""):(m=t.decoder(g.slice(0,_),s.decoder,f,"key"),y=r.maybeMap(c(g.slice(_+1),t),(function(e){return t.decoder(e,s.decoder,f,"value")}))),y&&t.interpretNumericEntities&&"iso-8859-1"===f&&(y=a(y)),g.indexOf("[]=")>-1&&(y=o(y)?[y]:y),i.call(u,m)?u[m]=r.combine(u[m],y):u[m]=y}return u}(e,n):e,h=n.plainObjects?Object.create(null):{},d=Object.keys(l),p=0;p<d.length;++p){var f=d[p],m=u(f,l[f],n,"string"==typeof e);h=r.merge(h,m,n)}return!0===n.allowSparse?h:r.compact(h)}},function(e,t,n){"use strict";n.r(t);var r=n(93);n.d(t,"AvroSerializer",(function(){return r.a}))},function(e,t,n){"use strict";var r=n(143),i=n(145),o=n(158),s=n(36);e.exports={Service:i.Service,assembleProtocol:o.assembleProtocol,discoverProtocol:i.discoverProtocol,parse:function(e,t){var n=o.read(e);return n.protocol?i.Service.forProtocol(n,t):r.Type.forSchema(n,t)},readProtocol:o.readProtocol,readSchema:o.readSchema},s.copyOwnProperties(r,e.exports)},function(e,t,n){"use strict";var r=n(70);e.exports={Type:r.Type,parse:function(e,t){var n;if("string"==typeof e)try{n=JSON.parse(e)}catch(t){n=e}else n=e;return r.Type.forSchema(n,t)},types:r.builtins,combine:r.Type.forTypes,infer:r.Type.forValue}},function(e,t,n){"use strict";(function(t){function n(){this.data=void 0}function r(e,t){var n=e[0],r=e[1],i=e[2],u=e[3];n=o(n,r,i,u,t[0],7,-680876936),u=o(u,n,r,i,t[1],12,-389564586),i=o(i,u,n,r,t[2],17,606105819),r=o(r,i,u,n,t[3],22,-1044525330),n=o(n,r,i,u,t[4],7,-176418897),u=o(u,n,r,i,t[5],12,1200080426),i=o(i,u,n,r,t[6],17,-1473231341),r=o(r,i,u,n,t[7],22,-45705983),n=o(n,r,i,u,t[8],7,1770035416),u=o(u,n,r,i,t[9],12,-1958414417),i=o(i,u,n,r,t[10],17,-42063),r=o(r,i,u,n,t[11],22,-1990404162),n=o(n,r,i,u,t[12],7,1804603682),u=o(u,n,r,i,t[13],12,-40341101),i=o(i,u,n,r,t[14],17,-1502002290),n=s(n,r=o(r,i,u,n,t[15],22,1236535329),i,u,t[1],5,-165796510),u=s(u,n,r,i,t[6],9,-1069501632),i=s(i,u,n,r,t[11],14,643717713),r=s(r,i,u,n,t[0],20,-373897302),n=s(n,r,i,u,t[5],5,-701558691),u=s(u,n,r,i,t[10],9,38016083),i=s(i,u,n,r,t[15],14,-660478335),r=s(r,i,u,n,t[4],20,-405537848),n=s(n,r,i,u,t[9],5,568446438),u=s(u,n,r,i,t[14],9,-1019803690),i=s(i,u,n,r,t[3],14,-187363961),r=s(r,i,u,n,t[8],20,1163531501),n=s(n,r,i,u,t[13],5,-1444681467),u=s(u,n,r,i,t[2],9,-51403784),i=s(i,u,n,r,t[7],14,1735328473),n=a(n,r=s(r,i,u,n,t[12],20,-1926607734),i,u,t[5],4,-378558),u=a(u,n,r,i,t[8],11,-2022574463),i=a(i,u,n,r,t[11],16,1839030562),r=a(r,i,u,n,t[14],23,-35309556),n=a(n,r,i,u,t[1],4,-1530992060),u=a(u,n,r,i,t[4],11,1272893353),i=a(i,u,n,r,t[7],16,-155497632),r=a(r,i,u,n,t[10],23,-1094730640),n=a(n,r,i,u,t[13],4,681279174),u=a(u,n,r,i,t[0],11,-358537222),i=a(i,u,n,r,t[3],16,-722521979),r=a(r,i,u,n,t[6],23,76029189),n=a(n,r,i,u,t[9],4,-640364487),u=a(u,n,r,i,t[12],11,-421815835),i=a(i,u,n,r,t[15],16,530742520),n=c(n,r=a(r,i,u,n,t[2],23,-995338651),i,u,t[0],6,-198630844),u=c(u,n,r,i,t[7],10,1126891415),i=c(i,u,n,r,t[14],15,-1416354905),r=c(r,i,u,n,t[5],21,-57434055),n=c(n,r,i,u,t[12],6,1700485571),u=c(u,n,r,i,t[3],10,-1894986606),i=c(i,u,n,r,t[10],15,-1051523),r=c(r,i,u,n,t[1],21,-2054922799),n=c(n,r,i,u,t[8],6,1873313359),u=c(u,n,r,i,t[15],10,-30611744),i=c(i,u,n,r,t[6],15,-1560198380),r=c(r,i,u,n,t[13],21,1309151649),n=c(n,r,i,u,t[4],6,-145523070),u=c(u,n,r,i,t[11],10,-1120210379),i=c(i,u,n,r,t[2],15,718787259),r=c(r,i,u,n,t[9],21,-343485551),e[0]=l(n,e[0]),e[1]=l(r,e[1]),e[2]=l(i,e[2]),e[3]=l(u,e[3])}function i(e,t,n,r,i,o){return t=l(l(t,e),l(r,o)),l(t<<i|t>>>32-i,n)}function o(e,t,n,r,o,s,a){return i(t&n|~t&r,e,t,o,s,a)}function s(e,t,n,r,o,s,a){return i(t&r|n&~r,e,t,o,s,a)}function a(e,t,n,r,o,s,a){return i(t^n^r,e,t,o,s,a)}function c(e,t,n,r,o,s,a){return i(n^(t|~r),e,t,o,s,a)}function u(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function l(e,t){return e+t&4294967295}n.prototype.end=function(e){this.data=e},n.prototype.read=function(){return function(e){var n,i=function(e){var t,n=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)r(i,u(e.substring(t-64,t)));e=e.substring(t-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(r(i,o),t=0;t<16;t++)o[t]=0;return o[14]=8*n,r(i,o),i}(e),o=t.alloc?t.alloc(16):new t(16);for(n=0;n<4;n++)o.writeIntLE(i[n],4*n,4);return o}(this.data)},e.exports={createHash:function(e){if("md5"!==e)throw new Error("only md5 is supported in the browser");return new n}}}).call(this,n(8).Buffer)},function(e,t,n){"use strict";(function(t,r){var i=n(70),o=n(36),s=n(21),a=n(53),c=n(19),u=o.Tap,l=i.Type,h=c.debuglog("avsc:services"),d=c.format,p={namespace:"org.apache.avro.ipc"},f=l.forSchema("boolean",p),m=l.forSchema({type:"map",values:"bytes"},p),y=l.forSchema("string",p),g=l.forSchema({name:"HandshakeRequest",type:"record",fields:[{name:"clientHash",type:{name:"MD5",type:"fixed",size:16}},{name:"clientProtocol",type:["null","string"],default:null},{name:"serverHash",type:"MD5"},{name:"meta",type:["null",m],default:null}]},p),v=l.forSchema({name:"HandshakeResponse",type:"record",fields:[{name:"match",type:{name:"HandshakeMatch",type:"enum",symbols:["BOTH","CLIENT","NONE"]}},{name:"serverProtocol",type:["null","string"],default:null},{name:"serverHash",type:["null","MD5"],default:null},{name:"meta",type:["null",m],default:null}]},p),_=new b("",l.forSchema({name:"PingRequest",type:"record",fields:[]},p),l.forSchema(["string"],p),l.forSchema("null",p));function b(e,t,n,r,i,o){if(this.name=e,!l.isType(t,"record"))throw new Error("invalid request type");if(this.requestType=t,!l.isType(n,"union")||!l.isType(n.getTypes()[0],"string"))throw new Error("invalid error type");if(this.errorType=n,i&&(!l.isType(r,"null")||n.getTypes().length>1))throw new Error("inapplicable one-way parameter");this.responseType=r,this.oneWay=!!i,this.doc=void 0!==o?""+o:void 0,Object.freeze(this)}function w(e,t,n,r,i){if("string"!=typeof e)return w.forProtocol(e,t);this.name=e,this._messagesByName=t||{},this.messages=Object.freeze(o.objectValues(this._messagesByName)),this._typesByName=n||{},this.types=Object.freeze(o.objectValues(this._typesByName)),this.protocol=r,this._hashStr=o.getHash(JSON.stringify(r)).toString("binary"),this.doc=r.doc?""+r.doc:void 0,this._server=i||this.createServer({silent:!0}),Object.freeze(this)}function E(e,t){t=t||{},s.EventEmitter.call(this),this._svc$=e,this._channels$=[],this._fns$=[],this._buffering$=!!t.buffering,this._cache$=t.cache||{},this._policy$=t.channelPolicy,this._strict$=!!t.strictTypes,this._timeout$=o.getOption(t,"timeout",1e4),t.remoteProtocols&&H(this._cache$,t.remoteProtocols,e,!0),this._svc$.messages.forEach((function(e){this[e.name]=this._createMessageHandler$(e)}),this)}function S(e,t){t=t||{},s.EventEmitter.call(this),this.service=e,this._handlers={},this._fns=[],this._channels={},this._nextChannelId=1,this._cache=t.cache||{},this._defaultHandler=t.defaultHandler,this._sysErrFormatter=t.systemErrorFormatter,this._silent=!!t.silent,this._strict=!!t.strictTypes,t.remoteProtocols&&H(this._cache,t.remoteProtocols,e,!1),e.messages.forEach((function(e){var n=e.name;t.noCapitalize||(n=o.capitalize(n)),this["on"+n]=this._createMessageHandler(e)}),this)}function k(e,t){t=t||{},s.EventEmitter.call(this),this.client=e,this.timeout=o.getOption(t,"timeout",e._timeout$),this._endWritable=!!o.getOption(t,"endWritable",!0),this._prefix=Y(t.scope);var n=e._cache$,r=e._svc$,i=t.serverHash;i||(i=r.hash);var a=n[i];a||(a=n[i=r.hash]=new j(r,r,i)),this._adapter=a,this._registry=new N(this,16),this.pending=0,this.destroyed=!1,this.draining=!1,this.once("_eot",(function(e,t){h("client channel EOT"),this.destroyed=!0,this.emit("eot",e,t)}))}function O(e,t,n){k.call(this,e,n),this._writableFactory=t,n&&n.noPing||(h("emitting ping request"),this.ping())}function T(e,n,i,s){k.call(this,e,s),this._readable=n,this._writable=i,this._connected=!(!s||!s.noPing),this._readable.on("end",f),this._writable.on("finish",m);var a,c=this,u=null;function l(e){if(!c.destroyed){a=c._createHandshakeRequest(c._adapter,!e);var t=[g.toBuffer(a),o.bufferFrom([0,0])];c._writable.write({id:c._prefix,payload:t})}}function d(e){if(c._matchesPrefix(e.id)){var n=r.concat(e.payload);try{var i=B(v,n).head;i.serverHash&&(c._adapter=c._getAdapter(i))}catch(e){return void c.destroy(e)}var o=i.match;h("handshake match: %s",o),c.emit("handshake",a,i),"NONE"===o?t.nextTick((function(){l(!0)})):(h("successfully connected"),u&&(clearTimeout(u),u=null),c._readable.removeListener("data",d).on("data",p),c._connected=!0,c.emit("_ready"),a=null)}else h("discarding unscoped response %s (still connecting)",e.id)}function p(e){var n=e.id;if(c._matchesPrefix(n)){var i=c._registry.get(n);i&&t.nextTick((function(){h("received message %s",n),i(null,r.concat(e.payload),c._adapter)}))}else h("discarding unscoped message %s",n)}function f(){c.destroy(!0)}function m(){c.destroy()}this.once("eot",(function(){u&&(clearTimeout(u),u=null),c._connected||c.emit("_ready"),this._writable.removeListener("finish",m),this._endWritable&&(h("ending transport"),this._writable.end()),this._readable.removeListener("data",d).removeListener("data",p).removeListener("end",f)})),this._connected?this._readable.on("data",p):(this._readable.on("data",d),t.nextTick(l),c.timeout&&(u=setTimeout((function(){c.destroy(new Error("timeout"))}),c.timeout)))}function C(e,t){t=t||{},s.EventEmitter.call(this),this.server=e,this._endWritable=!!o.getOption(t,"endWritable",!0),this._prefix=Y(t.scope);var n=e._cache,r=e.service,i=r.hash;n[i]||(n[i]=new j(r,r,i)),this._adapter=null,this.destroyed=!1,this.draining=!1,this.pending=0,this.once("_eot",(function(e,t){h("server channel EOT"),this.emit("eot",e,t)}))}function I(e,n,i){C.call(this,e,i),this._writable=void 0;var o,s=this;function a(e){var t,n=e.id,i=r.concat(e.payload);try{var o=B(g,i),a=o.head,c=s._getAdapter(a)}catch(e){t=V("INVALID_HANDSHAKE_REQUEST",e)}var u=s._createHandshakeResponse(t,a);function l(e){if(!s.destroyed){if(!s._writable)return void s.once("_writable",(function(){l(e)}));s._writable.write({id:n,payload:[v.toBuffer(u),e]})}s._writable&&s._endWritable&&s._writable.end()}s.emit("handshake",a,u),t?l(s._encodeSystemError(t)):s._receive(o.tail,c,l)}function c(){s.destroy()}function u(e){o.removeListener("data",a).removeListener("end",c),s.destroy(e||!0)}t.nextTick((function(){o=n.call(s,(function(e,n){t.nextTick((function(){e?u(e):(s._writable=n.on("finish",u),s.emit("_writable"))}))})).on("data",a).on("end",c)}))}function A(e,t,n,i){C.call(this,e,i),this._adapter=void 0,this._writable=n.on("finish",u),this._readable=t.on("data",s).on("end",c),this.once("_drain",(function(){this._readable.removeListener("data",s).removeListener("data",a).removeListener("end",c)})).once("eot",(function(){this._writable.removeListener("finish",u),this._endWritable&&this._writable.end()}));var o=this;function s(e){var t=e.id;if(o._matchesPrefix(t)){var n,i=r.concat(e.payload);try{var c=B(g,i),u=c.head;o._adapter=o._getAdapter(u)}catch(e){n=V("INVALID_HANDSHAKE_REQUEST",e)}var l=o._createHandshakeResponse(n,u);o.emit("handshake",u,l),n?h(o._encodeSystemError(n)):(o._readable.removeListener("data",s).on("data",a),o._receive(c.tail,o._adapter,h))}function h(e){o.destroyed||o._writable.write({id:t,payload:[v.toBuffer(l),e]})}}function a(e){var t=e.id;if(o._matchesPrefix(t)){var n=r.concat(e.payload);o._receive(n,o._adapter,(function(e,n){o.destroyed||n||o._writable.write({id:t,payload:[e]})}))}}function c(){o.destroy()}function u(){o.destroy(!0)}}function x(e,t,n){this._msg=e,this.headers=t||{},this.request=n||{}}function R(e,t,n,r){this._msg=e,this.headers=t,this.error=n,this.response=r}function P(e,t){this.channel=t,this.locals={},this.message=e,Object.freeze(this)}function N(e,t){this._ctx=e,this._mask=-1>>>(0|t),this._id=0,this._n=0,this._cbs={}}function j(e,t,n,r){this._clientSvc=e,this._serverSvc=t,this._hash=n,this._isRemote=!!r,this._readers=F(e,t)}function L(){a.Transform.call(this,{readableObjectMode:!0}),this._id=void 0,this._buf=o.newBuffer(0),this._bufs=[],this.on("finish",(function(){this.push(null)}))}function M(){a.Transform.call(this,{writableObjectMode:!0}),this.on("finish",(function(){this.push(null)}))}function q(){a.Transform.call(this,{readableObjectMode:!0}),this._id=void 0,this._frameCount=0,this._buf=o.newBuffer(0),this._bufs=[],this.on("finish",(function(){this.push(null)}))}function z(){a.Transform.call(this,{writableObjectMode:!0}),this.on("finish",(function(){this.push(null)}))}function U(e){var t=o.newBuffer(4);return t.writeInt32BE(e),t}function B(e,t){var n=new u(t),r=e._read(n);if(!n.isValid())throw new Error(d("truncated %j",e.schema()));return{head:r,tail:n.buf.slice(n.pos)}}function D(e,t){return e.equals(t)?e:e.createResolver(t)}function F(e,t){var n={};return e.messages.forEach((function(e){var r=e.name,i=t.message(r);try{if(!i)throw new Error(d("missing server message: %s",r));if(i.oneWay!==e.oneWay)throw new Error(d("inconsistent one-way message: %s",r));n[r+"?"]=D(i.requestType,e.requestType),n[r+"*"]=D(e.errorType,i.errorType),n[r+"!"]=D(e.responseType,i.responseType)}catch(e){throw V("INCOMPATIBLE_PROTOCOL",e)}})),n}function H(e,t,n,r){Object.keys(t).forEach((function(i){var o,s,a=t[i];r?(o=n,s=w.forProtocol(a)):(o=w.forProtocol(a),s=n),e[i]=new j(o,s,i,!0)}))}function $(e,t){var n={};return Object.keys(e).forEach((function(r){var i=e[r];if(i._isRemote){var o=t?i._serverSvc:i._clientSvc;n[r]=o.protocol}})),n}function K(e){return!!e&&"[object Error]"===Object.prototype.toString.call(e)}function W(e,t){var n=new Error(e);return n.cause=t,n}function V(e,t){var n=W(e.toLowerCase().replace(/_/g," "),t);return n.rpcCode=t&&t.rpcCode?t.rpcCode:e,n}function G(e,t,n){var r,i,o,s=[];for(r=0,i=n.length;r<i;r++)(o=n[r]).type.isValid(t[o.name],{errorHook:u});var a=s.map((function(e){return d("%s = %j but expected %s",e.path,e.value,e.type)})).join(", "),c=new Error(d("%s (%s)",e,a));return c.details=s,c;function u(e,t,n){var r,i,a,c=[];for(r=0,i=e.length;r<i;r++)a=e[r],isNaN(a)?c.push("."+a):c.push("["+a+"]");s.push({path:o.name+c.join(""),value:t,type:n})}}function Y(e){return e?o.getHash(e).readInt16BE(0)<<16:0}function J(e,t){return(e^t)>>16==0}function Z(e){return!(!e||!e.pipe)}function Q(e,t){var n=e.message(t);if(!n)throw new Error(d("unknown message: %s",t));return n}function X(e){var n,r=[e.wreq,e.wres],i=[];function o(){var t=i.pop();if(t){var r=!1;t.call(e.ctx,n,(function(t){r?e.onError(W("duplicate backward middleware call",t)):(n=t,r=!0,o())}))}else e.onCompletion.call(e.ctx,n)}!function s(a){var c=!1;a<e.fns.length?e.fns[a].apply(e.ctx,r.concat((function(t,r){if(c)e.onError(W("duplicate forward middleware call",t));else{if(c=!0,t||e.wres&&(void 0!==e.wres.error||void 0!==e.wres.response))return n=t,void o();r&&i.push(r),s(++a)}}))):e.onTransition.apply(e.ctx,r.concat((function(r){c?e.onError(W("duplicate handler call",r)):(c=!0,n=r,t.nextTick(o))})))}(0)}b.forSchema=function(e,t,n){if(n=n||{},!o.isValidName(e))throw new Error(d("invalid message name: %s",e));if(!Array.isArray(t.request))throw new Error(d("invalid message request: %s",e));var r=d("%s.%sRequest",p.namespace,o.capitalize(e)),i=l.forSchema({name:r,type:"record",namespace:n.namespace||"",fields:t.request},n);if(delete n.registry[r],!t.response)throw new Error(d("invalid message response: %s",e));var s=l.forSchema(t.response,n);if(void 0!==t.errors&&!Array.isArray(t.errors))throw new Error(d("invalid message errors: %s",e));return new b(e,i,l.forSchema(["string"].concat(t.errors||[]),n),s,!!t["one-way"],t.doc)},b.prototype.schema=l.prototype.getSchema,b.prototype._attrs=function(e){var t={request:this.requestType._attrs(e).fields,response:this.responseType._attrs(e)},n=this.doc;void 0!==n&&(t.doc=n);var r=this.errorType._attrs(e);return r.length>1&&(t.errors=r.slice(1)),this.oneWay&&(t["one-way"]=!0),t},o.addDeprecatedGetters(b,["name","errorType","requestType","responseType"]),b.prototype.isOneWay=c.deprecate((function(){return this.oneWay}),"use `.oneWay` directly instead of `.isOneWay()`"),w.Client=E,w.Server=S,w.compatible=function(e,t){try{F(e,t)}catch(e){return!1}return!0},w.forProtocol=function(e,t){t=t||{};var n,r=e.protocol;if(!r)throw new Error("missing protocol name");if(void 0!==e.namespace)t.namespace=e.namespace;else{var i=/^(.*)\.[^.]+$/.exec(r);i&&(t.namespace=i[1])}return r=o.qualify(r,t.namespace),e.types&&e.types.forEach((function(e){l.forSchema(e,t)})),e.messages&&(n={},Object.keys(e.messages).forEach((function(r){n[r]=b.forSchema(r,e.messages[r],t)}))),new w(r,n,t.registry,e)},w.isService=function(e){return!!e&&e.hasOwnProperty("_hashStr")},w.prototype.createClient=function(e){var n=new E(this,e);return t.nextTick((function(){if(e&&e.server){var t={objectMode:!0},r=[new a.PassThrough(t),new a.PassThrough(t)];e.server.createChannel({readable:r[0],writable:r[1]},t),n.createChannel({readable:r[1],writable:r[0]},t)}else e&&e.transport&&n.createChannel(e.transport)})),n},w.prototype.createServer=function(e){return new S(this,e)},Object.defineProperty(w.prototype,"hash",{enumerable:!0,get:function(){return o.bufferFrom(this._hashStr,"binary")}}),w.prototype.message=function(e){return this._messagesByName[e]},w.prototype.type=function(e){return this._typesByName[e]},w.prototype.inspect=function(){return d("<Service %j>",this.name)},o.addDeprecatedGetters(w,["message","messages","name","type","types"]),w.prototype.createEmitter=c.deprecate((function(e,t){t=t||{};var n,r,i=this.createClient({cache:t.cache,buffering:!1,strictTypes:t.strictErrors,timeout:t.timeout}),o=i.createChannel(e,t);return r=o,(n=i).on("error",(function(e){r.emit("error",e,n)})),o}),"use `.createClient()` instead of `.createEmitter()`"),w.prototype.createListener=c.deprecate((function(e,t){if(t&&t.strictErrors)throw new Error("use `.createServer()` to support strict errors");return this._server.createChannel(e,t)}),"use `.createServer().createChannel()` instead of `.createListener()`"),w.prototype.emit=c.deprecate((function(e,t,n,r){if(!n||!this.equals(n.client._svc$))throw new Error("invalid emitter");var i=n.client;return E.prototype.emitMessage.call(i,e,t,r&&r.bind(this)),n.getPending()}),"create a client via `.createClient()` to emit messages instead of `.emit()`"),w.prototype.equals=c.deprecate((function(e){return w.isService(e)&&this.getFingerprint().equals(e.getFingerprint())}),"equality testing is deprecated, compare the `.protocol`s instead"),w.prototype.getFingerprint=c.deprecate((function(e){return o.getHash(JSON.stringify(this.protocol),e)}),"use `.hash` instead of `.getFingerprint()`"),w.prototype.getSchema=c.deprecate(l.prototype.getSchema,"use `.protocol` instead of `.getSchema()`"),w.prototype.on=c.deprecate((function(e,t){var n=this;return this._server.onMessage(e,(function(e,r){return t.call(n,e,this.channel,r)})),this}),"use `.createServer().onMessage()` instead of `.on()`"),w.prototype.subprotocol=c.deprecate((function(){var e=this._server,t={strictTypes:e._strict,cache:e._cache},n=new S(e.service,t);return n._handlers=Object.create(e._handlers),new w(this.name,this._messagesByName,this._typesByName,this.protocol,n)}),"`.subprotocol()` will be removed in 5.1"),w.prototype._attrs=function(e){var t={protocol:this.name},n=[];this.types.forEach((function(t){if(void 0!==t.getName()){var r=t._attrs(e);"string"!=typeof r&&n.push(r)}})),n.length&&(t.types=n);var r=Object.keys(this._messagesByName);return r.length&&(t.messages={},r.forEach((function(n){t.messages[n]=this._messagesByName[n]._attrs(e)}),this)),e&&e.exportAttrs&&void 0!==this.doc&&(t.doc=this.doc),t},c.inherits(E,s.EventEmitter),E.prototype.activeChannels=function(){return this._channels$.slice()},E.prototype.createChannel=function(e,t){var n,r=t&&t.objectMode;if("function"==typeof e){var i;i=r?e:function(t){var r=new M,i=e((function(e,r){if(e)t(e);else{var i=(new L).once("error",(function(e){n.destroy(e)}));t(null,r.pipe(i))}}));if(i)return r.pipe(i),r},n=new O(this,i,t)}else{var o,s;if(Z(e)?o=s=e:(o=e.readable,s=e.writable),!r){var a=new q;o=o.pipe(a);var c=new z;c.pipe(s),s=c}n=new T(this,o,s,t),r||(n.once("eot",(function(){o.unpipe(a),c.unpipe(s)})),a.once("error",(function(e){n.destroy(e)})))}var u=this._channels$;return u.push(n),n.once("_drain",(function(){u.splice(u.indexOf(this),1)})),this._buffering$=!1,this.emit("channel",n),n},E.prototype.destroyChannels=function(e){this._channels$.forEach((function(t){t.destroy(e&&e.noWait)}))},E.prototype.emitMessage=function(e,t,n,r){var i=new x(Q(this._svc$,e),{},t);this._emitMessage$(i,n,r)},E.prototype.remoteProtocols=function(){return $(this._cache$,!0)},Object.defineProperty(E.prototype,"service",{enumerable:!0,get:function(){return this._svc$}}),E.prototype.use=function(){var e,t,n;for(e=0,t=arguments.length;e<t;e++)n=arguments[e],this._fns$.push(n.length<3?n(this):n);return this},E.prototype._emitMessage$=function(e,n,r){r||"function"!=typeof n||(r=n,n=void 0);var i=this,o=this._channels$,s=o.length;if(s){var a;if(void 0===(n=n||{}).timeout&&(n.timeout=this._timeout$),1===s)a=o[0];else if(this._policy$){if(!(a=this._policy$(this._channels$.slice())))return void h("policy returned no channel, skipping call")}else a=o[Math.floor(Math.random()*s)];a._emit(e,n,(function(e,t){var n=this,o=n.message.errorType;if(e)return i._strict$&&(e=o.clone(e.message,{wrapUnions:!0})),void s(e);function s(e,t){r?r.call(n,e,t):e&&i.emit("error",e)}t?(e=t.error,i._strict$||(void 0===e?e=null:l.isType(o,"union:unwrapped")?"string"==typeof e&&(e=new Error(e)):e&&e.string&&"string"==typeof e.string&&(e=new Error(e.string))),s(e,t.response)):s()}))}else if(this._buffering$)h("no active client channels, buffering call"),this.once("channel",(function(){this._emitMessage$(e,n,r)}));else{var c=new Error("no active channels");t.nextTick((function(){r?r.call(new P(e._msg),c):i.emit("error",c)}))}},E.prototype._createMessageHandler$=function(e){var t=e.requestType.getFields().map((function(e){return e.getName()})),n="return function "+e.name+"(";return t.length&&(n+=t.join(", ")+", "),n+="opts, cb) {\n",n+="  var req = {",n+=t.map((function(e){return e+": "+e})).join(", "),n+="};\n",n+="  return this.emitMessage('"+e.name+"', req, opts, cb);\n",n+="};",new Function(n)()},c.inherits(S,s.EventEmitter),S.prototype.activeChannels=function(){return o.objectValues(this._channels)},S.prototype.createChannel=function(e,t){var n,r=t&&t.objectMode;if("function"==typeof e){var i;i=r?e:function(t){var r=(new L).once("error",(function(e){n.destroy(e)}));return e((function(e,n){if(e)t(e);else{var r=new M;r.pipe(n),t(null,r)}})).pipe(r)},n=new I(this,i,t)}else{var o,s;if(Z(e)?o=s=e:(o=e.readable,s=e.writable),!r){var a=new q;o=o.pipe(a);var c=new z;c.pipe(s),s=c}n=new A(this,o,s,t),r||(n.once("eot",(function(){o.unpipe(a),c.unpipe(s)})),a.once("error",(function(e){n.destroy(e)})))}this.listeners("error").length||this.on("error",this._onError);var u=this._nextChannelId++,l=this._channels;return l[u]=n.once("eot",(function(){delete l[u]})),this.emit("channel",n),n},S.prototype.onMessage=function(e,t){return Q(this.service,e),this._handlers[e]=t,this},S.prototype.remoteProtocols=function(){return $(this._cache,!1)},S.prototype.use=function(){var e,t,n;for(e=0,t=arguments.length;e<t;e++)n=arguments[e],this._fns.push(n.length<3?n(this):n);return this},S.prototype._createMessageHandler=function(e){var t=e.name,n=e.requestType.fields,r=n.length,i=n.length?", "+n.map((function(e){return"req."+e.name})).join(", "):"",o="return function (handler) {\n";return o+="  if (handler.length > "+r+") {\n",o+="    return this.onMessage('"+t+"', function (req, cb) {\n",o+="      return handler.call(this"+i+", cb);\n",o+="    });\n",o+="  } else {\n",o+="    return this.onMessage('"+t+"', function (req) {\n",o+="      return handler.call(this"+i+");\n",o+="    });\n",o+="  }\n",o+="};\n",new Function(o)()},S.prototype._onError=function(e){this._silent||"UNKNOWN_PROTOCOL"===e.rpcCode||(console.error(),e.rpcCode?(console.error(e.rpcCode),console.error(e.cause)):(console.error("INTERNAL_SERVER_ERROR"),console.error(e)))},c.inherits(k,s.EventEmitter),k.prototype.destroy=function(e){h("destroying client channel"),this.draining||(this.draining=!0,this.emit("_drain"));var t=this._registry,n=this.pending;e&&t.clear(),e||!n?K(e)?(h("fatal client channel error: %s",e),this.emit("_eot",n,e)):this.emit("_eot",n):h("client channel entering drain mode (%s pending)",n)},k.prototype.ping=function(e,t){t||"function"!=typeof e||(t=e,e=void 0);var n=this,r=new x(_);this._emit(r,{timeout:e},(function(e){t?t.call(n,e):e&&n.destroy(e)}))},k.prototype._createHandshakeRequest=function(e,t){var n=this.client._svc$;return{clientHash:n.hash,clientProtocol:t?null:JSON.stringify(n.protocol),serverHash:e._hash}},k.prototype._emit=function(e,n,r){var i=e._msg,o=i.oneWay?void 0:new R(i,{}),s=new P(i,this),a=this;function c(e,t,r){var o,s;if(a.destroyed)o=new Error("channel destroyed");else try{s=e.toBuffer()}catch(t){o=G(d("invalid %j request",i.name),e,[{name:"headers",type:m},{name:"request",type:i.requestType}])}if(o)r(o);else{var c=n&&void 0!==n.timeout?n.timeout:a.timeout,u=a._registry.add(c,(function(e,n,o){if(!e&&!i.oneWay)try{o._decodeResponse(n,t,i)}catch(t){e=t}r(e)}));u|=a._prefix,h("sending message %s",u),a._send(u,s,!!i&&i.oneWay)}}function u(e){a.pending--,r.call(s,e,o),!a.draining||a.destroyed||a.pending||a.destroy()}function l(e){a.client.emit("error",e,a)}this.pending++,t.nextTick((function(){if(i.name){a.emit("outgoingCall",s,n);var t=a.client._fns$;h("starting client middleware chain (%s middleware)",t.length),X({fns:t,ctx:s,wreq:e,wres:o,onTransition:c,onCompletion:u,onError:l})}else c(e,o,u)}))},k.prototype._getAdapter=function(e){var t=e.serverHash,n=this.client._cache$,r=n[t];if(r)return r;var i=JSON.parse(e.serverProtocol),o=w.forProtocol(i);return r=new j(this.client._svc$,o,t,!0),n[t]=r},k.prototype._matchesPrefix=function(e){return J(e,this._prefix)},k.prototype._send=o.abstractFunction,o.addDeprecatedGetters(k,["pending","timeout"]),k.prototype.getCache=c.deprecate((function(){return this.client._cache$}),"use `.remoteProtocols()` instead of `.getCache()`"),k.prototype.getProtocol=c.deprecate((function(){return this.client._svc$}),"use `.service` instead or `.getProtocol()`"),k.prototype.isDestroyed=c.deprecate((function(){return this.destroyed}),"use `.destroyed` instead of `.isDestroyed`"),c.inherits(O,k),O.prototype._send=function(e,n){var i=this._registry.get(e),o=this._adapter,s=this;return t.nextTick((function a(c){if(s.destroyed)return;var u=s._createHandshakeRequest(o,!c),l=s._writableFactory.call(s,(function(e,n){e?i(e):n.on("data",(function(e){h("received response %s",e.id);var n=r.concat(e.payload);try{var c=B(v,n),l=c.head;l.serverHash&&(o=s._getAdapter(l))}catch(e){return void i(e)}var d=l.match;h("handshake match: %s",d),s.emit("handshake",u,l),"NONE"===d?t.nextTick((function(){a(!0)})):(s._adapter=o,i(null,c.tail,o))}))}));if(!l)return void i(new Error("invalid writable stream"));l.write({id:e,payload:[g.toBuffer(u),n]}),s._endWritable&&l.end()})),!0},c.inherits(T,k),T.prototype._emit=function(){if(this._connected||this.draining)k.prototype._emit.apply(this,arguments);else{h("queuing request");var e,t,n=[];for(e=0,t=arguments.length;e<t;e++)n.push(arguments[e]);this.once("_ready",(function(){this._emit.apply(this,n)}))}},T.prototype._send=function(e,n,r){if(r){var i=this;t.nextTick((function(){i._registry.get(e)(null,o.bufferFrom([0,0,0]),i._adapter)}))}return this._writable.write({id:e,payload:[n]})},c.inherits(C,s.EventEmitter),C.prototype.destroy=function(e){this.draining||(this.draining=!0,this.emit("_drain")),!e&&this.pending||(this.destroyed=!0,K(e)?(h("fatal server channel error: %s",e),this.emit("_eot",this.pending,e)):this.emit("_eot",this.pending))},C.prototype._createHandshakeResponse=function(e,t){var n=this.server.service,r=n.hash,i=t&&t.serverHash.equals(r);return{match:e?"NONE":i?"BOTH":"CLIENT",serverProtocol:i?null:JSON.stringify(n.protocol),serverHash:i?null:r}},C.prototype._getAdapter=function(e){var t=e.clientHash,n=this.server._cache[t];if(n)return n;if(!e.clientProtocol)throw V("UNKNOWN_PROTOCOL");var r=JSON.parse(e.clientProtocol);return n=new j(w.forProtocol(r),this.server.service,t,!0),this.server._cache[t]=n},C.prototype._matchesPrefix=function(e){return J(e,this._prefix)},C.prototype._receive=function(e,t,n){var r,i=this;try{r=t._decodeRequest(e)}catch(e){return void n(i._encodeSystemError(V("INVALID_REQUEST",e)))}var o=r._msg,s=new R(o,{});if(!o.name)return s.response=null,void n(s.toBuffer(),!1);var a=new P(o,this);i.emit("incomingCall",a);var c=this.server._fns;function u(e){i.server.emit("error",e,i)}h("starting server middleware chain (%s middleware)",c.length),i.pending++,X({fns:c,ctx:a,wreq:r,wres:s,onTransition:function(e,t,n){var r=i.server._handlers[o.name];if(r){var s=!o.oneWay;try{s?r.call(a,e.request,(function(e,r){s=!1,t.error=e,t.response=r,n()})):(r.call(a,e.request),n())}catch(e){s?(s=!1,n(e)):u(e)}}else{var c=i.server._defaultHandler;if(c)c.call(a,e,t,n);else{var l=new Error(d("no handler for %s",o.name));n(V("NOT_IMPLEMENTED",l))}}},onCompletion:function(e){i.pending--;var t,r=i.server;if(!e){var a=s.error;r._strict||(K(a)?s.error=o.errorType.clone(a.message,{wrapUnions:!0}):null===a&&(a=s.error=void 0),void 0===a&&void 0===s.response&&o.responseType.isValid(null)&&(s.response=null));try{t=s.toBuffer()}catch(t){e=void 0!==s.error?G(d("invalid %j error",o.name),s,[{name:"headers",type:m},{name:"error",type:o.errorType}]):G(d("invalid %j response",o.name),s,[{name:"headers",type:m},{name:"response",type:o.responseType}])}}t?void 0!==a&&r.emit("error",V("APPLICATION_ERROR",a)):t=i._encodeSystemError(e,s.headers);n(t,o.oneWay),i.draining&&!i.pending&&i.destroy()},onError:u})},o.addDeprecatedGetters(C,["pending"]),C.prototype.getCache=c.deprecate((function(){return this.server._cache}),"use `.remoteProtocols()` instead of `.getCache()`"),C.prototype.getProtocol=c.deprecate((function(){return this.server.service}),"use `.service` instead of `.getProtocol()`"),C.prototype.isDestroyed=c.deprecate((function(){return this.destroyed}),"use `.destroyed` instead of `.isDestroyed`"),C.prototype._encodeSystemError=function(e,t){var n,i,s=this.server;if(s.emit("error",e,this),s._sysErrFormatter?n=s._sysErrFormatter.call(this,e):e.rpcCode&&(n=e.message),t)try{i=m.toBuffer(t)}catch(e){s.emit("error",e,this)}return r.concat([i||o.bufferFrom([0]),o.bufferFrom([1,0]),y.toBuffer(n||"internal server error")])},c.inherits(I,C),c.inherits(A,C),x.prototype.toBuffer=function(){var e=this._msg;return r.concat([m.toBuffer(this.headers),y.toBuffer(e.name),e.requestType.toBuffer(this.request)])},R.prototype.toBuffer=function(){var e=m.toBuffer(this.headers),t=void 0!==this.error;return r.concat([e,f.toBuffer(t),t?this._msg.errorType.toBuffer(this.error):this._msg.responseType.toBuffer(this.response)])},N.prototype.get=function(e){return this._cbs[e&this._mask]},N.prototype.add=function(e,t){this._id=this._id+1&this._mask;var n,r=this,i=this._id;return e>0&&(n=setTimeout((function(){o(new Error("timeout"))}),e)),this._cbs[i]=o,this._n++,i;function o(){r._cbs[i]&&(delete r._cbs[i],r._n--,n&&clearTimeout(n),t.apply(r._ctx,arguments))}},N.prototype.clear=function(){Object.keys(this._cbs).forEach((function(e){this._cbs[e](new Error("interrupted"))}),this)},j.prototype._decodeRequest=function(e){var t,n,r=new u(e),i=m._read(r),o=y._read(r);if(o?(t=this._serverSvc.message(o),n=this._readers[o+"?"]._read(r)):t=_,!r.isValid())throw new Error(d("truncated %s request",o||"ping$"));return new x(t,i,n)},j.prototype._decodeResponse=function(e,t,n){var r=new u(e);o.copyOwnProperties(m._read(r),t.headers,!0);var i=f._read(r),s=n.name;if(s){var a=this._readers[s+(i?"*":"!")];if(n=this._clientSvc.message(s),i?t.error=a._read(r):t.response=a._read(r),!r.isValid())throw new Error(d("truncated %s response",s))}else n=_},c.inherits(L,a.Transform),L.prototype._transform=function(e,t,n){var i;for(e=r.concat([this._buf,e]);e.length>=4&&e.length>=(i=e.readInt32BE(0))+4;){if(i)this._bufs.push(e.slice(4,i+4));else{var o=this._bufs;this._bufs=[],this.push({id:null,payload:o})}e=e.slice(i+4)}this._buf=e,n()},L.prototype._flush=function(e){if(this._buf.length||this._bufs.length){var t=this._bufs.slice();t.unshift(this._buf);var n=V("TRAILING_DATA");n.trailingData=r.concat(t).toString(),this.emit("error",n)}e()},c.inherits(M,a.Transform),M.prototype._transform=function(e,t,n){var r,i,o,s=e.payload;for(r=0,i=s.length;r<i;r++)o=s[r],this.push(U(o.length)),this.push(o);this.push(U(0)),n()},c.inherits(q,a.Transform),q.prototype._transform=function(e,t,n){for(e=r.concat([this._buf,e]);;){if(void 0===this._id){if(e.length<8)return this._buf=e,void n();this._id=e.readInt32BE(0),this._frameCount=e.readInt32BE(4),e=e.slice(8)}for(var i;this._frameCount&&e.length>=4&&e.length>=(i=e.readInt32BE(0))+4;)this._frameCount--,this._bufs.push(e.slice(4,i+4)),e=e.slice(i+4);if(this._frameCount)return this._buf=e,void n();var o={id:this._id,payload:this._bufs};this._bufs=[],this._id=void 0,this.push(o)}},q.prototype._flush=L.prototype._flush,c.inherits(z,a.Transform),z.prototype._transform=function(e,t,n){var r,i,s=e.payload,a=s.length;for((r=o.newBuffer(8)).writeInt32BE(e.id,0),r.writeInt32BE(a,4),this.push(r),i=0;i<a;i++)r=s[i],this.push(U(r.length)),this.push(r);n()},e.exports={Adapter:j,HANDSHAKE_REQUEST_TYPE:g,HANDSHAKE_RESPONSE_TYPE:v,Message:b,Registry:N,Service:w,discoverProtocol:function(e,t,n){var r;void 0===n&&"function"==typeof t&&(n=t,t=void 0),new w({protocol:"Empty"},p).createClient({timeout:t&&t.timeout}).createChannel(e,{scope:t&&t.scope,endWritable:"function"==typeof e}).once("handshake",(function(e,t){r=t.serverProtocol,this.destroy(!0)})).once("eot",(function(e,t){t&&!/interrupted/.test(t)?n(t):n(null,JSON.parse(r))}))},streams:{FrameDecoder:L,FrameEncoder:M,NettyDecoder:q,NettyEncoder:z}}}).call(this,n(9),n(8).Buffer)},function(e,t){},function(e,t,n){"use strict";var r=n(72).Buffer,i=n(148);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t,n,i,o=r.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,n=o,i=a,t.copy(n,i),a+=s.data.length,s=s.next;return o},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(150),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(25))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i,o,s,a,c=1,u={},l=!1,h=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){f(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){f(e.data)},r=function(e){o.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(i=h.documentElement,r=function(e){var t=h.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):r=function(e){setTimeout(f,0,e)}:(s="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&f(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),r=function(t){e.postMessage(s+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return u[c]=i,r(c),c++},d.clearImmediate=p}function p(e){delete u[e]}function f(e){if(l)setTimeout(f,0,e);else{var t=u[e];if(t){l=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{p(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(25),n(9))},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,n(25))},function(e,t,n){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var r=n(8),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";e.exports=o;var r=n(98),i=Object.create(n(50));function o(e){if(!(this instanceof o))return new o(e);r.call(this,e)}i.inherits=n(37),i.inherits(o,r),o.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(73)},function(e,t,n){e.exports=n(29)},function(e,t,n){e.exports=n(71).Transform},function(e,t,n){e.exports=n(71).PassThrough},function(e,t,n){"use strict";var r=n(159),i=n(36),o=n(84),s=n(19).format,a={date:{type:"int",logicalType:"date"},decimal:{type:"bytes",logicalType:"decimal"},time_ms:{type:"long",logicalType:"time-millis"},timestamp_ms:{type:"long",logicalType:"timestamp-millis"}};function c(e,t,n){function i(e,n){t.importHook(e,"idl",(function(r,a){if(r)n(r);else if(void 0!==a){try{var c=new u(a,t)._readProtocol(a,t)}catch(r){return r.path=e,void n(r)}!function(e,n,r,a){var c=[];!function u(){var l=n.shift();if(l){var h=o.join(r,l.name);"idl"===l.kind?i(h,(function(e,t){e?a(e):(t&&c.push(t),u())})):t.importHook(h,l.kind,(function(e,t){if(e)a(e);else switch(l.kind){case"protocol":case"schema":if(void 0===t)return void u();try{var n=JSON.parse(t)}catch(e){return e.path=h,void a(e)}var r="schema"===l.kind?{types:[n]}:n;return c.push(r),void u();default:a(new Error(s("invalid import kind: %s",l.kind)))}}))}else{c.reverse();try{c.forEach((function(t){!function(e,t){var n=t.types||[];n.reverse(),n.forEach((function(n){e.types||(e.types=[]),void 0===n.namespace&&(n.namespace=d(t)||""),e.types.unshift(n)})),Object.keys(t.messages||{}).forEach((function(n){if(e.messages||(e.messages={}),e.messages[n])throw new Error(s("duplicate message: %s",n));e.messages[n]=t.messages[n]}))}(e,t)}))}catch(e){return void a(e)}a(null,e)}}()}(c.protocol,c.imports,o.dirname(e),n)}else n()}))}n||"function"!=typeof t||(n=t,t=void 0),(t=t||{}).importHook||(t.importHook=r.createImportHook()),i(e,(function(e,t){if(e)n(e);else if(t){var r=t.types;if(r){var i=d(t)||"";r.forEach((function(e){e.namespace===i&&delete e.namespace}))}n(null,t)}else n(new Error("empty root import"))}))}function u(e,t){t=t||{},this._tk=new l(e),this._ackVoidMessages=!!t.ackVoidMessages,this._implicitTags=!t.delimitedCollections,this._typeRefs=t.typeRefs||a}function l(e){this._str=e,this.pos=0}function h(e){for(var t=e.replace(/^[ \t]+|[ \t]+$/g,"").split("\n").map((function(e,t){return t?e.replace(/^\s*\*\s?/,""):e}));t.length&&!t[0];)t.shift();for(;t.length&&!t[t.length-1];)t.pop();return t.join("\n")}function d(e){if(e.namespace)return e.namespace;var t=/^(.*)\.[^.]+$/.exec(e.protocol);return t?t[1]:void 0}u.readProtocol=function(e,t){var n=new u(e,t)._readProtocol();if(n.imports.length)throw new Error("unresolvable import");return n.protocol},u.readSchema=function(e,t){var n=new u(e,t),r=n._readJavadoc(),i=n._readType(void 0===r?{}:{doc:r},!0);return n._tk.next({id:"(eof)"}),i},u.prototype._readProtocol=function(){var e,t=this._tk,n=[],r=[],i={};this._readImports(n);var o={},a=this._readJavadoc();for(void 0!==a&&(o.doc=a),this._readAnnotations(o),t.next({val:"protocol"}),t.next({val:"{",silent:!0})||(o.protocol=t.next({id:"name"}).val,t.next({val:"{"}));!t.next({val:"}",silent:!0});)if(!this._readImports(n)){var c=this._readJavadoc(),u=this._readType({},!0),l=this._readImports(n,!0),h=void 0;if(e=t.pos,!l&&(h=this._readMessage(u))){void 0!==c&&void 0===h.schema.doc&&(h.schema.doc=c);var d=!1;if("void"!==h.schema.response&&"void"!==h.schema.response.type||(d=!this._ackVoidMessages&&!h.schema.errors,"void"===h.schema.response?h.schema.response="null":h.schema.response.type="null"),d&&(h.schema["one-way"]=!0),i[h.name])throw new Error(s("duplicate message: %s",h.name));i[h.name]=h.schema}else c&&("string"==typeof u?u={doc:c,type:u}:void 0===u.doc&&(u.doc=c)),r.push(u),t.pos=e,t.next({val:";",silent:!0});c=void 0}return t.next({id:"(eof)"}),r.length&&(o.types=r),Object.keys(i).length&&(o.messages=i),{protocol:o,imports:n}},u.prototype._readAnnotations=function(e){for(var t=this._tk;t.next({val:"@",silent:!0});){for(var n=[];!t.next({val:"(",silent:!0});)n.push(t.next().val);e[n.join("")]=t.next({id:"json"}).val,t.next({val:")"})}},u.prototype._readMessage=function(e){var t=this._tk,n={request:[],response:e};this._readAnnotations(n);var r=t.next().val;if("("===t.next().val){if(!t.next({val:")",silent:!0}))do{n.request.push(this._readField())}while(!t.next({val:")",silent:!0})&&t.next({val:","}));var i=t.next();switch(i.val){case"throws":n.errors=[];do{n.errors.push(this._readType())}while(!t.next({val:";",silent:!0})&&t.next({val:","}));break;case"oneway":n["one-way"]=!0,t.next({val:";"});break;case";":break;default:throw t.error("invalid message suffix",i)}return{name:r,schema:n}}},u.prototype._readJavadoc=function(){var e=this._tk.next({id:"javadoc",emitJavadoc:!0,silent:!0});if(e)return e.val},u.prototype._readField=function(){var e=this._tk,t=this._readJavadoc(),n={type:this._readType()};return void 0!==t&&void 0===n.doc&&(n.doc=t),this._readAnnotations(n),n.name=e.next({id:"name"}).val,e.next({val:"=",silent:!0})&&(n.default=e.next({id:"json"}).val),n},u.prototype._readType=function(e,t){switch(e=e||{},this._readAnnotations(e),e.type=this._tk.next({id:"name"}).val,e.type){case"record":case"error":return this._readRecord(e);case"fixed":return this._readFixed(e);case"enum":return this._readEnum(e,t);case"map":return this._readMap(e);case"array":return this._readArray(e);case"union":if(Object.keys(e).length>1)throw new Error("union annotations are not supported");return this._readUnion();default:var n=this._typeRefs[e.type];return n&&(delete e.type,i.copyOwnProperties(n,e)),Object.keys(e).length>1?e:e.type}},u.prototype._readFixed=function(e){var t=this._tk;return t.next({val:"(",silent:!0})||(e.name=t.next({id:"name"}).val,t.next({val:"("})),e.size=parseInt(t.next({id:"number"}).val),t.next({val:")"}),e},u.prototype._readMap=function(e){var t=this._tk,n=this._implicitTags,r=void 0===t.next({val:"<",silent:n});return e.values=this._readType(),t.next({val:">",silent:r}),e},u.prototype._readArray=function(e){var t=this._tk,n=this._implicitTags,r=void 0===t.next({val:"<",silent:n});return e.items=this._readType(),t.next({val:">",silent:r}),e},u.prototype._readEnum=function(e,t){var n=this._tk;n.next({val:"{",silent:!0})||(e.name=n.next({id:"name"}).val,n.next({val:"{"})),e.symbols=[];do{e.symbols.push(n.next().val)}while(!n.next({val:"}",silent:!0})&&n.next({val:","}));return t&&n.next({val:"=",silent:!0})&&(e.default=n.next().val,n.next({val:";"})),e},u.prototype._readUnion=function(){var e=this._tk,t=[];e.next({val:"{"});do{t.push(this._readType())}while(!e.next({val:"}",silent:!0})&&e.next({val:","}));return t},u.prototype._readRecord=function(e){var t=this._tk;for(t.next({val:"{",silent:!0})||(e.name=t.next({id:"name"}).val,t.next({val:"{"})),e.fields=[];!t.next({val:"}",silent:!0});)e.fields.push(this._readField()),t.next({val:";"});return e},u.prototype._readImports=function(e,t){for(var n=this._tk,r=0,i=n.pos;n.next({val:"import",silent:!0});){if(!r&&t&&n.next({val:"(",silent:!0}))return void(n.pos=i);var o=n.next({id:"name"}).val,s=JSON.parse(n.next({id:"string"}).val);n.next({val:";"}),e.push({kind:o,name:s}),r++}return r},l.prototype.next=function(e){var t,n={pos:this.pos,id:void 0,val:void 0},r=this._skip(e&&e.emitJavadoc);if("string"==typeof r)n.id="javadoc",n.val=r;else{var i=this.pos,o=this._str,a=o.charAt(i);if(a)if(e&&"json"===e.id?(n.id="json",this.pos=this._endOfJson()):'"'===a?(n.id="string",this.pos=this._endOfString()):/[0-9]/.test(a)?(n.id="number",this.pos=this._endOf(/[0-9]/)):/[`A-Za-z_.]/.test(a)?(n.id="name",this.pos=this._endOf(/[`A-Za-z0-9_.]/)):(n.id="operator",this.pos=i+1),n.val=o.slice(i,this.pos),"json"===n.id)try{n.val=JSON.parse(n.val)}catch(t){throw this.error("invalid JSON",n)}else"name"===n.id&&(n.val=n.val.replace(/`/g,""));else n.id="(eof)"}if(e&&e.id&&e.id!==n.id?t=this.error(s("expected ID %s",e.id),n):e&&e.val&&e.val!==n.val&&(t=this.error(s("expected value %s",e.val),n)),t){if(e&&e.silent)return void(this.pos=n.pos);throw t}return n},l.prototype.error=function(e,t){var n,r="number"!=typeof t,i=r?t.pos:t,o=this._str,a=1,c=0;for(n=0;n<i;n++)"\n"===o.charAt(n)&&(a++,c=n);var u=r?s("invalid token %j: %s",t,e):e,l=new Error(u);return l.token=r?t:void 0,l.lineNum=a,l.colNum=i-c,l},l.prototype._skip=function(e){for(var t,n,r=this._str,i=!1;(n=r.charAt(this.pos))&&/\s/.test(n);)this.pos++;if(t=this.pos,"/"===n)switch(r.charAt(this.pos+1)){case"/":for(this.pos+=2;(n=r.charAt(this.pos))&&"\n"!==n;)this.pos++;return this._skip(e);case"*":for(this.pos+=2,"*"===r.charAt(this.pos)&&(i=!0);n=r.charAt(this.pos++);)if("*"===n&&"/"===r.charAt(this.pos))return this.pos++,i&&e?h(r.slice(t+3,this.pos-2)):this._skip(e);throw this.error("unterminated comment",t)}},l.prototype._endOf=function(e){for(var t=this.pos,n=this._str;e.test(n.charAt(t));)t++;return t},l.prototype._endOfString=function(){for(var e,t=this.pos+1,n=this._str;e=n.charAt(t);){if('"'===e)return t+1;"\\"===e?t+=2:t++}throw this.error("unterminated string",t-1)},l.prototype._endOfJson=function(){var e=i.jsonEnd(this._str,this.pos);if(e<0)throw this.error("invalid JSON",e);return e},e.exports={Tokenizer:l,assembleProtocol:c,read:function(e){var t;if("string"==typeof e&&~e.indexOf(o.sep)&&r.existsSync(e)){var n=r.readFileSync(e,{encoding:"utf8"});try{return JSON.parse(n)}catch(i){c(e,{importHook:r.createSyncImportHook()},(function(e,r){t=e?n:r}))}}else t=e;if("string"!=typeof t||"null"===t)return t;try{return JSON.parse(t)}catch(e){try{return u.readProtocol(t)}catch(e){try{return u.readSchema(t)}catch(e){return t}}}},readProtocol:u.readProtocol,readSchema:u.readSchema}},function(e,t,n){"use strict";function r(){return new Error("unsupported in the browser")}e.exports={createImportHook:function(){return function(e,t,n){n(r())}},createSyncImportHook:function(){return function(){throw r()}},existsSync:function(){return!1},readFileSync:function(){throw r()}}},function(e,t,n){"use strict";(function(t,r){var i=n(70),o=n(36),s=n(53),a=n(19),c=n(161),u={namespace:"org.apache.avro.file"},l=i.Type.forSchema("long",u),h=i.Type.forSchema({type:"map",values:"bytes"},u),d=i.Type.forSchema({name:"Header",type:"record",fields:[{name:"magic",type:{type:"fixed",name:"Magic",size:4}},{name:"meta",type:h},{name:"sync",type:{type:"fixed",name:"Sync",size:16}}]},u),p=i.Type.forSchema({name:"Block",type:"record",fields:[{name:"count",type:"long"},{name:"data",type:"bytes"},{name:"sync",type:"Sync"}]},u),f=o.bufferFrom("Obj"),m=a.format,y=o.Tap;function g(e,t){var n=!!(t=t||{}).noDecode;s.Duplex.call(this,{readableObjectMode:!n,allowHalfOpen:!1}),this._type=i.Type.forSchema(e),this._tap=new y(o.newBuffer(0)),this._writeCb=null,this._needPush=!1,this._readValue=k(n,this._type),this._finished=!1,this.on("finish",(function(){this._finished=!0,this._read()}))}function v(e){var t=!!(e=e||{}).noDecode;s.Duplex.call(this,{allowHalfOpen:!0,readableObjectMode:!t}),this._rType=void 0!==e.readerSchema?i.Type.forSchema(e.readerSchema):void 0,this._wType=null,this._codecs=e.codecs,this._codec=void 0,this._parseHook=e.parseHook,this._tap=new y(o.newBuffer(0)),this._blockTap=new y(o.newBuffer(0)),this._syncMarker=null,this._readValue=null,this._noDecode=t,this._queue=new o.OrderedQueue,this._decompress=null,this._index=0,this._remaining=void 0,this._needPush=!1,this._finished=!1,this.on("finish",(function(){this._finished=!0,this._needPush&&this._read()}))}function _(e,t){t=t||{},s.Transform.call(this,{writableObjectMode:!0,allowHalfOpen:!1}),this._type=i.Type.forSchema(e),this._writeValue=function(e,t){try{this._type._write(e,t)}catch(e){this.emit("typeError",e,t,this._type)}},this._tap=new y(o.newBuffer(t.batchSize||65536)),this.on("typeError",(function(e){this.emit("error",e)}))}function b(e,t){var n;if(t=t||{},s.Duplex.call(this,{allowHalfOpen:!0,writableObjectMode:!0}),i.Type.isType(e)?(n=e,e=void 0):n=i.Type.forSchema(e),this._schema=e,this._type=n,this._writeValue=function(e,t){try{this._type._write(e,t)}catch(e){return this.emit("typeError",e,t,this._type),!1}return!0},this._blockSize=t.blockSize||65536,this._tap=new y(o.newBuffer(this._blockSize)),this._codecs=t.codecs,this._codec=t.codec||"null",this._blockCount=0,this._syncMarker=t.syncMarker||(new o.Lcg).nextBuffer(16),this._queue=new o.OrderedQueue,this._pending=0,this._finished=!1,this._needHeader=!1,this._needPush=!1,this._metadata=t.metadata||{},!h.isValid(this._metadata))throw new Error("invalid metadata");var r=this._codec;if(this._compress=(this._codecs||b.getDefaultCodecs())[r],!this._compress)throw new Error(m("unsupported codec: %s",r));switch(void 0!==t.omitHeader&&(t.writeHeader=t.omitHeader?"never":"auto"),t.writeHeader){case!1:case"never":break;case void 0:case"auto":this._needHeader=!0;break;default:this._writeHeader()}this.on("finish",(function(){this._finished=!0,this._blockCount?this._flushChunk():this._finished&&this._needPush&&this.push(null)})),this.on("typeError",(function(e){this.emit("error",e)}))}function w(e,t,n){this.valueCount=e,this.rawDataLength=t,this.compressedDataLength=n}function E(e,t,n,r){this.index=e,this.buf=t,this.cb=n,this.count=0|r}function S(e){var t=e.pos,n=p._read(e);return e.isValid()?n:(e.pos=t,null)}function k(e,t,n){if(e)return i=t._skip,function(e){var t=e.pos;return i(e),e.buf.slice(t,e.pos)};if(n){var r=n.createResolver(t);return function(e){return r._read(e)}}return function(e){return t._read(e)};var i}a.inherits(g,s.Duplex),g.prototype._write=function(e,n,r){this._writeCb=r;var i=this._tap;i.buf=t.concat([i.buf.slice(i.pos),e]),i.pos=0,this._needPush&&(this._needPush=!1,this._read())},g.prototype._read=function(){this._needPush=!1;var e=this._tap,t=e.pos,n=this._readValue(e);e.isValid()?this.push(n):this._finished?this.push(null):(e.pos=t,this._needPush=!0,this._writeCb&&this._writeCb())},a.inherits(v,s.Duplex),v.defaultCodecs=function(){return{null:function(e,t){t(null,e)},deflate:c.inflateRaw}},v.getDefaultCodecs=v.defaultCodecs,v.prototype._decodeHeader=function(){var e=this._tap;if(e.buf.length<f.length)return!1;if(!f.equals(e.buf.slice(0,f.length)))return this.emit("error",new Error("invalid magic bytes")),!1;var t=d._read(e);if(!e.isValid())return!1;this._codec=(t.meta["avro.codec"]||"null").toString();var n=this._codecs||v.getDefaultCodecs();if(this._decompress=n[this._codec],this._decompress){try{var r=JSON.parse(t.meta["avro.schema"].toString());this._parseHook&&(r=this._parseHook(r)),this._wType=i.Type.forSchema(r)}catch(e){return void this.emit("error",e)}try{this._readValue=k(this._noDecode,this._wType,this._rType)}catch(e){return void this.emit("error",e)}return this._syncMarker=t.sync,this.emit("metadata",this._wType,this._codec,t),!0}this.emit("error",new Error(m("unknown codec: %s",this._codec)))},v.prototype._write=function(e,n,i){var s=this._tap;s.buf=t.concat([s.buf,e]),s.pos=0,this._decodeHeader()?(this._write=this._writeChunk,this._write(o.newBuffer(0),n,i)):r.nextTick(i)},v.prototype._writeChunk=function(e,n,r){var i=this._tap;i.buf=t.concat([i.buf.slice(i.pos),e]),i.pos=0;for(var o,s=1;o=S(i);){if(!this._syncMarker.equals(o.sync))return void this.emit("error",new Error("invalid sync marker"));s++,this._decompress(o.data,this._createBlockCallback(o.data.length,o.count,a))}function a(){--s||r()}a()},v.prototype._createBlockCallback=function(e,t,n){var r=this,i=this._index++;return function(o,s){if(o){var a=new Error(m("%s codec decompression error",r._codec));a.cause=o,r.emit("error",a),n()}else r.emit("block",new w(t,s.length,e)),r._queue.push(new E(i,s,n,t)),r._needPush&&r._read()}},v.prototype._read=function(){this._needPush=!1;var e,t=this._blockTap;if(!this._remaining){var n=this._queue.pop();if(!n||!n.count)return this._finished?this.push(null):this._needPush=!0,void(n&&n.cb());n.cb(),this._remaining=n.count,t.buf=n.buf,t.pos=0}this._remaining--;try{if(e=this._readValue(t),!t.isValid())throw new Error("truncated block")}catch(e){return this._remaining=0,void this.emit("error",e)}this.push(e)},a.inherits(_,s.Transform),_.prototype._transform=function(e,t,n){var r=this._tap,i=r.buf,s=r.pos;if(this._writeValue(r,e),!r.isValid()){s&&this.push(function(e,t,n){var r=o.newBuffer(n);return e.copy(r,0,t,t+n),r}(r.buf,0,s));var a=r.pos-s;a>i.length&&(r.buf=o.newBuffer(2*a)),r.pos=0,this._writeValue(r,e)}n()},_.prototype._flush=function(e){var t=this._tap,n=t.pos;n&&this.push(t.buf.slice(0,n)),e()},a.inherits(b,s.Duplex),b.defaultCodecs=function(){return{null:function(e,t){t(null,e)},deflate:c.deflateRaw}},b.getDefaultCodecs=b.defaultCodecs,b.prototype._writeHeader=function(){var e=JSON.stringify(this._schema?this._schema:this._type.getSchema({exportAttrs:!0})),t=o.copyOwnProperties(this._metadata,{"avro.schema":o.bufferFrom(e),"avro.codec":o.bufferFrom(this._codec)},!0),n=new(d.getRecordConstructor())(f,t,this._syncMarker);this.push(n.toBuffer())},b.prototype._write=function(e,t,n){this._needHeader&&(this._writeHeader(),this._needHeader=!1);var r=this._tap,i=r.pos,s=!1;if(this._writeValue(r,e)){if(!r.isValid()){i&&(this._flushChunk(i,n),s=!0);var a=r.pos-i;a>this._blockSize&&(this._blockSize=2*a),r.buf=o.newBuffer(this._blockSize),r.pos=0,this._writeValue(r,e)}this._blockCount++}else r.pos=i;s||n()},b.prototype._flushChunk=function(e,t){var n=this._tap;e=e||n.pos,this._compress(n.buf.slice(0,e),this._createBlockCallback(e,t)),this._blockCount=0},b.prototype._read=function(){var e=this,t=this._queue.pop();t?(this.push(l.toBuffer(t.count,!0)),this.push(l.toBuffer(t.buf.length,!0)),this.push(t.buf),this.push(this._syncMarker),this._finished||t.cb()):this._finished&&!this._pending?r.nextTick((function(){e.push(null)})):this._needPush=!0},b.prototype._createBlockCallback=function(e,t){var n=this,r=this._index++,i=this._blockCount;return this._pending++,function(o,s){if(o){var a=new Error(m("%s codec compression error",n._codec));return a.cause=o,void n.emit("error",a)}n._pending--,n.emit("block",new w(i,e,s.length)),n._queue.push(new E(r,s,t,i)),n._needPush&&(n._needPush=!1,n._read())}},e.exports={BLOCK_TYPE:p,HEADER_TYPE:d,MAGIC_BYTES:f,streams:{BlockDecoder:v,BlockEncoder:b,RawDecoder:g,RawEncoder:_}}}).call(this,n(8).Buffer,n(9))},function(e,t,n){"use strict";(function(e){var r=n(8).Buffer,i=n(53).Transform,o=n(162),s=n(19),a=n(99).ok,c=n(8).kMaxLength,u="Cannot create final Buffer. It would be larger than 0x"+c.toString(16)+" bytes";o.Z_MIN_WINDOWBITS=8,o.Z_MAX_WINDOWBITS=15,o.Z_DEFAULT_WINDOWBITS=15,o.Z_MIN_CHUNK=64,o.Z_MAX_CHUNK=1/0,o.Z_DEFAULT_CHUNK=16384,o.Z_MIN_MEMLEVEL=1,o.Z_MAX_MEMLEVEL=9,o.Z_DEFAULT_MEMLEVEL=8,o.Z_MIN_LEVEL=-1,o.Z_MAX_LEVEL=9,o.Z_DEFAULT_LEVEL=o.Z_DEFAULT_COMPRESSION;for(var l=Object.keys(o),h=0;h<l.length;h++){var d=l[h];d.match(/^Z/)&&Object.defineProperty(t,d,{enumerable:!0,value:o[d],writable:!1})}for(var p={Z_OK:o.Z_OK,Z_STREAM_END:o.Z_STREAM_END,Z_NEED_DICT:o.Z_NEED_DICT,Z_ERRNO:o.Z_ERRNO,Z_STREAM_ERROR:o.Z_STREAM_ERROR,Z_DATA_ERROR:o.Z_DATA_ERROR,Z_MEM_ERROR:o.Z_MEM_ERROR,Z_BUF_ERROR:o.Z_BUF_ERROR,Z_VERSION_ERROR:o.Z_VERSION_ERROR},f=Object.keys(p),m=0;m<f.length;m++){var y=f[m];p[p[y]]=y}function g(e,t,n){var i=[],o=0;function s(){for(var t;null!==(t=e.read());)i.push(t),o+=t.length;e.once("readable",s)}function a(){var t,s=null;o>=c?s=new RangeError(u):t=r.concat(i,o),i=[],e.close(),n(s,t)}e.on("error",(function(t){e.removeListener("end",a),e.removeListener("readable",s),n(t)})),e.on("end",a),e.end(t),s()}function v(e,t){if("string"==typeof t&&(t=r.from(t)),!r.isBuffer(t))throw new TypeError("Not a string or buffer");var n=e._finishFlushFlag;return e._processChunk(t,n)}function _(e){if(!(this instanceof _))return new _(e);C.call(this,e,o.DEFLATE)}function b(e){if(!(this instanceof b))return new b(e);C.call(this,e,o.INFLATE)}function w(e){if(!(this instanceof w))return new w(e);C.call(this,e,o.GZIP)}function E(e){if(!(this instanceof E))return new E(e);C.call(this,e,o.GUNZIP)}function S(e){if(!(this instanceof S))return new S(e);C.call(this,e,o.DEFLATERAW)}function k(e){if(!(this instanceof k))return new k(e);C.call(this,e,o.INFLATERAW)}function O(e){if(!(this instanceof O))return new O(e);C.call(this,e,o.UNZIP)}function T(e){return e===o.Z_NO_FLUSH||e===o.Z_PARTIAL_FLUSH||e===o.Z_SYNC_FLUSH||e===o.Z_FULL_FLUSH||e===o.Z_FINISH||e===o.Z_BLOCK}function C(e,n){var s=this;if(this._opts=e=e||{},this._chunkSize=e.chunkSize||t.Z_DEFAULT_CHUNK,i.call(this,e),e.flush&&!T(e.flush))throw new Error("Invalid flush flag: "+e.flush);if(e.finishFlush&&!T(e.finishFlush))throw new Error("Invalid flush flag: "+e.finishFlush);if(this._flushFlag=e.flush||o.Z_NO_FLUSH,this._finishFlushFlag=void 0!==e.finishFlush?e.finishFlush:o.Z_FINISH,e.chunkSize&&(e.chunkSize<t.Z_MIN_CHUNK||e.chunkSize>t.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<t.Z_MIN_WINDOWBITS||e.windowBits>t.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<t.Z_MIN_LEVEL||e.level>t.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<t.Z_MIN_MEMLEVEL||e.memLevel>t.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=t.Z_FILTERED&&e.strategy!=t.Z_HUFFMAN_ONLY&&e.strategy!=t.Z_RLE&&e.strategy!=t.Z_FIXED&&e.strategy!=t.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!r.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new o.Zlib(n);var a=this;this._hadError=!1,this._handle.onerror=function(e,n){I(a),a._hadError=!0;var r=new Error(e);r.errno=n,r.code=t.codes[n],a.emit("error",r)};var c=t.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(c=e.level);var u=t.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(u=e.strategy),this._handle.init(e.windowBits||t.Z_DEFAULT_WINDOWBITS,c,e.memLevel||t.Z_DEFAULT_MEMLEVEL,u,e.dictionary),this._buffer=r.allocUnsafe(this._chunkSize),this._offset=0,this._level=c,this._strategy=u,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!s._handle},configurable:!0,enumerable:!0})}function I(t,n){n&&e.nextTick(n),t._handle&&(t._handle.close(),t._handle=null)}function A(e){e.emit("close")}Object.defineProperty(t,"codes",{enumerable:!0,value:Object.freeze(p),writable:!1}),t.Deflate=_,t.Inflate=b,t.Gzip=w,t.Gunzip=E,t.DeflateRaw=S,t.InflateRaw=k,t.Unzip=O,t.createDeflate=function(e){return new _(e)},t.createInflate=function(e){return new b(e)},t.createDeflateRaw=function(e){return new S(e)},t.createInflateRaw=function(e){return new k(e)},t.createGzip=function(e){return new w(e)},t.createGunzip=function(e){return new E(e)},t.createUnzip=function(e){return new O(e)},t.deflate=function(e,t,n){return"function"==typeof t&&(n=t,t={}),g(new _(t),e,n)},t.deflateSync=function(e,t){return v(new _(t),e)},t.gzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),g(new w(t),e,n)},t.gzipSync=function(e,t){return v(new w(t),e)},t.deflateRaw=function(e,t,n){return"function"==typeof t&&(n=t,t={}),g(new S(t),e,n)},t.deflateRawSync=function(e,t){return v(new S(t),e)},t.unzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),g(new O(t),e,n)},t.unzipSync=function(e,t){return v(new O(t),e)},t.inflate=function(e,t,n){return"function"==typeof t&&(n=t,t={}),g(new b(t),e,n)},t.inflateSync=function(e,t){return v(new b(t),e)},t.gunzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),g(new E(t),e,n)},t.gunzipSync=function(e,t){return v(new E(t),e)},t.inflateRaw=function(e,t,n){return"function"==typeof t&&(n=t,t={}),g(new k(t),e,n)},t.inflateRawSync=function(e,t){return v(new k(t),e)},s.inherits(C,i),C.prototype.params=function(n,r,i){if(n<t.Z_MIN_LEVEL||n>t.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+n);if(r!=t.Z_FILTERED&&r!=t.Z_HUFFMAN_ONLY&&r!=t.Z_RLE&&r!=t.Z_FIXED&&r!=t.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+r);if(this._level!==n||this._strategy!==r){var s=this;this.flush(o.Z_SYNC_FLUSH,(function(){a(s._handle,"zlib binding closed"),s._handle.params(n,r),s._hadError||(s._level=n,s._strategy=r,i&&i())}))}else e.nextTick(i)},C.prototype.reset=function(){return a(this._handle,"zlib binding closed"),this._handle.reset()},C.prototype._flush=function(e){this._transform(r.alloc(0),"",e)},C.prototype.flush=function(t,n){var i=this,s=this._writableState;("function"==typeof t||void 0===t&&!n)&&(n=t,t=o.Z_FULL_FLUSH),s.ended?n&&e.nextTick(n):s.ending?n&&this.once("end",n):s.needDrain?n&&this.once("drain",(function(){return i.flush(t,n)})):(this._flushFlag=t,this.write(r.alloc(0),"",n))},C.prototype.close=function(t){I(this,t),e.nextTick(A,this)},C.prototype._transform=function(e,t,n){var i,s=this._writableState,a=(s.ending||s.ended)&&(!e||s.length===e.length);return null===e||r.isBuffer(e)?this._handle?(a?i=this._finishFlushFlag:(i=this._flushFlag,e.length>=s.length&&(this._flushFlag=this._opts.flush||o.Z_NO_FLUSH)),void this._processChunk(e,i,n)):n(new Error("zlib binding closed")):n(new Error("invalid input"))},C.prototype._processChunk=function(e,t,n){var i=e&&e.length,o=this._chunkSize-this._offset,s=0,l=this,h="function"==typeof n;if(!h){var d,p=[],f=0;this.on("error",(function(e){d=e})),a(this._handle,"zlib binding closed");do{var m=this._handle.writeSync(t,e,s,i,this._buffer,this._offset,o)}while(!this._hadError&&v(m[0],m[1]));if(this._hadError)throw d;if(f>=c)throw I(this),new RangeError(u);var y=r.concat(p,f);return I(this),y}a(this._handle,"zlib binding closed");var g=this._handle.write(t,e,s,i,this._buffer,this._offset,o);function v(c,u){if(this&&(this.buffer=null,this.callback=null),!l._hadError){var d=o-u;if(a(d>=0,"have should not go down"),d>0){var m=l._buffer.slice(l._offset,l._offset+d);l._offset+=d,h?l.push(m):(p.push(m),f+=m.length)}if((0===u||l._offset>=l._chunkSize)&&(o=l._chunkSize,l._offset=0,l._buffer=r.allocUnsafe(l._chunkSize)),0===u){if(s+=i-c,i=c,!h)return!0;var y=l._handle.write(t,e,s,i,l._buffer,l._offset,l._chunkSize);return y.callback=v,void(y.buffer=e)}if(!h)return!1;n()}}g.buffer=e,g.callback=v},s.inherits(_,C),s.inherits(b,C),s.inherits(w,C),s.inherits(E,C),s.inherits(S,C),s.inherits(k,C),s.inherits(O,C)}).call(this,n(9))},function(e,t,n){"use strict";(function(e,r){var i=n(99),o=n(164),s=n(165),a=n(168),c=n(171);for(var u in c)t[u]=c[u];t.NONE=0,t.DEFLATE=1,t.INFLATE=2,t.GZIP=3,t.GUNZIP=4,t.DEFLATERAW=5,t.INFLATERAW=6,t.UNZIP=7;function l(e){if("number"!=typeof e||e<t.DEFLATE||e>t.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=e,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}l.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,i(this.init_done,"close before init"),i(this.mode<=t.UNZIP),this.mode===t.DEFLATE||this.mode===t.GZIP||this.mode===t.DEFLATERAW?s.deflateEnd(this.strm):this.mode!==t.INFLATE&&this.mode!==t.GUNZIP&&this.mode!==t.INFLATERAW&&this.mode!==t.UNZIP||a.inflateEnd(this.strm),this.mode=t.NONE,this.dictionary=null)},l.prototype.write=function(e,t,n,r,i,o,s){return this._write(!0,e,t,n,r,i,o,s)},l.prototype.writeSync=function(e,t,n,r,i,o,s){return this._write(!1,e,t,n,r,i,o,s)},l.prototype._write=function(n,o,s,a,c,u,l,h){if(i.equal(arguments.length,8),i(this.init_done,"write before init"),i(this.mode!==t.NONE,"already finalized"),i.equal(!1,this.write_in_progress,"write already in progress"),i.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,i.equal(!1,void 0===o,"must provide flush value"),this.write_in_progress=!0,o!==t.Z_NO_FLUSH&&o!==t.Z_PARTIAL_FLUSH&&o!==t.Z_SYNC_FLUSH&&o!==t.Z_FULL_FLUSH&&o!==t.Z_FINISH&&o!==t.Z_BLOCK)throw new Error("Invalid flush value");if(null==s&&(s=e.alloc(0),c=0,a=0),this.strm.avail_in=c,this.strm.input=s,this.strm.next_in=a,this.strm.avail_out=h,this.strm.output=u,this.strm.next_out=l,this.flush=o,!n)return this._process(),this._checkError()?this._afterSync():void 0;var d=this;return r.nextTick((function(){d._process(),d._after()})),this},l.prototype._afterSync=function(){var e=this.strm.avail_out,t=this.strm.avail_in;return this.write_in_progress=!1,[t,e]},l.prototype._process=function(){var e=null;switch(this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=s.deflate(this.strm,this.flush);break;case t.UNZIP:switch(this.strm.avail_in>0&&(e=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===e)break;if(31!==this.strm.input[e]){this.mode=t.INFLATE;break}if(this.gzip_id_bytes_read=1,e++,1===this.strm.avail_in)break;case 1:if(null===e)break;139===this.strm.input[e]?(this.gzip_id_bytes_read=2,this.mode=t.GUNZIP):this.mode=t.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:for(this.err=a.inflate(this.strm,this.flush),this.err===t.Z_NEED_DICT&&this.dictionary&&(this.err=a.inflateSetDictionary(this.strm,this.dictionary),this.err===t.Z_OK?this.err=a.inflate(this.strm,this.flush):this.err===t.Z_DATA_ERROR&&(this.err=t.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===t.GUNZIP&&this.err===t.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=a.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},l.prototype._checkError=function(){switch(this.err){case t.Z_OK:case t.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===t.Z_FINISH)return this._error("unexpected end of file"),!1;break;case t.Z_STREAM_END:break;case t.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},l.prototype._after=function(){if(this._checkError()){var e=this.strm.avail_out,t=this.strm.avail_in;this.write_in_progress=!1,this.callback(t,e),this.pending_close&&this.close()}},l.prototype._error=function(e){this.strm.msg&&(e=this.strm.msg),this.onerror(e,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},l.prototype.init=function(e,n,r,o,s){i(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),i(e>=8&&e<=15,"invalid windowBits"),i(n>=-1&&n<=9,"invalid compression level"),i(r>=1&&r<=9,"invalid memlevel"),i(o===t.Z_FILTERED||o===t.Z_HUFFMAN_ONLY||o===t.Z_RLE||o===t.Z_FIXED||o===t.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(n,e,r,o,s),this._setDictionary()},l.prototype.params=function(){throw new Error("deflateParams Not supported")},l.prototype.reset=function(){this._reset(),this._setDictionary()},l.prototype._init=function(e,n,r,i,c){switch(this.level=e,this.windowBits=n,this.memLevel=r,this.strategy=i,this.flush=t.Z_NO_FLUSH,this.err=t.Z_OK,this.mode!==t.GZIP&&this.mode!==t.GUNZIP||(this.windowBits+=16),this.mode===t.UNZIP&&(this.windowBits+=32),this.mode!==t.DEFLATERAW&&this.mode!==t.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new o,this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=s.deflateInit2(this.strm,this.level,t.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:case t.UNZIP:this.err=a.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==t.Z_OK&&this._error("Init error"),this.dictionary=c,this.write_in_progress=!1,this.init_done=!0},l.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:this.err=s.deflateSetDictionary(this.strm,this.dictionary)}this.err!==t.Z_OK&&this._error("Failed to set dictionary")}},l.prototype._reset=function(){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:case t.GZIP:this.err=s.deflateReset(this.strm);break;case t.INFLATE:case t.INFLATERAW:case t.GUNZIP:this.err=a.inflateReset(this.strm)}this.err!==t.Z_OK&&this._error("Failed to reset stream")},t.Zlib=l}).call(this,n(8).Buffer,n(9))},function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function s(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,a,c=s(e),u=1;u<arguments.length;u++){for(var l in n=Object(arguments[u]))i.call(n,l)&&(c[l]=n[l]);if(r){a=r(n);for(var h=0;h<a.length;h++)o.call(n,a[h])&&(c[a[h]]=n[a[h]])}}return c}},function(e,t,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,n){"use strict";var r,i=n(55),o=n(166),s=n(100),a=n(101),c=n(167);function u(e,t){return e.msg=c[t],t}function l(e){return(e<<1)-(e>4?9:0)}function h(e){for(var t=e.length;--t>=0;)e[t]=0}function d(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function p(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,d(e.strm)}function f(e,t){e.pending_buf[e.pending++]=t}function m(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function y(e,t){var n,r,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,c=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,u=e.window,l=e.w_mask,h=e.prev,d=e.strstart+258,p=u[o+s-1],f=u[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(u[(n=t)+s]===f&&u[n+s-1]===p&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<d);if(r=258-(d-o),o=d-258,r>s){if(e.match_start=t,s=r,r>=a)break;p=u[o+s-1],f=u[o+s]}}}while((t=h[t&l])>c&&0!=--i);return s<=e.lookahead?s:e.lookahead}function g(e){var t,n,r,o,c,u,l,h,d,p,f=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-262)){i.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=f?r-f:0}while(--n);t=n=f;do{r=e.prev[--t],e.prev[t]=r>=f?r-f:0}while(--n);o+=f}if(0===e.strm.avail_in)break;if(u=e.strm,l=e.window,h=e.strstart+e.lookahead,d=o,p=void 0,(p=u.avail_in)>d&&(p=d),n=0===p?0:(u.avail_in-=p,i.arraySet(l,u.input,u.next_in,p,h),1===u.state.wrap?u.adler=s(u.adler,l,p,h):2===u.state.wrap&&(u.adler=a(u.adler,l,p,h)),u.next_in+=p,u.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=3)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+3-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function v(e,t){for(var n,r;;){if(e.lookahead<262){if(g(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=y(e,n)),e.match_length>=3)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}function _(e,t){for(var n,r,i;;){if(e.lookahead<262){if(g(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=y(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(p(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&p(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}function b(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function w(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),h(this.dyn_ltree),h(this.dyn_dtree),h(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),h(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),h(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function E(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):u(e,-2)}function S(e){var t,n=E(e);return 0===n&&((t=e.state).window_size=2*t.w_size,h(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function k(e,t,n,r,o,s){if(!e)return-2;var a=1;if(-1===t&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),o<1||o>9||8!==n||r<8||r>15||t<0||t>9||s<0||s>4)return u(e,-2);8===r&&(r=9);var c=new w;return e.state=c,c.strm=e,c.wrap=a,c.gzhead=null,c.w_bits=r,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=o+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new i.Buf8(2*c.w_size),c.head=new i.Buf16(c.hash_size),c.prev=new i.Buf16(c.w_size),c.lit_bufsize=1<<o+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new i.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=s,c.method=n,S(e)}r=[new b(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(g(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,p(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(p(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(p(e,!1),e.strm.avail_out),1)})),new b(4,4,8,4,v),new b(4,5,16,8,v),new b(4,6,32,32,v),new b(4,4,16,16,_),new b(8,16,32,32,_),new b(8,16,128,128,_),new b(8,32,128,256,_),new b(32,128,258,1024,_),new b(32,258,258,4096,_)],t.deflateInit=function(e,t){return k(e,t,8,15,8,0)},t.deflateInit2=k,t.deflateReset=S,t.deflateResetKeep=E,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},t.deflate=function(e,t){var n,i,s,c;if(!e||!e.state||t>5||t<0)return e?u(e,-2):-2;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return u(e,0===e.avail_out?-5:-2);if(i.strm=e,n=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,f(i,31),f(i,139),f(i,8),i.gzhead?(f(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),f(i,255&i.gzhead.time),f(i,i.gzhead.time>>8&255),f(i,i.gzhead.time>>16&255),f(i,i.gzhead.time>>24&255),f(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),f(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(f(i,255&i.gzhead.extra.length),f(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=a(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(f(i,0),f(i,0),f(i,0),f(i,0),f(i,0),f(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),f(i,3),i.status=113);else{var y=8+(i.w_bits-8<<4)<<8;y|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(y|=32),y+=31-y%31,i.status=113,m(i,y),0!==i.strstart&&(m(i,e.adler>>>16),m(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),d(e),s=i.pending,i.pending!==i.pending_buf_size));)f(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),d(e),s=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,f(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),0===c&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),d(e),s=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,f(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),0===c&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&d(e),i.pending+2<=i.pending_buf_size&&(f(i,255&e.adler),f(i,e.adler>>8&255),e.adler=0,i.status=113)):i.status=113),0!==i.pending){if(d(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&l(t)<=l(n)&&4!==t)return u(e,-5);if(666===i.status&&0!==e.avail_in)return u(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var v=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(g(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var n,r,i,s,a=e.window;;){if(e.lookahead<=258){if(g(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=a[i=e.strstart-1])===a[++i]&&r===a[++i]&&r===a[++i]){s=e.strstart+258;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s);e.match_length=258-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}(i,t):r[i.level].func(i,t);if(3!==v&&4!==v||(i.status=666),1===v||3===v)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===v&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(h(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),d(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(f(i,255&e.adler),f(i,e.adler>>8&255),f(i,e.adler>>16&255),f(i,e.adler>>24&255),f(i,255&e.total_in),f(i,e.total_in>>8&255),f(i,e.total_in>>16&255),f(i,e.total_in>>24&255)):(m(i,e.adler>>>16),m(i,65535&e.adler)),d(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?u(e,-2):(e.state=null,113===t?u(e,-3):0):-2},t.deflateSetDictionary=function(e,t){var n,r,o,a,c,u,l,d,p=t.length;if(!e||!e.state)return-2;if(2===(a=(n=e.state).wrap)||1===a&&42!==n.status||n.lookahead)return-2;for(1===a&&(e.adler=s(e.adler,t,p,0)),n.wrap=0,p>=n.w_size&&(0===a&&(h(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new i.Buf8(n.w_size),i.arraySet(d,t,p-n.w_size,n.w_size,0),t=d,p=n.w_size),c=e.avail_in,u=e.next_in,l=e.input,e.avail_in=p,e.next_in=0,e.input=t,g(n);n.lookahead>=3;){r=n.strstart,o=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--o);n.strstart=r,n.lookahead=2,g(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=u,e.input=l,e.avail_in=c,n.wrap=a,0},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,n){"use strict";var r=n(55);function i(e){for(var t=e.length;--t>=0;)e[t]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],c=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);i(u);var l=new Array(60);i(l);var h=new Array(512);i(h);var d=new Array(256);i(d);var p=new Array(29);i(p);var f,m,y,g=new Array(30);function v(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function _(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function b(e){return e<256?h[e]:h[256+(e>>>7)]}function w(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function E(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,w(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function S(e,t,n){E(e,n[2*t],n[2*t+1])}function k(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function O(e,t,n){var r,i,o=new Array(16),s=0;for(r=1;r<=15;r++)o[r]=s=s+n[r-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=k(o[a]++,a))}}function T(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function C(e){e.bi_valid>8?w(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function I(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function A(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&I(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!I(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function x(e,t,n){var r,i,a,c,u=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],i=e.pending_buf[e.l_buf+u],u++,0===r?S(e,i,t):(S(e,(a=d[i])+256+1,t),0!==(c=o[a])&&E(e,i-=p[a],c),S(e,a=b(--r),n),0!==(c=s[a])&&E(e,r-=g[a],c))}while(u<e.last_lit);S(e,256,t)}function R(e,t){var n,r,i,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<c;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=s[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)A(e,o,n);i=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],A(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,A(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,o,s,a,c=t.dyn_tree,u=t.max_code,l=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,m=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(o=c[2*c[2*(r=e.heap[n])+1]+1]+1)>f&&(o=f,m++),c[2*r+1]=o,r>u||(e.bl_count[o]++,s=0,r>=p&&(s=d[r-p]),a=c[2*r],e.opt_len+=a*(o+s),h&&(e.static_len+=a*(l[2*r+1]+s)));if(0!==m){do{for(o=f-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[f]--,m-=2}while(m>0);for(o=f;0!==o;o--)for(r=e.bl_count[o];0!==r;)(i=e.heap[--n])>u||(c[2*i+1]!==o&&(e.opt_len+=(o-c[2*i+1])*c[2*i],c[2*i+1]=o),r--)}}(e,t),O(o,u,e.bl_count)}function P(e,t,n){var r,i,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=t[2*(r+1)+1],++a<c&&i===s||(a<u?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=i,0===s?(c=138,u=3):i===s?(c=6,u=3):(c=7,u=4))}function N(e,t,n){var r,i,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),r=0;r<=n;r++)if(i=s,s=t[2*(r+1)+1],!(++a<c&&i===s)){if(a<u)do{S(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(S(e,i,e.bl_tree),a--),S(e,16,e.bl_tree),E(e,a-3,2)):a<=10?(S(e,17,e.bl_tree),E(e,a-3,3)):(S(e,18,e.bl_tree),E(e,a-11,7));a=0,o=i,0===s?(c=138,u=3):i===s?(c=6,u=3):(c=7,u=4)}}i(g);var j=!1;function L(e,t,n,i){E(e,0+(i?1:0),3),function(e,t,n,i){C(e),i&&(w(e,n),w(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}t._tr_init=function(e){j||(!function(){var e,t,n,r,i,c=new Array(16);for(n=0,r=0;r<28;r++)for(p[r]=n,e=0;e<1<<o[r];e++)d[n++]=r;for(d[n-1]=r,i=0,r=0;r<16;r++)for(g[r]=i,e=0;e<1<<s[r];e++)h[i++]=r;for(i>>=7;r<30;r++)for(g[r]=i<<7,e=0;e<1<<s[r]-7;e++)h[256+i++]=r;for(t=0;t<=15;t++)c[t]=0;for(e=0;e<=143;)u[2*e+1]=8,e++,c[8]++;for(;e<=255;)u[2*e+1]=9,e++,c[9]++;for(;e<=279;)u[2*e+1]=7,e++,c[7]++;for(;e<=287;)u[2*e+1]=8,e++,c[8]++;for(O(u,287,c),e=0;e<30;e++)l[2*e+1]=5,l[2*e]=k(e,5);f=new v(u,o,257,286,15),m=new v(l,s,0,30,15),y=new v(new Array(0),a,0,19,7)}(),j=!0),e.l_desc=new _(e.dyn_ltree,f),e.d_desc=new _(e.dyn_dtree,m),e.bl_desc=new _(e.bl_tree,y),e.bi_buf=0,e.bi_valid=0,T(e)},t._tr_stored_block=L,t._tr_flush_block=function(e,t,n,r){var i,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),R(e,e.l_desc),R(e,e.d_desc),s=function(e){var t;for(P(e,e.dyn_ltree,e.l_desc.max_code),P(e,e.dyn_dtree,e.d_desc.max_code),R(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*c[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?L(e,t,n,r):4===e.strategy||o===i?(E(e,2+(r?1:0),3),x(e,u,l)):(E(e,4+(r?1:0),3),function(e,t,n,r){var i;for(E(e,t-257,5),E(e,n-1,5),E(e,r-4,4),i=0;i<r;i++)E(e,e.bl_tree[2*c[i]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),x(e,e.dyn_ltree,e.dyn_dtree)),T(e),r&&C(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(d[n]+256+1)]++,e.dyn_dtree[2*b(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){E(e,2,3),S(e,256,u),function(e){16===e.bi_valid?(w(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,n){"use strict";var r=n(55),i=n(100),o=n(101),s=n(169),a=n(170);function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function l(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):-2}function h(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,l(e)):-2}function d(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,h(e))):-2}function p(e,t){var n,r;return e?(r=new u,e.state=r,r.window=null,0!==(n=d(e,t))&&(e.state=null),n):-2}var f,m,y=!0;function g(e){if(y){var t;for(f=new r.Buf32(512),m=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,f,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,m,0,e.work,{bits:5}),y=!1}e.lencode=f,e.lenbits=9,e.distcode=m,e.distbits=5}function v(e,t,n,i){var o,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),i>=s.wsize?(r.arraySet(s.window,t,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((o=s.wsize-s.wnext)>i&&(o=i),r.arraySet(s.window,t,n-i,o,s.wnext),(i-=o)?(r.arraySet(s.window,t,n-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}t.inflateReset=h,t.inflateReset2=d,t.inflateResetKeep=l,t.inflateInit=function(e){return p(e,15)},t.inflateInit2=p,t.inflate=function(e,t){var n,u,l,h,d,p,f,m,y,_,b,w,E,S,k,O,T,C,I,A,x,R,P,N,j=0,L=new r.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),d=e.next_out,l=e.output,f=e.avail_out,h=e.next_in,u=e.input,p=e.avail_in,m=n.hold,y=n.bits,_=p,b=f,R=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;y<16;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}if(2&n.wrap&&35615===m){n.check=0,L[0]=255&m,L[1]=m>>>8&255,n.check=o(n.check,L,2,0),m=0,y=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&m)<<8)+(m>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&m)){e.msg="unknown compression method",n.mode=30;break}if(y-=4,x=8+(15&(m>>>=4)),0===n.wbits)n.wbits=x;else if(x>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<x,e.adler=n.check=1,n.mode=512&m?10:12,m=0,y=0;break;case 2:for(;y<16;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}if(n.flags=m,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=m>>8&1),512&n.flags&&(L[0]=255&m,L[1]=m>>>8&255,n.check=o(n.check,L,2,0)),m=0,y=0,n.mode=3;case 3:for(;y<32;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}n.head&&(n.head.time=m),512&n.flags&&(L[0]=255&m,L[1]=m>>>8&255,L[2]=m>>>16&255,L[3]=m>>>24&255,n.check=o(n.check,L,4,0)),m=0,y=0,n.mode=4;case 4:for(;y<16;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}n.head&&(n.head.xflags=255&m,n.head.os=m>>8),512&n.flags&&(L[0]=255&m,L[1]=m>>>8&255,n.check=o(n.check,L,2,0)),m=0,y=0,n.mode=5;case 5:if(1024&n.flags){for(;y<16;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}n.length=m,n.head&&(n.head.extra_len=m),512&n.flags&&(L[0]=255&m,L[1]=m>>>8&255,n.check=o(n.check,L,2,0)),m=0,y=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((w=n.length)>p&&(w=p),w&&(n.head&&(x=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,u,h,w,x)),512&n.flags&&(n.check=o(n.check,u,w,h)),p-=w,h+=w,n.length-=w),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===p)break e;w=0;do{x=u[h+w++],n.head&&x&&n.length<65536&&(n.head.name+=String.fromCharCode(x))}while(x&&w<p);if(512&n.flags&&(n.check=o(n.check,u,w,h)),p-=w,h+=w,x)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===p)break e;w=0;do{x=u[h+w++],n.head&&x&&n.length<65536&&(n.head.comment+=String.fromCharCode(x))}while(x&&w<p);if(512&n.flags&&(n.check=o(n.check,u,w,h)),p-=w,h+=w,x)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;y<16;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}if(m!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}m=0,y=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;y<32;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}e.adler=n.check=c(m),m=0,y=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=d,e.avail_out=f,e.next_in=h,e.avail_in=p,n.hold=m,n.bits=y,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){m>>>=7&y,y-=7&y,n.mode=27;break}for(;y<3;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}switch(n.last=1&m,y-=1,3&(m>>>=1)){case 0:n.mode=14;break;case 1:if(g(n),n.mode=20,6===t){m>>>=2,y-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}m>>>=2,y-=2;break;case 14:for(m>>>=7&y,y-=7&y;y<32;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}if((65535&m)!=(m>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&m,m=0,y=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(w=n.length){if(w>p&&(w=p),w>f&&(w=f),0===w)break e;r.arraySet(l,u,h,w,d),p-=w,h+=w,f-=w,d+=w,n.length-=w;break}n.mode=12;break;case 17:for(;y<14;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}if(n.nlen=257+(31&m),m>>>=5,y-=5,n.ndist=1+(31&m),m>>>=5,y-=5,n.ncode=4+(15&m),m>>>=4,y-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;y<3;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}n.lens[M[n.have++]]=7&m,m>>>=3,y-=3}for(;n.have<19;)n.lens[M[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,P={bits:n.lenbits},R=a(0,n.lens,0,19,n.lencode,0,n.work,P),n.lenbits=P.bits,R){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;O=(j=n.lencode[m&(1<<n.lenbits)-1])>>>16&255,T=65535&j,!((k=j>>>24)<=y);){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}if(T<16)m>>>=k,y-=k,n.lens[n.have++]=T;else{if(16===T){for(N=k+2;y<N;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}if(m>>>=k,y-=k,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}x=n.lens[n.have-1],w=3+(3&m),m>>>=2,y-=2}else if(17===T){for(N=k+3;y<N;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}y-=k,x=0,w=3+(7&(m>>>=k)),m>>>=3,y-=3}else{for(N=k+7;y<N;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}y-=k,x=0,w=11+(127&(m>>>=k)),m>>>=7,y-=7}if(n.have+w>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;w--;)n.lens[n.have++]=x}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,P={bits:n.lenbits},R=a(1,n.lens,0,n.nlen,n.lencode,0,n.work,P),n.lenbits=P.bits,R){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,P={bits:n.distbits},R=a(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,P),n.distbits=P.bits,R){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(p>=6&&f>=258){e.next_out=d,e.avail_out=f,e.next_in=h,e.avail_in=p,n.hold=m,n.bits=y,s(e,b),d=e.next_out,l=e.output,f=e.avail_out,h=e.next_in,u=e.input,p=e.avail_in,m=n.hold,y=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;O=(j=n.lencode[m&(1<<n.lenbits)-1])>>>16&255,T=65535&j,!((k=j>>>24)<=y);){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}if(O&&0==(240&O)){for(C=k,I=O,A=T;O=(j=n.lencode[A+((m&(1<<C+I)-1)>>C)])>>>16&255,T=65535&j,!(C+(k=j>>>24)<=y);){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}m>>>=C,y-=C,n.back+=C}if(m>>>=k,y-=k,n.back+=k,n.length=T,0===O){n.mode=26;break}if(32&O){n.back=-1,n.mode=12;break}if(64&O){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&O,n.mode=22;case 22:if(n.extra){for(N=n.extra;y<N;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}n.length+=m&(1<<n.extra)-1,m>>>=n.extra,y-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;O=(j=n.distcode[m&(1<<n.distbits)-1])>>>16&255,T=65535&j,!((k=j>>>24)<=y);){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}if(0==(240&O)){for(C=k,I=O,A=T;O=(j=n.distcode[A+((m&(1<<C+I)-1)>>C)])>>>16&255,T=65535&j,!(C+(k=j>>>24)<=y);){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}m>>>=C,y-=C,n.back+=C}if(m>>>=k,y-=k,n.back+=k,64&O){e.msg="invalid distance code",n.mode=30;break}n.offset=T,n.extra=15&O,n.mode=24;case 24:if(n.extra){for(N=n.extra;y<N;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}n.offset+=m&(1<<n.extra)-1,m>>>=n.extra,y-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===f)break e;if(w=b-f,n.offset>w){if((w=n.offset-w)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}w>n.wnext?(w-=n.wnext,E=n.wsize-w):E=n.wnext-w,w>n.length&&(w=n.length),S=n.window}else S=l,E=d-n.offset,w=n.length;w>f&&(w=f),f-=w,n.length-=w;do{l[d++]=S[E++]}while(--w);0===n.length&&(n.mode=21);break;case 26:if(0===f)break e;l[d++]=n.length,f--,n.mode=21;break;case 27:if(n.wrap){for(;y<32;){if(0===p)break e;p--,m|=u[h++]<<y,y+=8}if(b-=f,e.total_out+=b,n.total+=b,b&&(e.adler=n.check=n.flags?o(n.check,l,b,d-b):i(n.check,l,b,d-b)),b=f,(n.flags?m:c(m))!==n.check){e.msg="incorrect data check",n.mode=30;break}m=0,y=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;y<32;){if(0===p)break e;p--,m+=u[h++]<<y,y+=8}if(m!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}m=0,y=0}n.mode=29;case 29:R=1;break e;case 30:R=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=d,e.avail_out=f,e.next_in=h,e.avail_in=p,n.hold=m,n.bits=y,(n.wsize||b!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&v(e,e.output,e.next_out,b-e.avail_out)?(n.mode=31,-4):(_-=e.avail_in,b-=e.avail_out,e.total_in+=_,e.total_out+=b,n.total+=b,n.wrap&&b&&(e.adler=n.check=n.flags?o(n.check,l,b,e.next_out-b):i(n.check,l,b,e.next_out-b)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===_&&0===b||4===t)&&0===R&&(R=-5),R)},t.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?-2:(n.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&i(1,t,r,0)!==n.check?-3:v(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i,o,s,a,c,u,l,h,d,p,f,m,y,g,v,_,b,w,E,S,k,O,T;n=e.state,r=e.next_in,O=e.input,i=r+(e.avail_in-5),o=e.next_out,T=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),c=n.dmax,u=n.wsize,l=n.whave,h=n.wnext,d=n.window,p=n.hold,f=n.bits,m=n.lencode,y=n.distcode,g=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{f<15&&(p+=O[r++]<<f,f+=8,p+=O[r++]<<f,f+=8),_=m[p&g];t:for(;;){if(p>>>=b=_>>>24,f-=b,0===(b=_>>>16&255))T[o++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=m[(65535&_)+(p&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&_,(b&=15)&&(f<b&&(p+=O[r++]<<f,f+=8),w+=p&(1<<b)-1,p>>>=b,f-=b),f<15&&(p+=O[r++]<<f,f+=8,p+=O[r++]<<f,f+=8),_=y[p&v];n:for(;;){if(p>>>=b=_>>>24,f-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=y[(65535&_)+(p&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(E=65535&_,f<(b&=15)&&(p+=O[r++]<<f,(f+=8)<b&&(p+=O[r++]<<f,f+=8)),(E+=p&(1<<b)-1)>c){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=b,f-=b,E>(b=o-s)){if((b=E-b)>l&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(S=0,k=d,0===h){if(S+=u-b,b<w){w-=b;do{T[o++]=d[S++]}while(--b);S=o-E,k=T}}else if(h<b){if(S+=u+h-b,(b-=h)<w){w-=b;do{T[o++]=d[S++]}while(--b);if(S=0,h<w){w-=b=h;do{T[o++]=d[S++]}while(--b);S=o-E,k=T}}}else if(S+=h-b,b<w){w-=b;do{T[o++]=d[S++]}while(--b);S=o-E,k=T}for(;w>2;)T[o++]=k[S++],T[o++]=k[S++],T[o++]=k[S++],w-=3;w&&(T[o++]=k[S++],w>1&&(T[o++]=k[S++]))}else{S=o-E;do{T[o++]=T[S++],T[o++]=T[S++],T[o++]=T[S++],w-=3}while(w>2);w&&(T[o++]=T[S++],w>1&&(T[o++]=T[S++]))}break}}break}}while(r<i&&o<a);r-=w=f>>3,p&=(1<<(f-=w<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=o<a?a-o+257:257-(o-a),n.hold=p,n.bits=f}},function(e,t,n){"use strict";var r=n(55),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,c,u,l,h,d){var p,f,m,y,g,v,_,b,w,E=d.bits,S=0,k=0,O=0,T=0,C=0,I=0,A=0,x=0,R=0,P=0,N=null,j=0,L=new r.Buf16(16),M=new r.Buf16(16),q=null,z=0;for(S=0;S<=15;S++)L[S]=0;for(k=0;k<c;k++)L[t[n+k]]++;for(C=E,T=15;T>=1&&0===L[T];T--);if(C>T&&(C=T),0===T)return u[l++]=20971520,u[l++]=20971520,d.bits=1,0;for(O=1;O<T&&0===L[O];O++);for(C<O&&(C=O),x=1,S=1;S<=15;S++)if(x<<=1,(x-=L[S])<0)return-1;if(x>0&&(0===e||1!==T))return-1;for(M[1]=0,S=1;S<15;S++)M[S+1]=M[S]+L[S];for(k=0;k<c;k++)0!==t[n+k]&&(h[M[t[n+k]]++]=k);if(0===e?(N=q=h,v=19):1===e?(N=i,j-=257,q=o,z-=257,v=256):(N=s,q=a,v=-1),P=0,k=0,S=O,g=l,I=C,A=0,m=-1,y=(R=1<<C)-1,1===e&&R>852||2===e&&R>592)return 1;for(;;){_=S-A,h[k]<v?(b=0,w=h[k]):h[k]>v?(b=q[z+h[k]],w=N[j+h[k]]):(b=96,w=0),p=1<<S-A,O=f=1<<I;do{u[g+(P>>A)+(f-=p)]=_<<24|b<<16|w|0}while(0!==f);for(p=1<<S-1;P&p;)p>>=1;if(0!==p?(P&=p-1,P+=p):P=0,k++,0==--L[S]){if(S===T)break;S=t[n+h[k]]}if(S>C&&(P&y)!==m){for(0===A&&(A=C),g+=O,x=1<<(I=S-A);I+A<T&&!((x-=L[I+A])<=0);)I++,x<<=1;if(R+=1<<I,1===e&&R>852||2===e&&R>592)return 1;u[m=P&y]=C<<24|I<<16|g-l|0}}return 0!==P&&(u[g+P]=S-A<<24|64<<16|0),d.bits=C,0}},function(e,t,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,n){"use strict";n.r(t),n.d(t,"ChainedTokenCredential",(function(){return u})),n.d(t,"EnvironmentCredential",(function(){return d})),n.d(t,"ClientSecretCredential",(function(){return x})),n.d(t,"ClientCertificateCredential",(function(){return N})),n.d(t,"InteractiveBrowserCredential",(function(){return gn})),n.d(t,"VisualStudioCodeCredential",(function(){return w})),n.d(t,"AzureCliCredential",(function(){return v})),n.d(t,"ManagedIdentityCredential",(function(){return m})),n.d(t,"DeviceCodeCredential",(function(){return bn})),n.d(t,"DefaultAzureCredential",(function(){return E})),n.d(t,"UsernamePasswordCredential",(function(){return En})),n.d(t,"AuthorizationCodeCredential",(function(){return On})),n.d(t,"AuthenticationError",(function(){return i.c})),n.d(t,"AggregateAuthenticationError",(function(){return i.a})),n.d(t,"AuthenticationErrorName",(function(){return i.d})),n.d(t,"AggregateAuthenticationErrorName",(function(){return i.b})),n.d(t,"CredentialUnavailable",(function(){return i.e})),n.d(t,"logger",(function(){return a.d})),n.d(t,"AzureAuthorityHosts",(function(){return mn.a})),n.d(t,"getDefaultAzureCredential",(function(){return Tn}));var r=n(10),i=n(18),o=n(22),s=n(44),a=n(3);const c=Object(a.a)("ChainedTokenCredential");class u{constructor(...e){this.UnavailableMessage="ChainedTokenCredential => failed to retrieve a token from the included credentials",this._sources=[],this._sources=e}getToken(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let n=null;const r=[],{span:u,updatedOptions:l}=Object(o.a)("ChainedTokenCredential-getToken",t);for(let t=0;t<this._sources.length&&null===n;t++)try{n=yield this._sources[t].getToken(e,l)}catch(t){if(!(t instanceof i.e))throw c.getToken.info(Object(a.b)(e,t)),t;r.push(t)}if(!n&&r.length>0){const t=new i.a(r);throw u.setStatus({code:s.b.ERROR,message:t.message}),c.getToken.info(Object(a.b)(e,t)),t}return u.end(),c.getToken.info(Object(a.c)(e)),n}))}}const l=new Error("EnvironmentCredential is not supported in the browser."),h=Object(a.a)("EnvironmentCredential");class d{constructor(){throw h.info(Object(a.b)("",l)),l}getToken(){throw h.getToken.info(Object(a.b)("",l)),l}}const p=new Error("ManagedIdentityCredential is not supported in the browser."),f=Object(a.a)("ManagedIdentityCredential");class m{constructor(){throw f.info(Object(a.b)("",p)),p}getToken(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){throw f.getToken.info(Object(a.b)("",p)),p}))}}const y=new Error("AzureCliCredential is not supported in the browser."),g=Object(a.a)("AzureCliCredential");class v{constructor(){throw g.info(Object(a.b)("",y)),y}getToken(){throw g.getToken.info(Object(a.b)("",y)),y}}const _=new Error("VisualStudioCodeCredential is not supported in the browser."),b=Object(a.a)("VisualStudioCodeCredential");class w{constructor(){throw b.info(Object(a.b)("",_)),_}getToken(){throw b.getToken.info(Object(a.b)("",_)),_}}class E extends u{constructor(e){const t=[];t.push(new d(e)),t.push(new m(e)),t.push(new v),t.push(new w(e)),super(...t)}}var S=n(38),k=n.n(S),O=n(77),T=n(30),C=n(57),I=n(40);const A=Object(a.a)("ClientSecretCredential");class x{constructor(e,t,n,r){this.identityClient=new C.a(r),this.tenantId=e,this.clientId=t,this.clientSecret=n}getToken(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{span:n,updatedOptions:r}=Object(o.a)("ClientSecretCredential-getToken",t);try{const i=Object(I.a)(this.tenantId),o=Object(O.a)({url:`${this.identityClient.authorityHost}/${this.tenantId}/${i}`,method:"POST",body:k.a.stringify({response_type:"token",grant_type:"client_credentials",client_id:this.clientId,client_secret:this.clientSecret,scope:"string"==typeof e?e:e.join(" ")}),headers:Object(T.a)({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),abortSignal:t&&t.abortSignal,tracingOptions:{spanOptions:r.tracingOptions&&r.tracingOptions.spanOptions,tracingContext:r.tracingOptions&&r.tracingOptions.tracingContext}}),s=yield this.identityClient.sendTokenRequest(o);return A.getToken.info(Object(a.c)(e)),s&&s.accessToken||null}catch(t){throw n.setStatus({code:s.b.ERROR,message:t.message}),A.getToken.info(Object(a.b)(e,t)),t}finally{n.end()}}))}}const R=new Error("ClientCertificateCredential is not supported in the browser."),P=Object(a.a)("ClientCertificateCredential");class N{constructor(){throw P.info(Object(a.b)("",R)),R}getToken(){throw P.getToken.info(Object(a.b)("",R)),R}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var j=function(e,t){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function L(e,t){function n(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var M=function(){return(M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function q(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function z(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function U(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var B,D=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var n=new Uint8Array(16);return t.getRandomValues(n),n[6]|=64,n[6]&=79,n[8]|=128,n[8]&=191,e.decimalToHex(n[0])+e.decimalToHex(n[1])+e.decimalToHex(n[2])+e.decimalToHex(n[3])+"-"+e.decimalToHex(n[4])+e.decimalToHex(n[5])+"-"+e.decimalToHex(n[6])+e.decimalToHex(n[7])+"-"+e.decimalToHex(n[8])+e.decimalToHex(n[9])+"-"+e.decimalToHex(n[10])+e.decimalToHex(n[11])+e.decimalToHex(n[12])+e.decimalToHex(n[13])+e.decimalToHex(n[14])+e.decimalToHex(n[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",i="0123456789abcdef",o=0,s="",a=0;a<36;a++)"-"!==r[a]&&"4"!==r[a]&&(o=16*Math.random()|0),"x"===r[a]?s+=i[o]:"y"===r[a]?(o&=3,s+=i[o|=8]):s+=r[a];return s},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},o={};for(t=r.exec(e);t;)o[i(t[1])]=i(t[2]),t=r.exec(e);return o},e}(),F=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!1,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!1,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(B||(B={}));var H,$,K,W="id_token",V="token",G="id_token token";!function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction.status",e.REDIRECT_REQUEST="redirect_request"}(H||(H={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}($||($={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(K||(K={}));var Y;!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(Y||(Y={}));var J,Z=[Y.SID,Y.LOGIN_HINT],Q="GET",X={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},ee="msalIdTokenFrame",te="msalRenewFrame",ne={code:"unexpected_error",desc:"Unexpected error in authentication."},re={code:"no_window_object",desc:"No window object available. Details:"},ie=function(e){function t(n,r){var i=e.call(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i.errorCode=n,i.errorMessage=r,i.name="AuthError",i}return L(t,e),t.createUnexpectedError=function(e){return new t(ne.code,ne.desc+": "+e)},t.createNoWindowObjectError=function(e){return new t(re.code,re.desc+" "+e)},t}(Error),oe=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},e}(),se={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},ae={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},ce={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},ue={code:"invalid_id_token",desc:"Invalid ID token format."},le={code:"invalid_state_error",desc:"Invalid state."},he={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},de={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},pe={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},fe={code:"user_cancelled",desc:"User cancelled the flow."},me={code:"callback_error",desc:"Error occurred in token received callback function."},ye={code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},ge={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},ve={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},_e={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},be={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},we={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},Ee={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},Se={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},ke={code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},Oe={code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"},Te=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,t.prototype),i}return L(t,e),t.createEndpointResolutionError=function(e){var n=se.desc;return e&&!oe.isEmpty(e)&&(n+=" Details: "+e),new t(se.code,n)},t.createPopupWindowError=function(e){var n=ae.desc;return e&&!oe.isEmpty(e)&&(n+=" Details: "+e),new t(ae.code,n)},t.createTokenRenewalTimeoutError=function(){return new t(ce.code,ce.desc)},t.createInvalidIdTokenError=function(e){return new t(ue.code,ue.desc+" Given token: "+e)},t.createInvalidStateError=function(e,n){return new t(le.code,le.desc+" "+e+", state expected : "+n+".")},t.createNonceMismatchError=function(e,n){return new t(he.code,he.desc+" "+e+", nonce expected : "+n+".")},t.createLoginInProgressError=function(){return new t(de.code,de.desc)},t.createAcquireTokenInProgressError=function(){return new t(pe.code,pe.desc)},t.createUserCancelledError=function(){return new t(fe.code,fe.desc)},t.createErrorInCallbackFunction=function(e){return new t(me.code,me.desc+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(ye.code,ye.desc)},t.createUserDoesNotExistError=function(){return new t(ge.code,ge.desc)},t.createClientInfoDecodingError=function(e){return new t(ve.code,ve.desc+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(_e.code,_e.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(be.code,be.desc+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(we.code,we.desc+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(Ee.code,Ee.desc+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(Se.code,Se.desc)},t.createCacheParseError=function(e){var n="invalid key: "+e+", "+ke.desc;return new t(ke.code,n)},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t(Oe.code,Oe.desc)},t}(ie),Ce={code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},Ie={code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},Ae={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},xe={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Re={code:"scopes_required",desc:"Scopes are required to obtain an access token."},Pe={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},Ne={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},je={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},Le={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},Me={code:"authority_uri_insecure",desc:"Authority URIs must use https."},qe={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},ze={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},Ue={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},Be={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},De={code:"empty_request_error",desc:"Request object is required."},Fe={code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},He={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},$e={code:"sso_silent_error",desc:"request must contain either sid or login_hint"},Ke={code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."},We=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,t.prototype),i}return L(t,e),t.createNoSetConfigurationError=function(){return new t(Ce.code,""+Ce.desc)},t.createStorageNotSupportedError=function(e){return new t(Ie.code,Ie.desc+" Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(Ae.code,Ae.desc)},t.createInvalidCallbackObjectError=function(e){return new t(xe.code,xe.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(Pe.code,Pe.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(Ne.code,Ne.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(Re.code,Re.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(je.code,je.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(Be.code,Be.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=De;return new t(e.code,e.desc)},t.createInvalidCorrelationIdError=function(){return new t(Fe.code,Fe.desc)},t.createKnownAuthoritiesNotSetError=function(){return new t(Ue.code,Ue.desc)},t.createInvalidAuthorityTypeError=function(){return new t(Le.code,Le.desc)},t.createUntrustedAuthorityError=function(e){return new t(ze.code,ze.desc+" Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var n=He,r=n.code,i=n.desc,o={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(r,i+" mising values: "+Object.keys(o).reduce((function(t,n){return e[n]?t:t.concat([n+" ("+o[n]+")"])}),[]).join(","))},t.createSsoSilentError=function(){return new t($e.code,$e.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(Ke.code,Ke.desc)},t}(Te),Ve=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var n=this.trimAndConvertArrayToLowerCase(U(e)),r=this.trimAndConvertArrayToLowerCase(U(t)),i=0;i<r.length;i++)if(n.indexOf(r[i].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var n=this.trimAndConvertArrayToLowerCase(U(e));return this.trimAndConvertArrayToLowerCase(U(t)).every((function(e){return n.indexOf(e.toString().toLowerCase())>=0}))},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map((function(e){return t.trimAndConvertToLowerCase(e)}))},e.trimScopes=function(e){return e.map((function(e){return e.trim()}))},e.removeElement=function(e,t){var n=this.trimAndConvertToLowerCase(t);return e.filter((function(e){return e!==n}))},e.parseScope=function(e){var t="";if(e)for(var n=0;n<e.length;++n)t+=n!==e.length-1?e[n]+" ":e[n];return t},e.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw We.createScopesNonArrayError(e);if(e.length<1&&t)throw We.createEmptyScopesArrayError(e.toString())}else if(t)throw We.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(F.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var n=t?this.trimAndConvertArrayToLowerCase(U(t)):null,r=this.trimAndConvertArrayToLowerCase(U(e));return n?U(r,n):r}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,n=0;return e.indexOf(F.openidScope)>-1&&(n+=1),e.indexOf(F.profileScope)>-1&&(n+=1),t>0&&t===n},e.containsAnyOidcScopes=function(e){var t=e.indexOf(F.openidScope)>-1,n=e.indexOf(F.profileScope)>-1;return t||n},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(F.openidScope)&&t.push(F.openidScope),-1===t.indexOf(F.profileScope)&&t.push(F.profileScope),t},e.removeDefaultScopes=function(e){return e.filter((function(e){return e!==F.openidScope&&e!==F.profileScope}))},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?F.oidcScopes:e},e}(),Ge=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),n=e.authorityInstance.AuthorizationEndpoint;return n.indexOf("?")<0?n+="?":n+="&",""+n+t.join("&")},e.createNavigationUrlString=function(e){var t=Ve.appendDefaultScopes(e.scopes),n=[];return n.push("response_type="+e.responseType),n.push("scope="+encodeURIComponent(Ve.parseScope(t))),n.push("client_id="+encodeURIComponent(e.clientId)),n.push("redirect_uri="+encodeURIComponent(e.redirectUri)),n.push("state="+encodeURIComponent(e.state)),n.push("nonce="+encodeURIComponent(e.nonce)),n.push("client_info=1"),n.push("x-client-SKU="+e.xClientSku),n.push("x-client-Ver="+e.xClientVer),e.promptValue&&n.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&n.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&n.push(e.queryParameters),e.extraQueryParameters&&n.push(e.extraQueryParameters),n.push("client-request-id="+encodeURIComponent(e.correlationId)),n},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var n=e.toLowerCase(),r=this.GetUrlComponents(n),i=r.PathSegments;return!t||0===i.length||i[0]!==F.common&&i[0]!==Y.ORGANIZATIONS&&i[0]!==Y.CONSUMERS||(i[0]=t),this.constructAuthorityUriFromObject(r,i)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===F.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===Y.ORGANIZATIONS},e.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===Y.CONSUMERS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=e.match(t);if(!n||n.length<6)throw"Valid url required";var r={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5]},i=r.AbsolutePath.split("/");return i=i.filter((function(e){return e&&e.length>0})),r.PathSegments=i,n[6]&&(r.Search=n[6]),n[8]&&(r.Hash=n[8]),r},e.CanonicalizeUri=function(t){if(t){var n=t.toLowerCase();return e.endsWith(n,"/")||(n+="/"),n}return t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(oe.isEmpty(e))return e;var n=new RegExp("(\\&"+t+"=)[^&]+");return e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),n=e.indexOf("#/");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var n=e.deserializeHash(t);return n.hasOwnProperty(B.ERROR_DESCRIPTION)||n.hasOwnProperty(B.ERROR)||n.hasOwnProperty(B.ACCESS_TOKEN)||n.hasOwnProperty(B.ID_TOKEN)},e.deserializeHash=function(t){var n=e.getHashFromUrl(t);return D.deserialize(n)},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e}(),Ye=function(e,t,n,r,i){this.authority=Ge.CanonicalizeUri(e),this.clientId=t,this.scopes=n,this.homeAccountIdentifier=D.base64Encode(r)+"."+D.base64Encode(i)},Je=function(e,t,n,r){this.accessToken=e,this.idToken=t,this.expiresIn=n,this.homeAccountIdentifier=r},Ze=function(){function e(e,t,n,r,i,o,s){this.authorityInstance=e,this.clientId=t,this.nonce=D.createNewGuid(),this.scopes=i?U(i):F.oidcScopes,this.scopes=Ve.trimScopes(this.scopes),this.state=o,this.correlationId=s,this.xClientSku="MSAL.JS",this.xClientVer="1.4.17",this.responseType=n,this.redirectUri=r}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!1,configurable:!0}),e.prototype.populateQueryParams=function(t,n,r,i){var o={};n&&(n.prompt&&(this.promptValue=n.prompt),n.claimsRequest&&(this.claimsValue=n.claimsRequest),e.isSSOParam(n)&&(o=this.constructUnifiedCacheQueryParameter(n,null))),r&&(o=this.constructUnifiedCacheQueryParameter(null,r)),o=this.addHintParameters(t,o);var s=n?n.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(o),this.extraQueryParameters=e.generateQueryParametersString(s,i)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var n,r,i;if(e)if(e.account){var o=e.account;(null===(n=o.idTokenClaims)||void 0===n?void 0:n.login_hint)?(r=Y.LOGIN_HINT,i=o.idTokenClaims.login_hint):o.sid?(r=Y.SID,i=o.sid):o.userName&&(r=Y.LOGIN_HINT,i=o.userName)}else e.sid?(r=Y.SID,i=e.sid):e.loginHint&&(r=Y.LOGIN_HINT,i=e.loginHint);else t&&t.hasOwnProperty(F.upn)&&(r=Y.ID_TOKEN,i=t.upn);return this.addSSOParameter(r,i)},e.prototype.addHintParameters=function(e,t){var n,r,i=t;return e&&(i[Y.SID]||i[Y.LOGIN_HINT]||((null===(n=e.idTokenClaims)||void 0===n?void 0:n.login_hint)?i=this.addSSOParameter(Y.LOGIN_HINT,null===(r=e.idTokenClaims)||void 0===r?void 0:r.login_hint,i):e.sid&&this.promptValue===X.NONE?i=this.addSSOParameter(Y.SID,e.sid,i):e.userName&&(i=this.addSSOParameter(Y.LOGIN_HINT,e.userName,i)))),i},e.prototype.addSSOParameter=function(e,t,n){var r=n||{};if(!t)return r;switch(e){case Y.SID:r[Y.SID]=t;break;case Y.ID_TOKEN:case Y.LOGIN_HINT:r[Y.LOGIN_HINT]=t}return r},e.generateQueryParametersString=function(e,t){var n=null;return e&&Object.keys(e).forEach((function(r){r===F.domain_hint&&(t||e[Y.SID])||(n?n+="&"+r+"="+encodeURIComponent(e[r]):n=r+"="+encodeURIComponent(e[r]))})),n},e.isSSOParam=function(e){return!(!e||!(e.account||e.sid||e.loginHint))},e.determineResponseType=function(e,t){return Ve.onlyContainsOidcScopes(t)?W:e?this.responseTypeForMatchingAccounts(t):G},e.responseTypeForMatchingAccounts=function(e){return Ve.containsAnyOidcScopes(e)?G:V},e}(),Qe=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,n){var r=this;return new Promise((function(n,i){var o=new XMLHttpRequest;if(o.open(t,e,!0),o.onload=function(){var e;(o.status<200||o.status>=300)&&i(r.handleError(o.responseText));try{e=JSON.parse(o.responseText)}catch(e){i(r.handleError(o.responseText))}var t={statusCode:o.status,body:e};n(t)},o.onerror=function(){i(o.status)},t!==Q)throw"not implemented";o.send()}))},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}(),Xe=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,n){t&&!this.getTrustedHostList().length&&n.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))},e.getAliases=function(e,t,n){return q(this,void 0,void 0,(function(){var r,i,o,s;return z(this,(function(a){return r=new Qe,i=Q,o="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize",s=t.createAndStartHttpEvent(n,i,o,"getAliases"),[2,r.sendRequestAsync(o,i,!0).then((function(e){return s.httpResponseStatus=e.statusCode,t.stopEvent(s),e.body.metadata})).catch((function(e){throw s.serverErrorCode=e,t.stopEvent(s),e}))]}))}))},e.setTrustedAuthoritiesFromNetwork=function(t,n,r){return q(this,void 0,void 0,(function(){var i;return z(this,(function(o){switch(o.label){case 0:return[4,this.getAliases(t,n,r)];case 1:return o.sent().forEach((function(t){t.aliases.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))})),i=Ge.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(i)&&e.TrustedHostList.push(i.toLowerCase()),[2]}}))}))},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(J||(J={}));var et,tt=function(){function e(e,t,n){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=n}return e.isAdfs=function(e){var t=Ge.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===F.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?J.Adfs:J.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=Ge.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=Ge.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===J.Adfs?this.CanonicalAuthority+".well-known/openid-configuration":this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw Le}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Me;if(!e.PathSegments||e.PathSegments.length<1)throw qe},e.prototype.DiscoverEndpoints=function(e,t,n){var r=new Qe,i=Q,o=t.createAndStartHttpEvent(n,i,e,"openIdConfigurationEndpoint");return r.sendRequestAsync(e,i,!0).then((function(e){return o.httpResponseStatus=e.statusCode,t.stopEvent(o),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}})).catch((function(e){throw o.serverErrorCode=e,t.stopEvent(o),e}))},e.prototype.resolveEndpointsAsync=function(e,t){return q(this,void 0,void 0,(function(){var n,r,i;return z(this,(function(o){switch(o.label){case 0:return this.IsValidationEnabled?(n=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==Xe.getTrustedHostList().length?[3,2]:[4,Xe.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:o.sent(),o.label=2;case 2:if(!Xe.IsInTrustedHostList(n))throw We.createUntrustedAuthorityError(n);o.label=3;case 3:return r=this.GetOpenIdConfigurationEndpoint(),i=this,[4,this.DiscoverEndpoints(r,e,t)];case 4:return i.tenantDiscoveryResponse=o.sent(),[2,this.tenantDiscoveryResponse]}}))}))},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),nt=function(){function e(t,n){if(!t||oe.isEmpty(t))return this.uid="",void(this.utid="");try{var r=D.base64Decode(t),i=JSON.parse(r);i&&(i.hasOwnProperty("uid")&&(this.uid=n?e.stripPolicyFromUid(i.uid,n):i.uid),i.hasOwnProperty("utid")&&(this.utid=i.utid))}catch(e){throw Te.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!1,configurable:!0}),e.createClientInfoFromIdToken=function(t,n){var r={uid:t.subject,utid:""};return new e(D.base64Encode(JSON.stringify(r)),n)},e.stripPolicyFromUid=function(e,t){var n=e.split("-"),r=t.split("/").reverse(),i="";return oe.isEmpty(r[0])?r.length>1&&(i=r[1]):i=r[0],n[n.length-1]===i?n.slice(0,n.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return D.base64Encode(e)},e}(),rt=function(){function e(){}return e.parseExpiresIn=function(e){return parseInt(e||"3599",10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),it=function(){function e(){}return e.decodeJwt=function(e){if(oe.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.validateExpirationIsWithinOffset=function(e,t){var n=t||300;return e&&e>rt.now()+n},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=D.base64Decode(n);return r?JSON.parse(r):null}catch(e){}return null},e}(),ot=function(e){if(oe.isEmpty(e))throw Te.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=it.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw Te.createIdTokenParsingError(e)}},st=function(e,t){this.key=e,this.value=t},at=function(){function e(e){if(!window)throw ie.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!==window[e]))throw We.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,n){window[this.cacheLocation].setItem(e,t),n&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,n){var r=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";n&&(r+="expires="+this.getCookieExpirationTime(n)+";");document.cookie=r},e.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),ct=function(){function e(){}return e.validateRequest=function(e,t,n,r){if(!t&&!e)throw We.createEmptyRequestError();var i,o;e&&(i=t?Ve.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,Ve.validateInputScope(i,!t),i=Ve.translateClientIdIfSingleScope(i,n),this.validatePromptParameter(e.prompt),o=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var s=this.validateAndGenerateState(e&&e.state,r),a=this.validateAndGenerateCorrelationId(e&&e.correlationId);return M(M({},e),{extraQueryParameters:o,scopes:i,state:s,correlationId:a})},e.validatePromptParameter=function(e){if(e&&[X.LOGIN,X.SELECT_ACCOUNT,X.CONSENT,X.NONE].indexOf(e)<0)throw We.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var n=M({},e);return n?(t&&delete n[F.claims],Z.forEach((function(e){n[e]&&delete n[e]})),n):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw We.createClaimsRequestParsingError(e)}},e.validateAndGenerateState=function(t,n){return oe.isEmpty(t)?e.generateLibraryState(n):""+e.generateLibraryState(n)+F.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:D.createNewGuid(),ts:rt.now(),method:e},n=JSON.stringify(t);return D.base64Encode(n)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(F.resourceDelimiter)[0];if(D.isGuid(t))return{id:t,ts:rt.now(),method:F.interactionTypeRedirect};try{var n=D.base64Decode(t);return JSON.parse(n)}catch(t){throw Te.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!D.isGuid(e))throw We.createInvalidCorrelationIdError();return D.isGuid(e)?e:D.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+F.resourceDelimiter+e.authority},e}(),ut=function(e){function t(t,n,r){var i=e.call(this,n)||this;return i.temporaryCache=new at("sessionStorage"),i.clientId=t,i.rollbackEnabled=!0,i.migrateCacheEntries(r),i}return L(t,e),t.prototype.migrateCacheEntries=function(t){var n,r=this,i=F.cachePrefix+"."+$.IDTOKEN,o=F.cachePrefix+"."+$.CLIENT_INFO,s=F.cachePrefix+"."+K.ERROR,a=F.cachePrefix+"."+K.ERROR_DESC,c=e.prototype.getItem.call(this,i);if(c)try{n=new ot(c)}catch(e){return}if(n&&n.claims&&n.claims.aud===this.clientId){var u=[c,e.prototype.getItem.call(this,o),e.prototype.getItem.call(this,s),e.prototype.getItem.call(this,a)];[$.IDTOKEN,$.CLIENT_INFO,K.ERROR,K.ERROR_DESC].forEach((function(e,n){return r.duplicateCacheEntry(e,u[n],t)}))}},t.prototype.duplicateCacheEntry=function(e,t,n){t&&this.setItem(e,t,n)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(n){return 0===e.indexOf(""+F.cachePrefix)||0===e.indexOf(F.adalIdToken)?e:t?F.cachePrefix+"."+this.clientId+"."+e:F.cachePrefix+"."+e}},t.prototype.matchKeyForType=function(e,t,n,r){var i=oe.validateAndParseJsonCacheKey(e);if(!i)return null;var o=e.match(t)&&e.match(n),s=!1;switch(r){case B.ACCESS_TOKEN:s=!!e.match(F.scopes);break;case B.ID_TOKEN:s=!e.match(F.scopes)}return o&&s?i:null},t.prototype.setItem=function(t,n,r){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),n,r),this.rollbackEnabled&&!r&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),n,r)},t.prototype.getItem=function(t,n){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),n)},t.prototype.removeItem=function(t){this.temporaryCache.removeItem(this.generateCacheKey(t,!0)),e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.setTemporaryItem=function(e,t,n){this.temporaryCache.setItem(this.generateCacheKey(e,!0),t,n)},t.prototype.getTemporaryItem=function(e,t){return this.temporaryCache.getItem(this.generateCacheKey(e,!0),t)},t.prototype.resetCacheItems=function(){var t,n=window[this.cacheLocation];for(t in n)n.hasOwnProperty(t)&&-1!==t.indexOf(F.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var n=this,r=t&&ct.parseLibraryState(t).id,i=this.tokenRenewalInProgress(t),o=window[this.cacheLocation];r&&!i&&Object.keys(o).forEach((function(t){-1!==t.indexOf(r)&&(n.removeItem(t),e.prototype.clearItemCookie.call(n,t))})),this.setInteractionInProgress(!1),this.removeItem(H.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,n,r){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),n,r),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),n,r)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllTokensByType=function(e,t,n){var r=this;return Object.keys(window[this.cacheLocation]).reduce((function(i,o){var s=r.matchKeyForType(o,e,t,n);if(s){var a=r.getItem(o);if(a)try{var c=new st(s,JSON.parse(a));return i.concat([c])}catch(e){return i}}return i}),[])},t.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,B.ACCESS_TOKEN)},t.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,B.ID_TOKEN)},t.prototype.getAllTokens=function(e,t){return U(this.getAllAccessTokens(e,t),this.getAllIdTokens(e,t))},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){return this.getTemporaryItem(this.generateCacheKey(H.INTERACTION_STATUS,!1))},t.prototype.setInteractionInProgress=function(e){if(e){if(this.isInteractionInProgress(!1))throw Te.createAcquireTokenInProgressError();this.setTemporaryItem(this.generateCacheKey(H.INTERACTION_STATUS,!1),this.clientId)}else!e&&this.isInteractionInProgress(!0)&&this.removeItem(this.generateCacheKey(H.INTERACTION_STATUS,!1))},t.prototype.tokenRenewalInProgress=function(e){var n=this.getItem(t.generateTemporaryCacheKey(H.RENEW_STATUS,e));return!(!n||n!==F.inProgress)},t.prototype.clearMsalCookie=function(n){var r=this;n?(this.clearItemCookie(t.generateTemporaryCacheKey(H.NONCE_IDTOKEN,n)),this.clearItemCookie(t.generateTemporaryCacheKey(H.STATE_LOGIN,n)),this.clearItemCookie(t.generateTemporaryCacheKey(H.LOGIN_REQUEST,n)),this.clearItemCookie(t.generateTemporaryCacheKey(H.STATE_ACQ_TOKEN,n))):document.cookie.split(";").forEach((function(t){var n=t.trim().split("=")[0];n.indexOf(F.cachePrefix)>-1&&e.prototype.clearItemCookie.call(r,n)}))},t.generateAcquireTokenAccountKey=function(e,t){var n=ct.parseLibraryState(t).id;return""+H.ACQUIRE_TOKEN_ACCOUNT+F.resourceDelimiter+e+F.resourceDelimiter+n},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(H.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var n=ct.parseLibraryState(t).id;return""+e+F.resourceDelimiter+n},t}(at),lt=function(){function e(e,t,n,r,i,o,s){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=n,this.name=r,this.idToken=i,this.idTokenClaims=i,this.sid=o,this.environment=s}return e.createAccount=function(t,n){var r,i=t.objectId||t.subject,o=n?n.uid:"",s=n?n.utid:"";return oe.isEmpty(o)||(r=oe.isEmpty(s)?D.base64Encode(o):D.base64Encode(o)+"."+D.base64Encode(s)),new e(i,r,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}(),ht=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+F.resourceDelimiter+t},e.monitorIframeForHash=function(t,n,r,i){return new Promise((function(o,s){var a=rt.relativeNowMs()+n;i.verbose("monitorWindowForIframe polling started");var c=setInterval((function(){if(rt.relativeNowMs()>a)return i.error("monitorIframeForHash unable to find hash in url, timing out"),i.errorPii("monitorIframeForHash polling timed out for url: "+r),clearInterval(c),void s(Te.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(e){}e&&Ge.urlContainsHash(e)&&(i.verbose("monitorIframeForHash found url in hash"),clearInterval(c),o(t.location.hash))}),e.POLLING_INTERVAL_MS)}))},e.monitorPopupForHash=function(t,n,r,i){return new Promise((function(o,s){var a=n/e.POLLING_INTERVAL_MS,c=0;i.verbose("monitorWindowForHash polling started");var u=setInterval((function(){if(t.closed)return i.error("monitorWindowForHash window closed"),clearInterval(u),void s(Te.createUserCancelledError());var n;try{n=t.location.href}catch(e){}if(n&&"about:blank"!==n)if(c++,n&&Ge.urlContainsHash(n)){i.verbose("monitorPopupForHash found url in hash"),clearInterval(u);var l=t.location.hash;e.clearUrlFragment(t),o(l)}else c>a&&(i.error("monitorPopupForHash unable to find hash in url, timing out"),i.errorPii("monitorPopupForHash polling timed out for url: "+r),clearInterval(u),s(Te.createTokenRenewalTimeoutError()))}),e.POLLING_INTERVAL_MS)}))},e.loadFrame=function(e,t,n,r){var i=this;return r.infoPii("LoadFrame: "+t),new Promise((function(o,s){setTimeout((function(){var n=i.loadFrameSync(e,t,r);n?o(n):s("Unable to load iframe with name: "+t)}),n)}))},e.loadFrameSync=function(t,n,r){var i=e.addHiddenIFrame(n,r);return i?(""!==i.src&&"about:blank"!==i.src||(i.src=t,r.infoPii("Frame Name : "+n+" Navigated to: "+t)),i):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.info("Add msal iframe to document"),t.infoPii("Add msal frame to document:"+e);var n=document.getElementById(e);if(n)t.verbose("Add msal iframe already exists");else{t.verbose("Add msal iframe does not exist");var r=document.createElement("iframe");r.setAttribute("id",e),r.setAttribute("aria-hidden","true"),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),n=document.getElementsByTagName("body")[0].appendChild(r)}return n},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map((function(e,n){return t.item(n)})).filter((function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}}))[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter((function(e){try{return e.location.hash===t}catch(e){return!1}}))[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach((function(e){return e.close()}))},e.blockReloadInHiddenIframes=function(){if(Ge.urlContainsHash(window.location.hash)&&e.isInIframe())throw Te.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(H.REDIRECT_REQUEST);if(t&&!Ge.urlContainsHash(window.location.hash)){var n=t.split(F.resourceDelimiter);n.shift();var r=n.length>0?n.join(F.resourceDelimiter):null;e.resetTempCacheItems(r)}},e.clearUrlFragment=function(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,null,""+e.location.pathname+e.location.search)},e.POLLING_INTERVAL_MS=50,e}(),dt=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var n=Number(t.expiration);return n&&!e.expiresOn&&(e.expiresOn=new Date(1e3*n)),M(M({},e),{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e.buildAuthResponse=function(t,n,r,i,o,s){switch(r.responseType){case W:var a=M(M({},n),{tokenType:B.ID_TOKEN,account:i,scopes:o,accountState:s});return(a=e.setResponseIdToken(a,t)).idToken?a:null;case G:var c=e.setResponseIdToken(n,t);return c&&c.accessToken&&c.idToken?c:null;case V:return e.setResponseIdToken(n,t);default:return null}},e}(),pt=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,n){return q(this,void 0,void 0,(function(){var r;return z(this,(function(i){switch(i.label){case 0:return[4,e.resolveEndpointsAsync(t,n)];case 1:return r=i.sent(),this.metadataMap.set(e.CanonicalAuthority,r),[2,r]}}))}))},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var n=JSON.parse(t);if(!n.authorization_endpoint||!n.end_session_endpoint||!n.issuer)throw We.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:n.authorization_endpoint,EndSessionEndpoint:n.end_session_endpoint,Issuer:n.issuer})}}catch(e){throw We.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,n){return oe.isEmpty(e)?null:(n&&this.saveMetadataFromConfig(e,n),new tt(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(et||(et={}));var ft=function(){function e(e,t){void 0===t&&(t={}),this.level=et.Info;var n=t.correlationId,r=void 0===n?"":n,i=t.level,o=void 0===i?et.Info:i,s=t.piiLoggingEnabled,a=void 0!==s&&s;this.localCallback=e,this.correlationId=r,this.level=o,this.piiLoggingEnabled=a}return e.prototype.logMessage=function(e,t,n){if(!(e>this.level||!this.piiLoggingEnabled&&n)){var r,i=(new Date).toUTCString();r=oe.isEmpty(this.correlationId)?i+":1.4.17-"+et[e]+(n?"-pii":"")+" "+t:i+":"+this.correlationId+"-1.4.17-"+et[e]+(n?"-pii":"")+" "+t,this.executeCallback(e,r,n)}},e.prototype.executeCallback=function(e,t,n){this.localCallback&&this.localCallback(e,t,n)},e.prototype.error=function(e){this.logMessage(et.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(et.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(et.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(et.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(et.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(et.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(et.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(et.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),mt={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return Ge.getCurrentUrl()},postLogoutRedirectUri:function(){return Ge.getCurrentUrl()},navigateToLoginRequestUrl:!0},yt={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},gt={logger:new ft(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},vt={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var _t={code:"server_unavailable",desc:"Server is temporarily unavailable."},bt={code:"unknown_server_error"},wt=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return L(t,e),t.createServerUnavailableError=function(){return new t(_t.code,_t.desc)},t.createUnknownServerError=function(e){return new t(bt.code,e)},t}(ie),Et={code:"interaction_required"},St={code:"consent_required"},kt={code:"login_required"},Ot=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return L(t,e),t.isInteractionRequiredError=function(e){var t=[Et.code,St.code,kt.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(kt.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(Et.code,e)},t.createConsentRequiredAuthError=function(e){return new t(St.code,e)},t}(wt);function Tt(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var Ct,It,At,xt="Microsoft.MSAL.correlation_id",Rt="msal.api_telem_id",Pt="msal.api_id",Nt="Microsoft_MSAL_cache_event_count",jt="Microsoft_MSAL_http_event_count",Lt="Microsoft_MSAL_ui_event_count",Mt=function(e){var t=Ge.GetUrlComponents(e);if(tt.isAdfs(e))return e;var n=t.PathSegments;if(n&&n.length>=2){var r="tfp"===n[1]?2:1;r<n.length&&(n[r]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+n.join("/")},qt=function(e){return D.base64Encode(e)},zt=function(e){return"msal."+(e||"")},Ut=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},Bt=function(){function e(e,t,n){var r;this.eventId=D.createNewGuid(),this.label=n,this.event=((r={})[zt("event_name")]=e,r[zt("elapsed_time")]=-1,r[""+xt]=t,r)}return e.prototype.setElapsedTime=function(e){this.event[zt("elapsed_time")]=e},e.prototype.stop=function(){var e,t,n;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,n=this.perfEndMark,Ut()&&(window.performance.mark(n),window.performance.measure(e,t,n),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(n))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[zt("start_time")]=this.startTimestamp,e=this.perfStartMark,Ut()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+xt]},set:function(e){this.event[""+xt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[zt("event_name")]},enumerable:!1,configurable:!0}),e.prototype.get=function(){return M(M({},this.event),{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!1,configurable:!0}),e}(),Dt=function(e){function t(t,n,r,i){var o=e.call(this,zt("default_event"),n,"DefaultEvent")||this;return o.event[zt("client_id")]=r,o.event[zt("sdk_plaform")]=t.sdk,o.event[zt("sdk_version")]=t.sdkVersion,o.event[zt("application_name")]=t.applicationName,o.event[zt("application_version")]=t.applicationVersion,o.event[zt("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,o.event[""+Lt]=o.getEventCount(zt("ui_event"),i),o.event[""+jt]=o.getEventCount(zt("http_event"),i),o.event[""+Nt]=o.getEventCount(zt("cache_event"),i),o}return L(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(Bt),Ft=zt("authority"),Ht=zt("authority_type"),$t=zt("ui_behavior"),Kt=zt("tenant_id"),Wt=zt("user_id"),Vt=zt("was_successful"),Gt=zt("api_error_code"),Yt=zt("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(It||(It={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(At||(At={}));var Jt=((Ct={})[At.AcquireTokenSilent]=It.AcquireTokenSilent,Ct[At.AcquireTokenPopup]=It.AcquireTokenPopup,Ct[At.AcquireTokenRedirect]=It.AcquireTokenRedirect,Ct[At.LoginPopup]=It.LoginPopup,Ct[At.LoginRedirect]=It.LoginRedirect,Ct[At.Logout]=It.Logout,Ct),Zt=function(e){function t(t,n,r){var i=e.call(this,zt("api_event"),t,r)||this;return r&&(i.apiCode=Jt[r],i.apiEventIdentifier=r),i.piiEnabled=n,i}return L(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event[Rt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event[Pt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[Ft]=Mt(e).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[Gt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[Kt]=this.piiEnabled&&e?qt(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[Wt]=this.piiEnabled&&e?qt(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[Vt]},set:function(e){this.event[Vt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[Yt]=this.piiEnabled&&e?qt(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[Ht]=e.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[$t]=e.toLowerCase()},enumerable:!1,configurable:!0}),t}(Bt),Qt=zt("http_path"),Xt=zt("user_agent"),en=zt("query_parameters"),tn=zt("api_version"),nn=zt("response_code"),rn=zt("oauth_error_code"),on=zt("http_method"),sn=zt("request_id_header"),an=zt("spe_info"),cn=zt("server_error_code"),un=zt("server_sub_error_code"),ln=zt("url"),hn=function(e){function t(t,n){return e.call(this,zt("http_event"),t,n)||this}return L(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=Mt(e);this.event[ln]=t&&t.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[Qt]=Mt(e).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[Xt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[en]=Ze.generateQueryParametersString(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[tn]=e.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[nn]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[rn]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[on]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[sn]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[an]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[cn]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[un]=e},enumerable:!1,configurable:!0}),t}(Bt),dn=function(){function e(e,t,n){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=M({sdk:F.libraryName,sdkVersion:"1.4.17",networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=n}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},(function(){}),t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=U(t||[],[e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var n=this.getOrphanedEvents(e);n.forEach((function(e){return t.incrementEventCount(e)}));var r=U(this.completedEvents[e],n);delete this.completedEvents[e];var i=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],r&&r.length){var o=U(r,[new Dt(this.telemetryPlatform,e,this.clientId,i)]);this.telemetryEmitter(o.map((function(e){return e.get()})))}}},e.prototype.createAndStartApiEvent=function(e,t){var n=new Zt(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(n),n},e.prototype.stopAndFlushApiEvent=function(e,t,n,r){t.wasSuccessful=n,r&&(t.apiErrorCode=r),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,n,r){var i=new hn(e,r);return i.url=n,i.httpMethod=t,this.startEvent(i),i},e.prototype.incrementEventCount=function(e){var t,n=e.eventName,r=this.eventCountByCorrelationId[e.telemetryCorrelationId];r?r[n]=r[n]?r[n]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[n]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce((function(n,r){if(-1!==r.indexOf(e)){var i=t.inProgressEvents[r];return delete t.inProgressEvents[r],U(n,[i])}return n}),[])},e}(),pn=function(){function e(){}return e.filterTokenCacheItemsByScope=function(e,t){return e.filter((function(e){var n=e.key.scopes.split(" "),r=Ve.removeDefaultScopes(t);return 0===r.length?Ve.containsScope(n,t):Ve.containsScope(n,r)}))},e.filterTokenCacheItemsByAuthority=function(e,t){return e.filter((function(e){return Ge.CanonicalizeUri(e.key.authority)===t}))},e.filterTokenCacheItemsByDomain=function(e,t){return e.filter((function(e){return Ge.GetUrlComponents(e.key.authority).HostNameAndPort===t}))},e}(),fn=function(){function e(e){var t,n,r,i,o,s,a,c;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(n=(t=e).auth,r=t.cache,i=void 0===r?{}:r,o=t.system,s=void 0===o?{}:o,a=t.framework,c=void 0===a?{}:a,{auth:M(M({},mt),n),cache:M(M({},yt),i),system:M(M({},gt),s),framework:M(M({},vt),c)}),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),Xe.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),pt.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new ut(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals||(window.activeRenewals={}),window.renewStates||(window.renewStates=[]),window.callbackMappedToRenewStates||(window.callbackMappedToRenewStates={}),window.promiseMappedToRenewStates||(window.promiseMappedToRenewStates={}),window.msal=this;var u=window.location.hash,l=Ge.urlContainsHash(u);(ht.checkIfBackButtonIsPressed(this.cacheStorage),l&&this.cacheStorage.isInteractionInProgress(!0))&&(this.getResponseState(u).method===F.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(u))}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=pt.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!1,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw We.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(F.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(F.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),Ge.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,n){if(this.logger.verbose("AuthResponseHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===F.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==F.interactionTypePopup)throw Te.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),n(t)}},e.prototype.authErrorHandler=function(e,t,n,r){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===F.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,n.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,n)}else{if(e!==F.interactionTypePopup)throw Te.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),r(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=ct.validateRequest(e,!0,this.clientId,F.interactionTypeRedirect);this.acquireTokenInteractive(F.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=ct.validateRequest(e,!1,this.clientId,F.interactionTypeRedirect);this.acquireTokenInteractive(F.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var n=ct.validateRequest(e,!0,this.clientId,F.interactionTypePopup),r=this.telemetryManager.createAndStartApiEvent(n.correlationId,At.LoginPopup);return new Promise((function(e,r){t.acquireTokenInteractive(F.interactionTypePopup,!0,n,e,r)})).then((function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!1,e.errorCode),e}))},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var n=ct.validateRequest(e,!1,this.clientId,F.interactionTypePopup),r=this.telemetryManager.createAndStartApiEvent(n.correlationId,At.AcquireTokenPopup);return new Promise((function(e,r){t.acquireTokenInteractive(F.interactionTypePopup,!1,n,e,r)})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!1,e.errorCode),e}))},e.prototype.acquireTokenInteractive=function(e,t,n,r,i){var o,s=this;this.logger.verbose("AcquireTokenInteractive has been called"),ht.blockReloadInHiddenIframes();try{this.cacheStorage.setInteractionInProgress(!0)}catch(r){var a=t?Te.createLoginInProgressError():Te.createAcquireTokenInProgressError(),c=Tt(this.getAccountState(n.state));return this.cacheStorage.resetTempCacheItems(n.state),void this.authErrorHandler(e,a,c,i)}if(e===F.interactionTypeRedirect&&this.cacheStorage.setItem(H.REDIRECT_REQUEST,""+F.inProgress+F.resourceDelimiter+n.state),n&&n.account&&!t?(o=n.account,this.logger.verbose("Account set from request")):(o=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),o||Ze.isSSOParam(n))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(o,e,t,n,r,i);else{if(!t){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");c=Tt(this.getAccountState(n.state));return this.cacheStorage.resetTempCacheItems(n.state),void this.authErrorHandler(e,Te.createUserLoginRequiredError(),c,i)}if(this.extractADALIdToken()&&!n.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var u=this.buildIDTokenRequest(n);this.silentLogin=!0,this.acquireTokenSilent(u).then((function(t){s.silentLogin=!1,s.logger.info("Unified cache call is successful"),s.authResponseHandler(e,t,r)}),(function(o){s.silentLogin=!1,s.logger.error("Error occurred during unified cache ATS: "+o),s.acquireTokenHelper(null,e,t,n,r,i)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,n,r,i)}},e.prototype.acquireTokenHelper=function(e,t,n,r,i,o){return q(this,void 0,void 0,(function(){var s,a,c,u,l,h,d,p,f,m;return z(this,(function(y){switch(y.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+n),s=r.scopes?r.scopes.join(" ").toLowerCase():F.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+s),c=r&&r.authority?pt.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance,y.label=1;case 1:return y.trys.push([1,11,,12]),c.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,pt.saveMetadataFromNetwork(c,this.telemetryManager,r.correlationId)]);case 2:return y.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),y.label=4;case 4:if(l=n?W:this.getTokenType(e,r.scopes),h=r.redirectStartPage||window.location.href,a=new Ze(c,this.clientId,l,this.getRedirectUri(r&&r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(a,e,n,h),this.logger.verbose("Updating cache entries"),a.populateQueryParams(e,r),this.logger.verbose("Query parameters populated from account"),d=Ge.createNavigateUrl(a)+F.response_mode_fragment,t===F.interactionTypeRedirect)n?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(ut.generateTemporaryCacheKey(H.STATE_ACQ_TOKEN,r.state),a.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+a.state));else{if(t!==F.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),Te.createInvalidInteractionTypeError();window.renewStates.push(a.state),window.requestType=n?F.login:F.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+a.state),this.registerCallback(a.state,s,i,o)}if(t!==F.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{u=this.openPopup(d,"msal",F.popUpWidth,F.popUpHeight),ht.trackPopup(u)}catch(e){if(this.logger.info(ae.code+":"+ae.desc),this.cacheStorage.setItem(K.ERROR,ae.code),this.cacheStorage.setItem(K.ERROR_DESC,ae.desc),o)return o(Te.createPopupWindowError()),[2]}if(!u)return[3,8];y.label=5;case 5:return y.trys.push([5,7,,8]),[4,ht.monitorPopupForHash(u,this.config.system.loadFrameTimeout,d,this.logger)];case 6:return p=y.sent(),this.handleAuthenticationResponse(p),this.cacheStorage.setInteractionInProgress(!1),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",p),ht.closePopups(),[3,8];case 7:return f=y.sent(),o&&o(f),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",f.errorCode+F.resourceDelimiter+f.errorMessage):(this.cacheStorage.setInteractionInProgress(!1),u.close()),[3,8];case 8:return[3,10];case 9:r.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==r.onRedirectNavigate(d)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(d)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(d)),y.label=10;case 10:return[3,12];case 11:return m=y.sent(),this.logger.error(m),this.cacheStorage.resetTempCacheItems(r.state),this.authErrorHandler(t,Te.createEndpointResolutionError(m.toString),Tt(r.state),o),u&&u.close(),[3,12];case 12:return[2]}}))}))},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw We.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw We.createSsoSilentError();return this.acquireTokenSilent(M(M({},e),{scopes:F.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var n=ct.validateRequest(e,!1,this.clientId,F.interactionTypeSilent),r=this.telemetryManager.createAndStartApiEvent(n.correlationId,At.AcquireTokenSilent),i=ct.createRequestSignature(n);return new Promise((function(e,r){return q(t,void 0,void 0,(function(){var t,o,s,a,c,u,l,h,d,p,f;return z(this,(function(m){switch(m.label){case 0:if(ht.blockReloadInHiddenIframes(),t=n.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),n.account?(o=n.account,this.logger.verbose("Account set from request")):(o=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),s=this.cacheStorage.getItem(F.adalIdToken),!o&&!n.sid&&!n.loginHint&&oe.isEmpty(s))return this.logger.info("User login is required"),[2,r(Te.createUserLoginRequiredError())];if(a=this.getTokenType(o,n.scopes),this.logger.verbose("Response type: "+a),c=new Ze(pt.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata),this.clientId,a,this.getRedirectUri(n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),Ze.isSSOParam(n)||o?(c.populateQueryParams(o,n,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):o||oe.isEmpty(s)?this.logger.verbose("No additional query parameters added"):(u=it.extractIdToken(s),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),c.populateQueryParams(o,null,u,!0)),!(l=n.claimsRequest||c.claimsValue)&&!n.forceRefresh)try{d=this.getCachedToken(c,o)}catch(e){h=e}return d?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(d.scopes)),e(d),[2,null]):[3,1];case 1:return h?(this.logger.infoPii(h.errorCode+":"+h.errorMessage),r(h),[2,null]):[3,2];case 2:p=void 0,p=l?"Skipped cache lookup since claims were given":n.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(p),c.authorityInstance||(c.authorityInstance=n.authority?pt.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+c.authority),m.label=3;case 3:return m.trys.push([3,7,,8]),c.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,pt.saveMetadataFromNetwork(c.authorityInstance,this.telemetryManager,n.correlationId)]);case 4:return m.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),m.label=6;case 6:return window.activeRenewals[i]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[i],i,e,r)):n.scopes&&Ve.onlyContainsOidcScopes(n.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(i,e,r,o,c)):(this.logger.verbose("Renewing access token"),this.renewToken(i,e,r,o,c)),[3,8];case 7:return f=m.sent(),this.logger.error(f),r(Te.createEndpointResolutionError(f.toString())),[2,null];case 8:return[2]}}))}))})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!1,e.errorCode),e}))},e.prototype.openPopup=function(e,t,n,r){this.logger.verbose("OpenPopup has been called");try{var i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=s/2-n/2+i,u=a/2-r/2+o,l=window.open(e,t,"width="+n+", height="+r+", top="+u+", left="+c+", scrollbars=yes");if(!l)throw Te.createPopupWindowError();return l.focus&&l.focus(),l}catch(e){throw this.cacheStorage.setInteractionInProgress(!1),Te.createPopupWindowError(e.toString())}},e.prototype.loadIframeTimeout=function(e,t,n){return q(this,void 0,void 0,(function(){var r,i,o,s,a;return z(this,(function(c){switch(c.label){case 0:return r=window.activeRenewals[n],this.logger.verbosePii("Set loading state to pending for: "+n+":"+r),this.cacheStorage.setItem(ut.generateTemporaryCacheKey(H.RENEW_STATUS,r),F.inProgress),this.config.system.navigateFrameWait?[4,ht.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return o=c.sent(),[3,3];case 2:o=ht.loadFrameSync(e,t,this.logger),c.label=3;case 3:i=o,c.label=4;case 4:return c.trys.push([4,6,,7]),[4,ht.monitorIframeForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(s=c.sent())&&this.handleAuthenticationResponse(s),[3,7];case 6:throw a=c.sent(),this.cacheStorage.getItem(ut.generateTemporaryCacheKey(H.RENEW_STATUS,r))===F.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+n+":"+r),r&&window.callbackMappedToRenewStates[r]&&window.callbackMappedToRenewStates[r](null,a),this.cacheStorage.removeItem(ut.generateTemporaryCacheKey(H.RENEW_STATUS,r))),ht.removeHiddenIframe(i),a;case 7:return ht.removeHiddenIframe(i),[2]}}))}))},e.prototype.navigateWindow=function(e,t){if(!e||oe.isEmpty(e))throw this.logger.info("Navigate url is empty"),ie.createUnexpectedError("Navigate url is empty");var n=t||window,r=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(r),n.location.assign(e)},e.prototype.registerCallback=function(e,t,n,r){var i=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:n,reject:r}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(n,r){delete window.activeRenewals[t];for(var o=0;o<window.promiseMappedToRenewStates[e].length;++o)try{if(r)window.promiseMappedToRenewStates[e][o].reject(r);else{if(!n)throw i.cacheStorage.resetTempCacheItems(e),ie.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][o].resolve(n)}}catch(e){i.logger.warning(e)}delete window.promiseMappedToRenewStates[e],delete window.callbackMappedToRenewStates[e]})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return q(this,void 0,void 0,(function(){var t,n,r,i,o,s;return z(this,(function(a){switch(a.label){case 0:t=e||D.createNewGuid(),n=this.telemetryManager.createAndStartApiEvent(t,At.Logout),this.clearCache(),this.account=null,a.label=1;case 1:return a.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,pt.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return a.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),a.label=4;case 4:return r="client-request-id="+t,i=void 0,this.getPostLogoutRedirectUri()?(i="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(i="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),o=void 0,this.authorityInstance.EndSessionEndpoint?(o=this.authorityInstance.EndSessionEndpoint+"?"+r+i,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(o=this.authority+"oauth2/v2.0/logout?"+r+i,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,n,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(o),[3,6];case 5:return s=a.sent(),this.telemetryManager.stopAndFlushApiEvent(t,n,!1,s.errorCode),[3,6];case 6:return[2]}}))}))},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(F.clientId,F.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(F.clientId,F.homeAccountIdentifier),n=0;n<t.length;n++){var r=t[n];r.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(r.key)),this.logger.verbosePii("Access token removed: "+r.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),Ge.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,n){this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");var r,i,o=t;o||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),o=this.getResponseState(e));try{r=this.saveTokenFromHash(e,o)}catch(e){i=e}try{this.cacheStorage.clearMsalCookie(o.state);var s=this.getAccountState(o.state);if(r){if(o.requestType===F.renewToken||r.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+B.ACCESS_TOKEN),r.tokenType=B.ACCESS_TOKEN):o.requestType===F.login&&(this.logger.verbose("Response tokenType set to "+B.ID_TOKEN),r.tokenType=B.ID_TOKEN),!n)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=r)}else if(!n)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=Tt(s),this.redirectError=i,void this.cacheStorage.resetTempCacheItems(o.state);this.logger.verbose("Calling callback provided to processCallback"),n(r,i)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),Te.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,n=this.getResponseState(t);this.logger.verbose("Obtained state from response");var r=window.callbackMappedToRenewStates[n.state];this.processCallBack(t,n,r)},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),ht.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var n=this.cacheStorage.getItem(ut.generateTemporaryCacheKey(H.LOGIN_REQUEST,t.state),this.inCookie);if(!n||"null"===n)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var r=Ge.removeHashFromUrl(window.location.href),i=Ge.removeHashFromUrl(n);if(r!==i)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+r+", finalRedirectUrl: "+i),void window.location.assign(""+i+e);this.logger.verbose("Current url matches login request url");var o=Ge.GetUrlComponents(n);o.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=o.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,n=Ge.deserializeHash(e);if(!n)throw ie.createUnexpectedError("Hash was not parsed correctly.");if(!n.hasOwnProperty(B.STATE))throw ie.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var r=ct.parseLibraryState(n.state);if((t={requestType:F.unknown,state:n.state,timestamp:r.ts,method:r.method,stateMatch:!1}).state===this.cacheStorage.getItem(ut.generateTemporaryCacheKey(H.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=F.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(ut.generateTemporaryCacheKey(H.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=F.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var i=window.renewStates,o=0;o<i.length;o++)if(i[o]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var n=e.scopes,r=this.getCachedIdToken(e,t),i=this.getCachedAccessToken(e,t,n),o=this.getAccountState(e.state);return dt.buildAuthResponse(r,i,e,t,n,o)},e.prototype.getTokenCacheItemByAuthority=function(e,t,n,r){var i,o=this;return 1===(i=Ge.isCommonAuthority(e)||Ge.isOrganizationsAuthority(e)||Ge.isConsumersAuthority(e)?pn.filterTokenCacheItemsByDomain(t,Ge.GetUrlComponents(e).HostNameAndPort):pn.filterTokenCacheItemsByAuthority(t,e)).length?i[0]:i.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),i.forEach((function(e){o.cacheStorage.removeItem(JSON.stringify(e.key))})),null):(this.logger.verbose("No matching tokens of type "+r+" found"),null)},e.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var n=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),r=e.authority||this.authority,i=this.getTokenCacheItemByAuthority(r,n,null,B.ID_TOKEN);if(i){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(i)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var o=i.value;return o?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),o?new ot(o.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(i.key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getCachedAccessToken=function(e,t,n){this.logger.verbose("Getting all cached tokens of type Access Token");var r=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),i=pn.filterTokenCacheItemsByScope(r,n),o=e.authority||this.authority,s=this.getTokenCacheItemByAuthority(o,i,n,B.ACCESS_TOKEN);if(s){if(e.authorityInstance=pt.CreateInstance(s.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(s)){this.logger.verbose("Access token expiration is within offset, using access token found in cache");var a=t||this.getAccount();if(!a)throw ie.createUnexpectedError("Account should not be null here.");var c=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:B.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:s.value.accessToken,scopes:s.key.scopes.split(" "),expiresOn:new Date(1e3*Number(s.value.expiresIn)),account:a,accountState:c,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(s.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},e.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return it.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(F.adalIdToken);return oe.isEmpty(e)?null:it.extractIdToken(e)},e.prototype.renewToken=function(e,t,n,r,i){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var o=ht.generateFrameName(te,e);ht.addHiddenIFrame(o,this.logger),this.updateCacheEntries(i,r,!1),this.logger.verbosePii("RenewToken expected state: "+i.state);var s=Ge.urlRemoveQueryStringParameter(Ge.createNavigateUrl(i),F.prompt)+F.prompt_none+F.response_mode_fragment;window.renewStates.push(i.state),window.requestType=F.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(i.state,e,t,n),this.logger.infoPii("Navigate to: "+s),this.loadIframeTimeout(s,o,e).catch((function(e){return n(e)}))},e.prototype.renewIdToken=function(e,t,n,r,i){this.logger.info("RenewIdToken has been called");var o=ht.generateFrameName(ee,e);ht.addHiddenIFrame(o,this.logger),this.updateCacheEntries(i,r,!1),this.logger.verbose("RenewIdToken expected state: "+i.state);var s=Ge.urlRemoveQueryStringParameter(Ge.createNavigateUrl(i),F.prompt)+F.prompt_none+F.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=F.login,this.silentAuthenticationState=i.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=F.renewToken,window.renewStates.push(i.state)),this.registerCallback(i.state,e,t,n),this.logger.infoPii('Navigate to:" '+s),this.loadIframeTimeout(s,o,e).catch((function(e){return n(e)}))},e.prototype.saveToken=function(e,t,n,r,i){var o=new Ye(t,this.clientId,n,r.uid,r.utid),s=new Je(e.accessToken,e.idToken.rawIdToken,i.toString(),r.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(o),JSON.stringify(s)),i?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*i)):this.logger.error("Could not parse expiresIn parameter for access token"),e},e.prototype.saveIdToken=function(e,t,n,r,i){this.logger.verbose("SaveIdToken has been called");var o=M({},e);o.scopes=F.oidcScopes,o.accessToken=n[B.ID_TOKEN];var s=Number(i.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(o,t,void 0,r,s)},e.prototype.saveAccessToken=function(e,t,n,r){this.logger.verbose("SaveAccessToken has been called");var i=M({},e),o=n[B.SCOPE],s=o.split(" "),a=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var c=0;c<a.length;c++){var u=a[c];if(u.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var l=u.key.scopes.split(" ");Ve.isIntersectingScopes(l,s)&&this.cacheStorage.removeItem(JSON.stringify(u.key))}}i.accessToken=n[B.ACCESS_TOKEN],i.scopes=s;var h=rt.parseExpiresIn(n[B.EXPIRES_IN]),d=ct.parseLibraryState(n[B.STATE]).ts+h;return this.logger.verbose("Saving access token to cache"),this.saveToken(i,t,o,r,d)},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var n,r={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},i=Ge.deserializeHash(e),o="",s="",a=null;if(i.hasOwnProperty(B.ERROR_DESCRIPTION)||i.hasOwnProperty(B.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+i[B.ERROR]+"; Error description: "+i[B.ERROR_DESCRIPTION]),this.cacheStorage.setItem(K.ERROR,i[B.ERROR]),this.cacheStorage.setItem(K.ERROR_DESC,i[B.ERROR_DESCRIPTION]),t.requestType===F.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(K.LOGIN_ERROR,i[B.ERROR_DESCRIPTION]+":"+i[B.ERROR]),o=ut.generateAuthorityKey(t.state)),t.requestType===F.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),o=ut.generateAuthorityKey(t.state);var c=this.getAccount(),u=void 0;c&&!oe.isEmpty(c.homeAccountIdentifier)?(u=c.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(u=F.no_account,this.logger.verbose("AccountId is set as no_account")),s=ut.generateAcquireTokenAccountKey(u,t.state)}var l=i[B.ERROR],h=i[B.ERROR_DESCRIPTION];n=Ot.isInteractionRequiredError(l)||Ot.isInteractionRequiredError(h)?new Ot(i[B.ERROR],i[B.ERROR_DESCRIPTION]):new wt(i[B.ERROR],i[B.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),i.hasOwnProperty(B.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(ut.generateTemporaryCacheKey(H.SESSION_STATE,t.state),i[B.SESSION_STATE])),r.accountState=this.getAccountState(t.state);var d=void 0;if(i.hasOwnProperty(B.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),r.accessToken=i[B.ACCESS_TOKEN],i.hasOwnProperty(B.SCOPE)&&(r.scopes=i[B.SCOPE].split(" ")),i.hasOwnProperty(B.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),a=new ot(i[B.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),a=new ot(this.cacheStorage.getItem($.IDTOKEN))),r=dt.setResponseIdToken(r,a);var p=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,a);this.logger.verbose("Got authority from cache"),i.hasOwnProperty(B.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),d=new nt(i[B.CLIENT_INFO],p)):this.authorityInstance.AuthorityType===J.Adfs?d=nt.createClientInfoFromIdToken(a,p):this.logger.warning("ClientInfo not received in the response from AAD"),r.account=lt.createAccount(a,d),this.logger.verbose("Account object created from response");var f=void 0;r.account&&!oe.isEmpty(r.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),f=r.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),f=F.no_account),s=ut.generateAcquireTokenAccountKey(f,t.state);var m=ut.generateAcquireTokenAccountKey(F.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var y=this.cacheStorage.getItem(s),g=void 0;oe.isEmpty(y)?oe.isEmpty(this.cacheStorage.getItem(m))||(this.logger.verbose("No acquireToken account retrieved from cache"),r=this.saveAccessToken(r,p,i,d)):(g=JSON.parse(y),this.logger.verbose("AcquireToken request account retrieved from cache"),r.account&&g&&lt.compareAccounts(r.account,g)?(r=this.saveAccessToken(r,p,i,d),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(i.hasOwnProperty(B.ID_TOKEN)){this.logger.info("Fragment has idToken"),a=new ot(i[B.ID_TOKEN]);p=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,a);if(r=dt.setResponseIdToken(r,a),i.hasOwnProperty(B.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),d=new nt(i[B.CLIENT_INFO],p)):this.authorityInstance.AuthorityType===J.Adfs?d=nt.createClientInfoFromIdToken(a,p):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=lt.createAccount(a,d),r.account=this.account,this.logger.verbose("Account object created from response"),a&&a.nonce){this.logger.verbose("IdToken has nonce");var v=this.cacheStorage.getItem(ut.generateTemporaryCacheKey(H.NONCE_IDTOKEN,t.state),this.inCookie);a.nonce!==v?(this.account=null,this.cacheStorage.setItem(K.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+v+",Actual Nonce: "+a.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+v+", Actual Nonce: "+a.nonce),n=Te.createNonceMismatchError(v,a.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem($.IDTOKEN,i[B.ID_TOKEN],this.inCookie),this.cacheStorage.setItem($.CLIENT_INFO,d.encodeClientInfo(),this.inCookie),this.saveIdToken(r,p,i,d,a))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),o=t.state,s=t.state,this.logger.error("Invalid id_token received in the response"),n=Te.createInvalidIdTokenError(a),this.cacheStorage.setItem(K.ERROR,n.errorCode),this.cacheStorage.setItem(K.ERROR_DESC,n.errorMessage)}}else{this.logger.verbose("State mismatch"),o=t.state,s=t.state;var _=this.cacheStorage.getItem(ut.generateTemporaryCacheKey(H.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+_+", Actual State: "+t.state),n=Te.createInvalidStateError(t.state,_),this.cacheStorage.setItem(K.ERROR,n.errorCode),this.cacheStorage.setItem(K.ERROR_DESC,n.errorMessage)}if(this.cacheStorage.removeItem(ut.generateTemporaryCacheKey(H.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(o,"",-1),this.cacheStorage.clearMsalCookie(t.state)),n)throw n;if(!r)throw ie.createUnexpectedError("Response is null");return r},e.prototype.populateAuthority=function(e,t,n,r){this.logger.verbose("PopulateAuthority has been called");var i=ut.generateAuthorityKey(e),o=n.getItem(i,t);return oe.isEmpty(o)?o:Ge.replaceTenantPath(o,r.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem($.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem($.CLIENT_INFO,this.inCookie);if(!oe.isEmpty(e)&&!oe.isEmpty(t)){var n=new ot(e),r=new nt(t,"");return this.account=lt.createAccount(n,r),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(F.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(F.clientId,F.homeAccountIdentifier),n=0;n<t.length;n++){var r=new ot(t[n].value.idToken),i=new nt(t[n].value.homeAccountIdentifier,""),o=lt.createAccount(r,i);e.push(o)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],n=[],r=0;r<e.length;++r)e[r].homeAccountIdentifier&&-1===t.indexOf(e[r].homeAccountIdentifier)&&(t.push(e[r].homeAccountIdentifier),n.push(e[r]));return n},e.prototype.broadcast=function(e,t){var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},e.prototype.getCachedTokenInternal=function(e,t,n,r){var i=t||this.getAccount();if(!i)return null;var o=this.authorityInstance?this.authorityInstance:pt.CreateInstance(this.authority,this.config.auth.validateAuthority),s=this.getTokenType(i,e),a=new Ze(o,this.clientId,s,this.getRedirectUri(),e,n,r);return this.getCachedToken(a,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var n=0,r=Array.from(this.config.framework.protectedResourceMap.keys());n<r.length;n++){var i=r[n];if(e.indexOf(i)>-1)return this.config.framework.protectedResourceMap.get(i)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?Ge.getHostFromUri(e)===Ge.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},e.prototype.setInteractionInProgress=function(e){this.cacheStorage.setInteractionInProgress(e)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw We.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var n=lt.compareAccounts(e,this.getAccount());return Ze.determineResponseType(n,t)},e.prototype.setAccountCache=function(e,t){var n=e?this.getAccountId(e):F.no_account,r=ut.generateAcquireTokenAccountKey(n,t);this.cacheStorage.setItem(r,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var n=ut.generateAuthorityKey(e);this.cacheStorage.setItem(n,Ge.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,n,r){r&&this.cacheStorage.setItem(ut.generateTemporaryCacheKey(H.LOGIN_REQUEST,e.state),r,this.inCookie),n?this.cacheStorage.setItem(ut.generateTemporaryCacheKey(H.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(ut.generateTemporaryCacheKey(H.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return oe.isEmpty(e.homeAccountIdentifier)?F.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:F.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return dn.getTelemetrymanagerStub(t,this.logger);var n=e.applicationName,r=e.applicationVersion,i=e.telemetryEmitter;if(!n||!r||!i)throw We.createTelemetryConfigError(e);return new dn({platform:{applicationName:n,applicationVersion:r},clientId:t},i,this.logger)},e}(),mn=n(26);const yn=Object(a.a)("InteractiveBrowserCredential");class gn{constructor(e){if(e=Object.assign(Object.assign({authorityHost:mn.b},e),{tenantId:e&&e.tenantId||mn.c,clientId:e&&e.clientId||mn.d}),this.loginStyle=e.loginStyle||"popup",-1===["redirect","popup"].indexOf(this.loginStyle)){const t=new Error("Invalid loginStyle: "+e.loginStyle);throw yn.info(Object(a.b)("",t)),t}const t="adfs"===e.tenantId&&e.authorityHost?[e.authorityHost]:[];this.msalConfig={auth:Object.assign(Object.assign({clientId:e.clientId,authority:`${e.authorityHost}/${e.tenantId}`,knownAuthorities:t},e.redirectUri&&{redirectUri:e.redirectUri}),e.postLogoutRedirectUri&&{redirectUri:e.postLogoutRedirectUri}),cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}},this.msalObject=new fn(this.msalConfig)}login(){switch(this.loginStyle){case"redirect":{const e=new Promise((e,t)=>{this.msalObject.handleRedirectCallback(e,t)});return this.msalObject.loginRedirect(),e}case"popup":return this.msalObject.loginPopup()}}acquireToken(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t,n;try{yn.info("Attempting to acquire token silently"),t=yield this.msalObject.acquireTokenSilent(e)}catch(t){if(t instanceof ie)switch(t.errorCode){case"consent_required":case"interaction_required":case"login_required":yn.info("Authentication returned errorCode "+t.errorCode);break;default:throw yn.info(Object(a.b)(e.scopes,"Failed to acquire token: "+t.message)),t}}if(void 0===t){switch(yn.info("Silent authentication failed, falling back to interactive method "+this.loginStyle),this.loginStyle){case"redirect":n=new Promise((e,t)=>{this.msalObject.handleRedirectCallback(e,t)}),this.msalObject.acquireTokenRedirect(e);break;case"popup":n=this.msalObject.acquireTokenPopup(e)}t=n&&(yield n)}return t}))}getToken(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{span:n}=Object(o.a)("InteractiveBrowserCredential-getToken",t);try{this.msalObject.getAccount()||(yield this.login());const t=yield this.acquireToken({scopes:Array.isArray(e)?e:e.split(",")});if(t){const n=t.expiresOn.getTime();return yn.getToken.info(Object(a.c)(e)),{token:t.accessToken,expiresOnTimestamp:n}}return yn.getToken.info("No response"),null}catch(t){throw n.setStatus({code:s.b.ERROR,message:t.message}),yn.getToken.info(Object(a.b)(e,t)),t}finally{n.end()}}))}}const vn=new Error("DeviceCodeCredential is not supported in the browser."),_n=Object(a.a)("DeviceCodeCredential");class bn{constructor(){throw _n.info(Object(a.b)("",vn)),vn}getToken(){throw _n.getToken.info(Object(a.b)("",vn)),vn}}const wn=Object(a.a)("UsernamePasswordCredential");class En{constructor(e,t,n,r,i){!function(e,t){if(!t.match(/^[0-9a-zA-Z-.:/]+$/)){const t=new Error("Invalid tenant id provided. You can locate your tenant id by following the instructions listed here: https://docs.microsoft.com/partner-center/find-ids-and-domain-names.");throw e.info(Object(a.b)("",t)),t}}(wn,e),this.identityClient=new C.a(i),this.tenantId=e,this.clientId=t,this.username=n,this.password=r}getToken(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{span:n,updatedOptions:r}=Object(o.a)("UsernamePasswordCredential-getToken",t);try{const i=Object(I.a)(this.tenantId),o=Object(O.a)({url:`${this.identityClient.authorityHost}/${this.tenantId}/${i}`,method:"POST",body:k.a.stringify({response_type:"token",grant_type:"password",client_id:this.clientId,username:this.username,password:this.password,scope:"string"==typeof e?e:e.join(" ")}),headers:Object(T.a)({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),abortSignal:t&&t.abortSignal,tracingOptions:{spanOptions:r.tracingOptions&&r.tracingOptions.spanOptions,tracingContext:r.tracingOptions&&r.tracingOptions.tracingContext}}),s=yield this.identityClient.sendTokenRequest(o);return wn.getToken.info(Object(a.c)(e)),s&&s.accessToken||null}catch(t){throw n.setStatus({code:s.b.ERROR,message:t.message}),wn.getToken.info(Object(a.b)(e,t)),t}finally{n.end()}}))}}const Sn=new Error("AuthorizationCodeCredential is not supported in the browser.  InteractiveBrowserCredential is more appropriate for this use case."),kn=Object(a.a)("AuthorizationCodeCredential");class On{constructor(){throw kn.info(Object(a.b)("",Sn)),Sn}getToken(){throw kn.getToken.info(Object(a.b)("",Sn)),Sn}}function Tn(){return new E}},function(e,t,n){"use strict";n.r(t),n.d(t,"EventHubConsumerClient",(function(){return Et})),n.d(t,"EventHubProducerClient",(function(){return Ct})),n.d(t,"EventHubBufferedProducerClient",(function(){return jt})),n.d(t,"latestEventPosition",(function(){return l})),n.d(t,"earliestEventPosition",(function(){return u})),n.d(t,"CloseReason",(function(){return f})),n.d(t,"MessagingError",(function(){return a.c})),n.d(t,"RetryMode",(function(){return y.a})),n.d(t,"logger",(function(){return i.b})),n.d(t,"parseEventHubConnectionString",(function(){return ut})),n.d(t,"createEventDataAdapter",(function(){return Lt}));var r=n(51),i=n(0);class o{constructor(e,t,n){this._eventHandlers=e,this._checkpointStore=t,this._context=n}get lastEnqueuedEventProperties(){return this._lastEnqueuedEventProperties}set lastEnqueuedEventProperties(e){this._lastEnqueuedEventProperties=e}get fullyQualifiedNamespace(){return this._context.fullyQualifiedNamespace}get consumerGroup(){return this._context.consumerGroup}get eventHubName(){return this._context.eventHubName}get partitionId(){return this._context.partitionId}get eventProcessorId(){return this._context.eventProcessorId}async initialize(){this._eventHandlers.processInitialize&&await this._eventHandlers.processInitialize(this)}async close(e){this._eventHandlers.processClose&&await this._eventHandlers.processClose(e,this)}async processEvents(e){await this._eventHandlers.processEvents(e,this)}async processError(e){if(this._eventHandlers.processError)try{await this._eventHandlers.processError(e,this)}catch(e){i.b.verbose("Error thrown from user's processError handler : "+e)}}async updateCheckpoint(e){const t={fullyQualifiedNamespace:this._context.fullyQualifiedNamespace,eventHubName:this._context.eventHubName,consumerGroup:this._context.consumerGroup,partitionId:this._context.partitionId,sequenceNumber:e.sequenceNumber,offset:e.offset};await this._checkpointStore.updateCheckpoint(t)}}var s=n(5),a=n(12),c=n(1);const u={offset:-1},l={offset:"@latest"};function h(e){if(!Object(c.b)(e))return;const t=Object.keys(e);if(!t.length)throw new TypeError("Invalid value for EventPosition found. Pass an object with either of offset, sequenceNumber or enqueuedOn properties set.");if(d(e))return void p(e);const n=e;for(let e=0;e<t.length;e++)Object.prototype.hasOwnProperty.call(n,t[e])&&p(n[t[e]])}function d(e){return!!e&&(!(!Object(c.d)(e,"offset")||!Object(c.b)(e.offset))||(!(!Object(c.d)(e,"sequenceNumber")||!Object(c.b)(e.sequenceNumber))||!(!Object(c.d)(e,"enqueuedOn")||!Object(c.b)(e.enqueuedOn))))}function p(e){if(!Object(c.b)(e))return;const t=Object(c.b)(e.offset),n=Object(c.b)(e.sequenceNumber),r=Object(c.b)(e.enqueuedOn);if(t&&n||t&&r||r&&n)throw new TypeError("Invalid value for EventPosition found. Set only one of offset, sequenceNumber or enqueuedOn properties.");if(!t&&!r&&!n)throw new TypeError("Invalid value for EventPosition found. Pass an object with either of offset, sequenceNumber or enqueuedOn properties set.")}var f;!function(e){e.OwnershipLost="OwnershipLost",e.Shutdown="Shutdown"}(f||(f={}));var m=n(17),y=n(110),g=n(2),v=n(4);const _={toRheaMessageHeader(e){const t={};return null!=e.deliveryCount&&(t.delivery_count=e.deliveryCount),null!=e.durable&&(t.durable=e.durable),null!=e.firstAcquirer&&(t.first_acquirer=e.firstAcquirer),null!=e.priority&&(t.priority=e.priority),null!=e.timeToLive&&(t.ttl=e.timeToLive),v.b.verbose("To RheaMessageHeader: %O",t),t},fromRheaMessageHeader(e){const t={};return null!=e.delivery_count&&(t.deliveryCount=e.delivery_count),null!=e.durable&&(t.durable=e.durable),null!=e.first_acquirer&&(t.firstAcquirer=e.first_acquirer),null!=e.priority&&(t.priority=e.priority),null!=e.ttl&&(t.timeToLive=e.ttl),v.b.verbose("From RheaMessageHeader: %O",t),t}},b={toRheaMessageProperties(e){const t={};return null!=e.absoluteExpiryTime&&(t.absolute_expiry_time=new Date(e.absoluteExpiryTime)),null!=e.contentEncoding&&(t.content_encoding=e.contentEncoding),null!=e.contentType&&(t.content_type=e.contentType),null!=e.correlationId&&(t.correlation_id=e.correlationId),null!=e.creationTime&&(t.creation_time=new Date(e.creationTime)),null!=e.groupId&&(t.group_id=e.groupId),null!=e.groupSequence&&(t.group_sequence=e.groupSequence),null!=e.messageId&&(t.message_id=e.messageId),null!=e.replyTo&&(t.reply_to=e.replyTo),null!=e.replyToGroupId&&(t.reply_to_group_id=e.replyToGroupId),null!=e.subject&&(t.subject=e.subject),null!=e.to&&(t.to=e.to),v.b.verbose("To RheaMessageProperties: %O",t),t},fromRheaMessageProperties(e){const t={};return null!=e.absolute_expiry_time&&(t.absoluteExpiryTime=e.absolute_expiry_time.getTime()),null!=e.content_encoding&&(t.contentEncoding=e.content_encoding),null!=e.content_type&&(t.contentType=e.content_type),null!=e.correlation_id&&(t.correlationId=e.correlation_id),null!=e.creation_time&&(t.creationTime=e.creation_time.getTime()),null!=e.group_id&&(t.groupId=e.group_id),null!=e.group_sequence&&(t.groupSequence=e.group_sequence),null!=e.message_id&&(t.messageId=e.message_id),null!=e.reply_to&&(t.replyTo=e.reply_to),null!=e.reply_to_group_id&&(t.replyToGroupId=e.reply_to_group_id),null!=e.subject&&(t.subject=e.subject),null!=e.to&&(t.to=e.to),v.b.verbose("From RheaMessageProperties: %O",t),t}},w={fromRheaMessage:e=>({header:_.fromRheaMessageHeader(e),footer:e.footer,messageAnnotations:e.message_annotations,deliveryAnnotations:e.delivery_annotations,applicationProperties:e.application_properties,properties:b.fromRheaMessageProperties(e),body:e.body}),toRheaMessage:e=>Object.assign(Object.assign(Object.assign({},b.toRheaMessageProperties(e.properties||{})),_.toRheaMessageHeader(e.header||{})),{body:e.body,message_annotations:e.messageAnnotations,delivery_annotations:e.deliveryAnnotations,application_properties:e.applicationProperties,footer:e.footer})};var E=n(8),S=n(75),k=n.n(S);const O={encode(e,t){let n;if(void 0===e&&(e=null),"value"===t)n=g.message.data_section(e),n.typecode=119;else if("sequence"===t)n=g.message.sequence_section(e);else if(k()(e)||e instanceof Uint8Array)n=g.message.data_section(e);else if(null===e&&"data"===t)n=g.message.data_section(null);else try{const t=JSON.stringify(e);n=g.message.data_section(E.Buffer.from(t,"utf8"))}catch(t){const n="An error occurred while executing JSON.stringify() on the given body "+e+(t?t.stack:JSON.stringify(t));throw i.b.warning("[encode] "+n),Object(i.a)(t),new Error(n)}return n},decode(e,t){try{if(null==(n=e)||"number"!=typeof n.typecode||117!==n.typecode&&119!==n.typecode&&118!==n.typecode)return k()(e)?{body:t?e:T(e),bodyType:"data"}:{body:e,bodyType:"value"};switch(e.typecode){case 117:return{body:t?e.content:T(e.content),bodyType:"data"};case 118:return{body:e.content,bodyType:"sequence"};case 119:return{body:e.content,bodyType:"value"}}}catch(e){throw i.b.verbose("[decode] An error occurred while decoding the received message body. The error is: %O",e),e}var n}};function T(e){let t=e;try{const e=t.toString("utf8");t=JSON.parse(e)}catch(e){i.b.verbose("[decode] An error occurred while trying JSON.parse() on the received body. The error is %O",e)}return t}var C=n(6),I=n(14);function A(e,t,n,r){var i,o;const s=M(e)?e.applicationProperties:e.properties;if(Boolean(null==s?void 0:s["Diagnostic-Id"]))return{event:e,spanContext:void 0};const{span:a,updatedOptions:c}=I.b.startSpan("message",t,Object(I.a)({entityPath:n,host:r},"producer"));try{if(!a.isRecording())return{event:e,spanContext:void 0};const t=I.b.createRequestHeaders(null===(i=c.tracingOptions)||void 0===i?void 0:i.tracingContext).traceparent;if(t){const n=Object.assign({},s);e=M(e)?Object.assign(Object.assign({},e),{applicationProperties:n}):Object.assign(Object.assign({},e),{properties:n}),n["Diagnostic-Id"]=t}return{event:e,spanContext:null===(o=c.tracingOptions)||void 0===o?void 0:o.tracingContext}}finally{a.end()}}function x(e){if(!e.properties||!e.properties["Diagnostic-Id"])return;const t=e.properties["Diagnostic-Id"];return I.b.parseTraceparentHeader(t)}var R=n(11);function P(e){return Object(c.c)(e,["count","sizeInBytes","tryAdd"])&&"function"==typeof e.tryAdd&&"number"==typeof e.count&&"number"==typeof e.sizeInBytes}class N{constructor(e,t,n,r,i){this._encodedMessages=[],this._spanContexts=[],this._context=e,this._maxSizeInBytes=t,this._isIdempotent=n,this._partitionKey=Object(c.b)(r)?String(r):r,this._partitionId=Object(c.b)(i)?String(i):i,this._sizeInBytes=0,this._count=0}get maxSizeInBytes(){return this._maxSizeInBytes}get partitionKey(){return this._partitionKey}get partitionId(){return this._partitionId}get sizeInBytes(){return this._sizeInBytes}get count(){return this._count}get startingPublishedSequenceNumber(){return this._startingPublishSequenceNumber}get _messageSpanContexts(){return this._spanContexts}_generateBatch(e,t,n){if(this._isIdempotent&&n){const t=e.map(g.message.decode);e=this._decorateRheaMessagesWithPublishingProps(t,n).map(g.message.encode)}const r={body:g.message.data_sections(e)};return t&&(r.message_annotations=t),g.message.encode(r)}_decorateRheaMessagesWithPublishingProps(e,t){if(!this._isIdempotent)return e;const{lastPublishedSequenceNumber:n=0,ownerLevel:r,producerGroupId:i}=t,o=n+1;for(let t=0;t<e.length;t++){z(e[t],{isIdempotentPublishingEnabled:this._isIdempotent,ownerLevel:r,producerGroupId:i,publishSequenceNumber:o+t})}return this._pendingStartingSequenceNumber=o,e}_decorateRheaMessageWithPlaceholderIdempotencyProps(e){return this._isIdempotent?(e.message_annotations||(e.message_annotations={}),z(e,{isIdempotentPublishingEnabled:this._isIdempotent,ownerLevel:0,publishSequenceNumber:0,producerGroupId:0}),e):e}_generateMessage(e){return this._generateBatch(this._encodedMessages,this._batchAnnotations,e)}_commitPublish(){this._startingPublishSequenceNumber=this._pendingStartingSequenceNumber}tryAdd(e,t={}){Object(R.d)(this._context.connectionId,"tryAdd","eventData",e);const{entityPath:n,host:r}=this._context.config,{event:i,spanContext:o}=A(e,t,n,r),s=L(i,this._partitionKey),a=s.message_annotations&&Object.assign({},s.message_annotations);this._decorateRheaMessageWithPlaceholderIdempotencyProps(s);const c=g.message.encode(s);let u=this._sizeInBytes;0===this.count&&(a&&(this._batchAnnotations=a),u+=this._generateBatch([],this._batchAnnotations).length);const l=c.length;return u+=l+(l<=255?5:8),!(u>this._maxSizeInBytes)&&(this._encodedMessages.push(c),o&&this._spanContexts.push(o),this._sizeInBytes=u,this._count++,!0)}}const j={message_id:"messageId",user_id:"userId",to:"to",subject:"subject",reply_to:"replyTo",correlation_id:"correlationId",content_type:"contentType",content_encoding:"contentEncoding",absolute_expiry_time:"absoluteExpiryTime",creation_time:"creationTime",group_id:"groupId",group_sequence:"groupSequence",reply_to_group_id:"replyToGroupId"};function L(e,t){var n,r;let i;if(M(e))i=Object.assign(Object.assign({},w.toRheaMessage(e)),{body:O.encode(e.body,null!==(n=e.bodyType)&&void 0!==n?n:"data")});else{let n="data";if("function"==typeof e.getRawAmqpMessage&&(n=null!==(r=e.getRawAmqpMessage().bodyType)&&void 0!==r?r:"data"),i={body:O.encode(e.body,n)},i.message_annotations={},e.properties&&(i.application_properties=e.properties),Object(c.b)(t)&&(i.message_annotations[s.a.partitionKey]=t,i.durable=!0),null!=e.contentType&&(i.content_type=e.contentType),null!=e.correlationId&&(i.correlation_id=e.correlationId),null!=e.messageId){if("string"==typeof e.messageId&&e.messageId.length>s.a.maxMessageIdLength)throw new Error(`Length of 'messageId' property on the event cannot be greater than ${s.a.maxMessageIdLength} characters.`);i.message_id=e.messageId}}return i}function M(e){return Object(c.c)(e,["body","bodyType"])&&!Object(c.d)(e,"getRawAmqpMessage")}function q(e){if(!Object(c.b)(e))return e;if("object"==typeof e&&Object(c.d)(e,"getTime")&&"function"==typeof e.getTime)return e.getTime();if(Array.isArray(e))return e.map(q);if("object"==typeof e&&Object(c.b)(e)){e=Object.assign({},e);for(const t of Object.keys(e))e[t]=q(e[t])}return e}function z(e,{isIdempotentPublishingEnabled:t,ownerLevel:n,producerGroupId:r,publishSequenceNumber:i}){if(!t)return;const o=e.message_annotations||{};e.message_annotations||(e.message_annotations=o),Object(c.b)(n)&&(o[C.b.epoch]=g.types.wrap_short(n)),Object(c.b)(r)&&(o[C.b.producerId]=g.types.wrap_long(r)),Object(c.b)(i)&&(o[C.b.producerSequenceNumber]=g.types.wrap_int(i))}var U=n(41),B=n(23);class D extends U.a{constructor(e,t,n,r,i={}){super(e,{partitionId:n,name:e.config.getReceiverAddress(n,t)}),this._checkpoint=-1,this._internalQueue=[],this._usingInternalQueue=!1,this._isReceivingMessages=!1,this._isStreaming=!1,this._isClosed=!1,this.consumerGroup=t,this.address=e.config.getReceiverAddress(n,this.consumerGroup),this.audience=e.config.getReceiverAudience(n,this.consumerGroup),this.ownerLevel=i.ownerLevel,this.eventPosition=r,this.options=i,this.runtimeInfo={}}get checkpoint(){return this._checkpoint}get isReceivingMessages(){return this._isReceivingMessages}get isClosed(){return this._isClosed}get lastEnqueuedEventProperties(){return this.runtimeInfo}_onAmqpMessage(e){if(!e.message)return;const t=function(e,t){const n=w.fromRheaMessage(e),{body:r,bodyType:i}=O.decode(e.body,t);n.bodyType=i;const o={body:r,getRawAmqpMessage:()=>n};if(e.message_annotations)for(const t of Object.keys(e.message_annotations))switch(t){case s.a.partitionKey:o.partitionKey=e.message_annotations[t];break;case s.a.sequenceNumber:o.sequenceNumber=e.message_annotations[t];break;case s.a.enqueuedTime:o.enqueuedTimeUtc=new Date(e.message_annotations[t]);break;case s.a.offset:o.offset=e.message_annotations[t];break;default:o.systemProperties||(o.systemProperties={}),o.systemProperties[t]=q(e.message_annotations[t])}e.application_properties&&(o.properties=q(e.application_properties)),e.delivery_annotations&&(o.lastEnqueuedOffset=e.delivery_annotations.last_enqueued_offset,o.lastSequenceNumber=e.delivery_annotations.last_enqueued_sequence_number,o.lastEnqueuedTime=new Date(e.delivery_annotations.last_enqueued_time_utc),o.retrievalTime=new Date(e.delivery_annotations.runtime_info_retrieval_time_utc));const a=Object.keys(j);for(const t of a)o.systemProperties||(o.systemProperties={}),null!=e[t]&&(o.systemProperties[j[t]]=q(e[t]));return null!=e.content_type&&(o.contentType=e.content_type),null!=e.correlation_id&&(o.correlationId=e.correlation_id),null!=e.message_id&&(o.messageId=e.message_id),o}(e.message,!!this.options.skipParsingBodyAsJson),n=t.getRawAmqpMessage(),r={body:t.body,properties:t.properties,offset:t.offset,sequenceNumber:t.sequenceNumber,enqueuedTimeUtc:t.enqueuedTimeUtc,partitionKey:t.partitionKey,systemProperties:t.systemProperties,getRawAmqpMessage:()=>n};null!=t.correlationId&&(r.correlationId=t.correlationId),null!=t.contentType&&(r.contentType=t.contentType),null!=t.messageId&&(r.messageId=t.messageId),this._checkpoint=r.sequenceNumber,this.options.trackLastEnqueuedEventProperties&&t&&(this.runtimeInfo.sequenceNumber=t.lastSequenceNumber,this.runtimeInfo.enqueuedOn=t.lastEnqueuedTime,this.runtimeInfo.offset=t.lastEnqueuedOffset,this.runtimeInfo.retrievedOn=t.retrievalTime),!this._onMessage||this._usingInternalQueue?this._internalQueue.push(r):(this._isStreaming&&this._addCredit(1),this._onMessage(r))}_onAmqpError(e){const t=this._receiver||e.receiver,n=t&&t.error;if(i.b.verbose("[%s] 'receiver_error' event occurred on the receiver '%s' with address '%s'. The associated error is: %O",this._context.connectionId,this.name,this.address,n),this._onError&&n){const e=Object(a.e)(n);Object(i.a)(e),this._onError(e)}}_onAmqpSessionError(e){const t=e.session&&e.session.error;if(i.b.verbose("[%s] 'session_error' event occurred on the session of receiver '%s' with address '%s'. The associated error is: %O",this._context.connectionId,this.name,this.address,t),this._onError&&t){const e=Object(a.e)(t);Object(i.a)(e),this._onError(e)}}async _onAmqpClose(e){const t=this._receiver||e.receiver;i.b.verbose("[%s] 'receiver_close' event occurred on the receiver '%s' with address '%s'. Value for isItselfClosed on the receiver is: '%s' Value for isConnecting on the session is: '%s'.",this._context.connectionId,this.name,this.address,t?t.isItselfClosed().toString():void 0,this.isConnecting),t&&!this.isConnecting&&await t.close().catch(e=>{i.b.verbose("[%s] Error when closing receiver [%s] after 'receiver_close' event: %O",this._context.connectionId,this.name,e)})}async _onAmqpSessionClose(e){const t=this._receiver||e.receiver;i.b.verbose("[%s] 'session_close' event occurred on the session of receiver '%s' with address '%s'. Value for isSessionItselfClosed on the session is: '%s' Value for isConnecting on the session is: '%s'.",this._context.connectionId,this.name,this.address,t?t.isSessionItselfClosed().toString():void 0,this.isConnecting),t&&!this.isConnecting&&await t.close().catch(e=>{i.b.verbose("[%s] Error when closing receiver [%s] after 'session_close' event: %O",this._context.connectionId,this.name,e)})}async abort(){const e=`[${this._context.connectionId}] The receive operation on the Receiver "${this.name}" with address "${this.address}" has been cancelled by the user.`;if(i.b.info(e),this._onError){const e=new r.b(s.b);this._onError(e)}this.clearHandlers(),await this.close()}clearHandlers(){this._abortSignal&&this._onAbort&&this._abortSignal.removeEventListener("abort",this._onAbort),this._abortSignal=void 0,this._onAbort=void 0,this._onError=void 0,this._onMessage=void 0,this._isReceivingMessages=!1,this._isStreaming=!1}async close(){try{if(this.clearHandlers(),!this._receiver)return;const e=this._receiver;this._deleteFromCache(),await this._closeLink(e)}catch(e){const t=`[${this._context.connectionId}] An error occurred while closing receiver ${this.name}: ${null==e?void 0:e.name}: ${null==e?void 0:e.message}`;throw i.b.warning(t),Object(i.a)(e),e}finally{this._isClosed=!0}}isOpen(){const e=Boolean(this._receiver&&this._receiver.isOpen());return i.b.verbose("[%s] Receiver '%s' with address '%s' is open? -> %s",this._context.connectionId,this.name,this.address,e),e}registerHandlers(e,t,n,r,o,s){this._abortSignal=o,this._onAbort=s,this._onError=t,this._onMessage=e,this._isStreaming=r,this._isReceivingMessages=!0,this._useInternalQueue(e,o).then(async s=>{if(this._onMessage!==e)return;if(!r&&n-s<=0)return;if(this.isOpen())i.b.verbose("[%s] Receiver link already present, hence reusing it.",this._context.connectionId);else try{await this.initialize({abortSignal:o,timeoutInMs:Object(B.a)(this.options.retryOptions)})}catch(e){return void(this._onError===t&&t(e))}const a=this._receiver?this._receiver.credit:0,c=r?0:s,u=Math.max(n-(a+c),0);this._addCredit(u)}).catch(e=>{this._onError===t&&t(e)})}_addCredit(e){this._receiver&&this._receiver.addCredit(e)}_deleteFromCache(){this._receiver=void 0,delete this._context.receivers[this.name],i.b.verbose("[%s] Deleted the receiver '%s' from the client cache.",this._context.connectionId,this.name)}async _useInternalQueue(e,t){let n=0;for(await Object(m.b)(0),this._usingInternalQueue=!0;this._internalQueue.length&&this._onMessage&&(!t||!t.aborted)&&this._onMessage===e;){n++,e(this._internalQueue.splice(0,1)[0]),await Object(m.b)(0)}return this._usingInternalQueue=!1,n}async initialize({abortSignal:e,timeoutInMs:t}){try{if(this.isOpen()||this.isConnecting)i.b.verbose("[%s] The receiver '%s' with address '%s' is open -> %s and is connecting -> %s. Hence not reconnecting.",this._context.connectionId,this.name,this.address,this.isOpen(),this.isConnecting);else{this.isConnecting=!0,await this._context.readyToOpenLink(),await this._negotiateClaim({setTokenRenewal:!1,abortSignal:e,timeoutInMs:t});const n={onClose:e=>this._onAmqpClose(e),onError:e=>this._onAmqpError(e),onMessage:e=>this._onAmqpMessage(e),onSessionClose:e=>this._onAmqpSessionClose(e),onSessionError:e=>this._onAmqpSessionError(e)};this.checkpoint>-1&&(n.eventPosition={sequenceNumber:this.checkpoint});const r=this._createReceiverOptions(n);i.b.verbose("[%s] Trying to create receiver '%s' with options %O",this._context.connectionId,this.name,r),this._receiver=await this._context.connection.createReceiver(Object.assign(Object.assign({},r),{abortSignal:e})),this.isConnecting=!1,i.b.verbose("[%s] Receiver '%s' created with receiver options: %O",this._context.connectionId,this.name,r),this._context.receivers[this.name]=this,this._ensureTokenRenewal()}}catch(e){this.isConnecting=!1;const t=Object(a.e)(e);throw i.b.warning("[%s] An error occured while creating the receiver '%s': %s",this._context.connectionId,this.name,`${null==t?void 0:t.name}: ${null==t?void 0:t.message}`),Object(i.a)(e),t}}_createReceiverOptions(e){const t={name:this.name,autoaccept:!0,source:{address:this.address},credit_window:0,onMessage:e.onMessage,onError:e.onError,onClose:e.onClose,onSessionError:e.onSessionError,onSessionClose:e.onSessionClose};"number"==typeof this.ownerLevel&&(t.properties={[s.a.attachEpoch]:g.types.wrap_long(this.ownerLevel)}),this.options.trackLastEnqueuedEventProperties&&(t.desired_capabilities=s.a.enableReceiverRuntimeMetricName);const n=e.eventPosition||this.eventPosition;if(n){const e=function(e){let t;if(Object(c.b)(e.offset))t=e.isInclusive?`${s.a.offsetAnnotation} >= '${e.offset}'`:`${s.a.offsetAnnotation} > '${e.offset}'`;else if(Object(c.b)(e.sequenceNumber))t=e.isInclusive?`${s.a.sequenceNumberAnnotation} >= '${e.sequenceNumber}'`:`${s.a.sequenceNumberAnnotation} > '${e.sequenceNumber}'`;else if(Object(c.b)(e.enqueuedOn)){const n=e.enqueuedOn instanceof Date?e.enqueuedOn.getTime():e.enqueuedOn;t=`${s.a.enqueuedTimeAnnotation} > '${n}'`}if(!t)throw Object(a.e)({condition:a.b.ArgumentError,description:"No starting position was set in the EventPosition."});return t}(n);e&&(t.source.filter={"apache.org:selector-filter:string":g.types.wrap_described(e,77567109365764)})}return t}async receiveBatch(e,t=60,n){const o=[],a=this.options.retryOptions||{},c=Object.defineProperties({operation:()=>new Promise((a,c)=>{if(this._isClosed||this._context.wasConnectionCloseCalled)return a(o);let u;const l=()=>{const e=this.name,t=this.address,n=`[${this._context.connectionId}] The request operation on the Receiver "${e}" with address "${t}" has been cancelled by the user.`;i.b.info(n)},h=async()=>{l();try{await this.close()}finally{c(new r.b(s.b))}};if(n&&n.aborted)return h();const d=Math.max(e-o.length,0);if(0===d)return a(o);i.b.verbose("[%s] Receiver '%s', setting the prefetch count to %d.",this._context.connectionId,this.name,d);const p=()=>{this.clearHandlers(),clearTimeout(u)},f=()=>{clearTimeout(u),h()};this.registerHandlers(n=>{o.push(n),o.length===e&&(i.b.info("[%s] Batching Receiver '%s', %d messages received within %d seconds.",this._context.connectionId,this.name,o.length,t),p(),a(o))},e=>{for(;o.length;)this._internalQueue.unshift(o.pop());p(),"AbortError"===e.name?h():c(e)},e-o.length,!1,n,f);(()=>{i.b.verbose("[%s] Setting the wait timer for %d seconds for receiver '%s'.",this._context.connectionId,t,this.name),u=setTimeout(()=>{i.b.info("[%s] Batching Receiver '%s', %d messages received when max wait time in seconds %d is over.",this._context.connectionId,this.name,o.length,t),p(),a(o)},1e3*t)})(),n&&!n.aborted&&n.addEventListener("abort",f)}),operationType:y.b.receiveMessage,abortSignal:n,retryOptions:a},{connectionId:{enumerable:!0,get:()=>this._context.connectionId},connectionHost:{enumerable:!0,get:()=>this._context.config.host}});return Object(y.c)(c)}}class F{constructor(e,t,n,i){this._context=e,this._startPosition=n,this._isReceiving=!1,this._isStopped=!1,this._partitionProcessor=t,this._processorOptions=i,this._abortController=new r.a}get isReceiving(){return this._isReceiving}async start(){this._isReceiving=!0;try{await this._partitionProcessor.initialize()}catch(e){this._partitionProcessor.processError(e)}this._receiveEvents(this._partitionProcessor.partitionId),i.b.info(`Successfully started the receiver for partition "${this._partitionProcessor.partitionId}".`)}_setOrReplaceReceiver(e,t){const n=t>=0?{sequenceNumber:t,isInclusive:!1}:this._startPosition;return this._receiver=new D(this._context,this._partitionProcessor.consumerGroup,e,n,{ownerLevel:this._processorOptions.ownerLevel,trackLastEnqueuedEventProperties:this._processorOptions.trackLastEnqueuedEventProperties,retryOptions:this._processorOptions.retryOptions,skipParsingBodyAsJson:this._processorOptions.skipParsingBodyAsJson}),this._receiver}async _receiveEvents(e){let t=-1,n=this._setOrReplaceReceiver(e,t);for(;this._isReceiving;)try{n.isClosed&&(n=this._setOrReplaceReceiver(e,t));const r=await n.receiveBatch(this._processorOptions.maxBatchSize,this._processorOptions.maxWaitTimeInSeconds,this._abortController.signal);if(this._processorOptions.trackLastEnqueuedEventProperties&&n.lastEnqueuedEventProperties&&(this._partitionProcessor.lastEnqueuedEventProperties=n.lastEnqueuedEventProperties),!this._isReceiving)return;r.length&&(t=r[r.length-1].sequenceNumber),await I.b.withSpan("PartitionPump.process",{},()=>this._partitionProcessor.processEvents(r),H(r,this._context.config))}catch(e){if(!this._isReceiving)return;i.b.warning(`An error was thrown while receiving or processing events on partition "${this._partitionProcessor.partitionId}"`),Object(i.a)(e);try{await this._partitionProcessor.processError(e)}catch(e){i.b.verbose("An error was thrown by user's processError method: ",e)}if("object"!=typeof e||!e.retryable)try{return"ReceiverDisconnectedError"===e.code?await this.stop(f.OwnershipLost):await this.stop(f.Shutdown)}catch(e){i.b.verbose(`An error occurred while closing the receiver with reason ${f.Shutdown}: `,e)}}}async stop(e){if(!this._isStopped){this._isStopped=!0,this._isReceiving=!1;try{this._abortController.abort(),this._receiver&&await this._receiver.close(),await this._partitionProcessor.close(e)}catch(e){throw i.b.warning(`An error occurred while closing the receiver: ${null==e?void 0:e.name}: ${null==e?void 0:e.message}`),Object(i.a)(e),this._partitionProcessor.processError(e),e}}}}function H(e,t){const n=[];for(const t of e){const e=x(t);e&&n.push({tracingContext:e,attributes:{enqueuedTime:t.enqueuedTimeUtc.getTime()}})}return Object.assign({spanLinks:n,spanKind:"consumer"},Object(I.a)(t))}class ${constructor(e,t){this._partitionIdToPumps={},this._eventProcessorName=e,this._options=t}receivingFromPartitions(){return Object.keys(this._partitionIdToPumps).filter(e=>{const t=this._partitionIdToPumps[e];return Boolean(t&&t.isReceiving)})}isReceivingFromPartition(e){const t=this._partitionIdToPumps[e];return Boolean(t&&t.isReceiving)}async createPump(e,t,n,r){const o=n.partitionId;if(r.aborted)return void i.b.verbose(`${this._eventProcessorName}] The subscription was closed before creating the pump for partition ${o}.`);const s=this._partitionIdToPumps[o];if(s){if(s.isReceiving)return void i.b.verbose(`[${this._eventProcessorName}] [${o}] The existing pump is running.`);i.b.verbose(`[${this._eventProcessorName}] [${o}] The existing pump is not running.`),await this.removePump(o,f.OwnershipLost)}i.b.verbose(`[${this._eventProcessorName}] [${o}] Creating a new pump.`);const a=new F(t,n,e,this._options);try{this._partitionIdToPumps[o]=a,await a.start()}catch(e){i.b.verbose(`[${this._eventProcessorName}] [${o}] An error occured while adding/updating a pump: ${e}`),Object(i.a)(e)}}async removePump(e,t){try{const n=this._partitionIdToPumps[e];n?(delete this._partitionIdToPumps[e],i.b.verbose(`[${this._eventProcessorName}] [${e}] Stopping the pump.`),await n.stop(t)):i.b.verbose(`[${this._eventProcessorName}] [${e}] No pump was found to remove.`)}catch(t){i.b.verbose(`[${this._eventProcessorName}] [${e}] An error occured while removing a pump: ${t}`),Object(i.a)(t)}}async removeAllPumps(e){const t=Object.keys(this._partitionIdToPumps);i.b.verbose(`[${this._eventProcessorName}] Removing all pumps due to reason ${e}.`);const n=[];for(const r of t){const t=this._partitionIdToPumps[r];t&&n.push(t.stop(e))}try{await Promise.all(n)}catch(e){i.b.verbose(`[${this._eventProcessorName}] An error occured while removing all pumps: ${e}`),Object(i.a)(e)}finally{this._partitionIdToPumps={}}}}async function K(e,t){try{await Object(m.b)(e,t)}catch(e){}}var W=n(58);class V{constructor(e,t,n,r,o){this._consumerGroup=e,this._context=t,this._subscriptionEventHandlers=n,this._checkpointStore=r,this._isRunning=!1,o.ownerId?(this._id=o.ownerId,i.b.verbose("Starting event processor with ID "+this._id)):(this._id=Object(W.a)(),i.b.verbose("Starting event processor with autogenerated ID "+this._id)),this._eventHubName=this._context.config.entityPath,this._fullyQualifiedNamespace=this._context.config.host,this._processorOptions=o,this._pumpManager=o.pumpManager||new $(this._id,this._processorOptions),this._processingTarget=o.processingTarget,this._loopIntervalInMs=o.loopIntervalInMs,this._loadBalancingStrategy=o.loadBalancingStrategy}get id(){return this._id}_createPartitionOwnershipRequest(e,t){const n=e.get(t);return{ownerId:this._id,partitionId:t,fullyQualifiedNamespace:this._fullyQualifiedNamespace,consumerGroup:this._consumerGroup,eventHubName:this._eventHubName,etag:n?n.etag:void 0}}async _claimOwnership(e,t){if(t.aborted)i.b.verbose(`[${this._id}] Subscription was closed before claiming ownership of ${e.partitionId}.`);else{i.b.info(`[${this._id}] Attempting to claim ownership of partition ${e.partitionId}.`);try{if(!(await this._checkpointStore.claimOwnership([e])).length)return;i.b.info(`[${this._id}] Successfully claimed ownership of partition ${e.partitionId}.`),await this._startPump(e.partitionId,t)}catch(t){i.b.warning(`[${this.id}] Failed to claim ownership of partition ${e.partitionId}`),Object(i.a)(t),await this._handleSubscriptionError(t)}}}async _startPump(e,t){if(t.aborted)return void i.b.verbose(`[${this._id}] The subscription was closed before starting to read from ${e}.`);if(this._pumpManager.isReceivingFromPartition(e))return void i.b.verbose(`[${this._id}] There is already an active partitionPump for partition "${e}", skipping pump creation.`);i.b.verbose(`[${this._id}] [${e}] Calling user-provided PartitionProcessorFactory.`);const n=new o(this._subscriptionEventHandlers,this._checkpointStore,{fullyQualifiedNamespace:this._fullyQualifiedNamespace,eventHubName:this._eventHubName,consumerGroup:this._consumerGroup,partitionId:e,eventProcessorId:this.id}),r=await this._getStartingPosition(e);await this._pumpManager.createPump(r,this._context,n,t),i.b.verbose(`[${this._id}] PartitionPump created successfully.`)}async _getStartingPosition(e){const t=(await this._checkpointStore.listCheckpoints(this._fullyQualifiedNamespace,this._eventHubName,this._consumerGroup)).filter(t=>t.partitionId===e);return t.length>0?{offset:t[0].offset}:(i.b.verbose(`No checkpoint found for partition ${e}. Looking for fallback.`),function(e,t){if(null==t)return l;if(d(t))return t;const n=t[e];if(null==n)return l;return n}(e,this._processorOptions.startPosition))}async _runLoopForSinglePartition(e,t){for(;!t.aborted;)try{await this._startPump(e,t)}catch(e){i.b.warning(`[${this._id}] An error occured within the EventProcessor loop: ${null==e?void 0:e.name}: ${null==e?void 0:e.message}`),Object(i.a)(e),await this._handleSubscriptionError(e)}finally{i.b.verbose(`[${this._id}] Pausing the EventProcessor loop for ${this._loopIntervalInMs} ms.`),await K(this._loopIntervalInMs,t)}this._isRunning=!1}async _runLoopWithLoadBalancing(e,t){let n;const r=new Promise(e=>{n=e,t.aborted?e():t.addEventListener("abort",e)});for(;!t.aborted;){const n=Date.now();try{const{partitionIds:r}=await this._context.managementSession.getEventHubProperties({abortSignal:t});await this._performLoadBalancing(e,r,t)}catch(e){i.b.warning(`[${this._id}] An error occured within the EventProcessor loop: ${null==e?void 0:e.name}: ${null==e?void 0:e.message}`),Object(i.a)(e),await Promise.race([this._handleSubscriptionError(e),r])}finally{const e=Date.now()-n,r=Math.max(this._loopIntervalInMs-e,0);i.b.verbose(`[${this._id}] Pausing the EventProcessor loop for ${r} ms.`),await K(r,t)}}n&&t.removeEventListener("abort",n),this._isRunning=!1}async _performLoadBalancing(e,t,n){if(n.aborted)throw new r.b("The operation was aborted.");const i=await this._checkpointStore.listOwnership(this._fullyQualifiedNamespace,this._eventHubName,this._consumerGroup);if(n.aborted)throw new r.b("The operation was aborted.");const o=new Map,s=new Map,a=[];for(const e of i)o.set(e.partitionId,e),G(e)||s.set(e.partitionId,e),e.ownerId===this._id&&this._pumpManager.isReceivingFromPartition(e.partitionId)&&a.push(e.partitionId);const c=e.getPartitionsToCliam(this._id,s,t);c.push(...a);const u=new Set(c);for(const e of u){const t=this._createPartitionOwnershipRequest(o,e);await this._claimOwnership(t,n)}}async _handleSubscriptionError(e){if("AbortError"!==e.name&&this._subscriptionEventHandlers.processError)try{await this._subscriptionEventHandlers.processError(e,{fullyQualifiedNamespace:this._fullyQualifiedNamespace,eventHubName:this._eventHubName,consumerGroup:this._consumerGroup,partitionId:"",updateCheckpoint:async()=>{}})}catch(e){i.b.verbose(`[${this._id}] An error was thrown from the user's processError handler: ${e}`)}}start(){this._isRunning?i.b.verbose(`[${this._id}] Attempted to start an already running EventProcessor.`):(this._isRunning=!0,this._abortController=new r.a,i.b.verbose(`[${this._id}] Starting an EventProcessor.`),this._processingTarget?(i.b.verbose(`[${this._id}] Single partition target: ${this._processingTarget}`),this._loopTask=this._runLoopForSinglePartition(this._processingTarget,this._abortController.signal)):(i.b.verbose(`[${this._id}] Multiple partitions, using load balancer`),this._loopTask=this._runLoopWithLoadBalancing(this._loadBalancingStrategy,this._abortController.signal)))}isRunning(){return this._isRunning}async stop(){i.b.verbose(`[${this._id}] Stopping an EventProcessor.`),this._abortController&&this._abortController.abort();try{await this._pumpManager.removeAllPumps(f.Shutdown),this._loopTask&&await this._loopTask}catch(e){i.b.verbose(`[${this._id}] An error occured while stopping the EventProcessor: ${e}`)}finally{i.b.verbose(`[${this._id}] EventProcessor stopped.`)}this._processingTarget?i.b.verbose(`[${this._id}] No partitions owned, skipping abandoning.`):await this.abandonPartitionOwnerships()}async abandonPartitionOwnerships(){i.b.verbose(`[${this._id}] Abandoning owned partitions`);const e=(await this._checkpointStore.listOwnership(this._fullyQualifiedNamespace,this._eventHubName,this._consumerGroup)).filter(e=>e.ownerId===this._id);for(const t of e)t.ownerId="";return this._checkpointStore.claimOwnership(e)}}function G(e){return""===e.ownerId}function Y(){if("undefined"==typeof self)return"";return self.navigator.appVersion}var J=n(74);class Z{constructor(e,t){this.endpoint=s.a.cbsEndpoint,this.replyTo=`${s.a.cbsReplyTo}-${Object(g.generate_uuid)()}`,this.cbsLock=`${s.a.negotiateCbsKey}-${Object(g.generate_uuid)()}`,this.connection=e,this.connectionLock=t}async init(e={}){const{abortSignal:t,timeoutInMs:n}=e;try{if(null==t?void 0:t.aborted)throw new r.b(s.b);if(this.connection.isOpen()||(v.b.verbose("The CBS client is trying to establish an AMQP connection."),await m.a.acquire(this.connectionLock,()=>this.connection.open({abortSignal:t}),{abortSignal:t,timeoutInMs:n})),this.isOpen())v.b.verbose("[%s] CBS session is already present. Reusing the cbs sender '%s' and receiver '%s' links over cbs session.",this.connection.id,this._cbsSenderReceiverLink.sender.name,this._cbsSenderReceiverLink.receiver.name);else{const e={source:{address:this.endpoint},name:this.replyTo,onSessionError:e=>{const t=e.connection.options.id,n=Object(a.e)(e.session.error);v.b.verbose("[%s] An error occurred on the session for request/response links for $cbs: %O",t,n)}},n={target:{address:this.endpoint}};v.b.verbose("[%s] Creating sender/receiver links on a session for $cbs endpoint.",this.connection.id),this._cbsSenderReceiverLink=await J.a.create(this.connection,n,e,{abortSignal:t}),this._cbsSenderReceiverLink.sender.on(g.SenderEvents.senderError,e=>{const t=e.connection.options.id,n=Object(a.e)(e.sender.error);v.b.verbose("[%s] An error occurred on the cbs sender link.. %O",t,n)}),this._cbsSenderReceiverLink.receiver.on(g.ReceiverEvents.receiverError,e=>{const t=e.connection.options.id,n=Object(a.e)(e.receiver.error);v.b.verbose("[%s] An error occurred on the cbs receiver link.. %O",t,n)}),v.b.verbose("[%s] Successfully created the cbs sender '%s' and receiver '%s' links over cbs session.",this.connection.id,this._cbsSenderReceiverLink.sender.name,this._cbsSenderReceiverLink.receiver.name)}}catch(e){const t=Object(a.e)(e);throw v.b.warning("[%s] An error occurred while establishing the cbs links: %s",this.connection.id,`${null==t?void 0:t.name}: ${null==t?void 0:t.message}`),Object(v.a)(t),t}}async negotiateClaim(e,t,n,i={}){const{abortSignal:o,timeoutInMs:a}=i;try{if(null==o?void 0:o.aborted)throw new r.b(s.b);if(!this._cbsSenderReceiverLink)throw new Error("Attempted to negotiate a claim but the CBS link does not exist.");const i={body:t,message_id:Object(g.generate_uuid)(),reply_to:this.replyTo,to:this.endpoint,application_properties:{operation:s.a.operationPutToken,name:e,type:n}},c=await this._cbsSenderReceiverLink.sendRequest(i,{abortSignal:o,timeoutInMs:a,requestName:"negotiateClaim"});return v.b.verbose("[%s] The CBS response is: %O",this.connection.id,c),this._fromRheaMessageResponse(c)}catch(e){throw v.b.warning("[%s] An error occurred while negotiating the cbs claim: %s",this.connection.id,`${null==e?void 0:e.name}: ${null==e?void 0:e.message}`),Object(v.a)(e),e}}async close(){try{if(this.isOpen()){const e=this._cbsSenderReceiverLink;this._cbsSenderReceiverLink=void 0,await e.close(),v.b.verbose("[%s] Successfully closed the cbs session.",this.connection.id)}}catch(e){const t=`An error occurred while closing the cbs link: ${e.stack||JSON.stringify(e)}.`;throw v.b.verbose("[%s] %s",this.connection.id,t),new Error(t)}}remove(){try{if(this._cbsSenderReceiverLink){const e=this._cbsSenderReceiverLink;this._cbsSenderReceiverLink=void 0,e.remove(),v.b.verbose("[%s] Successfully removed the cbs session.",this.connection.id)}}catch(e){const t=`An error occurred while removing the cbs link: ${e.stack||JSON.stringify(e)}.`;throw v.b.verbose("[%s] %s",this.connection.id,t),new Error(t)}}isOpen(){var e;return Boolean(null===(e=this._cbsSenderReceiverLink)||void 0===e?void 0:e.isOpen())}_fromRheaMessageResponse(e){const t={correlationId:e.correlation_id,statusCode:e.application_properties?e.application_properties["status-code"]:"",statusDescription:e.application_properties?e.application_properties["status-description"]:""};return v.b.verbose("[%s] The deserialized CBS response is: %o",this.connection.id,t),t}}var Q=n(16);const X={create(e,t){e=String(e);const n=Object(m.f)(e);if(!n.Endpoint)throw new TypeError("Missing Endpoint in Connection String.");n.Endpoint.endsWith("/")||(n.Endpoint+="/");const r={connectionString:e,endpoint:n.Endpoint,host:n&&n.Endpoint?(n.Endpoint.match(".*://([^/]*)")||[])[1]:"",sharedAccessKeyName:n.SharedAccessKeyName,sharedAccessKey:n.SharedAccessKey};return(t||n.EntityPath)&&(r.entityPath=t||n.EntityPath),r},validate(e,t){if(t||(t={}),!e)throw new TypeError("Missing configuration");if(!e.endpoint)throw new TypeError("Missing 'endpoint' in configuration");if(e.endpoint=String(e.endpoint),!e.host)throw new TypeError("Missing 'host' in configuration");if(e.host=String(e.host),t.isEntityPathRequired&&!e.entityPath)throw new TypeError("Missing 'entityPath' in configuration");if(Object(Q.a)(e.entityPath)&&(e.entityPath=String(e.entityPath)),null==e.connectionString.match(/;{0,1}SharedAccessSignature=SharedAccessSignature /)){if(!e.sharedAccessKeyName)throw new TypeError("Missing 'sharedAccessKeyName' in configuration");if(e.sharedAccessKeyName=String(e.sharedAccessKeyName),!e.sharedAccessKey)throw new TypeError("Missing 'sharedAccessKey' in configuration");e.sharedAccessKey=String(e.sharedAccessKey)}}};class ee extends g.Connection{async createSender(e){const t=await super.createSender(e);return t.setMaxListeners(1e3),t}async createAwaitableSender(e){const t=await super.createAwaitableSender(e);return t.setMaxListeners(1e3),t}async createReceiver(e){const t=await super.createReceiver(e);return t.setMaxListeners(1e3),t}}const te={create(e){var t,n,r;X.validate(e.config,{isEntityPathRequired:e.isEntityPathRequired||!1});const i=e.connectionProperties.userAgent;if(i.length>s.a.maxUserAgentLength)throw new Error(`The user-agent string cannot be more than ${s.a.maxUserAgentLength} characters in length.The given user-agent string is: ${i} with length: ${i.length}`);const o={transport:s.a.TLS,host:e.config.host,hostname:null!==(t=e.config.amqpHostname)&&void 0!==t?t:e.config.host,username:e.config.sharedAccessKeyName,port:null!==(n=e.config.port)&&void 0!==n?n:5671,reconnect:!1,properties:{product:e.connectionProperties.product,version:e.connectionProperties.version,"user-agent":i,platform:`(javascript-Browser-${Y()})`,framework:"Browser/"+Y()},idle_time_out:s.a.defaultConnectionIdleTimeoutInMs,operationTimeoutInSeconds:e.operationTimeoutInMs?e.operationTimeoutInMs/1e3:void 0};if(e.config.webSocket||!m.c&&"undefined"!=typeof self&&self.WebSocket){const t=e.config.webSocket||self.WebSocket,n=e.config.host,i=e.config.webSocketEndpointPath||"",s=e.config.webSocketConstructorOptions||{},a=null!==(r=e.config.port)&&void 0!==r?r:443;o.webSocketOptions={webSocket:t,url:`wss://${n}:${a}/${i}`,protocol:["AMQPWSB10"],options:s}}const a=new ee(o),c=`${s.a.establishConnection}-${Object(g.generate_uuid)()}`;return{wasConnectionCloseCalled:!1,connectionLock:c,negotiateClaimLock:`${s.a.negotiateClaim}-${Object(g.generate_uuid)()}`,connection:a,connectionId:a.id,cbsSession:new Z(a,c),config:e.config,refreshConnection(){const e=new ee(o),t=`${s.a.establishConnection}-${Object(g.generate_uuid)()}`;this.wasConnectionCloseCalled=!1,this.connectionLock=t,this.negotiateClaimLock=`${s.a.negotiateClaim} - ${Object(g.generate_uuid)()}`,this.connection=e,this.connectionId=e.id,this.cbsSession=new Z(e,t)}}}};var ne=n(179),re=n(180);const ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function oe(e,t,n,r){let i,o,s;const a=t||[0],c=(n=n||0)>>>3,u=-1===r?3:0;for(i=0;i<e.length;i+=1)s=i+c,o=s>>>2,a.length<=o&&a.push(0),a[o]|=e[i]<<8*(u+r*(s%4));return{value:a,binLen:8*e.length+n}}function se(e,t,n){switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":return function(e,t,r){return function(e,t,n,r){let i,o,s,a;if(0!=e.length%2)throw new Error("String of HEX type must be in byte increments");const c=t||[0],u=(n=n||0)>>>3,l=-1===r?3:0;for(i=0;i<e.length;i+=2){if(o=parseInt(e.substr(i,2),16),isNaN(o))throw new Error("String of HEX type contains invalid characters");for(a=(i>>>1)+u,s=a>>>2;c.length<=s;)c.push(0);c[s]|=o<<8*(l+r*(a%4))}return{value:c,binLen:4*e.length+n}}(e,t,r,n)};case"TEXT":return function(e,r,i){return function(e,t,n,r,i){let o,s,a,c,u,l,h,d,p=0;const f=n||[0],m=(r=r||0)>>>3;if("UTF8"===t)for(h=-1===i?3:0,a=0;a<e.length;a+=1)for(o=e.charCodeAt(a),s=[],128>o?s.push(o):2048>o?(s.push(192|o>>>6),s.push(128|63&o)):55296>o||57344<=o?s.push(224|o>>>12,128|o>>>6&63,128|63&o):(a+=1,o=65536+((1023&o)<<10|1023&e.charCodeAt(a)),s.push(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)),c=0;c<s.length;c+=1){for(l=p+m,u=l>>>2;f.length<=u;)f.push(0);f[u]|=s[c]<<8*(h+i*(l%4)),p+=1}else for(h=-1===i?2:0,d="UTF16LE"===t&&1!==i||"UTF16LE"!==t&&1===i,a=0;a<e.length;a+=1){for(o=e.charCodeAt(a),!0===d&&(c=255&o,o=c<<8|o>>>8),l=p+m,u=l>>>2;f.length<=u;)f.push(0);f[u]|=o<<8*(h+i*(l%4)),p+=2}return{value:f,binLen:8*p+r}}(e,t,r,i,n)};case"B64":return function(e,t,r){return function(e,t,n,r){let i,o,s,a,c,u,l,h=0;const d=t||[0],p=(n=n||0)>>>3,f=-1===r?3:0,m=e.indexOf("=");if(-1===e.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(e=e.replace(/=/g,""),-1!==m&&m<e.length)throw new Error("Invalid '=' found in base-64 string");for(o=0;o<e.length;o+=4){for(c=e.substr(o,4),a=0,s=0;s<c.length;s+=1)i=ie.indexOf(c.charAt(s)),a|=i<<18-6*s;for(s=0;s<c.length-1;s+=1){for(l=h+p,u=l>>>2;d.length<=u;)d.push(0);d[u]|=(a>>>16-8*s&255)<<8*(f+r*(l%4)),h+=1}}return{value:d,binLen:8*h+n}}(e,t,r,n)};case"BYTES":return function(e,t,r){return function(e,t,n,r){let i,o,s,a;const c=t||[0],u=(n=n||0)>>>3,l=-1===r?3:0;for(o=0;o<e.length;o+=1)i=e.charCodeAt(o),a=o+u,s=a>>>2,c.length<=s&&c.push(0),c[s]|=i<<8*(l+r*(a%4));return{value:c,binLen:8*e.length+n}}(e,t,r,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(e){throw new Error("ARRAYBUFFER not supported by this environment")}return function(e,t,r){return function(e,t,n,r){return oe(new Uint8Array(e),t,n,r)}(e,t,r,n)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(e){throw new Error("UINT8ARRAY not supported by this environment")}return function(e,t,r){return oe(e,t,r,n)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function ae(e,t,n,r){switch(e){case"HEX":return function(e){return function(e,t,n,r){let i,o,s="";const a=t/8,c=-1===n?3:0;for(i=0;i<a;i+=1)o=e[i>>>2]>>>8*(c+n*(i%4)),s+="0123456789abcdef".charAt(o>>>4&15)+"0123456789abcdef".charAt(15&o);return r.outputUpper?s.toUpperCase():s}(e,t,n,r)};case"B64":return function(e){return function(e,t,n,r){let i,o,s,a,c,u="";const l=t/8,h=-1===n?3:0;for(i=0;i<l;i+=3)for(a=i+1<l?e[i+1>>>2]:0,c=i+2<l?e[i+2>>>2]:0,s=(e[i>>>2]>>>8*(h+n*(i%4))&255)<<16|(a>>>8*(h+n*((i+1)%4))&255)<<8|c>>>8*(h+n*((i+2)%4))&255,o=0;o<4;o+=1)u+=8*i+6*o<=t?ie.charAt(s>>>6*(3-o)&63):r.b64Pad;return u}(e,t,n,r)};case"BYTES":return function(e){return function(e,t,n){let r,i,o="";const s=t/8,a=-1===n?3:0;for(r=0;r<s;r+=1)i=e[r>>>2]>>>8*(a+n*(r%4))&255,o+=String.fromCharCode(i);return o}(e,t,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(e){throw new Error("ARRAYBUFFER not supported by this environment")}return function(e){return function(e,t,n){let r;const i=t/8,o=new ArrayBuffer(i),s=new Uint8Array(o),a=-1===n?3:0;for(r=0;r<i;r+=1)s[r]=e[r>>>2]>>>8*(a+n*(r%4))&255;return o}(e,t,n)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(e){throw new Error("UINT8ARRAY not supported by this environment")}return function(e){return function(e,t,n){let r;const i=t/8,o=-1===n?3:0,s=new Uint8Array(i);for(r=0;r<i;r+=1)s[r]=e[r>>>2]>>>8*(o+n*(r%4))&255;return s}(e,t,n)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const ce=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],ue=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],le=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],he="Chosen SHA variant is not supported";function de(e,t){let n,r;const i=e.binLen>>>3,o=t.binLen>>>3,s=i<<3,a=4-i<<3;if(i%4!=0){for(n=0;n<o;n+=4)r=i+n>>>2,e.value[r]|=t.value[n>>>2]<<s,e.value.push(0),e.value[r+1]|=t.value[n>>>2]>>>a;return(e.value.length<<2)-4>=o+i&&e.value.pop(),{value:e.value,binLen:e.binLen+t.binLen}}return{value:e.value.concat(t.value),binLen:e.binLen+t.binLen}}function pe(e){const t={outputUpper:!1,b64Pad:"=",outputLen:-1},n=e||{},r="Output length must be a multiple of 8";if(t.outputUpper=n.outputUpper||!1,n.b64Pad&&(t.b64Pad=n.b64Pad),n.outputLen){if(n.outputLen%8!=0)throw new Error(r);t.outputLen=n.outputLen}else if(n.shakeLen){if(n.shakeLen%8!=0)throw new Error(r);t.outputLen=n.shakeLen}if("boolean"!=typeof t.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw new Error("Invalid b64Pad formatting option");return t}function fe(e,t,n,r){const i=e+" must include a value and format";if(!t){if(!r)throw new Error(i);return r}if(void 0===t.value||!t.format)throw new Error(i);return se(t.format,t.encoding||"UTF8",n)(t.value)}class me{constructor(e,t,n){const r=n||{};if(this.t=t,this.i=r.encoding||"UTF8",this.numRounds=r.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.s=e,this.o=[],this.h=0,this.u=!1,this.l=0,this.A=!1,this.H=[],this.S=[]}update(e){let t,n=0;const r=this.p>>>5,i=this.m(e,this.o,this.h),o=i.binLen,s=i.value,a=o>>>5;for(t=0;t<a;t+=r)n+this.p<=o&&(this.C=this.R(s.slice(t,t+r),this.C),n+=this.p);this.l+=n,this.o=s.slice(n>>>5),this.h=o%this.p,this.u=!0}getHash(e,t){let n,r,i=this.U;const o=pe(t);if(this.v){if(-1===o.outputLen)throw new Error("Output length must be specified in options");i=o.outputLen}const s=ae(e,i,this.K,o);if(this.A&&this.T)return s(this.T(o));for(r=this.F(this.o.slice(),this.h,this.l,this.g(this.C),i),n=1;n<this.numRounds;n+=1)this.v&&i%32!=0&&(r[r.length-1]&=16777215>>>24-i%32),r=this.F(r,i,0,this.B(this.s),i);return s(r)}setHMACKey(e,t,n){if(!this.L)throw new Error("Variant does not support HMAC");if(this.u)throw new Error("Cannot set MAC key after calling update");const r=se(t,(n||{}).encoding||"UTF8",this.K);this.M(r(e))}M(e){const t=this.p>>>3,n=t/4-1;let r;if(1!==this.numRounds)throw new Error("Cannot set numRounds with MAC");if(this.A)throw new Error("MAC key already set");for(t<e.binLen/8&&(e.value=this.F(e.value,e.binLen,0,this.B(this.s),this.U));e.value.length<=n;)e.value.push(0);for(r=0;r<=n;r+=1)this.H[r]=909522486^e.value[r],this.S[r]=1549556828^e.value[r];this.C=this.R(this.H,this.C),this.l=this.p,this.A=!0}getHMAC(e,t){const n=pe(t);return ae(e,this.U,this.K,n)(this.k())}k(){let e;if(!this.A)throw new Error("Cannot call getHMAC without first setting MAC key");const t=this.F(this.o.slice(),this.h,this.l,this.g(this.C),this.U);return e=this.R(this.S,this.B(this.s)),e=this.F(t,this.U,this.p,e,this.U),e}}function ye(e,t){return e<<t|e>>>32-t}function ge(e,t){return e>>>t|e<<32-t}function ve(e,t){return e>>>t}function _e(e,t,n){return e^t^n}function be(e,t,n){return e&t^~e&n}function we(e,t,n){return e&t^e&n^t&n}function Ee(e){return ge(e,2)^ge(e,13)^ge(e,22)}function Se(e,t){const n=(65535&e)+(65535&t);return(65535&(e>>>16)+(t>>>16)+(n>>>16))<<16|65535&n}function ke(e,t,n,r){const i=(65535&e)+(65535&t)+(65535&n)+(65535&r);return(65535&(e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(i>>>16))<<16|65535&i}function Oe(e,t,n,r,i){const o=(65535&e)+(65535&t)+(65535&n)+(65535&r)+(65535&i);return(65535&(e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(i>>>16)+(o>>>16))<<16|65535&o}function Te(e){return ge(e,7)^ge(e,18)^ve(e,3)}function Ce(e){return ge(e,6)^ge(e,11)^ge(e,25)}function Ie(e){return[1732584193,4023233417,2562383102,271733878,3285377520]}function Ae(e,t){let n,r,i,o,s,a,c;const u=[];for(n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],c=0;c<80;c+=1)u[c]=c<16?e[c]:ye(u[c-3]^u[c-8]^u[c-14]^u[c-16],1),a=c<20?Oe(ye(n,5),be(r,i,o),s,1518500249,u[c]):c<40?Oe(ye(n,5),_e(r,i,o),s,1859775393,u[c]):c<60?Oe(ye(n,5),we(r,i,o),s,2400959708,u[c]):Oe(ye(n,5),_e(r,i,o),s,3395469782,u[c]),s=o,o=i,i=ye(r,30),r=n,n=a;return t[0]=Se(n,t[0]),t[1]=Se(r,t[1]),t[2]=Se(i,t[2]),t[3]=Se(o,t[3]),t[4]=Se(s,t[4]),t}function xe(e,t,n,r){let i;const o=15+(t+65>>>9<<4),s=t+n;for(;e.length<=o;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[o]=4294967295&s,e[o-1]=s/4294967296|0,i=0;i<e.length;i+=16)r=Ae(e.slice(i,i+16),r);return r}class Re extends me{constructor(e,t,n){if("SHA-1"!==e)throw new Error(he);super(e,t,n);const r=n||{};this.L=!0,this.T=this.k,this.K=-1,this.m=se(this.t,this.i,this.K),this.R=Ae,this.g=function(e){return e.slice()},this.B=Ie,this.F=xe,this.C=[1732584193,4023233417,2562383102,271733878,3285377520],this.p=512,this.U=160,this.v=!1,r.hmacKey&&this.M(fe("hmacKey",r.hmacKey,this.K))}}function Pe(e){let t;return t="SHA-224"==e?ue.slice():le.slice(),t}function Ne(e,t){let n,r,i,o,s,a,c,u,l,h,d;const p=[];for(n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],c=t[6],u=t[7],d=0;d<64;d+=1)p[d]=d<16?e[d]:ke(ge(f=p[d-2],17)^ge(f,19)^ve(f,10),p[d-7],Te(p[d-15]),p[d-16]),l=Oe(u,Ce(s),be(s,a,c),ce[d],p[d]),h=Se(Ee(n),we(n,r,i)),u=c,c=a,a=s,s=Se(o,l),o=i,i=r,r=n,n=Se(l,h);var f;return t[0]=Se(n,t[0]),t[1]=Se(r,t[1]),t[2]=Se(i,t[2]),t[3]=Se(o,t[3]),t[4]=Se(s,t[4]),t[5]=Se(a,t[5]),t[6]=Se(c,t[6]),t[7]=Se(u,t[7]),t}class je extends me{constructor(e,t,n){if("SHA-224"!==e&&"SHA-256"!==e)throw new Error(he);super(e,t,n);const r=n||{};this.T=this.k,this.L=!0,this.K=-1,this.m=se(this.t,this.i,this.K),this.R=Ne,this.g=function(e){return e.slice()},this.B=Pe,this.F=function(t,n,r,i){return function(e,t,n,r,i){let o,s;const a=15+(t+65>>>9<<4),c=t+n;for(;e.length<=a;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[a]=4294967295&c,e[a-1]=c/4294967296|0,o=0;o<e.length;o+=16)r=Ne(e.slice(o,o+16),r);return s="SHA-224"===i?[r[0],r[1],r[2],r[3],r[4],r[5],r[6]]:r,s}(t,n,r,i,e)},this.C=Pe(e),this.p=512,this.U="SHA-224"===e?224:256,this.v=!1,r.hmacKey&&this.M(fe("hmacKey",r.hmacKey,this.K))}}class Le{constructor(e,t){this.Y=e,this.N=t}}function Me(e,t){let n;return t>32?(n=64-t,new Le(e.N<<t|e.Y>>>n,e.Y<<t|e.N>>>n)):0!==t?(n=32-t,new Le(e.Y<<t|e.N>>>n,e.N<<t|e.Y>>>n)):e}function qe(e,t){let n;return t<32?(n=32-t,new Le(e.Y>>>t|e.N<<n,e.N>>>t|e.Y<<n)):(n=64-t,new Le(e.N>>>t|e.Y<<n,e.Y>>>t|e.N<<n))}function ze(e,t){return new Le(e.Y>>>t,e.N>>>t|e.Y<<32-t)}function Ue(e,t,n){return new Le(e.Y&t.Y^e.Y&n.Y^t.Y&n.Y,e.N&t.N^e.N&n.N^t.N&n.N)}function Be(e){const t=qe(e,28),n=qe(e,34),r=qe(e,39);return new Le(t.Y^n.Y^r.Y,t.N^n.N^r.N)}function De(e,t){let n,r;n=(65535&e.N)+(65535&t.N),r=(e.N>>>16)+(t.N>>>16)+(n>>>16);const i=(65535&r)<<16|65535&n;return n=(65535&e.Y)+(65535&t.Y)+(r>>>16),r=(e.Y>>>16)+(t.Y>>>16)+(n>>>16),new Le((65535&r)<<16|65535&n,i)}function Fe(e,t,n,r){let i,o;i=(65535&e.N)+(65535&t.N)+(65535&n.N)+(65535&r.N),o=(e.N>>>16)+(t.N>>>16)+(n.N>>>16)+(r.N>>>16)+(i>>>16);const s=(65535&o)<<16|65535&i;return i=(65535&e.Y)+(65535&t.Y)+(65535&n.Y)+(65535&r.Y)+(o>>>16),o=(e.Y>>>16)+(t.Y>>>16)+(n.Y>>>16)+(r.Y>>>16)+(i>>>16),new Le((65535&o)<<16|65535&i,s)}function He(e,t,n,r,i){let o,s;o=(65535&e.N)+(65535&t.N)+(65535&n.N)+(65535&r.N)+(65535&i.N),s=(e.N>>>16)+(t.N>>>16)+(n.N>>>16)+(r.N>>>16)+(i.N>>>16)+(o>>>16);const a=(65535&s)<<16|65535&o;return o=(65535&e.Y)+(65535&t.Y)+(65535&n.Y)+(65535&r.Y)+(65535&i.Y)+(s>>>16),s=(e.Y>>>16)+(t.Y>>>16)+(n.Y>>>16)+(r.Y>>>16)+(i.Y>>>16)+(o>>>16),new Le((65535&s)<<16|65535&o,a)}function $e(e,t){return new Le(e.Y^t.Y,e.N^t.N)}function Ke(e){const t=qe(e,19),n=qe(e,61),r=ze(e,6);return new Le(t.Y^n.Y^r.Y,t.N^n.N^r.N)}function We(e){const t=qe(e,1),n=qe(e,8),r=ze(e,7);return new Le(t.Y^n.Y^r.Y,t.N^n.N^r.N)}function Ve(e){const t=qe(e,14),n=qe(e,18),r=qe(e,41);return new Le(t.Y^n.Y^r.Y,t.N^n.N^r.N)}const Ge=[new Le(ce[0],3609767458),new Le(ce[1],602891725),new Le(ce[2],3964484399),new Le(ce[3],2173295548),new Le(ce[4],4081628472),new Le(ce[5],3053834265),new Le(ce[6],2937671579),new Le(ce[7],3664609560),new Le(ce[8],2734883394),new Le(ce[9],1164996542),new Le(ce[10],1323610764),new Le(ce[11],3590304994),new Le(ce[12],4068182383),new Le(ce[13],991336113),new Le(ce[14],633803317),new Le(ce[15],3479774868),new Le(ce[16],2666613458),new Le(ce[17],944711139),new Le(ce[18],2341262773),new Le(ce[19],2007800933),new Le(ce[20],1495990901),new Le(ce[21],1856431235),new Le(ce[22],3175218132),new Le(ce[23],2198950837),new Le(ce[24],3999719339),new Le(ce[25],766784016),new Le(ce[26],2566594879),new Le(ce[27],3203337956),new Le(ce[28],1034457026),new Le(ce[29],2466948901),new Le(ce[30],3758326383),new Le(ce[31],168717936),new Le(ce[32],1188179964),new Le(ce[33],1546045734),new Le(ce[34],1522805485),new Le(ce[35],2643833823),new Le(ce[36],2343527390),new Le(ce[37],1014477480),new Le(ce[38],1206759142),new Le(ce[39],344077627),new Le(ce[40],1290863460),new Le(ce[41],3158454273),new Le(ce[42],3505952657),new Le(ce[43],106217008),new Le(ce[44],3606008344),new Le(ce[45],1432725776),new Le(ce[46],1467031594),new Le(ce[47],851169720),new Le(ce[48],3100823752),new Le(ce[49],1363258195),new Le(ce[50],3750685593),new Le(ce[51],3785050280),new Le(ce[52],3318307427),new Le(ce[53],3812723403),new Le(ce[54],2003034995),new Le(ce[55],3602036899),new Le(ce[56],1575990012),new Le(ce[57],1125592928),new Le(ce[58],2716904306),new Le(ce[59],442776044),new Le(ce[60],593698344),new Le(ce[61],3733110249),new Le(ce[62],2999351573),new Le(ce[63],3815920427),new Le(3391569614,3928383900),new Le(3515267271,566280711),new Le(3940187606,3454069534),new Le(4118630271,4000239992),new Le(116418474,1914138554),new Le(174292421,2731055270),new Le(289380356,3203993006),new Le(460393269,320620315),new Le(685471733,587496836),new Le(852142971,1086792851),new Le(1017036298,365543100),new Le(1126000580,2618297676),new Le(1288033470,3409855158),new Le(1501505948,4234509866),new Le(1607167915,987167468),new Le(1816402316,1246189591)];function Ye(e){return"SHA-384"===e?[new Le(3418070365,ue[0]),new Le(1654270250,ue[1]),new Le(2438529370,ue[2]),new Le(355462360,ue[3]),new Le(1731405415,ue[4]),new Le(41048885895,ue[5]),new Le(3675008525,ue[6]),new Le(1203062813,ue[7])]:[new Le(le[0],4089235720),new Le(le[1],2227873595),new Le(le[2],4271175723),new Le(le[3],1595750129),new Le(le[4],2917565137),new Le(le[5],725511199),new Le(le[6],4215389547),new Le(le[7],327033209)]}function Je(e,t){let n,r,i,o,s,a,c,u,l,h,d,p;const f=[];for(n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],c=t[6],u=t[7],d=0;d<80;d+=1)d<16?(p=2*d,f[d]=new Le(e[p],e[p+1])):f[d]=Fe(Ke(f[d-2]),f[d-7],We(f[d-15]),f[d-16]),l=He(u,Ve(s),(y=a,g=c,new Le((m=s).Y&y.Y^~m.Y&g.Y,m.N&y.N^~m.N&g.N)),Ge[d],f[d]),h=De(Be(n),Ue(n,r,i)),u=c,c=a,a=s,s=De(o,l),o=i,i=r,r=n,n=De(l,h);var m,y,g;return t[0]=De(n,t[0]),t[1]=De(r,t[1]),t[2]=De(i,t[2]),t[3]=De(o,t[3]),t[4]=De(s,t[4]),t[5]=De(a,t[5]),t[6]=De(c,t[6]),t[7]=De(u,t[7]),t}class Ze extends me{constructor(e,t,n){if("SHA-384"!==e&&"SHA-512"!==e)throw new Error(he);super(e,t,n);const r=n||{};this.T=this.k,this.L=!0,this.K=-1,this.m=se(this.t,this.i,this.K),this.R=Je,this.g=function(e){return e.slice()},this.B=Ye,this.F=function(t,n,r,i){return function(e,t,n,r,i){let o,s;const a=31+(t+129>>>10<<5),c=t+n;for(;e.length<=a;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[a]=4294967295&c,e[a-1]=c/4294967296|0,o=0;o<e.length;o+=32)r=Je(e.slice(o,o+32),r);return s="SHA-384"===i?[(r=r)[0].Y,r[0].N,r[1].Y,r[1].N,r[2].Y,r[2].N,r[3].Y,r[3].N,r[4].Y,r[4].N,r[5].Y,r[5].N]:[r[0].Y,r[0].N,r[1].Y,r[1].N,r[2].Y,r[2].N,r[3].Y,r[3].N,r[4].Y,r[4].N,r[5].Y,r[5].N,r[6].Y,r[6].N,r[7].Y,r[7].N],s}(t,n,r,i,e)},this.C=Ye(e),this.p=1024,this.U="SHA-384"===e?384:512,this.v=!1,r.hmacKey&&this.M(fe("hmacKey",r.hmacKey,this.K))}}const Qe=[new Le(0,1),new Le(0,32898),new Le(2147483648,32906),new Le(2147483648,2147516416),new Le(0,32907),new Le(0,2147483649),new Le(2147483648,2147516545),new Le(2147483648,32777),new Le(0,138),new Le(0,136),new Le(0,2147516425),new Le(0,2147483658),new Le(0,2147516555),new Le(2147483648,139),new Le(2147483648,32905),new Le(2147483648,32771),new Le(2147483648,32770),new Le(2147483648,128),new Le(0,32778),new Le(2147483648,2147483658),new Le(2147483648,2147516545),new Le(2147483648,32896),new Le(0,2147483649),new Le(2147483648,2147516424)],Xe=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function et(e){let t;const n=[];for(t=0;t<5;t+=1)n[t]=[new Le(0,0),new Le(0,0),new Le(0,0),new Le(0,0),new Le(0,0)];return n}function tt(e){let t;const n=[];for(t=0;t<5;t+=1)n[t]=e[t].slice();return n}function nt(e,t){let n,r,i,o;const s=[],a=[];if(null!==e)for(r=0;r<e.length;r+=2)t[(r>>>1)%5][(r>>>1)/5|0]=$e(t[(r>>>1)%5][(r>>>1)/5|0],new Le(e[r+1],e[r]));for(n=0;n<24;n+=1){for(o=et(),r=0;r<5;r+=1)s[r]=(c=t[r][0],u=t[r][1],l=t[r][2],h=t[r][3],d=t[r][4],new Le(c.Y^u.Y^l.Y^h.Y^d.Y,c.N^u.N^l.N^h.N^d.N));for(r=0;r<5;r+=1)a[r]=$e(s[(r+4)%5],Me(s[(r+1)%5],1));for(r=0;r<5;r+=1)for(i=0;i<5;i+=1)t[r][i]=$e(t[r][i],a[r]);for(r=0;r<5;r+=1)for(i=0;i<5;i+=1)o[i][(2*r+3*i)%5]=Me(t[r][i],Xe[r][i]);for(r=0;r<5;r+=1)for(i=0;i<5;i+=1)t[r][i]=$e(o[r][i],new Le(~o[(r+1)%5][i].Y&o[(r+2)%5][i].Y,~o[(r+1)%5][i].N&o[(r+2)%5][i].N));t[0][0]=$e(t[0][0],Qe[n])}var c,u,l,h,d;return t}function rt(e){let t,n,r=0;const i=[0,0],o=[4294967295&e,e/4294967296&2097151];for(t=6;t>=0;t--)n=o[t>>2]>>>8*t&255,0===n&&0===r||(i[r+1>>2]|=n<<8*(r+1),r+=1);return r=0!==r?r:1,i[0]|=r,{value:r+1>4?i:[i[0]],binLen:8+8*r}}function it(e){return de(rt(e.binLen),e)}function ot(e,t){let n,r=rt(t);r=de(r,e);const i=t>>>2,o=(i-r.value.length%i)%i;for(n=0;n<o;n++)r.value.push(0);return r.value}class st extends me{constructor(e,t,n){let r=6,i=0;super(e,t,n);const o=n||{};if(1!==this.numRounds){if(o.kmacKey||o.hmacKey)throw new Error("Cannot set numRounds with MAC");if("CSHAKE128"===this.s||"CSHAKE256"===this.s)throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.K=1,this.m=se(this.t,this.i,this.K),this.R=nt,this.g=tt,this.B=et,this.C=et(),this.v=!1,e){case"SHA3-224":this.p=i=1152,this.U=224,this.L=!0,this.T=this.k;break;case"SHA3-256":this.p=i=1088,this.U=256,this.L=!0,this.T=this.k;break;case"SHA3-384":this.p=i=832,this.U=384,this.L=!0,this.T=this.k;break;case"SHA3-512":this.p=i=576,this.U=512,this.L=!0,this.T=this.k;break;case"SHAKE128":r=31,this.p=i=1344,this.U=-1,this.v=!0,this.L=!1,this.T=null;break;case"SHAKE256":r=31,this.p=i=1088,this.U=-1,this.v=!0,this.L=!1,this.T=null;break;case"KMAC128":r=4,this.p=i=1344,this.I(n),this.U=-1,this.v=!0,this.L=!1,this.T=this.X;break;case"KMAC256":r=4,this.p=i=1088,this.I(n),this.U=-1,this.v=!0,this.L=!1,this.T=this.X;break;case"CSHAKE128":this.p=i=1344,r=this._(n),this.U=-1,this.v=!0,this.L=!1,this.T=null;break;case"CSHAKE256":this.p=i=1088,r=this._(n),this.U=-1,this.v=!0,this.L=!1,this.T=null;break;default:throw new Error(he)}this.F=function(e,t,n,o,s){return function(e,t,n,r,i,o,s){let a,c,u=0;const l=[],h=i>>>5,d=t>>>5;for(a=0;a<d&&t>=i;a+=h)r=nt(e.slice(a,a+h),r),t-=i;for(e=e.slice(a),t%=i;e.length<h;)e.push(0);for(a=t>>>3,e[a>>2]^=o<<a%4*8,e[h-1]^=2147483648,r=nt(e,r);32*l.length<s&&(c=r[u%5][u/5|0],l.push(c.N),!(32*l.length>=s));)l.push(c.Y),u+=1,0==64*u%i&&(nt(null,r),u=0);return l}(e,t,0,o,i,r,s)},o.hmacKey&&this.M(fe("hmacKey",o.hmacKey,this.K))}_(e,t){const n=function(e){const t=e||{};return{funcName:fe("funcName",t.funcName,1,{value:[],binLen:0}),customization:fe("Customization",t.customization,1,{value:[],binLen:0})}}(e||{});t&&(n.funcName=t);const r=de(it(n.funcName),it(n.customization));if(0!==n.customization.binLen||0!==n.funcName.binLen){const e=ot(r,this.p>>>3);for(let t=0;t<e.length;t+=this.p>>>5)this.C=this.R(e.slice(t,t+(this.p>>>5)),this.C),this.l+=this.p;return 4}return 31}I(e){const t=function(e){const t=e||{};return{kmacKey:fe("kmacKey",t.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:fe("Customization",t.customization,1,{value:[],binLen:0})}}(e||{});this._(e,t.funcName);const n=ot(it(t.kmacKey),this.p>>>3);for(let e=0;e<n.length;e+=this.p>>>5)this.C=this.R(n.slice(e,e+(this.p>>>5)),this.C),this.l+=this.p;this.A=!0}X(e){const t=de({value:this.o.slice(),binLen:this.h},function(e){let t,n,r=0;const i=[0,0],o=[4294967295&e,e/4294967296&2097151];for(t=6;t>=0;t--)n=o[t>>2]>>>8*t&255,0===n&&0===r||(i[r>>2]|=n<<8*r,r+=1);return r=0!==r?r:1,i[r>>2]|=r<<8*r,{value:r+1>4?i:[i[0]],binLen:8+8*r}}(e.outputLen));return this.F(t.value,t.binLen,this.l,this.g(this.C),e.outputLen)}}function at(e){return Object(ne.a)(e)||Object(re.a)(e)?new ct(e):Object(Q.b)(e,["sharedAccessKeyName","sharedAccessKey"])?new ct({name:e.sharedAccessKeyName,key:e.sharedAccessKey}):new ct({signature:e.sharedAccessSignature})}class ct{constructor(e){this._credential=e}get isSasTokenProvider(){return!0}getToken(e){return Object(ne.a)(this._credential)?function(e,t,n,r){r=encodeURIComponent(r),e=encodeURIComponent(e);const i=r+"\n"+n,o=new class{constructor(e,t,n){if("SHA-1"==e)this.O=new Re(e,t,n);else if("SHA-224"==e||"SHA-256"==e)this.O=new je(e,t,n);else if("SHA-384"==e||"SHA-512"==e)this.O=new Ze(e,t,n);else{if("SHA3-224"!=e&&"SHA3-256"!=e&&"SHA3-384"!=e&&"SHA3-512"!=e&&"SHAKE128"!=e&&"SHAKE256"!=e&&"CSHAKE128"!=e&&"CSHAKE256"!=e&&"KMAC128"!=e&&"KMAC256"!=e)throw new Error(he);this.O=new st(e,t,n)}}update(e){this.O.update(e)}getHash(e,t){return this.O.getHash(e,t)}setHMACKey(e,t,n){this.O.setHMACKey(e,t,n)}getHMAC(e,t){return this.O.getHMAC(e,t)}}("SHA-256","TEXT");o.setHMACKey(t,"TEXT"),o.update(i);const s=encodeURIComponent(o.getHMAC("B64"));return{token:`SharedAccessSignature sr=${r}&sig=${s}&se=${n}&skn=${e}`,expiresOnTimestamp:n}}(this._credential.name,this._credential.key,Math.floor(Date.now()/1e3)+3600,e):{token:this._credential.signature,expiresOnTimestamp:0}}}function ut(e){const t=Object(m.f)(e);!function(e,t,n,r){if(!e)throw new Error("Connection string should have an Endpoint key.");if(t){if(n||r)throw new Error("Connection string cannot have both SharedAccessSignature and SharedAccessKey keys.")}else{if(n&&!r)throw new Error("Connection string with SharedAccessKey should have SharedAccessKeyName.");if(!n&&r)throw new Error("Connection string with SharedAccessKeyName should have SharedAccessKey as well.")}}(t.Endpoint,t.SharedAccessSignature,t.SharedAccessKey,t.SharedAccessKeyName);const n={fullyQualifiedNamespace:(t.Endpoint.match(".*://([^/]*)")||[])[1],endpoint:t.Endpoint};return t.EntityPath&&(n.eventHubName=t.EntityPath),t.SharedAccessSignature&&(n.sharedAccessSignature=t.SharedAccessSignature),t.SharedAccessKey&&t.SharedAccessKeyName&&(n.sharedAccessKey=t.SharedAccessKey,n.sharedAccessKeyName=t.SharedAccessKeyName),n}var lt=n(104);const ht={create(e,t){const n=X.create(e,t);if(!n.entityPath)throw new TypeError(`Either provide "path" or the "connectionString": "${e}", must contain EntityPath="<path-to-the-entity>".`);return ht.createFromConnectionConfig(n)},createFromConnectionConfig:e=>(X.validate(e,{isEntityPathRequired:!0}),e.getManagementAudience=()=>`${e.endpoint}${e.entityPath}/$management`,e.getManagementAddress=()=>e.entityPath+"/$management",e.getSenderAudience=t=>null!=t?`${e.endpoint}${e.entityPath}/Partitions/${t}`:`${e.endpoint}${e.entityPath}`,e.getSenderAddress=t=>null!=t?`${e.entityPath}/Partitions/${t}`:""+e.entityPath,e.getReceiverAudience=(t,n)=>(n||(n="$default"),`${e.endpoint}${e.entityPath}/ConsumerGroups/${n}/Partitions/`+t),e.getReceiverAddress=(t,n)=>(n||(n="$default"),`${e.entityPath}/ConsumerGroups/${n}/Partitions/${t}`),e),setCustomEndpointAddress(e,t){e.amqpHostname=e.host;const{hostname:n,port:r}=function(e){const t=e.match(/.*:\/\/([^/]*)/);if(!t)throw new TypeError("Invalid endpoint missing host: "+e);const[,n]=t,[r,i]=n.split(":");return{host:n,hostname:r,port:i}}(t);e.host=n,r&&(e.port=parseInt(r,10))},validate:e=>X.validate(e,{isEntityPathRequired:!0})};function dt(){return"BROWSER-VERSION; Browser "+function(){if("undefined"==typeof self)return"";return self.navigator.appVersion}()}var pt;function ft(e,t,n,r){let i,o,s;if(e=String(e),Object(c.a)(n)){const r=t;let a=e;if(s=Object(ne.a)(n)||Object(re.a)(n)?at(n):n,!r)throw new TypeError('"eventHubName" is missing');a.endsWith("/")||(a+="/"),i=`Endpoint=sb://${a};SharedAccessKeyName=defaultKeyName;SharedAccessKey=defaultKeyValue;EntityPath=${r}`,o=ht.create(i)}else{const a=ut(e);if(!(a.eventHubName||"string"==typeof t&&t))throw new TypeError(`Either provide "eventHubName" or the "connectionString": "${e}", must contain "EntityPath=<your-event-hub-name>".`);if(a.eventHubName&&"string"==typeof t&&t&&a.eventHubName!==t)throw new TypeError(`The entity path "${a.eventHubName}" in connectionString: "${e}" doesn't match with eventHubName: "${t}".`);if(i=e,"string"!=typeof t)o=ht.create(i),r=t;else{const e=t;o=ht.create(i,e),r=n}s=at(ut(i))}return(null==r?void 0:r.customEndpointAddress)&&ht.setCustomEndpointAddress(o,r.customEndpointAddress),X.validate(o),pt.create(o,s,r)}function mt(e,t,n,r){if(!n.length)return[];const o=function(e,t){const n=new Map;return e.forEach((e,r)=>{if(void 0===e.lastModifiedTimeInMs||null===e.lastModifiedTimeInMs)return;Date.now()-e.lastModifiedTimeInMs<t&&e.ownerId&&n.set(r,e)}),n}(t,r);if(i.b.verbose(`[${e}] Number of active ownership records: ${o.size}.`),0===o.size)return n;const s=new Map;for(const e of o.values()){const t=s.get(e.ownerId)||[];t.push(e),s.set(e.ownerId,t)}s.has(e)||s.set(e,[]),i.b.info(`[${e}] Number of active event processors: ${s.size}.`);const{minPartitionsPerOwner:a,requiredNumberOfOwnersWithExtraPartition:c}=function(e,t){return{minPartitionsPerOwner:Math.floor(t.length/e.size),requiredNumberOfOwnersWithExtraPartition:t.length%e.size}}(s,n);i.b.verbose(`[${e}] Expected minimum number of partitions per event processor: ${a},expected number of event processors with additional partition: ${c}.`);const u=function(e,t){const n={haveRequiredPartitions:0,haveAdditionalPartition:0,haveTooManyPartitions:0};for(const r of t.values()){const t=r.length;t===e?n.haveRequiredPartitions++:t===e+1?n.haveAdditionalPartition++:t>e+1&&n.haveTooManyPartitions++}return n}(a,s);if(function(e,t,{haveAdditionalPartition:n,haveRequiredPartitions:r}){return n===e&&r+n===t}(c,s.size,u))return[];let l=function(e,t,n,{haveAdditionalPartition:r,haveTooManyPartitions:i}){let o=e;return t>0&&r+i<t&&(o=e+1),o-n}(a,c,s.get(e).length,u);if(l<=0)return[];const h=[],d=n.filter(e=>!o.has(e));for(;Math.min(l,d.length);){const e=Math.floor(Math.random()*d.length);h.push(d.splice(e,1)[0]),l--}if(0===l)return h;const p=function(e,t,n,r,i){const o=[],s=[];i.forEach((e,n)=>{n===r||e.length<=t||s.push(e)}),s.sort((e,t)=>e.length>t.length?-1:e.length<t.length?1:0);let a=0,c=s.shift();for(;e>0&&c;){let r=t;a<n&&r++,a++;let i=c.length-r;for(;Math.min(e,i);){const t=Math.floor(Math.random()*c.length);o.push(c.splice(t,1)[0].partitionId),e--,i--}c=s.shift()}return o}(l,a,c,e,s);return h.concat(p)}!function(e){const t=`azsdk-js-azureeventhubs/${C.c.version} (${dt()})`;function n(e){const n=e.userAgent?`${t},${e.userAgent}`:t;if(n.length>s.a.maxUserAgentLength)throw new Error(`The user-agent string cannot be more than ${s.a.maxUserAgentLength} characters in length.The given user-agent string is: ${n} with length: ${n.length}`);return n}e.getUserAgent=n,e.create=function(e,t,r){r||(r={}),e.webSocket=r.webSocketOptions&&r.webSocketOptions.webSocket,e.webSocketEndpointPath="$servicebus/websocket",e.webSocketConstructorOptions=r.webSocketOptions&&r.webSocketOptions.webSocketConstructorOptions;const o={config:e,isEntityPathRequired:!0,connectionProperties:{product:"MSJSClient",userAgent:n(r),version:C.c.version}},s=te.create(o);s.tokenCredential=t,s.wasConnectionCloseCalled=!1,s.senders={},s.receivers={};const a={address:r.managementSessionAddress,audience:r.managementSessionAudience};let c,u;s.managementSession=new lt.a(s,a),Object.assign(s,{isConnectionClosing(){return Boolean(!this.connection.isOpen()&&this.connection.isRemoteOpen())},async readyToOpenLink(){this.isConnectionClosing()&&await this.waitForDisconnectedEvent(),await this.waitForConnectionReset()},waitForDisconnectedEvent(){return new Promise(e=>{i.b.verbose(`[${this.connectionId}] Attempting to reinitialize connection but the connection is in the process of closing. Waiting for the disconnect event before continuing.`),this.connection.once(g.ConnectionEvents.disconnected,e)})},waitForConnectionReset:()=>u||Promise.resolve(),async close(){var e;try{this.connection.isOpen()&&(await Promise.all(Object.keys(s.senders).map(e=>{var t;return null===(t=s.senders[e])||void 0===t?void 0:t.close().catch(()=>{})})),await Promise.all(Object.keys(s.receivers).map(e=>{var t;return null===(t=s.receivers[e])||void 0===t?void 0:t.close().catch(()=>{})})),await this.cbsSession.close(),await(null===(e=this.managementSession)||void 0===e?void 0:e.close()),await this.connection.close(),this.wasConnectionCloseCalled=!0,i.b.info("Closed the amqp connection '%s' on the client.",this.connectionId))}catch(e){const t=e instanceof Error?`${e.name}: ${e.message}`:JSON.stringify(e);throw i.b.warning(`An error occurred while closing the connection "${this.connectionId}":\n${t}`),Object(i.a)(e),e}}});const l=()=>{s.wasConnectionCloseCalled=!1,i.b.verbose("[%s] setting 'wasConnectionCloseCalled' property of connection context to %s.",s.connection.id,s.wasConnectionCloseCalled)},h=async e=>{var t,n;if(!u){u=new Promise(e=>{c=e});try{i.b.verbose("[%s] 'disconnected' event occurred on the amqp connection.",s.connection.id),e.connection&&e.connection.error&&i.b.verbose("[%s] Accompanying error on the context.connection: %O",s.connection.id,e.connection&&e.connection.error),e.error&&i.b.verbose("[%s] Accompanying error on the context: %O",s.connection.id,e.error);const r={wasConnectionCloseCalled:s.wasConnectionCloseCalled,numSenders:Object.keys(s.senders).length,numReceivers:Object.keys(s.receivers).length};i.b.verbose("[%s] Closing all open senders and receivers in the state: %O",s.connection.id,r),s.connection.removeAllSessions(),await(null===(t=s.cbsSession)||void 0===t?void 0:t.close().catch(()=>{})),await(null===(n=s.managementSession)||void 0===n?void 0:n.close().catch(()=>{})),(r.numSenders||r.numReceivers)&&(await Promise.all(Object.keys(s.senders).map(e=>{var t;return null===(t=s.senders[e])||void 0===t?void 0:t.close().catch(()=>{})})),await Promise.all(Object.keys(s.receivers).map(e=>{var t;return null===(t=s.receivers[e])||void 0===t?void 0:t.close().catch(()=>{})})))}catch(e){i.b.verbose(`[${s.connectionId}] An error occurred while closing the connection in 'disconnected'. %O`,e)}try{await async function(e){const t=e.connectionId;try{await function(e){return e.connection.removeListener(g.ConnectionEvents.connectionOpen,l),e.connection.removeListener(g.ConnectionEvents.disconnected,h),e.connection.removeListener(g.ConnectionEvents.protocolError,d),e.connection.removeListener(g.ConnectionEvents.error,p),e.connection.close()}(e)}catch(t){i.b.verbose(`[${e.connectionId}] There was an error closing the connection before reconnecting: %O`,t)}e.refreshConnection(),f(e.connection),i.b.verbose(`The connection "${t}" has been updated to "${e.connectionId}".`)}(s)}catch(e){i.b.verbose(`[${s.connectionId}] An error occurred while refreshing the connection in 'disconnected'. %O`,e)}finally{c(),u=void 0}}},d=async e=>{i.b.verbose("[%s] 'protocol_error' event occurred on the amqp connection.",s.connection.id),e.connection&&e.connection.error&&i.b.verbose("[%s] Accompanying error on the context.connection: %O",s.connection.id,e.connection&&e.connection.error),e.error&&i.b.verbose("[%s] Accompanying error on the context: %O",s.connection.id,e.error)},p=async e=>{i.b.verbose("[%s] 'error' event occurred on the amqp connection.",s.connection.id),e.connection&&e.connection.error&&i.b.verbose("[%s] Accompanying error on the context.connection: %O",s.connection.id,e.connection&&e.connection.error),e.error&&i.b.verbose("[%s] Accompanying error on the context: %O",s.connection.id,e.error)};function f(e){e.on(g.ConnectionEvents.connectionOpen,l),e.on(g.ConnectionEvents.disconnected,h),e.on(g.ConnectionEvents.protocolError,d),e.on(g.ConnectionEvents.error,p)}return f(s.connection),i.b.verbose("[%s] Created connection context successfully.",s.connectionId),s}}(pt||(pt={}));class yt{constructor(e){this._partitionOwnershipExpirationIntervalInMs=e}getPartitionsToCliam(e,t,n){const r=mt(e,t,n,this._partitionOwnershipExpirationIntervalInMs);if(!r.length)return[];return[r[Math.floor(Math.random()*r.length)]]}}class gt{constructor(e){this._partitionOwnershipExpirationIntervalInMs=e}getPartitionsToCliam(e,t,n){return mt(e,t,n,this._partitionOwnershipExpirationIntervalInMs)}}class vt{constructor(){this._partitionOwnershipMap=new Map,this._committedCheckpoints=new Map}async listOwnership(e,t,n){const r=[];for(const e of this._partitionOwnershipMap.values())r.push(Object.assign({},e));return r}async claimOwnership(e){const t=[];for(const n of e)if(!this._partitionOwnershipMap.has(n.partitionId)||this._partitionOwnershipMap.get(n.partitionId).etag===n.etag){const e=new Date,r=Object.assign(Object.assign({},n),{etag:Object(g.generate_uuid)(),lastModifiedTimeInMs:e.getTime()});this._partitionOwnershipMap.set(r.partitionId,r),t.push(r)}return t}async updateCheckpoint(e){Object(R.d)("","updateCheckpoint","sequenceNumber",e.sequenceNumber),Object(R.d)("","updateCheckpoint","offset",e.offset),e=Object.assign({},e);const t=this._partitionOwnershipMap.get(e.partitionId);if(t){t.etag=Object(g.generate_uuid)();const n=`${e.fullyQualifiedNamespace}:${e.eventHubName}:${e.consumerGroup}`;let r=this._committedCheckpoints.get(n);null==r&&(r=new Map,this._committedCheckpoints.set(n,r)),r.set(e.partitionId,e)}}async listCheckpoints(e,t,n){const r=`${e}:${t}:${n}`,i=this._committedCheckpoints.get(r);if(null==i)return[];const o=[];for(const e of i.values())o.push(Object.assign({},e));return o}}class _t{constructor(){this._partitions=new Set}add(e){if("all"===e&&this._partitions.size>0||this._partitions.has(e)||this._partitions.has("all"))throw new Error("Partition already has a subscriber.");this._partitions.add(e)}remove(e){this._partitions.delete(e)}}class bt{getPartitionsToCliam(e,t,n){return n}}const wt={maxBatchSize:1,maxWaitTimeInSeconds:60};class Et{constructor(e,t,n,r,o,s){var a;this._consumerGroup=e,this._partitionGate=new _t,this._id=Object(W.a)(),this._subscriptions=new Set,Object(c.a)(r)?(i.b.info("Creating EventHubConsumerClient with TokenCredential."),St(o)?(this._checkpointStore=o,this._userChoseCheckpointStore=!0,this._clientOptions=s||{}):(this._checkpointStore=new vt,this._userChoseCheckpointStore=!1,this._clientOptions=o||{}),this._context=ft(t,n,r,this._clientOptions)):"string"==typeof n?(i.b.info("Creating EventHubConsumerClient with connection string and event hub name."),St(r)?(this._checkpointStore=r,this._userChoseCheckpointStore=!0,this._clientOptions=o||{}):(this._checkpointStore=new vt,this._userChoseCheckpointStore=!1,this._clientOptions=r||{}),this._context=ft(t,n,this._clientOptions)):(i.b.info("Creating EventHubConsumerClient with connection string."),St(n)?(this._checkpointStore=n,this._userChoseCheckpointStore=!0,this._clientOptions=r||{}):(this._checkpointStore=new vt,this._userChoseCheckpointStore=!1,this._clientOptions=n||{}),this._context=ft(t,this._clientOptions)),this._loadBalancingOptions=Object.assign({strategy:"balanced",updateIntervalInMs:1e4,partitionOwnershipExpirationIntervalInMs:6e4},null===(a=this._clientOptions)||void 0===a?void 0:a.loadBalancingOptions)}get eventHubName(){return this._context.config.entityPath}get fullyQualifiedNamespace(){return this._context.config.host}async close(){const e=Array.from(this._subscriptions);return await Promise.all(e.map(e=>e.close())),this._context.close()}getPartitionIds(e={}){return this._context.managementSession.getEventHubProperties(Object.assign(Object.assign({},e),{retryOptions:this._clientOptions.retryOptions})).then(e=>e.partitionIds)}getPartitionProperties(e,t={}){return this._context.managementSession.getPartitionProperties(e,Object.assign(Object.assign({},t),{retryOptions:this._clientOptions.retryOptions}))}getEventHubProperties(e={}){return this._context.managementSession.getEventHubProperties(Object.assign(Object.assign({},e),{retryOptions:this._clientOptions.retryOptions}))}subscribe(e,t,n){let r,i;if(kt(e)){const n=t;n&&n.startPosition&&h(n.startPosition),({targetedPartitionId:i,eventProcessor:r}=this.createEventProcessorForAllPartitions(e,n))}else{if(!kt(t))throw new TypeError("Unhandled subscribe() overload");{const o=n;o&&o.startPosition&&h(o.startPosition),({targetedPartitionId:i,eventProcessor:r}=this.createEventProcessorForSinglePartition(String(e),t,n))}}r.start();const o={get isRunning(){return r.isRunning()},close:()=>(this._partitionGate.remove(i),this._subscriptions.delete(o),r.stop())};return this._subscriptions.add(o),o}_getLoadBalancingStrategy(){var e;if(!this._userChoseCheckpointStore)return new bt;const t=this._loadBalancingOptions.partitionOwnershipExpirationIntervalInMs;return"greedy"===(null===(e=this._loadBalancingOptions)||void 0===e?void 0:e.strategy)?new gt(t):new yt(t)}createEventProcessorForAllPartitions(e,t){this._partitionGate.add("all"),this._userChoseCheckpointStore?i.b.verbose("EventHubConsumerClient subscribing to all partitions, using a checkpoint store."):i.b.verbose("EventHubConsumerClient subscribing to all partitions, no checkpoint store.");const n=this._getLoadBalancingStrategy();return{targetedPartitionId:"all",eventProcessor:this._createEventProcessor(this._context,e,this._checkpointStore,Object.assign(Object.assign(Object.assign({},wt),t),{ownerLevel:Ot(t,this._userChoseCheckpointStore),ownerId:this._id,retryOptions:this._clientOptions.retryOptions,loadBalancingStrategy:n,loopIntervalInMs:this._loadBalancingOptions.updateIntervalInMs}))}}createEventProcessorForSinglePartition(e,t,n){var r;this._partitionGate.add(e);const o=n;this._userChoseCheckpointStore?i.b.verbose(`EventHubConsumerClient subscribing to specific partition (${e}), using a checkpoint store.`):i.b.verbose(`EventHubConsumerClient subscribing to specific partition (${e}), no checkpoint store.`);return{targetedPartitionId:e,eventProcessor:this._createEventProcessor(this._context,t,this._checkpointStore,Object.assign(Object.assign(Object.assign({},wt),n),{processingTarget:e,ownerLevel:Ot(o,this._userChoseCheckpointStore),retryOptions:this._clientOptions.retryOptions,loadBalancingStrategy:new bt,loopIntervalInMs:null!==(r=this._loadBalancingOptions.updateIntervalInMs)&&void 0!==r?r:1e4}))}}_createEventProcessor(e,t,n,r){return new V(this._consumerGroup,e,t,n,r)}}function St(e){if(!e)return!1;const t=e;return"function"==typeof t.claimOwnership&&"function"==typeof t.listCheckpoints&&"function"==typeof t.listOwnership&&"function"==typeof t.updateCheckpoint}function kt(e){return"function"==typeof e.processEvents}function Ot(e,t){return e&&e.ownerLevel?e.ownerLevel:t?0:void 0}Et.defaultConsumerGroupName=s.a.defaultConsumerGroup;class Tt extends U.a{constructor(e,{partitionId:t,enableIdempotentProducer:n,partitionPublishingOptions:r}){super(e,{name:e.config.getSenderAddress(t),partitionId:t}),this.senderLock="sender-"+Object(W.a)(),this.address=e.config.getSenderAddress(t),this.audience=e.config.getSenderAudience(t),this._isIdempotentProducer=n,this._userProvidedPublishingOptions=r,this._onAmqpError=e=>{const t=e.sender&&e.sender.error;i.b.verbose("[%s] 'sender_error' event occurred on the sender '%s' with address '%s'. The associated error is: %O",this._context.connectionId,this.name,this.address,t)},this._onSessionError=e=>{const t=e.session&&e.session.error;i.b.verbose("[%s] 'session_error' event occurred on the session of sender '%s' with address '%s'. The associated error is: %O",this._context.connectionId,this.name,this.address,t)},this._onAmqpClose=async e=>{const t=this._sender||e.sender;i.b.verbose("[%s] 'sender_close' event occurred on the sender '%s' with address '%s'. Value for isItselfClosed on the receiver is: '%s' Value for isConnecting on the session is: '%s'.",this._context.connectionId,this.name,this.address,t?t.isItselfClosed().toString():void 0,this.isConnecting),t&&!this.isConnecting&&await t.close().catch(e=>{i.b.verbose("[%s] Error when closing sender [%s] after 'sender_close' event: %O",this._context.connectionId,this.name,e)})},this._onSessionClose=async e=>{const t=this._sender||e.sender;i.b.verbose("[%s] 'session_close' event occurred on the session of sender '%s' with address '%s'. Value for isSessionItselfClosed on the session is: '%s' Value for isConnecting on the session is: '%s'.",this._context.connectionId,this.name,this.address,t?t.isSessionItselfClosed().toString():void 0,this.isConnecting),t&&!this.isConnecting&&await t.close().catch(e=>{i.b.verbose("[%s] Error when closing sender [%s] after 'session_close' event: %O",this._context.connectionId,this.name,e)})}}async close(){try{if(this._sender){i.b.info("[%s] Closing the Sender for the entity '%s'.",this._context.connectionId,this._context.config.entityPath);const e=this._sender;this._deleteFromCache(),await this._closeLink(e)}}catch(e){const t=`[${this._context.connectionId}] An error occurred while closing sender ${this.name}: ${null==e?void 0:e.name}: ${null==e?void 0:e.message}`;throw i.b.warning(t),Object(i.a)(e),e}}isOpen(){const e=Boolean(this._sender&&this._sender.isOpen());return i.b.verbose("[%s] Sender '%s' with address '%s' is open? -> %s",this._context.connectionId,this.name,this.address,e),e}async getMaxMessageSize(e={}){return(await this._getLink(e)).maxMessageSize}async getPartitionPublishingProperties(e={}){var t,n;if(this._localPublishingProperties)return Object.assign({},this._localPublishingProperties);const r={isIdempotentPublishingEnabled:this._isIdempotentProducer,partitionId:null!==(t=this.partitionId)&&void 0!==t?t:""};if(this._isIdempotentProducer){if(this._sender=await this._getLink(e),!this._sender)throw new Error(`Failed to retrieve partition publishing properties for partition "${this.partitionId}".`);const{[C.b.epoch]:t,[C.b.producerId]:i,[C.b.producerSequenceNumber]:o}=null!==(n=this._sender.properties)&&void 0!==n?n:{};r.ownerLevel=parseInt(t,10),r.producerGroupId=parseInt(i,10),r.lastPublishedSequenceNumber=parseInt(o,10)}return this._localPublishingProperties=r,Object.assign({},r)}async send(e,t){try{if(i.b.info("[%s] Sender '%s', trying to send EventData[].",this._context.connectionId,this.name),this._isIdempotentProducer&&this._hasPendingSend)throw new Error('There can only be 1 "sendBatch" call in-flight per partition while "enableIdempotentRetries" is set to true.');const n=P(e)?e.count:e.length;if(0===n)return void i.b.info(`[${this._context.connectionId}] No events were passed to sendBatch.`);if(this._isIdempotentProducer&&(this._hasPendingSend=!0),i.b.info("[%s] Sender '%s', sending encoded batch message.",this._context.connectionId,this.name),await this._trySendBatch(e,t),this._isIdempotentProducer&&(function(e){if(P(e))e._commitPublish();else for(const t of e)t._publishedSequenceNumber=t[C.a],delete t[C.a]}(e),this._localPublishingProperties)){const{lastPublishedSequenceNumber:e=0}=this._localPublishingProperties;this._localPublishingProperties.lastPublishedSequenceNumber=e+n}return}catch(t){throw function(e){if(P(e));else for(const t of e)delete t[C.a]}(e),i.b.warning(`An error occurred while sending the batch message ${null==t?void 0:t.name}: ${null==t?void 0:t.message}`),Object(i.a)(t),t}finally{this._isIdempotentProducer&&(this._hasPendingSend=!1)}}_populateLocalPublishingProperties(e){var t,n;const{[C.b.epoch]:r,[C.b.producerId]:i,[C.b.producerSequenceNumber]:o}=null!==(t=e.properties)&&void 0!==t?t:{};this._localPublishingProperties={isIdempotentPublishingEnabled:this._isIdempotentProducer,partitionId:null!==(n=this.partitionId)&&void 0!==n?n:"",lastPublishedSequenceNumber:o,ownerLevel:r,producerGroupId:i}}_deleteFromCache(){this._sender=void 0,delete this._context.senders[this.name],i.b.verbose("[%s] Deleted the sender '%s' with address '%s' from the client cache.",this._context.connectionId,this.name,this.address)}_createSenderOptions(e){e&&(this.name=""+Object(W.a)());const t={name:this.name,target:{address:this.address},onError:this._onAmqpError,onClose:this._onAmqpClose,onSessionError:this._onSessionError,onSessionClose:this._onSessionClose};if(this._isIdempotentProducer){t.desired_capabilities=C.b.capability;const e=function(e,t){let n,r,i;if(t)n=t.ownerLevel,r=t.producerGroupId,i=t.lastPublishedSequenceNumber;else{if(!e)return{};n=e.ownerLevel,r=e.producerGroupId,i=e.startingSequenceNumber}return{[C.b.epoch]:Object(c.b)(n)?g.types.wrap_short(n):null,[C.b.producerId]:Object(c.b)(r)?g.types.wrap_long(r):null,[C.b.producerSequenceNumber]:Object(c.b)(i)?g.types.wrap_int(i):null}}(this._userProvidedPublishingOptions,this._localPublishingProperties);t.properties=e}return i.b.verbose("Creating sender with options: %O",t),t}async _trySendBatch(e,t={}){const n=t.abortSignal,r=t.retryOptions||{},o=Object(B.a)(r);r.timeoutInMs=o;const s={operation:async()=>{var r,s;const c=Date.now(),u=await this._getLink(t),l=await this.getPartitionPublishingProperties(t),h=Date.now()-c;i.b.verbose("[%s] Sender '%s', credit: %d available: %d",this._context.connectionId,this.name,u.credit,u.session.outgoing.available());let d=1e3;if(!u.sendable()&&o-h>d?(i.b.verbose("%s Sender '%s', waiting for 1 second for sender to become sendable",this._context.connectionId,this.name),await Object(m.b)(d),i.b.verbose("%s Sender '%s' after waiting for a second, credit: %d available: %d",this._context.connectionId,this.name,u.credit,null===(s=null===(r=u.session)||void 0===r?void 0:r.outgoing)||void 0===s?void 0:s.available())):d=0,!u.sendable()){const e=`[${this._context.connectionId}] Sender "${this.name}", cannot send the message right now. Please try later.`;i.b.warning(e);const t={condition:a.b.SenderBusyError,description:e};throw Object(a.e)(t)}if(i.b.verbose("[%s] Sender '%s', sending message with id '%s'.",this._context.connectionId,this.name),o<=h+d){const e=`${this._context.connectionId} Sender "${this.name}" with address "${this.address}", was not able to send the message right now, due to operation timeout.`;i.b.warning(e);const t={condition:a.b.ServiceUnavailableError,description:e};throw Object(a.e)(t)}try{const r=function(e,t,n={}){var r;if(P(e))return e._generateMessage(t);{const i=e.length,o=[],s=null!==(r=n.tracingProperties)&&void 0!==r?r:[];for(let r=0;r<i;r++){const i=e[r],a=s[r],c=L(Object.assign(Object.assign({},i),{properties:Object.assign(Object.assign({},i.properties),a)}),n.partitionKey),{lastPublishedSequenceNumber:u=0}=t,l=u+1+r;z(c,Object.assign(Object.assign({},t),{publishSequenceNumber:l})),t.isIdempotentPublishingEnabled&&(i[C.a]=l),o.push(c)}const a={body:g.message.data_sections(o.map(g.message.encode))};return o[0].message_annotations&&(a.message_annotations=Object.assign({},o[0].message_annotations)),g.message.encode(a)}}(e,l,t),s=await u.send(r,{format:2147563264,timeoutInSeconds:(o-h-d)/1e3,abortSignal:n});i.b.info("[%s] Sender '%s', sent message with delivery id: %d",this._context.connectionId,this.name,s.id)}catch(e){const t=e.innerError||e;throw Object(R.e)(t)}},connectionId:this._context.connectionId,operationType:y.b.sendMessage,abortSignal:n,retryOptions:r};try{await Object(y.c)(s)}catch(e){const t=Object(a.e)(e);throw i.b.warning("[%s] Sender '%s', An error occurred while sending the message %s",this._context.connectionId,this.name,`${null==t?void 0:t.name}: ${null==t?void 0:t.message}`),Object(i.a)(t),t}}async _getLink(e={}){if(this.isOpen()&&this._sender)return this._sender;const t=e.retryOptions||{},n=Object(B.a)(t);t.timeoutInMs=n;const r=this._createSenderOptions(),o=Date.now(),s={operation:async()=>m.a.acquire(this.senderLock,()=>{const t=Date.now(),i=n-(t-o);return this._init(Object.assign(Object.assign({},r),{abortSignal:e.abortSignal,timeoutInMs:i}))},{abortSignal:e.abortSignal,timeoutInMs:n}),connectionId:this._context.connectionId,operationType:y.b.senderLink,abortSignal:e.abortSignal,retryOptions:t};try{return await Object(y.c)(s)}catch(e){const t=Object(a.e)(e);throw i.b.warning("[%s] An error occurred while creating the sender %s: %s",this._context.connectionId,this.name,`${null==t?void 0:t.name}: ${null==t?void 0:t.message}`),Object(i.a)(t),t}}async _init(e){try{if(this.isOpen()&&this._sender)return i.b.verbose("[%s] The sender '%s' with address '%s' is open -> %s. Hence not reconnecting.",this._context.connectionId,this.name,this.address,this.isOpen()),this._sender;{await this._context.readyToOpenLink(),await this._negotiateClaim({setTokenRenewal:!1,abortSignal:e.abortSignal,timeoutInMs:e.timeoutInMs}),i.b.verbose("[%s] Trying to create sender '%s'...",this._context.connectionId,this.name);const t=await this._context.connection.createAwaitableSender(e);return t.setMaxListeners(1e3),this._sender=t,this._populateLocalPublishingProperties(this._sender),this.isConnecting=!1,i.b.verbose("[%s] Sender '%s' created with sender options: %O",this._context.connectionId,this.name,e),this._context.senders[this.name]||(this._context.senders[this.name]=this),this._ensureTokenRenewal(),t}}catch(e){const t=Object(a.e)(e);throw i.b.warning("[%s] An error occurred while creating the sender %s: %s",this._context.connectionId,this.name,`${null==t?void 0:t.name}: ${null==t?void 0:t.message}`),Object(i.a)(t),t}}static create(e,t){const n=new Tt(e,t);return e.senders[n.name]||(e.senders[n.name]=n),e.senders[n.name]}}class Ct{constructor(e,t,n,r){this._context=ft(e,t,n,r),"string"!=typeof t?this._clientOptions=t||{}:Object(c.a)(n)?this._clientOptions=r||{}:this._clientOptions=n||{},this._sendersMap=new Map}get eventHubName(){return this._context.config.entityPath}get fullyQualifiedNamespace(){return this._context.config.host}async createBatch(e={}){var t;Object(R.c)(this._context);const n=Object(c.b)(e.partitionId)?String(e.partitionId):void 0;Object(R.f)({enableIdempotentRetries:this._enableIdempotentRetries,partitionId:n,partitionKey:e.partitionKey});let r=this._sendersMap.get(n||"");if(!r){const e=Object(c.b)(n)?null===(t=this._partitionOptions)||void 0===t?void 0:t[n]:void 0;r=Tt.create(this._context,{enableIdempotentProducer:Boolean(this._enableIdempotentRetries),partitionId:n,partitionPublishingOptions:e}),this._sendersMap.set(n||"",r)}let o=await r.getMaxMessageSize({retryOptions:this._clientOptions.retryOptions,abortSignal:e.abortSignal});if(e.maxSizeInBytes){if(e.maxSizeInBytes>o){const t=new Error(`Max message size (${e.maxSizeInBytes} bytes) is greater than maximum message size (${o} bytes) on the AMQP sender link.`);throw i.b.warning(`[${this._context.connectionId}] ${t.message}`),Object(i.a)(t),t}o=e.maxSizeInBytes}return new N(this._context,o,Boolean(this._enableIdempotentRetries),e.partitionKey,n)}async getPartitionPublishingProperties(e,t={}){var n;if(!Object(c.b)(e))throw new TypeError('getPartitionPublishingProperties called without required argument "partitionId"');"number"==typeof e&&(e=String(e));let r=this._sendersMap.get(e);return r||(r=Tt.create(this._context,{enableIdempotentProducer:Boolean(this._enableIdempotentRetries),partitionId:e,partitionPublishingOptions:null===(n=this._partitionOptions)||void 0===n?void 0:n[e]}),this._sendersMap.set(e,r)),r.getPartitionPublishingProperties(t)}async sendBatch(e,t={}){let n,r;Object(R.c)(this._context),Object(R.d)(this._context.connectionId,"sendBatch","batch",e);const i=[];let o=[];if(P(e)){if(this._enableIdempotentRetries&&Object(c.b)(e.startingPublishedSequenceNumber))throw new Error(R.a);const i=function(e,t){const n={},r=e.partitionId,i=e.partitionKey,{partitionId:o,partitionKey:s}=It(t);if(s&&i!==s)throw new Error(`The partitionKey (${s}) set on sendBatch does not match the partitionKey (${i}) set when creating the batch.`);if(o&&o!==r)throw new Error(`The partitionId (${o}) set on sendBatch does not match the partitionId (${r}) set when creating the batch.`);Object(c.b)(r)&&(n.partitionId=String(r));Object(c.b)(i)&&(n.partitionKey=String(i));return n}(e,t);n=i.partitionId,r=i.partitionKey,o=e._messageSpanContexts}else{if(Array.isArray(e)||(e=[e]),e.some(e=>Object(c.b)(e._publishedSequenceNumber)))throw new Error(R.b);const o=It(t);n=o.partitionId,r=o.partitionKey;for(let n=0;n<e.length;n++)e[n]=A(e[n],t,this._context.config.entityPath,this._context.config.host).event,i[n]=e[n].properties}return Object(R.f)({enableIdempotentRetries:this._enableIdempotentRetries,partitionId:n,partitionKey:r}),I.b.withSpan(`${Ct.name}.${this.sendBatch.name}`,t,t=>{var i;let o=this._sendersMap.get(n||"");if(!o){const e=Object(c.b)(n)?null===(i=this._partitionOptions)||void 0===i?void 0:i[n]:void 0;o=Tt.create(this._context,{enableIdempotentProducer:Boolean(this._enableIdempotentRetries),partitionId:n,partitionPublishingOptions:e}),this._sendersMap.set(n||"",o)}return o.send(e,Object.assign(Object.assign({},t),{partitionId:n,partitionKey:r,retryOptions:this._clientOptions.retryOptions}))},Object.assign({spanLinks:o.map(e=>({tracingContext:e}))},Object(I.a)(this._context.config,"client")))}async close(){await this._context.close();for(const e of this._sendersMap)await e[1].close();this._sendersMap.clear()}getEventHubProperties(e={}){return this._context.managementSession.getEventHubProperties(Object.assign(Object.assign({},e),{retryOptions:this._clientOptions.retryOptions}))}getPartitionIds(e={}){return this._context.managementSession.getEventHubProperties(Object.assign(Object.assign({},e),{retryOptions:this._clientOptions.retryOptions})).then(e=>e.partitionIds)}getPartitionProperties(e,t={}){return this._context.managementSession.getPartitionProperties(e,Object.assign(Object.assign({},t),{retryOptions:this._clientOptions.retryOptions}))}}function It(e={}){const t={},{partitionId:n,partitionKey:r}=e;return Object(c.b)(n)&&(t.partitionId=String(n)),Object(c.b)(r)&&(t.partitionKey=String(r)),t}class At{constructor(){this._resolvers=[],this._items=[]}size(){return this._items.length}shift(){const e=this._items.shift();return void 0!==e?Promise.resolve(e):new Promise(e=>this._resolvers.push(e))}push(e){this._resolveNextItem(e)||this._items.push(e)}_resolveNextItem(e){const t=this._resolvers.shift();return!!t&&(t(e),!0)}}function xt(){let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}}class Rt{constructor({loopAbortSignal:e,maxBufferSize:t,maxWaitTimeInMs:n,onSendEventsErrorHandler:r,onSendEventsSuccessHandler:i,partitionId:o,producer:s}){this._eventQueue=new At,this._batchedEvents=[],this._bufferCount=0,this._readyQueue=[],this._flushState={isFlushing:!1},this._isRunning=!1,this._lastBatchCreationTime=0,this._loopAbortSignal=e,this._maxBufferSize=t,this._maxWaitTimeInMs=n,this._onSendEventsErrorHandler=r,this._onSendEventsSuccessHandler=i,this._partitionId=o,this._producer=s}getCurrentBufferedCount(){return this._bufferCount}async enqueueEvent(e){await this._ready(),this._eventQueue.push(e),this._bufferCount++,this._isRunning||(this._isRunning=!0,this._startPublishLoop().catch(e=>{i.b.error("The following error occured during batch creation or sending: "+JSON.stringify(e,void 0,"  "))}))}async flush(e={}){const t=this._flushState;if(t.isFlushing)return t.currentPromise;if(0===this.getCurrentBufferedCount())return Promise.resolve();const{promise:n,resolve:r}=xt();return this._flushState={isFlushing:!0,currentPromise:n,resolve:r},n}_ready(){if(this.getCurrentBufferedCount()<this._maxBufferSize&&!this._readyQueue.length&&!this._flushState.isFlushing)return Promise.resolve();const{promise:e,reject:t,resolve:n}=xt();return this._readyQueue.push({resolve:n,reject:t}),e}async _startPublishLoop(){let e,t,n=this._eventQueue.shift();for(;!this._loopAbortSignal.aborted;)try{Object(c.b)(e)||(e=await this._createBatch());const r=Date.now()-this._lastBatchCreationTime,i=e.count?Math.max(this._maxWaitTimeInMs-r,0):this._maxWaitTimeInMs,o=null!=t?t:await Promise.race([n,Object(m.b)(i)]);if(!o){e.count&&(await this._producer.sendBatch(e),this._reportSuccess(),e=await this._createBatch());continue}t||(t=o,n=this._eventQueue.shift());const s=e.tryAdd(o);s&&(this._batchedEvents.push(o),t=void 0),(s&&e.count>=this._maxBufferSize||!s&&e.count)&&(await this._producer.sendBatch(e),this._reportSuccess(),e=await this._createBatch()),s||e.tryAdd(o)?s||this._batchedEvents.push(o):this._reportFailure(new Error("Placeholder for max message size exceeded"),o),t=void 0}catch(t){Object(c.c)(t,["name"])&&"AbortError"===t.name||(this._reportFailure(t),e=void 0,this._batchedEvents=[])}}async _createBatch(){this._lastBatchCreationTime=Date.now(),this._batchedEvents=[];const e=await this._producer.createBatch({partitionId:this._partitionId});return this._incrementReadiness(),e}_incrementReadiness(){var e;if(this._flushState.isFlushing)return;const t=this.getCurrentBufferedCount(),n=Math.min(this._maxBufferSize-t,this._readyQueue.length);for(let t=0;t<n;t++)null===(e=this._readyQueue.shift())||void 0===e||e.resolve()}_reportSuccess(){var e;this._bufferCount=this._bufferCount-this._batchedEvents.length,this._updateFlushState();try{null===(e=this._onSendEventsSuccessHandler)||void 0===e||e.call(this,{events:this._batchedEvents,partitionId:this._partitionId})}catch(e){i.b.error("The following error occurred in the onSendEventsSuccessHandler: "+JSON.stringify(e,void 0,"  "))}}_reportFailure(e,t){this._bufferCount=this._bufferCount-(t?1:this._batchedEvents.length),this._updateFlushState();try{this._onSendEventsErrorHandler({error:e,events:t?[t]:this._batchedEvents,partitionId:this._partitionId})}catch(e){i.b.error("The following error occurred in the onSendEventsErrorHandler: "+JSON.stringify(e,void 0,"  "))}}_updateFlushState(){const e=this._flushState;e.isFlushing&&0===this.getCurrentBufferedCount()&&(e.resolve(),this._flushState={isFlushing:!1},this._incrementReadiness())}}var Pt=n(105);class Nt{constructor(){this._partitions=[],this._lastRoundRobinPartitionIndex=-1}setPartitionIds(e){this._partitions=e}assignPartition({partitionId:e,partitionKey:t}){if(Object(c.b)(e)&&Object(c.b)(t))throw new Error(`The partitionId (${e}) and partitionKey (${t}) cannot both be specified.`);if(!this._partitions.length)throw new Error("Unable to determine partitionIds, can't assign partitionId.");return Object(c.b)(e)&&this._partitions.includes(e)?e:Object(c.b)(t)?Object(Pt.a)(t,this._partitions.length).toString():this._assignRoundRobinPartition()}_assignRoundRobinPartition(){const e=this._partitions.length-1,t=this._lastRoundRobinPartitionIndex+1,n=t>e?0:t;return this._lastRoundRobinPartitionIndex=n,this._partitions[n]}}class jt{constructor(e,t,n,i){this._abortController=new r.a,this._isClosed=!1,this._partitionAssigner=new Nt,this._partitionIds=[],this._partitionChannels=new Map,this._backgroundManagementInterval=1e4,this._isBackgroundManagementRunning=!1,"string"!=typeof t?(this._producer=new Ct(e,t),this._clientOptions=Object.assign({},t)):Object(c.a)(n)?(this._producer=new Ct(e,t,n,i),this._clientOptions=Object.assign({},i)):(this._producer=new Ct(e,t,n),this._clientOptions=Object.assign({},n)),this._producer._enableIdempotentRetries=this._clientOptions.enableIdempotentRetries}get eventHubName(){return this._producer.eventHubName}get fullyQualifiedNamespace(){return this._producer.fullyQualifiedNamespace}async close(e={}){i.b.verbose("closing buffered producer client..."),Object(c.b)(e.flush)&&!0!==e.flush||await this.flush(e),this._abortController.abort(),await this._producer.close(),this._isClosed=!0}async enqueueEvent(e,t={}){if(this._isClosed)throw new Error("This EventHubBufferedProducerClient has already been closed. Create a new client to enqueue events.");this._partitionIds.length||await this._updatePartitionIds(),this._isBackgroundManagementRunning||(this._startPartitionIdsUpdateLoop().catch(e=>{i.b.error("The following error occured during batch creation or sending: "+JSON.stringify(e,void 0,"  "))}),this._isBackgroundManagementRunning=!0);const n=this._partitionAssigner.assignPartition({partitionId:t.partitionId,partitionKey:t.partitionKey}),r=this._getPartitionChannel(n);return await r.enqueueEvent(e),this._getTotalBufferedEventsCount()}async enqueueEvents(e,t={}){for(const n of e)await this.enqueueEvent(n,t);return this._getTotalBufferedEventsCount()}async flush(e={}){await Promise.all(Array.from(this._partitionChannels.values()).map(t=>t.flush(e)))}getEventHubProperties(e={}){return this._producer.getEventHubProperties(e)}getPartitionIds(e={}){return this._producer.getPartitionIds(e)}getPartitionProperties(e,t={}){return this._producer.getPartitionProperties(e,t)}_getPartitionChannel(e){var t;const n=null!==(t=this._partitionChannels.get(e))&&void 0!==t?t:new Rt({loopAbortSignal:this._abortController.signal,maxBufferSize:this._clientOptions.maxEventBufferLengthPerPartition||1500,maxWaitTimeInMs:this._clientOptions.maxWaitTimeInMs||1e3,onSendEventsErrorHandler:this._clientOptions.onSendEventsErrorHandler,onSendEventsSuccessHandler:this._clientOptions.onSendEventsSuccessHandler,partitionId:e,producer:this._producer});return this._partitionChannels.set(e,n),n}_getTotalBufferedEventsCount(){let e=0;for(const[t,n]of this._partitionChannels)e+=n.getCurrentBufferedCount();return e}async _updatePartitionIds(){i.b.verbose("Checking for partition Id updates...");const e=await this.getPartitionIds();this._partitionIds.length!==e.length&&(i.b.verbose("Applying partition Id updates"),this._partitionIds=e,this._partitionAssigner.setPartitionIds(this._partitionIds))}async _startPartitionIdsUpdateLoop(){for(i.b.verbose("Starting a background loop to check and apply partition id updates...");!this._abortController.signal.aborted&&!this._isClosed;)await Object(m.b)(this._backgroundManagementInterval),this._isClosed||await this._updatePartitionIds()}}function Lt(e={}){return{produce:({data:t,contentType:n})=>Object.assign(Object.assign({},e),{body:t,contentType:n}),consume:e=>{const{body:t,contentType:n}=e;if(void 0===t)throw new Error("Expected the body field to be defined");if(void 0===n)throw new Error("Expected the contentType field to be defined");return{data:"object"==typeof t?Uint8Array.from(Object.values(t)):t,contentType:n}}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"SchemaRegistryClient",(function(){return K}));var r={};n.r(r),n.d(r,"SchemaGroups",(function(){return s})),n.d(r,"ErrorModel",(function(){return a})),n.d(r,"ErrorDetail",(function(){return c})),n.d(r,"SchemaVersions",(function(){return u})),n.d(r,"SchemaId",(function(){return l})),n.d(r,"SchemaGroupsListExceptionHeaders",(function(){return h})),n.d(r,"SchemaGetByIdHeaders",(function(){return d})),n.d(r,"SchemaGetByIdExceptionHeaders",(function(){return p})),n.d(r,"SchemaGetVersionsExceptionHeaders",(function(){return f})),n.d(r,"SchemaQueryIdByContentHeaders",(function(){return m})),n.d(r,"SchemaQueryIdByContentExceptionHeaders",(function(){return y})),n.d(r,"SchemaRegisterHeaders",(function(){return g})),n.d(r,"SchemaRegisterExceptionHeaders",(function(){return v}));var i=n(175),o=n(24);const s={type:{name:"Composite",className:"SchemaGroups",modelProperties:{schemaGroups:{serializedName:"schemaGroups",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},a={type:{name:"Composite",className:"ErrorModel",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorDetail"}}}}},c={type:{name:"Composite",className:"ErrorDetail",modelProperties:{code:{serializedName:"code",required:!0,type:{name:"String"}},message:{serializedName:"message",required:!0,type:{name:"String"}},details:{serializedName:"details",type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorDetail"}}}}}}},u={type:{name:"Composite",className:"SchemaVersions",modelProperties:{schemaVersions:{serializedName:"schemaVersions",type:{name:"Sequence",element:{type:{name:"Number"}}}}}}},l={type:{name:"Composite",className:"SchemaId",modelProperties:{id:{serializedName:"id",type:{name:"String"}}}}},h={type:{name:"Composite",className:"SchemaGroupsListExceptionHeaders",modelProperties:{xMsErrorCode:{serializedName:"x-ms-error-code",type:{name:"String"}}}}},d={type:{name:"Composite",className:"SchemaGetByIdHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},contentType:{serializedName:"content-type",type:{name:"String"}},schemaId:{serializedName:"schema-id",type:{name:"String"}},schemaIdLocation:{serializedName:"schema-id-location",type:{name:"String"}},schemaGroupName:{serializedName:"schema-group-name",type:{name:"String"}},schemaName:{serializedName:"schema-name",type:{name:"String"}},schemaVersion:{serializedName:"schema-version",type:{name:"Number"}}}}},p={type:{name:"Composite",className:"SchemaGetByIdExceptionHeaders",modelProperties:{xMsErrorCode:{serializedName:"x-ms-error-code",type:{name:"String"}}}}},f={type:{name:"Composite",className:"SchemaGetVersionsExceptionHeaders",modelProperties:{xMsErrorCode:{serializedName:"x-ms-error-code",type:{name:"String"}}}}},m={type:{name:"Composite",className:"SchemaQueryIdByContentHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},schemaId:{serializedName:"schema-id",type:{name:"String"}},schemaIdLocation:{serializedName:"schema-id-location",type:{name:"String"}},schemaGroupName:{serializedName:"schema-group-name",type:{name:"String"}},schemaName:{serializedName:"schema-name",type:{name:"String"}},schemaVersion:{serializedName:"schema-version",type:{name:"Number"}}}}},y={type:{name:"Composite",className:"SchemaQueryIdByContentExceptionHeaders",modelProperties:{xMsErrorCode:{serializedName:"x-ms-error-code",type:{name:"String"}}}}},g={type:{name:"Composite",className:"SchemaRegisterHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},schemaId:{serializedName:"schema-id",type:{name:"String"}},schemaIdLocation:{serializedName:"schema-id-location",type:{name:"String"}},schemaGroupName:{serializedName:"schema-group-name",type:{name:"String"}},schemaName:{serializedName:"schema-name",type:{name:"String"}},schemaVersion:{serializedName:"schema-version",type:{name:"Number"}}}}},v={type:{name:"Composite",className:"SchemaRegisterExceptionHeaders",modelProperties:{xMsErrorCode:{serializedName:"x-ms-error-code",type:{name:"String"}}}}},_={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},b={parameterPath:"endpoint",mapper:{serializedName:"endpoint",required:!0,type:{name:"String"}},skipEncoding:!0},w={parameterPath:"apiVersion",mapper:{defaultValue:"2021-10",isConstant:!0,serializedName:"api-version",type:{name:"String"}}},E={parameterPath:"groupName",mapper:{serializedName:"groupName",required:!0,type:{name:"String"}}},S={parameterPath:"schemaName",mapper:{constraints:{MaxLength:50},serializedName:"schemaName",required:!0,type:{name:"String"}}},k={parameterPath:"schemaContent",mapper:{serializedName:"schemaContent",required:!0,type:{name:"Stream"}}},O={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},T={parameterPath:"contentType",mapper:{serializedName:"Content-Type",required:!0,type:{name:"String"}}};class C{constructor(e){this.client=e}list(e){return this.client.sendOperationRequest({options:e},A)}}const I=o.b(r,!1),A={path:"/$schemaGroups",httpMethod:"GET",responses:{200:{bodyMapper:s},default:{bodyMapper:a,headersMapper:h}},queryParameters:[w],urlParameters:[b],headerParameters:[_],serializer:I};class x{constructor(e){this.client=e}getById(e,t){return this.client.sendOperationRequest({id:e,options:t},P)}getVersions(e,t,n){return this.client.sendOperationRequest({groupName:e,schemaName:t,options:n},N)}queryIdByContent(e,t,n,r,i){return this.client.sendOperationRequest({groupName:e,schemaName:t,contentType:n,schemaContent:r,options:i},j)}register(e,t,n,r,i){return this.client.sendOperationRequest({groupName:e,schemaName:t,contentType:n,schemaContent:r,options:i},L)}}const R=o.b(r,!1),P={path:"/$schemaGroups/$schemas/{id}",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:d},default:{bodyMapper:a,headersMapper:p}},queryParameters:[w],urlParameters:[b,{parameterPath:"id",mapper:{serializedName:"id",required:!0,type:{name:"String"}}}],headerParameters:[{parameterPath:"accept",mapper:{defaultValue:"application/json; serialization=Avro",isConstant:!0,serializedName:"Accept",type:{name:"String"}}}],serializer:R},N={path:"/$schemaGroups/{groupName}/schemas/{schemaName}/versions",httpMethod:"GET",responses:{200:{bodyMapper:u},default:{bodyMapper:a,headersMapper:f}},queryParameters:[w],urlParameters:[b,E,S],headerParameters:[_],serializer:R},j={path:"/$schemaGroups/{groupName}/schemas/{schemaName}:get-id",httpMethod:"POST",responses:{204:{headersMapper:m},415:{bodyMapper:a,headersMapper:y,isError:!0},default:{bodyMapper:a,headersMapper:y}},requestBody:k,queryParameters:[w],urlParameters:[b,E,S],headerParameters:[O,T],mediaType:"binary",serializer:R},L={path:"/$schemaGroups/{groupName}/schemas/{schemaName}",httpMethod:"PUT",responses:{204:{headersMapper:g},415:{bodyMapper:a,headersMapper:v,isError:!0},default:{bodyMapper:a,headersMapper:v}},requestBody:k,queryParameters:[w],urlParameters:[b,E,S],headerParameters:[O,T],mediaType:"binary",serializer:R};class M extends i.a{constructor(e,t){var n,r;if(void 0===e)throw new Error("'endpoint' cannot be null");t||(t={});const i=t.userAgentOptions&&t.userAgentOptions.userAgentPrefix?t.userAgentOptions.userAgentPrefix+" azsdk-js-schema-registry/1.1.0":"azsdk-js-schema-registry/1.1.0";super(Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8"}),t),{userAgentOptions:{userAgentPrefix:i},baseUri:null!==(r=null!==(n=t.endpoint)&&void 0!==n?n:t.baseUri)&&void 0!==r?r:"https://{endpoint}"})),this.endpoint=e,this.apiVersion=t.apiVersion||"2021-10",this.schemaGroupsOperations=new C(this),this.schema=new x(this)}}var q=n(176),z=n(181);async function U(e){return async function(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=()=>n,r.readAsText(e)})}(await e.blobBody)}async function B(e){return{definition:await U(e),properties:{id:e.schemaId,format:F(e.contentType),groupName:e.schemaGroupName,name:e.schemaName}}}function D(e){return t=>({id:t.schemaId,format:e,groupName:t.schemaGroupName,name:t.schemaName})}function F(e){const t=/.*serialization=(.*)$/.exec(e),n=null==t?void 0:t[1];if(n)return n;throw new Error("Unrecognized response's content-type: "+e)}var H=n(13);const $=Object(H.a)("schema-registry");class K{constructor(e,t,n={}){this.fullyQualifiedNamespace=e;const r=Object.assign(Object.assign({},n),{loggingOptions:{logger:$.info}});this._client=new M(this.fullyQualifiedNamespace,Object.assign({endpoint:this.fullyQualifiedNamespace,apiVersion:n.apiVersion},r)),this._tracing=Object(q.a)({namespace:"Microsoft.EventHub",packageName:"@azure/schema-registry",packageVersion:"1.1.0"});const i=Object(z.a)({credential:t,scopes:"https://eventhubs.azure.net/.default"});this._client.pipeline.addPolicy(i)}registerSchema(e,t={}){const{groupName:n,name:r,definition:i,format:o}=e;return this._tracing.withSpan("SchemaRegistryClient.registerSchema",t,e=>this._client.schema.register(n,r,"application/json; serialization="+o,i,e).then(D(o)))}getSchemaProperties(e,t={}){const{groupName:n,name:r,definition:i,format:o}=e;return this._tracing.withSpan("SchemaRegistryClient.getSchemaProperties",t,e=>this._client.schema.queryIdByContent(n,r,"application/json; serialization="+o,i,e).then(D(o)))}getSchema(e,t={}){return this._tracing.withSpan("SchemaRegistryClient.getSchema",t,t=>this._client.schema.getById(e,t).then(B))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return Z}));var r=n(77),i=n(7);function o(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function s(e){if(o(e)){const t="string"==typeof e.name,n="string"==typeof e.message;return t&&n}return!1}function a(e){if(s(e))return e.message;{let t;try{t="object"==typeof e&&e?JSON.stringify(e):String(e)}catch(e){t="[unable to stringify input]"}return"Unknown error "+t}}const c={},u=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],l=["api-version"];class h{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=u.concat(e),t=l.concat(t),this.allowedHeaderNames=new Set(e.map(e=>e.toLowerCase())),this.allowedQueryParameters=new Set(t.map(e=>e.toLowerCase()))}sanitize(e){const t=new Set;return JSON.stringify(e,(e,n)=>{if(n instanceof Error)return Object.assign(Object.assign({},n),{name:n.name,message:n.message});if("headers"===e)return this.sanitizeHeaders(n);if("url"===e)return this.sanitizeUrl(n);if("query"===e)return this.sanitizeQuery(n);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(n)||o(n)){if(t.has(n))return"[Circular]";t.add(n)}return n}},2)}sanitizeHeaders(e){const t={};for(const n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]="REDACTED";return t}sanitizeQuery(e){if("object"!=typeof e||null===e)return e;const t={};for(const n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]="REDACTED";return t}sanitizeUrl(e){if("string"!=typeof e||null===e)return e;const t=new URL(e);if(!t.search)return e;for(const[e]of t.searchParams)this.allowedQueryParameters.has(e.toLowerCase())||t.searchParams.set(e,"REDACTED");return t.toString()}}const d=new h;class p extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,this.request=t.request,this.response=t.response,Object.setPrototypeOf(this,p.prototype)}[c](){return`RestError: ${this.message} \n ${d.sanitize(this)}`}}p.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",p.PARSE_ERROR="PARSE_ERROR";var f=n(24);function m(e,t,n){let r=t.parameterPath;const i=t.mapper;let o;if("string"==typeof r&&(r=[r]),Array.isArray(r)){if(r.length>0)if(i.isConstant)o=i.defaultValue;else{let t=y(e,r);!t.propertyFound&&n&&(t=y(n,r));let s=!1;t.propertyFound||(s=i.required||"options"===r[0]&&2===r.length),o=s?i.defaultValue:t.propertyValue}}else{i.required&&(o={});for(const t in r){const s=i.type.modelProperties[t],a=m(e,{parameterPath:r[t],mapper:s},n);void 0!==a&&(o||(o={}),o[t]=a)}}return o}function y(e,t){const n={propertyFound:!1};let r=0;for(;r<t.length;++r){const n=t[r];if(!e||!(n in e))break;e=e[n]}return r===t.length&&(n.propertyValue=e,n.propertyFound=!0),n}const g=new WeakMap;function v(e){let t=g.get(e);return t||(t={},g.set(e,t)),t}const _=["application/json","text/json"],b=["application/xml","application/atom+xml"];function w(e={}){var t,n,r,o,s,a,c;const u=null!==(n=null===(t=e.expectedContentTypes)||void 0===t?void 0:t.json)&&void 0!==n?n:_,l=null!==(o=null===(r=e.expectedContentTypes)||void 0===r?void 0:r.xml)&&void 0!==o?o:b,h=e.parseXML,d=e.serializerOptions,m={xml:{rootName:null!==(s=null==d?void 0:d.xml.rootName)&&void 0!==s?s:"",includeRoot:null!==(a=null==d?void 0:d.xml.includeRoot)&&void 0!==a&&a,xmlCharKey:null!==(c=null==d?void 0:d.xml.xmlCharKey)&&void 0!==c?c:i.b}};return{name:"deserializationPolicy",async sendRequest(e,t){const n=await t(e);return async function(e,t,n,r,i){const o=await async function(e,t,n,r,i){var o;if(!(null===(o=n.request.streamResponseStatusCodes)||void 0===o?void 0:o.has(n.status))&&n.bodyAsText){const o=n.bodyAsText,s=n.headers.get("Content-Type")||"",a=s?s.split(";").map(e=>e.toLowerCase()):[];try{if(0===a.length||a.some(t=>-1!==e.indexOf(t)))return n.parsedBody=JSON.parse(o),n;if(a.some(e=>-1!==t.indexOf(e))){if(!i)throw new Error("Parsing XML not supported.");const e=await i(o,r.xml);return n.parsedBody=e,n}}catch(e){const t=`Error "${e}" occurred while parsing the response body - ${n.bodyAsText}.`,r=e.code||p.PARSE_ERROR;throw new p(t,{code:r,statusCode:n.status,request:n.request,response:n})}}return n}(e,t,n,r,i);if(!function(e){const t=v(e.request),n=null==t?void 0:t.shouldDeserialize;let r;r=void 0===n||("boolean"==typeof n?n:n(e));return r}(o))return o;const s=v(o.request),a=null==s?void 0:s.operationSpec;if(!a||!a.responses)return o;const c=function(e){let t;const n=v(e.request),r=null==n?void 0:n.operationSpec;r&&(t=(null==n?void 0:n.operationResponseGetter)?null==n?void 0:n.operationResponseGetter(r,e):r.responses[e.status]);return t}(o),{error:u,shouldReturnResponse:l}=function(e,t,n){var r;const i=200<=e.status&&e.status<300;if(function(e){const t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?i:n){if(!n)return{error:null,shouldReturnResponse:!1};if(!n.isError)return{error:null,shouldReturnResponse:!1}}const o=null!=n?n:t.responses.default,s=(null===(r=e.request.streamResponseStatusCodes)||void 0===r?void 0:r.has(e.status))?"Unexpected status code: "+e.status:e.bodyAsText,a=new p(s,{statusCode:e.status,request:e.request,response:e});if(!o)throw a;const c=o.bodyMapper,u=o.headersMapper;try{if(e.parsedBody){const n=e.parsedBody;let r;if(c){let e=n;if(t.isXML&&c.type.name===f.a.Sequence){e=[];const t=c.xmlElementName;"object"==typeof n&&t&&(e=n[t])}r=t.serializer.deserialize(c,e,"error.response.parsedBody")}const i=n.error||r||n;a.code=i.code,i.message&&(a.message=i.message),c&&(a.response.parsedBody=r)}e.headers&&u&&(a.response.parsedHeaders=t.serializer.deserialize(u,e.headers.toJSON(),"operationRes.parsedHeaders"))}catch(t){a.message=`Error "${t.message}" occurred in deserializing the responseBody - "${e.bodyAsText}" for the default response.`}return{error:a,shouldReturnResponse:!1}}(o,a,c);if(u)throw u;if(l)return o;if(c){if(c.bodyMapper){let e=o.parsedBody;a.isXML&&c.bodyMapper.type.name===f.a.Sequence&&(e="object"==typeof e?e[c.bodyMapper.xmlElementName]:[]);try{o.parsedBody=a.serializer.deserialize(c.bodyMapper,e,"operationRes.parsedBody")}catch(e){throw new p(`Error ${e} occurred in deserializing the responseBody - ${o.bodyAsText}`,{statusCode:o.status,request:o.request,response:o})}}else"HEAD"===a.httpMethod&&(o.parsedBody=n.status>=200&&n.status<300);c.headersMapper&&(o.parsedHeaders=a.serializer.deserialize(c.headersMapper,o.headers.toJSON(),"operationRes.parsedHeaders"))}return o}(u,l,n,m,h)}}}var E=n(13);const S=Object(E.a)("core-rest-pipeline");const k=new Set(["Deserialize","Serialize","Retry","Sign"]);class O{constructor(e=[]){this._policies=[],this._policies=e,this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!k.has(t.phase))throw new Error("Invalid phase name: "+t.phase);if(t.afterPhase&&!k.has(t.afterPhase))throw new Error("Invalid afterPhase name: "+t.afterPhase);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter(n=>!(e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase)||(t.push(n.policy),!1)),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight((e,t)=>n=>t.sendRequest(n,e),t=>e.sendRequest(t))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new O(this._policies)}static create(){return new O}orderPolicies(){const e=[],t=new Map;function n(e){return{name:e,policies:new Set,hasRun:!1}}const r=n("Serialize"),i=n("None"),o=n("Deserialize"),s=n("Retry"),a=n("Sign"),c=[r,i,o,s,a];function u(e){return"Retry"===e?s:"Serialize"===e?r:"Deserialize"===e?o:"Sign"===e?a:i}for(const e of this._policies){const n=e.policy,r=e.options,i=n.name;if(t.has(i))throw new Error("Duplicate policy names not allowed in pipeline");const o={policy:n,dependsOn:new Set,dependants:new Set};r.afterPhase&&(o.afterPhase=u(r.afterPhase)),t.set(i,o);u(r.phase).policies.add(o)}for(const e of this._policies){const{policy:n,options:r}=e,i=n.name,o=t.get(i);if(!o)throw new Error("Missing node for policy "+i);if(r.afterPolicies)for(const e of r.afterPolicies){const n=t.get(e);n&&(o.dependsOn.add(n),n.dependants.add(o))}if(r.beforePolicies)for(const e of r.beforePolicies){const n=t.get(e);n&&(n.dependsOn.add(o),o.dependants.add(n))}}function l(n){n.hasRun=!0;for(const r of n.policies)if((!r.afterPhase||r.afterPhase.hasRun&&!r.afterPhase.policies.size)&&0===r.dependsOn.size){e.push(r.policy);for(const e of r.dependants)e.dependsOn.delete(r);t.delete(r.policy.name),n.policies.delete(r)}}function h(){for(const e of c)if(l(e),e.policies.size>0&&e!==i)return void(i.hasRun||l(i))}let d=0;for(;t.size>0;){d++;const t=e.length;if(h(),e.length<=t&&d>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}function T(e){const t=new Map;t.set("core-rest-pipeline","1.9.0"),function(e){const t=self.navigator;e.set("OS",(t.oscpu||t.platform).replace(" ",""))}(t);const n=function(e){const t=[];for(const[n,r]of e){const e=r?`${n}/${r}`:n;t.push(e)}return t.join(" ")}(t);return e?`${e} ${n}`:n}new Error("decompressResponsePolicy is not supported in browser environment");var C=n(39);const I=["retry-after-ms","x-ms-retry-after-ms","Retry-After"];function A(e){if(e&&[429,503].includes(e.status))try{for(const t of I){const n=Object(C.b)(e,t);if(0===n||n){return n*("Retry-After"===t?1e3:1)}}const t=e.headers.get("Retry-After");if(!t)return;const n=Date.parse(t)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch(e){return}}function x(e={}){var t,n;const r=null!==(t=e.retryDelayInMs)&&void 0!==t?t:1e3,i=null!==(n=e.maxRetryDelayInMs)&&void 0!==n?n:64e3;let o=r;return{name:"exponentialRetryStrategy",retry({retryCount:t,response:n,responseError:r}){const s=function(e){if(!e)return!1;return"ETIMEDOUT"===e.code||"ESOCKETTIMEDOUT"===e.code||"ECONNREFUSED"===e.code||"ECONNRESET"===e.code||"ENOENT"===e.code}(r),a=s&&e.ignoreSystemErrors,c=function(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(n),u=c&&e.ignoreHttpStatusCodes;if(n&&(function(e){return Number.isFinite(A(e))}(n)||!c)||u||a)return{skipStrategy:!0};if(r&&!s&&!c)return{errorToThrow:r};const l=o*Math.pow(2,t),h=Math.min(i,l);var d,p;return o=h/2+(d=0,p=h/2,d=Math.ceil(d),p=Math.floor(p),Math.floor(Math.random()*(p-d+1))+d),{retryAfterInMs:o}}}}var R=n(51);const P=Object(E.a)("core-rest-pipeline retryPolicy");function N(e,t={maxRetries:3}){const n=t.logger||P;return{name:"retryPolicy",async sendRequest(r,i){var o,s;let a,c,u=-1;e:for(;;){u+=1,a=void 0,c=void 0;try{n.info(`Retry ${u}: Attempting to send request`,r.requestId),a=await i(r),n.info(`Retry ${u}: Received a response from request`,r.requestId)}catch(e){if(n.error(`Retry ${u}: Received an error from request`,r.requestId),c=e,!e||"RestError"!==c.name)throw e;a=c.response}if(null===(o=r.abortSignal)||void 0===o?void 0:o.aborted){n.error(`Retry ${u}: Request aborted.`);throw new R.b}if(u>=(null!==(s=t.maxRetries)&&void 0!==s?s:3)){if(n.info(`Retry ${u}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),c)throw c;if(a)return a;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${u}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||P;e.info(`Retry ${u}: Processing retry strategy ${t.name}.`);const n=t.retry({retryCount:u,response:a,responseError:c});if(n.skipStrategy){e.info(`Retry ${u}: Skipped.`);continue t}const{errorToThrow:i,retryAfterInMs:o,redirectTo:s}=n;if(i)throw e.error(`Retry ${u}: Retry strategy ${t.name} throws error:`,i),i;if(o||0===o){e.info(`Retry ${u}: Retry strategy ${t.name} retries after ${o}`),await Object(C.a)(o,void 0,{abortSignal:r.abortSignal});continue e}if(s){e.info(`Retry ${u}: Retry strategy ${t.name} redirects to ${s}`),r.url=s;continue e}}if(c)throw n.info("None of the retry strategies could work with the received error. Throwing it."),c;if(a)return n.info("None of the retry strategies could work with the received response. Returning it."),a}}}}new Error("proxyPolicy is not supported in browser environment");var j=n(176);function L(e={}){const t=T(e.userAgentPrefix),n=function(){try{return Object(j.a)({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:"1.9.0"})}catch(e){return void S.warning("Error when creating the TracingClient: "+a(e))}}();return{name:"tracingPolicy",async sendRequest(e,r){var i,o;if(!n||!(null===(i=e.tracingOptions)||void 0===i?void 0:i.tracingContext))return r(e);const{span:c,tracingContext:u}=null!==(o=function(e,t,n){try{const{span:r,updatedOptions:i}=e.startSpan("HTTP "+t.method,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":t.method,"http.url":t.url,requestId:t.requestId}});if(!r.isRecording())return void r.end();n&&r.setAttribute("http.user_agent",n);const o=e.createRequestHeaders(i.tracingOptions.tracingContext);for(const[e,n]of Object.entries(o))t.headers.set(e,n);return{span:r,tracingContext:i.tracingOptions.tracingContext}}catch(e){return void S.warning("Skipping creating a tracing span due to an error: "+a(e))}}(n,e,t))&&void 0!==o?o:{};if(!c||!u)return r(e);try{const t=await n.withContext(u,r,e);return function(e,t){try{e.setAttribute("http.status_code",t.status);const n=t.headers.get("x-ms-request-id");n&&e.setAttribute("serviceRequestId",n),e.setStatus({status:"success"}),e.end()}catch(e){S.warning("Skipping tracing span processing due to an error: "+a(e))}}(c,t),t}catch(e){throw function(e,t){try{e.setStatus({status:"error",error:s(t)?t:void 0}),((n=t)instanceof p||s(n)&&"RestError"===n.name)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(n){S.warning("Skipping tracing span processing due to an error: "+a(n))}var n}(c,e),e}}}}function M(e){const t=O.create();return t.addPolicy({name:"formDataPolicy",async sendRequest(e,t){if(e.formData){const t=e.formData,n=new FormData;for(const e of Object.keys(t)){const r=t[e];if(Array.isArray(r))for(const t of r)n.append(e,t);else n.append(e,r)}e.body=n,e.formData=void 0;const r=e.headers.get("Content-Type");r&&-1!==r.indexOf("application/x-www-form-urlencoded")?e.body=new URLSearchParams(n).toString():r&&-1!==r.indexOf("multipart/form-data")&&e.headers.delete("Content-Type")}return t(e)}}),t.addPolicy(function(e={}){const t=T(e.userAgentPrefix);return{name:"userAgentPolicy",sendRequest:async(e,n)=>(e.headers.has("x-ms-useragent")||e.headers.set("x-ms-useragent",t),n(e))}}(e.userAgentOptions)),t.addPolicy(function(e="x-ms-client-request-id"){return{name:"setClientRequestIdPolicy",sendRequest:async(t,n)=>(t.headers.has(e)||t.headers.set(e,t.requestId),n(t))}}()),t.addPolicy(function(e={}){var t;return{name:"defaultRetryPolicy",sendRequest:N([{name:"throttlingRetryStrategy",retry({response:e}){const t=A(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}},x(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:3}).sendRequest}}(e.retryOptions),{phase:"Retry"}),t.addPolicy(L(e.userAgentOptions),{afterPhase:"Retry"}),t.addPolicy(function(e={}){var t;const n=null!==(t=e.logger)&&void 0!==t?t:S.info,r=new h({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:"logPolicy",async sendRequest(e,t){if(!n.enabled)return t(e);n("Request: "+r.sanitize(e));const i=await t(e);return n("Response status code: "+i.status),n("Headers: "+r.sanitize(i.headers)),i}}}(e.loggingOptions),{afterPhase:"Retry"}),t}var q=n(181);function z(e){const{parameterPath:t,mapper:n}=e;let r;return r="string"==typeof t?t:Array.isArray(t)?t.join("."):n.serializedName,r}function U(e={}){const t=e.stringifyXML;return{name:"serializationPolicy",async sendRequest(e,n){const r=v(e),o=null==r?void 0:r.operationSpec,s=null==r?void 0:r.operationArguments;return o&&s&&(function(e,t,n){var r,i;if(n.headerParameters)for(const r of n.headerParameters){let i=m(t,r);if(null!=i||r.mapper.required){i=n.serializer.serialize(r.mapper,i,z(r));const t=r.mapper.headerCollectionPrefix;if(t)for(const n of Object.keys(i))e.headers.set(t+n,i[n]);else e.headers.set(r.mapper.serializedName||z(r),i)}}const o=null===(i=null===(r=t.options)||void 0===r?void 0:r.requestOptions)||void 0===i?void 0:i.customHeaders;if(o)for(const t of Object.keys(o))e.headers.set(t,o[t])}(e,s,o),function(e,t,n,r=function(){throw new Error("XML serialization unsupported!")}){var o,s,a,c,u;const l=null===(o=t.options)||void 0===o?void 0:o.serializerOptions,h={xml:{rootName:null!==(s=null==l?void 0:l.xml.rootName)&&void 0!==s?s:"",includeRoot:null!==(a=null==l?void 0:l.xml.includeRoot)&&void 0!==a&&a,xmlCharKey:null!==(c=null==l?void 0:l.xml.xmlCharKey)&&void 0!==c?c:i.b}},d=h.xml.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){e.body=m(t,n.requestBody);const o=n.requestBody.mapper,{required:s,serializedName:a,xmlName:c,xmlElementName:l,xmlNamespace:p,xmlNamespacePrefix:y,nullable:g}=o,v=o.type.name;try{if(void 0!==e.body&&null!==e.body||g&&null===e.body||s){const t=z(n.requestBody);e.body=n.serializer.serialize(o,e.body,t,h);const s=v===f.a.Stream;if(n.isXML){const t=y?"xmlns:"+y:"xmlns",n=function(e,t,n,r,o){if(e&&!["Composite","Sequence","Dictionary"].includes(n)){const n={};return n[o.xml.xmlCharKey]=r,n[i.a]={[t]:e},n}return r}(p,t,v,e.body,h);v===f.a.Sequence?e.body=r(function(e,t,n,r){Array.isArray(e)||(e=[e]);if(!n||!r)return{[t]:e};const o={[t]:e};return o[i.a]={[n]:r},o}(n,l||c||a,t,p),{rootName:c||a,xmlCharKey:d}):s||(e.body=r(n,{rootName:c||a,xmlCharKey:d}))}else{if(v===f.a.String&&((null===(u=n.contentType)||void 0===u?void 0:u.match("text/plain"))||"text"===n.mediaType))return;s||(e.body=JSON.stringify(e.body))}}}catch(e){throw new Error(`Error "${e.message}" occurred in serializing the payload - ${JSON.stringify(a,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){e.formData={};for(const r of n.formDataParameters){const i=m(t,r);if(null!=i){const t=r.mapper.serializedName||z(r);e.formData[t]=n.serializer.serialize(r.mapper,i,z(r),h)}}}}(e,s,o,t)),n(e)}}}var B=n(42),D=n(30);function F(e){return Boolean(e&&"function"==typeof e.getReader&&"function"==typeof e.tee)}class H{async sendRequest(e){if("https:"!==new URL(e.url).protocol&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await async function(e){const{abortController:t,abortControllerCleanup:n}=function(e){const t=new AbortController;let n,r;if(e.abortSignal){if(e.abortSignal.aborted)throw new R.b("The operation was aborted.");r=e=>{"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",r),n=()=>{var t;r&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",r))}}e.timeout>0&&setTimeout(()=>{t.abort()},e.timeout);return{abortController:t,abortControllerCleanup:n}}(e);try{const r=function(e){const t=new Headers;for(const[n,r]of e)t.append(n,r);return t}(e.headers),i=function(e){const t="function"==typeof e.body?e.body():e.body;if(function(e){return e&&"function"==typeof e.pipe}(t))throw new Error("Node streams are not supported in browser environment.");return F(t)?$(t,e.onUploadProgress):t}(e);return async function(e,t){var n,r;const i=function(e){const t=Object(D.a)();for(const[n,r]of e.headers)t.set(n,r);return t}(e),o={request:t,headers:i,status:e.status},s=F(e.body)?$(e.body,t.onDownloadProgress):e.body;if((null===(n=t.streamResponseStatusCodes)||void 0===n?void 0:n.has(Number.POSITIVE_INFINITY))||(null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(o.status)))if(t.enableBrowserStreams)o.browserStreamBody=null!=s?s:void 0;else{const e=new Response(s);o.blobBody=e.blob()}else{const e=new Response(s);o.bodyAsText=await e.text()}return o}(await fetch(e.url,{body:i,method:e.method,headers:r,signal:t.signal,credentials:e.withCredentials?"include":"same-origin",cache:"no-store"}),e)}finally{n&&n()}}(e)}catch(t){throw function(e,t){var n;return e&&"AbortError"===(null==e?void 0:e.name)?e:new p("Error sending request: "+e.message,{code:null!==(n=null==e?void 0:e.code)&&void 0!==n?n:p.REQUEST_SEND_ERROR,request:t})}(t,e)}}}function $(e,t){let n=0;if(function(e){return void 0!==e.pipeThrough&&void 0!==self.TransformStream}(e))return e.pipeThrough(new TransformStream({transform(e,r){null!==e?(r.enqueue(e),n+=e.length,t&&t({loadedBytes:n})):r.terminate()}}));{const r=e.getReader();return new ReadableStream({async pull(e){var i;const{done:o,value:s}=await r.read();if(o||!s)return e.close(),void r.releaseLock();n+=null!==(i=null==s?void 0:s.length)&&void 0!==i?i:0,e.enqueue(s),t&&t({loadedBytes:n})}})}}function K(){return new H}let W;const V={CSV:",",SSV:" ",Multi:"Multi",TSV:"\t",Pipes:"|"};function G(e,t,n,r){const i=function(e,t,n){var r;const i=new Map;if(null===(r=e.urlParameters)||void 0===r?void 0:r.length)for(const r of e.urlParameters){let o=m(t,r,n);const s=z(r);o=e.serializer.serialize(r.mapper,o,s),r.skipEncoding||(o=encodeURIComponent(o)),i.set(`{${r.mapper.serializedName||s}}`,o)}return i}(t,n,r);let o=!1,s=Y(e,i);if(t.path){let e=Y(t.path,i);"/{nextLink}"===t.path&&e.startsWith("/")&&(e=e.substring(1)),e.includes("://")?(s=e,o=!0):s=function(e,t){if(!t)return e;const n=new URL(e);let r=n.pathname;r.endsWith("/")||(r+="/");t.startsWith("/")&&(t=t.substring(1));const i=t.indexOf("?");if(-1!==i){const e=t.substring(0,i),o=t.substring(i+1);r+=e,o&&(n.search=n.search?`${n.search}&${o}`:o)}else r+=t;return n.pathname=r,n.toString()}(s,e)}const{queryParams:a,sequenceParams:c}=function(e,t,n){var r;const i=new Map,o=new Set;if(null===(r=e.queryParameters)||void 0===r?void 0:r.length)for(const r of e.queryParameters){"Sequence"===r.mapper.type.name&&r.mapper.serializedName&&o.add(r.mapper.serializedName);let s=m(t,r,n);if(null!=s||r.mapper.required){s=e.serializer.serialize(r.mapper,s,z(r));const t=r.collectionFormat?V[r.collectionFormat]:"";if(Array.isArray(s)&&(s=s.map(e=>null==e?"":e)),"Multi"===r.collectionFormat&&0===s.length)continue;!Array.isArray(s)||"SSV"!==r.collectionFormat&&"TSV"!==r.collectionFormat||(s=s.join(t)),r.skipEncoding||(s=Array.isArray(s)?s.map(e=>encodeURIComponent(e)):encodeURIComponent(s)),!Array.isArray(s)||"CSV"!==r.collectionFormat&&"Pipes"!==r.collectionFormat||(s=s.join(t)),i.set(r.mapper.serializedName||z(r),s)}}return{queryParams:i,sequenceParams:o}}(t,n,r);return s=function(e,t,n,r=!1){if(0===t.size)return e;const i=new URL(e),o=function(e){const t=new Map;if(!e||"?"!==e[0])return t;const n=(e=e.slice(1)).split("&");for(const e of n){const[n,r]=e.split("=",2),i=t.get(n);i?Array.isArray(i)?i.push(r):t.set(n,[i,r]):t.set(n,r)}return t}(i.search);for(const[e,i]of t){const t=o.get(e);if(Array.isArray(t))if(Array.isArray(i)){t.push(...i);const n=new Set(t);o.set(e,Array.from(n))}else t.push(i);else t?(Array.isArray(i)?i.unshift(t):n.has(e)&&o.set(e,[t,i]),r||o.set(e,i)):o.set(e,i)}const s=[];for(const[e,t]of o)if("string"==typeof t)s.push(`${e}=${t}`);else if(Array.isArray(t))for(const n of t)s.push(`${e}=${n}`);else s.push(`${e}=${t}`);return i.search=s.length?"?"+s.join("&"):"",i.toString()}(s,a,c,o),s}function Y(e,t){let n=e;for(const[e,r]of t)n=n.split(e).join(r);return n}const J=Object(E.a)("core-client");class Z{constructor(e={}){var t,n;if(this._requestContentType=e.requestContentType,this._endpoint=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri,e.baseUri&&J.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||(W||(W=K()),W),this.pipeline=e.pipeline||function(e){const t=function(e){if(e.credentialScopes){const t=e.credentialScopes;return Array.isArray(t)?t.map(e=>new URL(e).toString()):new URL(t).toString()}if(e.endpoint)return e.endpoint+"/.default";if(e.baseUri)return e.baseUri+"/.default";if(e.credential&&!e.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy");return}(e),n=e.credential&&t?{credentialScopes:t,credential:e.credential}:void 0;return function(e={}){const t=M(null!=e?e:{});return e.credentialOptions&&t.addPolicy(Object(q.a)({credential:e.credentialOptions.credential,scopes:e.credentialOptions.credentialScopes})),t.addPolicy(U(e.serializationOptions),{phase:"Serialize"}),t.addPolicy(w(e.deserializationOptions),{phase:"Deserialize"}),t}(Object.assign(Object.assign({},e),{credentialOptions:n}))}(e),null===(n=e.additionalPolicies)||void 0===n?void 0:n.length)for(const{policy:t,position:n}of e.additionalPolicies){const e="perRetry"===n?"Sign":void 0;this.pipeline.addPolicy(t,{afterPhase:e})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){const n=t.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const i=G(n,t,e,this),o=Object(r.a)({url:i});o.method=t.httpMethod;const s=v(o);s.operationSpec=t,s.operationArguments=e;const a=t.contentType||this._requestContentType;a&&t.requestBody&&o.headers.set("Content-Type",a);const c=e.options;if(c){const e=c.requestOptions;e&&(e.timeout&&(o.timeout=e.timeout),e.onUploadProgress&&(o.onUploadProgress=e.onUploadProgress),e.onDownloadProgress&&(o.onDownloadProgress=e.onDownloadProgress),void 0!==e.shouldDeserialize&&(s.shouldDeserialize=e.shouldDeserialize),e.allowInsecureConnection&&(o.allowInsecureConnection=!0)),c.abortSignal&&(o.abortSignal=c.abortSignal),c.tracingOptions&&(o.tracingOptions=c.tracingOptions)}this._allowInsecureConnection&&(o.allowInsecureConnection=!0),void 0===o.streamResponseStatusCodes&&(o.streamResponseStatusCodes=function(e){const t=new Set;for(const n in e.responses){const r=e.responses[n];r.bodyMapper&&r.bodyMapper.type.name===f.a.Stream&&t.add(Number(n))}return t}(t));try{const e=await this.sendRequest(o),n=Object(B.a)(e,t.responses[e.status]);return(null==c?void 0:c.onResponse)&&c.onResponse(e,n),n}catch(e){if("object"==typeof e&&(null==e?void 0:e.response)){const n=e.response,r=Object(B.a)(n,t.responses[e.statusCode]||t.responses.default);e.details=r,(null==c?void 0:c.onResponse)&&c.onResponse(n,r,e)}throw e}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));const r={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function i(e={}){let t=new o(e.parentContext);return e.span&&(t=t.setValue(r.span,e.span)),e.namespace&&(t=t.setValue(r.namespace,e.namespace)),t}class o{constructor(e){this._contextMap=e instanceof o?new Map(e._contextMap):new Map}setValue(e,t){const n=new o(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new o(this);return t._contextMap.delete(e),t}}let s;function a(){return s||(s={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:i({parentContext:t.tracingContext})}),withContext:(e,t,...n)=>t(...n)}),s}function c(e){const{namespace:t,packageName:n,packageVersion:i}=e;function o(e,o,s){var c;const u=a().startSpan(e,Object.assign(Object.assign({},s),{packageName:n,packageVersion:i,tracingContext:null===(c=null==o?void 0:o.tracingOptions)||void 0===c?void 0:c.tracingContext}));let l=u.tracingContext;const h=u.span;l.getValue(r.namespace)||(l=l.setValue(r.namespace,t)),h.setAttribute("az.namespace",l.getValue(r.namespace));return{span:h,updatedOptions:Object.assign({},o,{tracingOptions:Object.assign(Object.assign({},null==o?void 0:o.tracingOptions),{tracingContext:l})})}}function s(e,t,...n){return a().withContext(e,t,...n)}return{startSpan:o,withSpan:async function(e,t,n,r){const{span:i,updatedOptions:a}=o(e,t,r);try{const e=await s(a.tracingOptions.tracingContext,()=>Promise.resolve(n(a,i)));return i.setStatus({status:"success"}),e}catch(e){throw i.setStatus({status:"error",error:e}),e}finally{i.end()}},withContext:s,parseTraceparentHeader:function(e){return a().parseTraceparentHeader(e)},createRequestHeaders:function(e){return a().createRequestHeaders(e)}}}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(56);function i(e){return Object(r.a)(e,["name","key"])&&"string"==typeof e.key&&"string"==typeof e.name}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(56);function i(e){return Object(r.a)(e,["signature"])&&"string"==typeof e.signature}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(39);const i={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function o(e,t){let n,o=null,s=null;const a=Object.assign(Object.assign({},i),t),c={get isRefreshing(){return null!==o},get shouldRefresh(){var e;return!c.isRefreshing&&(null!==(e=null==s?void 0:s.expiresOnTimestamp)&&void 0!==e?e:0)-a.refreshWindowInMs<Date.now()},get mustRefresh(){return null===s||s.expiresOnTimestamp-a.forcedRefreshWindowInMs<Date.now()}};function u(t,i){var u;if(!c.isRefreshing){o=async function(e,t,n){async function i(){if(!(Date.now()<n)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(e){return null}}let o=await i();for(;null===o;)await Object(r.a)(t),o=await i();return o}(()=>e.getToken(t,i),a.retryIntervalInMs,null!==(u=null==s?void 0:s.expiresOnTimestamp)&&void 0!==u?u:Date.now()).then(e=>(o=null,s=e,n=i.tenantId,s)).catch(e=>{throw o=null,s=null,n=void 0,e})}return o}return async(e,t)=>n!==t.tenantId||c.mustRefresh?u(e,t):(c.shouldRefresh&&u(e,t),s)}async function s(e){const{scopes:t,getAccessToken:n,request:r}=e,i={abortSignal:r.abortSignal,tracingOptions:r.tracingOptions},o=await n(t,i);o&&e.request.headers.set("Authorization","Bearer "+o.token)}function a(e){var t;const{credential:n,scopes:r,challengeCallbacks:i,logger:a}=e,c=Object.assign({authorizeRequest:null!==(t=null==i?void 0:i.authorizeRequest)&&void 0!==t?t:s,authorizeRequestOnChallenge:null==i?void 0:i.authorizeRequestOnChallenge},i),u=n?o(n):()=>Promise.resolve(null);return{name:"bearerTokenAuthenticationPolicy",async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let n,i;await c.authorizeRequest({scopes:Array.isArray(r)?r:[r],request:e,getAccessToken:u,logger:a});try{n=await t(e)}catch(e){i=e,n=e.response}if(c.authorizeRequestOnChallenge&&401===(null==n?void 0:n.status)&&function(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(n)){if(await c.authorizeRequestOnChallenge({scopes:Array.isArray(r)?r:[r],request:e,response:n,getAccessToken:u,logger:a}))return t(e)}if(i)throw i;return n}}}}]);